var W_=Object.defineProperty;var z_=(s,t,e)=>t in s?W_(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var b=(s,t,e)=>(z_(s,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerpolicy&&(n.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?n.credentials="include":r.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=e(r);fetch(r.href,n)}})();var Xe=(s=>(s.Renderer="renderer",s.Application="application",s.WebGLRendererPipes="renderer-webgl-pipes",s.WebGLRendererPipesAdaptor="renderer-webgl-pipes-adaptor",s.WebGLRendererSystem="renderer-webgl-system",s.WebGPURendererPipes="renderer-webgpu-pipes",s.WebGPURendererPipesAdaptor="renderer-webgpu-pipes-adaptor",s.WebGPURendererSystem="renderer-webgpu-system",s.CanvasRendererSystem="renderer-canvas-system",s.CanvasRendererPipesAdaptor="renderer-canvas-pipes-adaptor",s.CanvasRendererPipes="renderer-canvas-pipes",s.Asset="asset",s.LoadParser="load-parser",s.ResolveParser="resolve-parser",s.CacheParser="cache-parser",s.DetectionParser="detection-parser",s.MaskEffect="mask-effect",s))(Xe||{});const ah=s=>{if(typeof s=="function"||typeof s=="object"&&s.extension){if(!s.extension)throw new Error("Extension class must have an extension object");s={...typeof s.extension!="object"?{type:s.extension}:s.extension,ref:s}}if(typeof s=="object")s={...s};else throw new Error("Invalid extension type");return typeof s.type=="string"&&(s.type=[s.type]),s},fn=(s,t)=>ah(s).priority??t,Eo={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...s){return s.map(ah).forEach(t=>{t.type.forEach(e=>{var i,r;return(r=(i=this._removeHandlers)[e])==null?void 0:r.call(i,t)})}),this},add(...s){return s.map(ah).forEach(t=>{t.type.forEach(e=>{const i=this._addHandlers,r=this._queue;i[e]?i[e](t):(r[e]=r[e]||[],r[e].push(t))})}),this},handle(s,t,e){const i=this._addHandlers,r=this._removeHandlers;if(i[s]||r[s])throw new Error(`Extension type ${s} already has a handler`);i[s]=t,r[s]=e;const n=this._queue;return n[s]&&(n[s].forEach(o=>t(o)),delete n[s]),this},handleByMap(s,t){return this.handle(s,e=>{t[e.name]=e.ref},e=>{delete t[e.name]})},handleByNamedList(s,t,e=-1){return this.handle(s,i=>{t.findIndex(n=>n.name===i.name)>=0||(t.push({name:i.name,value:i.ref}),t.sort((n,o)=>fn(o.value,e)-fn(n.value,e)))},i=>{const r=t.findIndex(n=>n.name===i.name);r!==-1&&t.splice(r,1)})},handleByList(s,t,e=-1){return this.handle(s,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((r,n)=>fn(n,e)-fn(r,e)))},i=>{const r=t.indexOf(i.ref);r!==-1&&t.splice(r,1)})}};var wd=(s=>(s[s.Low=0]="Low",s[s.Normal=1]="Normal",s[s.High=2]="High",s))(wd||{});const H_={createCanvas:(s,t)=>{const e=document.createElement("canvas");return e.width=s,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(s,t)=>fetch(s,t),parseXML:s=>new DOMParser().parseFromString(s,"text/xml")},Vt={ADAPTER:H_,RETINA_PREFIX:/@([0-9\.]+)x/,FAIL_IF_MAJOR_PERFORMANCE_CAVEAT:!1,RESOLUTION:2};function Ee(s){if(typeof s!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(s)}`)}function lr(s){return s.split("?")[0].split("#")[0]}function X_(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function j_(s,t,e){return s.replace(new RegExp(X_(t),"g"),e)}function Y_(s,t){let e="",i=0,r=-1,n=0,o=-1;for(let a=0;a<=s.length;++a){if(a<s.length)o=s.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||n===1))if(r!==a-1&&n===2){if(e.length<2||i!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const h=e.lastIndexOf("/");if(h!==e.length-1){h===-1?(e="",i=0):(e=e.slice(0,h),i=e.length-1-e.lastIndexOf("/")),r=a,n=0;continue}}else if(e.length===2||e.length===1){e="",i=0,r=a,n=0;continue}}t&&(e.length>0?e+="/..":e="..",i=2)}else e.length>0?e+=`/${s.slice(r+1,a)}`:e=s.slice(r+1,a),i=a-r-1;r=a,n=0}else o===46&&n!==-1?++n:n=-1}return e}const Lr={toPosix(s){return j_(s,"\\","/")},isUrl(s){return/^https?:/.test(this.toPosix(s))},isDataUrl(s){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(s)},hasProtocol(s){return/^[^/:]+:\//.test(this.toPosix(s))},getProtocol(s){Ee(s),s=this.toPosix(s);let t="";const e=/^file:\/\/\//.exec(s),i=/^[^/:]+:\/\//.exec(s),r=/^[^/:]+:\//.exec(s);if(e||i||r){const n=(e==null?void 0:e[0])||(i==null?void 0:i[0])||(r==null?void 0:r[0]);t=n,s=s.slice(n.length)}return t},toAbsolute(s,t,e){if(this.isDataUrl(s))return s;const i=lr(this.toPosix(t??Vt.ADAPTER.getBaseUrl())),r=lr(this.toPosix(e??this.rootname(i)));return Ee(s),s=this.toPosix(s),s.startsWith("/")?Lr.join(r,s.slice(1)):this.isAbsolute(s)?s:this.join(i,s)},normalize(s){if(s=this.toPosix(s),Ee(s),s.length===0)return".";let t="";const e=s.startsWith("/");this.hasProtocol(s)&&(t=this.rootname(s),s=s.slice(t.length));const i=s.endsWith("/");return s=Y_(s,!1),s.length>0&&i&&(s+="/"),e?`/${s}`:t+s},isAbsolute(s){return Ee(s),s=this.toPosix(s),this.hasProtocol(s)?!0:s.startsWith("/")},join(...s){if(s.length===0)return".";let t;for(let e=0;e<s.length;++e){const i=s[e];if(Ee(i),i.length>0)if(t===void 0)t=i;else{const r=s[e-1]??"";this.extname(r)?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(s){if(Ee(s),s.length===0)return".";s=this.toPosix(s);let t=s.charCodeAt(0);const e=t===47;let i=-1,r=!0;const n=this.getProtocol(s),o=s;s=s.slice(n.length);for(let a=s.length-1;a>=1;--a)if(t=s.charCodeAt(a),t===47){if(!r){i=a;break}}else r=!1;return i===-1?e?"/":this.isUrl(o)?n+s:n:e&&i===1?"//":n+s.slice(0,i)},rootname(s){Ee(s),s=this.toPosix(s);let t="";if(s.startsWith("/")?t="/":t=this.getProtocol(s),this.isUrl(s)){const e=s.indexOf("/",t.length);e!==-1?t=s.slice(0,e):t=s,t.endsWith("/")||(t+="/")}return t},basename(s,t){Ee(s),t&&Ee(t),s=lr(this.toPosix(s));let e=0,i=-1,r=!0,n;if(t!==void 0&&t.length>0&&t.length<=s.length){if(t.length===s.length&&t===s)return"";let o=t.length-1,a=-1;for(n=s.length-1;n>=0;--n){const h=s.charCodeAt(n);if(h===47){if(!r){e=n+1;break}}else a===-1&&(r=!1,a=n+1),o>=0&&(h===t.charCodeAt(o)?--o===-1&&(i=n):(o=-1,i=a))}return e===i?i=a:i===-1&&(i=s.length),s.slice(e,i)}for(n=s.length-1;n>=0;--n)if(s.charCodeAt(n)===47){if(!r){e=n+1;break}}else i===-1&&(r=!1,i=n+1);return i===-1?"":s.slice(e,i)},extname(s){Ee(s),s=lr(this.toPosix(s));let t=-1,e=0,i=-1,r=!0,n=0;for(let o=s.length-1;o>=0;--o){const a=s.charCodeAt(o);if(a===47){if(!r){e=o+1;break}continue}i===-1&&(r=!1,i=o+1),a===46?t===-1?t=o:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||i===-1||n===0||n===1&&t===i-1&&t===e+1?"":s.slice(t,i)},parse(s){Ee(s);const t={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return t;s=lr(this.toPosix(s));let e=s.charCodeAt(0);const i=this.isAbsolute(s);let r;t.root=this.rootname(s),i||this.hasProtocol(s)?r=1:r=0;let n=-1,o=0,a=-1,h=!0,l=s.length-1,c=0;for(;l>=r;--l){if(e=s.charCodeAt(l),e===47){if(!h){o=l+1;break}continue}a===-1&&(h=!1,a=l+1),e===46?n===-1?n=l:c!==1&&(c=1):n!==-1&&(c=-1)}return n===-1||a===-1||c===0||c===1&&n===a-1&&n===o+1?a!==-1&&(o===0&&i?t.base=t.name=s.slice(1,a):t.base=t.name=s.slice(o,a)):(o===0&&i?(t.name=s.slice(1,n),t.base=s.slice(1,a)):(t.name=s.slice(o,n),t.base=s.slice(o,a)),t.ext=s.slice(n,a)),t.dir=this.dirname(s),t},sep:"/",delimiter:":"};var na=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Zt={},q_={get exports(){return Zt},set exports(s){Zt=s}};(function(s){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function r(h,l,c){this.fn=h,this.context=l,this.once=c||!1}function n(h,l,c,u,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new r(c,u||h,d),p=e?e+l:l;return h._events[p]?h._events[p].fn?h._events[p]=[h._events[p],f]:h._events[p].push(f):(h._events[p]=f,h._eventsCount++),h}function o(h,l){--h._eventsCount===0?h._events=new i:delete h._events[l]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],c,u;if(this._eventsCount===0)return l;for(u in c=this._events)t.call(c,u)&&l.push(e?u.slice(1):u);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},a.prototype.listeners=function(l){var c=e?e+l:l,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,f=u.length,p=new Array(f);d<f;d++)p[d]=u[d].fn;return p},a.prototype.listenerCount=function(l){var c=e?e+l:l,u=this._events[c];return u?u.fn?1:u.length:0},a.prototype.emit=function(l,c,u,d,f,p){var m=e?e+l:l;if(!this._events[m])return!1;var _=this._events[m],x=arguments.length,g,y;if(_.fn){switch(_.once&&this.removeListener(l,_.fn,void 0,!0),x){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,c),!0;case 3:return _.fn.call(_.context,c,u),!0;case 4:return _.fn.call(_.context,c,u,d),!0;case 5:return _.fn.call(_.context,c,u,d,f),!0;case 6:return _.fn.call(_.context,c,u,d,f,p),!0}for(y=1,g=new Array(x-1);y<x;y++)g[y-1]=arguments[y];_.fn.apply(_.context,g)}else{var w=_.length,v;for(y=0;y<w;y++)switch(_[y].once&&this.removeListener(l,_[y].fn,void 0,!0),x){case 1:_[y].fn.call(_[y].context);break;case 2:_[y].fn.call(_[y].context,c);break;case 3:_[y].fn.call(_[y].context,c,u);break;case 4:_[y].fn.call(_[y].context,c,u,d);break;default:if(!g)for(v=1,g=new Array(x-1);v<x;v++)g[v-1]=arguments[v];_[y].fn.apply(_[y].context,g)}}return!0},a.prototype.on=function(l,c,u){return n(this,l,c,u,!1)},a.prototype.once=function(l,c,u){return n(this,l,c,u,!0)},a.prototype.removeListener=function(l,c,u,d){var f=e?e+l:l;if(!this._events[f])return this;if(!c)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===c&&(!d||p.once)&&(!u||p.context===u)&&o(this,f);else{for(var m=0,_=[],x=p.length;m<x;m++)(p[m].fn!==c||d&&!p[m].once||u&&p[m].context!==u)&&_.push(p[m]);_.length?this._events[f]=_.length===1?_[0]:_:o(this,f)}return this},a.prototype.removeAllListeners=function(l){var c;return l?(c=e?e+l:l,this._events[c]&&o(this,c)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,s.exports=a})(q_);let Gt=class vd{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new vd(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}static get shared(){return oa.x=0,oa.y=0,oa}};const oa=new Gt,pn=[new Gt,new Gt,new Gt,new Gt];let Ge=class $n{constructor(t=0,e=0,i=0,r=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new $n(0,0,0,0)}clone(){return new $n(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const T=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=T)return!1;const P=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>P}const i=this.left,r=this.right,n=this.top,o=this.bottom;if(r<=i||o<=n)return!1;const a=pn[0].set(t.left,t.top),h=pn[1].set(t.left,t.bottom),l=pn[2].set(t.right,t.top),c=pn[3].set(t.right,t.bottom);if(l.x<=a.x||h.y<=a.y)return!1;const u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(a,a),e.apply(h,h),e.apply(l,l),e.apply(c,c),Math.max(a.x,h.x,l.x,c.x)<=i||Math.min(a.x,h.x,l.x,c.x)>=r||Math.max(a.y,h.y,l.y,c.y)<=n||Math.min(a.y,h.y,l.y,c.y)>=o))return!1;const d=u*(h.y-a.y),f=u*(a.x-h.x),p=d*i+f*n,m=d*r+f*n,_=d*i+f*o,x=d*r+f*o;if(Math.max(p,m,_,x)<=d*a.x+f*a.y||Math.min(p,m,_,x)>=d*c.x+f*c.y)return!1;const g=u*(a.y-l.y),y=u*(l.x-a.x),w=g*i+y*n,v=g*r+y*n,S=g*i+y*o,C=g*r+y*o;return!(Math.max(w,v,S,C)<=g*a.x+y*a.y||Math.min(w,v,S,C)>=g*c.x+y*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this}ceil(t=1,e=.001){const i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this}getBounds(t){return t=t||new $n,t.copyFrom(this),t}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};const Le=(s,t)=>(Array.isArray(s)||(s=[s]),t?s.map(e=>typeof e=="string"?t(e):e):s);let K_=class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const i=Le(t);let r;for(let a=0;a<this.parsers.length;a++){const h=this.parsers[a];if(h.test(e)){r=h.getCacheableAssets(i,e);break}}r||(r={},i.forEach(a=>{r[a]=e}));const n=Object.keys(r),o={cacheKeys:n,keys:i};i.forEach(a=>{this._cacheMap.set(a,o)}),n.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==e&&console.warn("[Cache] already has key:",a),this._cache.set(a,r[a])})}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(r=>{this._cache.delete(r)}),e.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}};const Fe=new K_,to=()=>{},aa={},Kl={};function Z_(s,t){let e=Kl[s];return e===void 0&&(aa[t]===void 0&&(aa[t]=1),Kl[s]=e=aa[t]++),e}let J_=0;const Td=class extends Zt{constructor(t={}){super(),this.resourceType="textureSampler",this.uid=J_++,this._maxAnisotropy=1,t={...Td.DEFAULT,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get resourceId(){return this._resourceId||this.generateResourceId()}update(){this.emit("change",this),this._resourceId=null}generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._resourceId=Z_(t,"sampler"),this._resourceId}destroy(){this.emit("destroy",this),this.removeAllListeners()}};let Fr=Td;Fr.DEFAULT={addressMode:"clamp-to-edge",scaleMode:"nearest"};let Q_=0,tm=0,Cd=class extends Zt{constructor(t={}){var i,r;super(),this.uid=Q_++,this.resourceType="textureSource",this.resourceId=tm++,this.type="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm-srgb",this.viewDimensions="2d",this.dimension="2d",this.antialias=!1,this.depthStencil=!0,this.resource=t.resource,this._resolution=t.resolution??1,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=((i=t.resource)==null?void 0:i.width)??1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=((r=t.resource)==null?void 0:r.height)??1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format??"bgra8unorm",this.viewDimensions=t.view??"2d",this.dimension=t.dimensions??"2d",this.mipLevelCount=t.mipLevelCount??1,this.autoGenerateMipmaps=t.autoGenerateMipmaps??!1,this.sampleCount=t.sampleCount??1,this.antialias=t.antialias??!1;const e=t.style??{};this.style=e instanceof Fr?e:new Fr(e),this.style.on("change",this.onStyleUpdate,this),this.styleSourceKey=(this.style.resourceId<<24)+this.uid}get source(){return this}update(){this.emit("update",this)}onStyleUpdate(){this.styleSourceKey=(this.style.resourceId<<24)+this.uid}destroy(){this.emit("destroy",this),this.style&&(this.style.destroy(),this.style=null),this.type=null,this.resource=null,this.removeAllListeners()}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,i){i=i||this._resolution,t=t||this.width,e=e||this.height;const r=Math.round(t*i),n=Math.round(e*i);this.width=r/i,this.height=n/i,this._resolution=i,!(this.pixelWidth===r&&this.pixelHeight===n)&&(this.pixelWidth=r,this.pixelHeight=n,this.emit("resize",this),this.resourceId++,this.emit("change",this))}};const em=Math.PI*2,sm=180/Math.PI,im=Math.PI/180;let tt=class Sd{constructor(t=1,e=0,i=0,r=1,n=0,o=0){this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,i,r,n,o){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,e){e=e||new Gt;const i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e}applyInverse(t,e){e=e||new Gt;const i=this.a,r=this.b,n=this.c,o=this.d,a=this.tx,h=this.ty,l=1/(i*o+n*-r),c=t.x,u=t.y;return e.x=o*l*c+-n*l*u+(h*n-a*o)*l,e.y=i*l*u+-r*l*c+(-h*i+a*r)*l,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,o=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=o*e-this.ty*i,this.ty=o*i+this.ty*e,this}append(t){const e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this}appendFrom(t,e){const i=t.a,r=t.b,n=t.c,o=t.d,a=t.tx,h=t.ty,l=e.a,c=e.b,u=e.c,d=e.d;return this.a=i*l+r*u,this.b=i*c+r*d,this.c=n*l+o*u,this.d=n*c+o*d,this.tx=a*l+h*u+e.tx,this.ty=a*c+h*d+e.ty,this}setTransform(t,e,i,r,n,o,a,h,l){return this.a=Math.cos(a+l)*n,this.b=Math.sin(a+l)*n,this.c=-Math.sin(a-h)*o,this.d=Math.cos(a-h)*o,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,i=this.b,r=this.c,n=this.d,o=t.pivot,a=-Math.atan2(-r,n),h=Math.atan2(i,e),l=Math.abs(a+h);return l<1e-5||Math.abs(em-l)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=h),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx+(o.x*e+o.y*r),t.position.y=this.ty+(o.x*i+o.y*n),t}invert(){const t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,o=t*r-e*i;return this.a=r/o,this.b=-e/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-r*n)/o,this.ty=-(t*this.ty-e*n)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Sd;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return nm.identity()}static get shared(){return rm.identity()}};const rm=new tt,nm=new tt,Ns=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Ds=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],$s=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Gs=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],hh=[],Ad=[],_n=Math.sign;function om(){for(let s=0;s<16;s++){const t=[];hh.push(t);for(let e=0;e<16;e++){const i=_n(Ns[s]*Ns[e]+$s[s]*Ds[e]),r=_n(Ds[s]*Ns[e]+Gs[s]*Ds[e]),n=_n(Ns[s]*$s[e]+$s[s]*Gs[e]),o=_n(Ds[s]*$s[e]+Gs[s]*Gs[e]);for(let a=0;a<16;a++)if(Ns[a]===i&&Ds[a]===r&&$s[a]===n&&Gs[a]===o){t.push(a);break}}}for(let s=0;s<16;s++){const t=new tt;t.set(Ns[s],Ds[s],$s[s],Gs[s],0,0),Ad.push(t)}}om();const ct={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:s=>Ns[s],uY:s=>Ds[s],vX:s=>$s[s],vY:s=>Gs[s],inv:s=>s&8?s&15:-s&7,add:(s,t)=>hh[s][t],sub:(s,t)=>hh[s][ct.inv(t)],rotate180:s=>s^4,isVertical:s=>(s&3)===2,byDirection:(s,t)=>Math.abs(s)*2<=Math.abs(t)?t>=0?ct.S:ct.N:Math.abs(t)*2<=Math.abs(s)?s>0?ct.E:ct.W:t>0?s>0?ct.SE:ct.SW:s>0?ct.NE:ct.NW,matrixAppendRotationInv:(s,t,e=0,i=0)=>{const r=Ad[ct.inv(t)];r.tx=e,r.ty=i,s.append(r)}};let Zl=class extends Zt{constructor(t={}){super(),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=t.frame||new Ge(0,0,1,1),this.orig=t.orig||this.frame,this.rotate=t.rotate??0,this.trim=t.trim,this.defaultAnchor=t.defaultAnchor,this.updateUvs()}updateUvs(){const t=this.uvs,e=this.frame;let i=this.rotate;if(i){const r=e.width/2,n=e.height/2,o=e.x+r,a=e.y+n;i=ct.add(i,ct.NW),t.x0=o+r*ct.uX(i),t.y0=a+n*ct.uY(i),i=ct.add(i,2),t.x1=o+r*ct.uX(i),t.y1=a+n*ct.uY(i),i=ct.add(i,2),t.x2=o+r*ct.uX(i),t.y2=a+n*ct.uY(i),i=ct.add(i,2),t.x3=o+r*ct.uX(i),t.y3=a+n*ct.uY(i)}else t.x0=e.x,t.y0=e.y,t.x1=e.x+e.width,t.y1=e.y,t.x2=e.x+e.width,t.y2=e.y+e.height,t.x3=e.x,t.y3=e.y+e.height}update(){this.updateUvs(),this.emit("update",this)}destroy(){this.emit("destroy",this),this.removeAllListeners(),this.frame=null,this.orig=null,this.trim=null,this.defaultAnchor=null,this.uvs=null}};const Jl=new tt;let am=class{constructor(t,e){this.mapCoord=new tt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){var e;this.texture!==t&&((e=this._texture)==null||e.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){e===void 0&&(e=t);const i=this.mapCoord;for(let r=0;r<t.length;r+=2){const n=t[r],o=t[r+1];e[r]=n*i.a+o*i.c+i.tx,e[r+1]=n*i.b+o*i.d+i.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.layout.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const i=t.layout.orig,r=t.layout.trim;r&&(Jl.set(i.width/r.width,0,0,i.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(Jl));const n=t.source,o=this.uClampFrame,a=this.clampMargin/n._resolution,h=this.clampOffset;return o[0]=(t.frameX+a+h)/n.width,o[1]=(t.frameY+a+h)/n.height,o[2]=(t.frameX+t.frameWidth-a+h)/n.width,o[3]=(t.frameY+t.frameHeight-a+h)/n.height,this.uClampOffset[0]=h/n.pixelWidth,this.uClampOffset[1]=h/n.pixelHeight,this.isSimple=t.frameWidth===n.width&&t.frameHeight===n.height&&t.layout.rotate===0,!0}},hm=0,z=class extends Zt{constructor({source:t,style:e,layout:i,label:r}={}){super(),this.id=hm++,this.styleSourceKey=0,this.label=r,this.source=(t==null?void 0:t.source)??new Cd,this.layout=i instanceof Zl?i:new Zl(i),e&&(this._style=e instanceof Fr?e:new Fr(e)),this.styleSourceKey=(this.style.resourceId<<24)+this._source.uid}static from(t){return Fe.get(t)}set source(t){this._source&&(this._source.off("update",this.onStyleSourceUpdate,this),this._source.off("resize",this.onUpdate,this)),this._source=t,t.on("update",this.onStyleSourceUpdate,this),t.on("resize",this.onUpdate,this),this.styleSourceKey=(this.style.resourceId<<24)+this._source.uid,this.emit("update",this)}get source(){return this._source}get style(){return this._style||this.source.style}set style(t){var e,i;(e=this._style)==null||e.off("change",this.onStyleSourceUpdate,this),this._style=t,(i=this._style)==null||i.on("change",this.onStyleSourceUpdate,this)}get layout(){return this._layout}set layout(t){var e;(e=this._layout)==null||e.off("update",this.onUpdate,this),this._layout=t,t.on("update",this.onUpdate,this),this.emit("update",this)}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new am(this)),this._textureMatrix}set frameWidth(t){this._layout.frame.width=t/this._source.width}get frameWidth(){return this._source.pixelWidth/this._source._resolution*this._layout.frame.width}set frameHeight(t){this._layout.frame.height=t/this._source.height}get frameHeight(){return this._source.pixelHeight/this._source._resolution*this._layout.frame.height}set frameX(t){if(t===0){this._layout.frame.x=0;return}this._layout.frame.x=this._source.width/t}get frameX(){return this._source.width*this._layout.frame.x}set frameY(t){if(t===0){this._layout.frame.y=0;return}this._layout.frame.y=this._source.height/t}get frameY(){return this._source.height*this._layout.frame.y}get width(){return this._source.width*this._layout.orig.width}get height(){return this._source.height*this._layout.orig.height}destroy(t=!1){this._style&&(this._style.destroy(),this._style=null),this._layout&&(this._layout.destroy(),this._layout=null),this._source&&t&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.removeAllListeners()}onStyleSourceUpdate(){this.styleSourceKey=(this.style.resourceId<<24)+this._source.uid,this.emit("update",this)}onUpdate(){this.emit("update",this)}};z.EMPTY=new z({});z.EMPTY.label="EMPTY";z.EMPTY.destroy=to;function lm(s,t){if(Array.isArray(t)){for(const e of t)if(s.startsWith(`data:${e}`))return!0;return!1}return s.startsWith(`data:${t}`)}function cm(s,t){const e=s.split("?")[0],i=Lr.extname(e).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}const Ql={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ns(s){if(typeof s=="number")return s;if(typeof s=="string"){if(Ql[s]!==void 0)return Ql[s];if(s[0]==="#"){if(s.length===4){const t=parseInt(s[1]+s[1],16),e=parseInt(s[2]+s[2],16),i=parseInt(s[3]+s[3],16);return(t<<16)+(e<<8)+i}return parseInt(s.substring(1),16)}console.warn(`[pixi.js] Invalid color: ${s}`)}return 0}let pl=class Pd{constructor(t=1/0,e=1/0,i=-1/0,r=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrixStack=[],this.matrix=new tt,this.minX=t,this.minY=e,this.maxX=i,this.maxY=r}get rectangle(){this._rectangle||(this._rectangle=new Ge);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):(t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY),t}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrixStack.length=0,this.matrix.identity()}pushMatrix(t){this.matrixStack.push(t),this.matrixStack.length>1?(this.matrix.copyFrom(this.matrixStack[this.matrixStack.length-2]),this.matrix.append(t)):this.matrix.copyFrom(t)}popMatrix(){this.matrixStack.pop(),this.matrixStack.length>1?(this.matrix.copyFrom(this.matrixStack[this.matrixStack.length-2]),this.matrix.append(this.matrixStack[this.matrixStack.length-1])):this.matrixStack.length===1?this.matrix.copyFrom(this.matrixStack[0]):this.matrix.identity()}setMatrix(t){this.matrix.copyFrom(t)}set(t,e,i,r){this.minX=t,this.minY=e,this.maxX=i,this.maxY=r}addFrame(t,e,i,r){const n=this.matrix,o=n.a,a=n.b,h=n.c,l=n.d,c=n.tx,u=n.ty;let d=this.minX,f=this.minY,p=this.maxX,m=this.maxY,_=o*t+h*e+c,x=a*t+l*e+u;d=_<d?_:d,f=x<f?x:f,p=_>p?_:p,m=x>m?x:m,_=o*i+h*e+c,x=a*i+l*e+u,d=_<d?_:d,f=x<f?x:f,p=_>p?_:p,m=x>m?x:m,_=o*t+h*r+c,x=a*t+l*r+u,d=_<d?_:d,f=x<f?x:f,p=_>p?_:p,m=x>m?x:m,_=o*i+h*r+c,x=a*i+l*r+u,d=_<d?_:d,f=x<f?x:f,p=_>p?_:p,m=x>m?x:m,this.minX=d,this.minY=f,this.maxX=p,this.maxY=m}addRect(t){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height)}addBounds(t){this.addFrame(t.minX,t.minY,t.maxX,t.maxY)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,{a:o,b:a,c:h,d:l,tx:c,ty:u}=t;let d=o*e+h*i+c,f=a*e+l*i+u;this.minX=d,this.minY=f,this.maxX=d,this.maxY=f,d=o*r+h*i+c,f=a*r+l*i+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*e+h*n+c,f=a*e+l*n+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*r+h*n+c,f=a*r+l*n+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Pd(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}get y(){return this.minY}get width(){return this.maxX-this.minX}get height(){return this.maxY-this.minY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,i){let r=this.minX,n=this.minY,o=this.maxX,a=this.maxY;const h=this.matrix,l=h.a,c=h.b,u=h.c,d=h.d,f=h.tx,p=h.ty;for(let m=e;m<i;m+=2){const _=t[m],x=t[m+1],g=l*_+u*x+f,y=c*_+d*x+p;r=g<r?g:r,n=y<n?y:n,o=g>o?g:o,a=y>a?y:a}this.minX=r,this.minY=n,this.maxX=o,this.maxY=a}toString(){return`[@pixi:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}};function lh(s){if(typeof s=="string")return s;let t=(s|0).toString(16);return t="000000".substring(0,6-t.length)+t,`#${t}`}let Mo=class extends Cd{constructor(t){super(t),this.type="image",this.alphaMode=t.alphaMode??0}};const Io=Vt.ADAPTER.createCanvas(),li=1;Io.width=li;Io.height=li;const ps=Io.getContext("2d");ps.fillStyle="#ffffff";ps.fillRect(0,0,li,li);ps.beginPath();ps.moveTo(0,0);ps.lineTo(li,0);ps.lineTo(li,li);ps.closePath();ps.fillStyle="#ffffff";ps.fill();z.WHITE=new z({source:new Mo({resource:Io})});z.WHITE.label="WHITE";z.WHITE.destroy=to;let um=0;const ch=class{constructor(t,e,i,r){this.uid=um++,this.type="linear",this.gradientStops=[],this.x0=t,this.y0=e,this.x1=i,this.y1=r}addColorStop(t,e){return e=lh(e),this.gradientStops.push({offset:t,color:e}),this}buildLinearGradient(){const t=ch.defaultTextureSize,{gradientStops:e}=this,i=Vt.ADAPTER.createCanvas();i.width=t,i.height=t;const r=i.getContext("2d"),n=r.createLinearGradient(0,0,ch.defaultTextureSize,1);for(let m=0;m<e.length;m++){const _=e[m];n.addColorStop(_.offset,_.color)}r.fillStyle=n,r.fillRect(0,0,t,t),this.texture=new z({source:new Mo({resource:i}),style:{addressModeU:"clamp-to-edge",addressModeV:"repeat"}});const{x0:o,y0:a,x1:h,y1:l}=this,c=new tt,u=h-o,d=l-a,f=Math.sqrt(u*u+d*d),p=Math.atan2(d,u);c.translate(-o,-a),c.scale(1/t,1/t),c.rotate(-p),c.scale(256/f,1),this.transform=c}};let Or=ch;Or.defaultTextureSize=256;const tc={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};let dm=0,_l=class{constructor(t,e){this.uid=dm++,this.transform=new tt,this.texture=t,this.repetition=e,this.transform.scale(1/t.frameWidth,1/t.frameHeight),e&&(t.style.addressModeU=tc[e].addressModeU,t.style.addressModeV=tc[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frameWidth,1/e.frameHeight)}};const fm={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0};function pm(s,t){var h;const e=s.match(/[a-df-z][^a-df-z]*/gi),i=(h=s.match(/[+-]?\d*\.?\d+(?:[eE][+-]?\d+)?/g))==null?void 0:h.map(parseFloat),r=[];e.forEach(l=>{var f;const c=(f=l.match(/[+-]?\d*\.?\d+(?:[eE][+-]?\d+)?/g))==null?void 0:f.map(parseFloat),u=l[0];let d=1;c&&(d=c.length/fm[u.toLowerCase()]);for(let p=0;p<d;p++)r.push(u)});let n=0,o=0,a=0;for(let l=0;l<r.length;l++){const c=r[l];switch(c){case"M":o=i[n++],a=i[n++],t.moveTo(o,a);break;case"m":o+=i[n++],a+=i[n++],t.moveTo(o,a);break;case"H":o=i[n++],t.lineTo(o,a);break;case"h":o+=i[n++],t.lineTo(o,a);break;case"V":a=i[n++],t.lineTo(o,a);break;case"v":a+=i[n++],t.lineTo(o,a);break;case"L":o=i[n++],a=i[n++],t.lineTo(o,a);break;case"l":o+=i[n++],a+=i[n++],t.lineTo(o,a);break;case"C":o=i[n+4],a=i[n+5],t.bezierCurveTo(i[n],i[n+1],i[n+2],i[n+3],o,a),n+=6;break;case"c":t.bezierCurveTo(o+i[n],a+i[n+1],o+i[n+2],a+i[n+3],o+i[n+4],a+i[n+5]),o+=i[n+4],a+=i[n+5],n+=6;break;case"S":o=i[n+2],a=i[n+3],t.bezierCurveToShort(i[n],i[n+1],o,a),n+=4;break;case"s":t.bezierCurveToShort(o+i[n],a+i[n+1],o+i[n+2],a+i[n+3]),o+=i[n+2],a+=i[n+3],n+=4;break;case"Q":o=i[n+2],a=i[n+3],t.quadraticCurveTo(i[n],i[n+1],o,a),n+=4;break;case"q":t.quadraticCurveTo(o+i[n],a+i[n+1],o+i[n+2],a+i[n+3]),o+=i[n+2],a+=i[n+3],n+=4;break;case"T":o=i[n++],a=i[n++],t.quadraticCurveToShort(o,a);break;case"t":o+=i[n++],a+=i[n++],t.quadraticCurveToShort(o,a);break;case"A":o=i[n+5],a=i[n+6],t.arcToSvg(i[n],i[n+1],i[n+2],i[n+3],i[n+4],o,a),n+=7;break;case"a":o+=i[n+5],a+=i[n+6],t.arcToSvg(i[n],i[n+1],i[n+2],i[n+3],i[n+4],o,a),n+=7;break;case"Z":case"z":t.closePath();break;default:console.warn(`Unknown SVG path command: ${c}`)}}return t}let _m=class Ed{constructor(t=0,e=0,i=0){this.type="circle",this.x=t,this.y=e,this.radius=i}clone(){return new Ed(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const i=this.radius*this.radius;let r=this.x-t,n=this.y-e;return r*=r,n*=n,r+n<=i}getBounds(t){return t=t||new Ge,t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}},mm=class Md{constructor(t=0,e=0,i=0,r=0){this.type="ellipse",this.x=t,this.y=e,this.width=i,this.height=r}clone(){return new Md(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let i=(t-this.x)/this.width,r=(e-this.y)/this.height;return i*=i,r*=r,i+r<=1}getBounds(){return new Ge(this.x-this.width,this.y-this.height,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}},Gn=class Id{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const i=[];for(let r=0,n=e.length;r<n;r++)i.push(e[r].x,e[r].y);e=i}this.points=e,this.closePath=!0}clone(){const t=this.points.slice(),e=new Id(t);return e.closePath=this.closePath,e}contains(t,e){let i=!1;const r=this.points.length/2;for(let n=0,o=r-1;n<r;o=n++){const a=this.points[n*2],h=this.points[n*2+1],l=this.points[o*2],c=this.points[o*2+1];h>e!=c>e&&t<(l-a)*((e-h)/(c-h))+a&&(i=!i)}return i}getBounds(t){t=t||new Ge;const e=this.points;let i=1/0,r=-1/0,n=1/0,o=-1/0;for(let a=0,h=e.length;a<h;a+=2){const l=e[a],c=e[a+1];i=l<i?l:i,r=l>r?l:r,n=c<n?c:n,o=c>o?c:o}return t.x=i,t.width=r-i,t.y=n,t.height=o-n,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}},gm=class Rd{constructor(t=0,e=0,i=0,r=0,n=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n}getBounds(t){return t=t||new Ge,t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new Rd(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+i&&e<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let r=t-(this.x+i),n=e-(this.y+i);const o=i*i;if(r*r+n*n<=o||(r=t-(this.x+this.width-i),r*r+n*n<=o)||(n=e-(this.y+this.height-i),r*r+n*n<=o)||(r=t-(this.x+i),r*r+n*n<=o))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}};const ym=8,mn=11920929e-14,xm=1;function kd(s,t,e,i,r,n,o,a,h){let c=xm/1;return c*=c,bm(t,e,i,r,n,o,a,h,s,c),s}function bm(s,t,e,i,r,n,o,a,h,l){uh(s,t,e,i,r,n,o,a,h,l,0),h.push(o,a)}function uh(s,t,e,i,r,n,o,a,h,l,c){if(c>ym)return;const u=(s+e)/2,d=(t+i)/2,f=(e+r)/2,p=(i+n)/2,m=(r+o)/2,_=(n+a)/2,x=(u+f)/2,g=(d+p)/2,y=(f+m)/2,w=(p+_)/2,v=(x+y)/2,S=(g+w)/2;if(c>0){let C=o-s,T=a-t;const A=Math.abs((e-o)*T-(i-a)*C),P=Math.abs((r-o)*T-(n-a)*C);if(A>mn&&P>mn){if((A+P)*(A+P)<=l*(C*C+T*T)){h.push(v,S);return}}else if(A>mn){if(A*A<=l*(C*C+T*T)){h.push(v,S);return}}else if(P>mn){if(P*P<=l*(C*C+T*T)){h.push(v,S);return}}else if(C=v-(s+o)/2,T=S-(t+a)/2,C*C+T*T<=l){h.push(v,S);return}}uh(s,t,u,d,x,g,v,S,h,l,c+1),uh(v,S,y,w,m,_,o,a,h,l,c+1)}const wm=8,vm=11920929e-14,Tm=1;function Cm(s,t,e,i,r,n,o){let h=Tm/1;return h*=h,Sm(t,e,i,r,n,o,s,h),s}function Sm(s,t,e,i,r,n,o,a){dh(o,s,t,e,i,r,n,a,0),o.push(r,n)}function dh(s,t,e,i,r,n,o,a,h){if(h>wm)return;const l=(t+i)/2,c=(e+r)/2,u=(i+n)/2,d=(r+o)/2,f=(l+u)/2,p=(c+d)/2;let m=n-t,_=o-e;const x=Math.abs((i-n)*_-(r-o)*m);if(x>vm){if(x*x<=a*(m*m+_*_)){s.push(f,p);return}}else if(m=f-(t+n)/2,_=p-(e+o)/2,m*m+_*_<=a){s.push(f,p);return}dh(s,t,e,l,c,f,p,a,h+1),dh(s,f,p,u,d,n,o,a,h+1)}function Bd(s,t,e,i,r,n,o,a){let h=Math.abs(r-n);(!o&&r>n||o&&n>r)&&(h=2*Math.PI-h),a=a||Math.max(6,Math.floor(6*Math.pow(i,1/3)*(h/Math.PI))),a=Math.max(a,3);let l=h/a,c=r;l*=o?-1:1;for(let u=0;u<a+1;u++){const d=Math.cos(c),f=Math.sin(c),p=t+d*i,m=e+f*i;s.push(p,m),c+=l}}function Am(s,t,e,i,r,n){const o=s[s.length-2],h=s[s.length-1]-e,l=o-t,c=r-e,u=i-t,d=Math.abs(h*u-l*c);if(d<1e-8||n===0){(s[s.length-2]!==t||s[s.length-1]!==e)&&s.push(t,e);return}const f=h*h+l*l,p=c*c+u*u,m=h*c+l*u,_=n*Math.sqrt(f)/d,x=n*Math.sqrt(p)/d,g=_*m/f,y=x*m/p,w=_*u+x*l,v=_*c+x*h,S=l*(x+g),C=h*(x+g),T=u*(_+y),A=c*(_+y),P=Math.atan2(C-v,S-w),I=Math.atan2(A-v,T-w);Bd(s,w+t,v+e,n,P,I,l*c>u*h)}const Ar=Math.PI*2,ha={centerX:0,centerY:0,ang1:0,ang2:0},la=({x:s,y:t},e,i,r,n,o,a,h)=>{s*=e,t*=i;const l=r*s-n*t,c=n*s+r*t;return h.x=l+o,h.y=c+a,h};function Pm(s,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),i=t===1.5707963267948966?.551915024494:e,r=Math.cos(s),n=Math.sin(s),o=Math.cos(s+t),a=Math.sin(s+t);return[{x:r-n*i,y:n+r*i},{x:o+a*i,y:a-o*i},{x:o,y:a}]}const ec=(s,t,e,i)=>{const r=s*i-t*e<0?-1:1;let n=s*e+t*i;return n>1&&(n=1),n<-1&&(n=-1),r*Math.acos(n)},Em=(s,t,e,i,r,n,o,a,h,l,c,u,d)=>{const f=Math.pow(r,2),p=Math.pow(n,2),m=Math.pow(c,2),_=Math.pow(u,2);let x=f*p-f*_-p*m;x<0&&(x=0),x/=f*_+p*m,x=Math.sqrt(x)*(o===a?-1:1);const g=x*r/n*u,y=x*-n/r*c,w=l*g-h*y+(s+e)/2,v=h*g+l*y+(t+i)/2,S=(c-g)/r,C=(u-y)/n,T=(-c-g)/r,A=(-u-y)/n,P=ec(1,0,S,C);let I=ec(S,C,T,A);a===0&&I>0&&(I-=Ar),a===1&&I<0&&(I+=Ar),d.centerX=w,d.centerY=v,d.ang1=P,d.ang2=I};function Mm(s,t,e,i,r,n,o,a=0,h=0,l=0){if(n===0||o===0)return;const c=Math.sin(a*Ar/360),u=Math.cos(a*Ar/360),d=u*(t-i)/2+c*(e-r)/2,f=-c*(t-i)/2+u*(e-r)/2;if(d===0&&f===0)return;n=Math.abs(n),o=Math.abs(o);const p=Math.pow(d,2)/Math.pow(n,2)+Math.pow(f,2)/Math.pow(o,2);p>1&&(n*=Math.sqrt(p),o*=Math.sqrt(p)),Em(t,e,i,r,n,o,h,l,c,u,d,f,ha);let{ang1:m,ang2:_}=ha;const{centerX:x,centerY:g}=ha;let y=Math.abs(_)/(Ar/4);Math.abs(1-y)<1e-7&&(y=1);const w=Math.max(Math.ceil(y),1);_/=w;let v=s[s.length-2],S=s[s.length-1];const C={x:0,y:0};for(let T=0;T<w;T++){const A=Pm(m,_),{x:P,y:I}=la(A[0],n,o,u,c,x,g,C),{x:Z,y:q}=la(A[1],n,o,u,c,x,g,C),{x:j,y:H}=la(A[2],n,o,u,c,x,g,C);kd(s,v,S,P,I,Z,q,j,H),v=j,S=H,m+=_}}const Im=new Ge;let Rm=class{constructor(t){this.shapePrimitives=[],this.currentPoly=null,this._bounds=new pl,this.graphicsPath2D=t}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const i=this.currentPoly.points,r=i[i.length-2],n=i[i.length-1];return(r!==t||n!==e)&&i.push(t,e),this}arc(t,e,i,r,n,o){this._ensurePoly(!1);const a=this.currentPoly.points;return Bd(a,t,e,i,r,n,o),this}arcTo(t,e,i,r,n){this._ensurePoly();const o=this.currentPoly.points;return Am(o,t,e,i,r,n),this}arcToSvg(t,e,i,r,n,o,a){const h=this.currentPoly.points;return Mm(h,this.currentPoly.lastX,this.currentPoly.lastY,o,a,t,e,i,r,n),this}bezierCurveTo(t,e,i,r,n,o){this._ensurePoly();const a=this.currentPoly;return kd(this.currentPoly.points,a.lastX,a.lastY,t,e,i,r,n,o),this}quadraticCurveTo(t,e,i,r){this._ensurePoly();const n=this.currentPoly;return Cm(this.currentPoly.points,n.lastX,n.lastY,t,e,i,r),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));for(let i=0;i<t.instructions.length;i++){const r=t.instructions[i];this[r.action](...r.data)}return this}finish(t=!1){this.endPoly(t)}rect(t,e,i,r,n){return this.drawShape(new Ge(t,e,i,r),n),this}circle(t,e,i,r){return this.drawShape(new _m(t,e,i),r),this}poly(t,e,i){const r=new Gn(t);r.closePath=e,this.drawShape(r,i)}ellipse(t,e,i,r,n){return this.drawShape(new mm(t,e,i,r),n),this}roundRect(t,e,i,r,n,o){return this.drawShape(new gm(t,e,i,r,n),o),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let i=this.currentPoly;return i&&this.endPoly(),i=new Gn,i.points.push(t,e),this.currentPoly=i,this}endPoly(t=!1){const e=this.currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this.currentPoly=null,this}_ensurePoly(t=!0){if(!this.currentPoly&&(this.currentPoly=new Gn,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let i=e.shape.x,r=e.shape.y;if(e.transform.isIdentity()){const n=e.transform,o=i;i=n.a*i+n.c*r+n.tx,r=n.b*o+n.d*r+n.ty}this.currentPoly.points.push(i,i)}else this.currentPoly.points.push(0,0)}}buildPath(){const t=this.graphicsPath2D;this.shapePrimitives.length=0,this.currentPoly=null;for(let e=0;e<t.instructions.length;e++){const i=t.instructions[e];this[i.action](...i.data)}this.finish()}isPointInPath(t,e){const i=this.shapePrimitives;for(let r=0;r<i.length;r++)if(i[r].shape.contains(t,e))return!0;return!1}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let i=0;i<e.length;i++){const r=e[i],n=r.shape.getBounds(Im);r.transform?(t.pushMatrix(r.transform),t.addRect(n),t.popMatrix()):t.addRect(n)}return t}},km=0,eo=class Ld{constructor(t){this.instructions=[],this.uid=km++,this.dirty=!0,typeof t=="string"?pm(t,this):this.instructions=(t==null?void 0:t.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new Rm(this)),this.dirty&&(this.dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this.dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this.dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this.dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this.dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this.dirty=!0,this}bezierCurveToShort(t,e,i,r){const n=this.instructions[this.instructions.length-1],o=this.getLastPoint(Gt.shared);let a=0,h=0;if(!n||n.action!=="bezierCurveTo")a=o.x,h=o.y;else{a=n.data[2],h=n.data[3];const l=o.x,c=o.y;a=l+(l-a),h=c+(c-h)}return this.instructions.push({action:"bezierCurveTo",data:[a,h,t,e,i,r]}),this.dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this.dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this.dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this.dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this.dirty=!0,this}quadraticCurveToShort(t,e){const i=this.instructions[this.instructions.length-1],r=this.getLastPoint(Gt.shared);let n=0,o=0;if(!i||i.action!=="quadraticCurveTo")n=r.x,o=r.y;else{n=i.data[0],o=i.data[1];const a=r.x,h=r.y;n=a+(a-n),o=h+(h-o)}return this.instructions.push({action:"quadraticCurveTo",data:[n,o,t,e]}),this.dirty=!0,this}rect(t,e,i,r,n){return this.instructions.push({action:"rect",data:[t,e,i,r,n]}),this.dirty=!0,this}circle(t,e,i,r){return this.instructions.push({action:"circle",data:[t,e,i,r]}),this.dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this.dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this.dirty=!0,this}star(t,e,i,r,n,o=0,a){n=n||r/2;const h=-1*Math.PI/2+o,l=i*2,c=Math.PI*2/l,u=[];for(let d=0;d<l;d++){const f=d%2?n:r,p=d*c+h;u.push(t+f*Math.cos(p),e+f*Math.sin(p))}return this.poly(u,!0,a),this}clone(t=!1){const e=new Ld;if(!t)e.instructions=this.instructions.slice();else for(let i=0;i<this.instructions.length;i++){const r=this.instructions[i];e.instructions.push({action:r.action,data:r.data.slice()})}return e}getLastPoint(t){let e=this.instructions.length-1,i=this.instructions[e];if(!i)return t.x=0,t.y=0,t;for(;i.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;i=this.instructions[e]}let r,n,o;switch(i.action){case"moveTo":case"lineTo":t.x=i.data[0],t.y=i.data[1];break;case"quadraticCurveTo":t.x=i.data[2],t.y=i.data[3];break;case"bezierCurveTo":t.x=i.data[4],t.y=i.data[5];break;case"arc":case"arcToSvg":t.x=i.data[5],t.y=i.data[6];break;case"addPath":t.x=i.data[0].lastX,t.y=i.data[2].lastY;break;case"rect":if(o=i.data[4],r=i.data[0],n=i.data[1],o){const{a,b:h,c:l,d:c,tx:u,ty:d}=o;t.x=a*r+l*n+u,t.y=h*r+c*n+d}else t.x=r,t.y=n;break;default:console.warn(`${i.action} is not supported yet`);break}return t}clear(){return this.instructions.length=0,this.dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,i=t.b,r=t.c,n=t.d,o=t.tx,a=t.ty;let h=0,l=0,c=0,u=0,d=0,f=0,p=0,m=0;for(let _=0;_<this.instructions.length;_++){const x=this.instructions[_],g=x.data;switch(x.action){case"moveTo":case"lineTo":h=g[0],l=g[1],g[0]=e*h+r*l+o,g[1]=i*h+n*l+a;break;case"bezierCurveTo":c=g[0],u=g[1],d=g[2],f=g[3],h=g[4],l=g[5],g[0]=e*c+r*u+o,g[1]=i*c+n*u+a,g[2]=e*d+r*f+o,g[3]=i*d+n*f+a,g[4]=e*h+r*l+o,g[5]=i*h+n*l+a;break;case"quadraticCurveTo":c=g[0],u=g[1],h=g[2],l=g[3],g[0]=e*c+r*u+o,g[1]=i*c+n*u+a,g[2]=e*h+r*l+o,g[3]=i*h+n*l+a;break;case"arcToSvg":h=g[5],l=g[6],p=g[0],m=g[1],g[0]=e*p+r*m,g[1]=i*p+n*m,g[5]=e*h+r*l+o,g[6]=i*h+n*l+a;break;case"rect":g[4]=ca(g[4],t);break;case"ellipse":g[8]=ca(g[8],t);break;case"roundRect":g[5]=ca(g[5],t);break;case"addPath":g[0].transform(t);break;default:console.warn("unknown transform action",x.action);break}}return this.dirty=!0,this}get bounds(){return this.shapePath.bounds}};function ca(s,t){return s?s.prepend(t):t.clone()}function Bm(s,t){if(typeof s=="string"){const i=document.createElement("div");i.innerHTML=s.trim(),s=i.querySelector("svg")}const e={context:t,path:new eo};return Fd(s,e,null,null),t}function Fd(s,t,e,i){const r=s.children,{fillStyle:n,strokeStyle:o}=Lm(s);n&&e?e={...e,...n}:n&&(e=n),o&&i?i={...i,...o}:o&&(i=o),t.context.fillStyle=e,t.context.strokeStyle=i;let a,h,l,c,u,d,f,p,m,_,x,g,y,w,v,S,C;switch(s.nodeName.toLowerCase()){case"path":w=s.getAttribute("d"),v=new eo(w),t.context.path(v),e&&t.context.fill(),i&&t.context.stroke();break;case"circle":f=St(s,"cx",0),p=St(s,"cy",0),m=St(s,"r",0),t.context.ellipse(f,p,m,m),e&&t.context.fill(),i&&t.context.stroke();break;case"rect":a=St(s,"x",0),h=St(s,"y",0),S=St(s,"width",0),C=St(s,"height",0),_=St(s,"rx",0),x=St(s,"ry",0),_||x?t.context.roundRect(a,h,S,C,_||x):t.context.rect(a,h,S,C),e&&t.context.fill(),i&&t.context.stroke();break;case"ellipse":f=St(s,"cx",0),p=St(s,"cy",0),_=St(s,"rx",0),x=St(s,"ry",0),t.context.beginPath(),t.context.ellipse(f,p,_,x),e&&t.context.fill(),i&&t.context.stroke();break;case"line":l=St(s,"x1",0),c=St(s,"y1",0),u=St(s,"x2",0),d=St(s,"y2",0),t.context.beginPath(),t.context.moveTo(l,c),t.context.lineTo(u,d),i&&t.context.stroke();break;case"polygon":y=s.getAttribute("points"),g=y.match(/\d+/g).map(T=>parseInt(T,10)),t.context.poly(g,!0),e&&t.context.fill(),i&&t.context.stroke();break;case"polyline":y=s.getAttribute("points"),g=y.match(/\d+/g).map(T=>parseInt(T,10)),t.context.poly(g,!1),i&&t.context.stroke();break;case"g":case"svg":break;default:{console.info(`[SVG parser] <${s.nodeName}> elements unsupported`);break}}for(let T=0;T<r.length;T++)Fd(r[T],t,e,i)}function St(s,t,e){const i=s.getAttribute(t);return i?Number(i):e}function Lm(s){const t=s.getAttribute("style"),e={},i={};let r=!1,n=!1;if(t){const o=t.split(";");for(let a=0;a<o.length;a++){const h=o[a],[l,c]=h.split(":");switch(l){case"stroke":c!=="none"&&(e.color=ns(c),n=!0);break;case"stroke-width":e.width=Number(c);break;case"fill":c!=="none"&&(r=!0,i.color=ns(c));break;case"fill-opacity":i.alpha=Number(c);break;case"stroke-opacity":e.alpha=Number(c);break;case"opacity":i.alpha=Number(c),e.alpha=Number(c);break}}}else{const o=s.getAttribute("stroke");o&&o!=="none"&&(n=!0,e.color=ns(o),e.width=St(s,"stroke-width",1));const a=s.getAttribute("fill");a&&a!=="none"&&(r=!0,i.color=ns(a))}return{strokeStyle:n?e:null,fillStyle:r?i:null}}function so(s,t){if(!s)return null;let e,i;if(s!=null&&s.fill?(i=s.fill,e={...t,...s}):(i=s,e=t),typeof i=="number"||typeof i=="string")return{...e,color:ns(i),texture:z.WHITE};if(i instanceof _l){const n=i;return{...e,color:16777215,texture:n.texture,matrix:n.transform}}else if(i instanceof Or){const n=i;return n.buildLinearGradient(),{...e,color:16777215,texture:n.texture,matrix:n.transform}}const r={...t,...s};if(r.texture!==z.WHITE){const n=r.matrix||new tt;n.scale(1/r.texture.frameWidth,1/r.texture.frameHeight),r.matrix=n,r.color=16777215}return r.color=ns(r.color),r}let Fm=0;const xi=new Gt,sc=new tt,Vs=class extends Zt{constructor(){super(...arguments),this.uid=Fm++,this.usage=0,this.dirty=!0,this.batchMode="auto",this.instructions=[],this.activePath=new eo,this._transform=new tt,this._fillStyle={...Vs.defaultFillStyle},this._fillStyleOriginal=16777215,this._strokeStyle={...Vs.defaultStrokeStyle},this._strokeStyleOriginal=16777215,this._stateStack=[],this._tick=0,this._bounds=new pl,this.boundsDirty=!0}set fillStyle(t){if(this._fillStyleOriginal!==t)if(this._fillStyleOriginal=t,typeof t=="number"||typeof t=="string")this._fillStyle.color=ns(t),this._fillStyle.texture=z.WHITE;else if(t instanceof _l){const e=t;this._fillStyle.color=16777215,this._fillStyle.texture=e.texture,this._fillStyle.matrix=e.transform}else if(t instanceof Or){const e=t;e.buildLinearGradient(),this._fillStyle.color=16777215,this._fillStyle.texture=e.texture,this._fillStyle.matrix=e.transform}else this._fillStyle={...Vs.defaultFillStyle,...t}}get fillStyle(){return this._fillStyleOriginal}set strokeStyle(t){if(this._strokeStyleOriginal!==t)if(this._strokeStyleOriginal=t,typeof t=="number"||typeof t=="string")this._strokeStyle.color=ns(t),this._strokeStyle.texture=z.WHITE;else if(t instanceof Or){const e=t;e.buildLinearGradient(),this._strokeStyle.color=16777215,this._strokeStyle.texture=e.texture,this._strokeStyle.matrix=e.transform}else this._strokeStyle={...Vs.defaultStrokeStyle,...t}}get strokeStyle(){return this._strokeStyleOriginal}setFillStyle(t){return this.fillStyle=t,this}setStrokeStyle(t){return this.strokeStyle=t,this}texture(t,e,i,r,n,o){return this.instructions.push({action:"texture",data:{image:t,dx:i||0,dy:r||0,dw:n||t.frameWidth,dh:o||t.frameHeight,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e||16777215}}),this.onUpdate(),this}beginPath(){return this.activePath=new eo,this}fill(t){let e;const i=this.instructions[this.instructions.length-1];if(this._tick===0&&i&&i.action==="stroke"?e=i.data.path:e=this.activePath.clone(),!e)return this;let r=this._fillStyle;return t&&(r=so(t,Vs.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:r,path:e}}),this.onUpdate(),this.activePath.instructions.length=0,this._tick=0,this}stroke(t){let e;const i=this.instructions[this.instructions.length-1];if(this._tick===0&&i&&i.action==="fill"?e=i.data.path:e=this.activePath.clone(),!e)return this;let r=this._strokeStyle;return t&&(r=so(t,Vs.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:r,path:e}}),this.onUpdate(),this.activePath.instructions.length=0,this._tick=0,this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],i=this.activePath.clone();e&&(e.action==="stroke"||e.action==="fill")&&(e.data.hole=i)}return this.activePath.instructions.length=0,this}arc(t,e,i,r,n,o){this._tick++;const a=this._transform;return this.activePath.arc(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,i,r,n,o),this}arcTo(t,e,i,r,n){this._tick++;const o=this._transform;return this.activePath.arcTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*i+o.c*r+o.tx,o.b*i+o.d*r+o.ty,n),this}arcToSvg(t,e,i,r,n,o,a){this._tick++;const h=this._transform;return this.activePath.arcToSvg(t,e,i,r,n,h.a*o+h.c*a+h.tx,h.b*o+h.d*a+h.ty),this}bezierCurveTo(t,e,i,r,n,o){this._tick++;const a=this._transform;return this.activePath.bezierCurveTo(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,a.a*i+a.c*r+a.tx,a.b*i+a.d*r+a.ty,a.a*n+a.c*o+a.tx,a.b*n+a.d*o+a.ty),this}closePath(){var t;return this._tick++,(t=this.activePath)==null||t.closePath(),this}ellipse(t,e,i,r){return this._tick++,this.activePath.ellipse(t,e,i,r,this._transform.clone()),this}circle(t,e,i){return this._tick++,this.activePath.circle(t,e,i,this._transform.clone()),this}path(t){return this._tick++,this.activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const i=this._transform;return this.activePath.lineTo(i.a*t+i.c*e+i.tx,i.b*t+i.d*e+i.ty),this}moveTo(t,e){this._tick++;const i=this._transform;return this.activePath.moveTo(i.a*t+i.c*e+i.tx,i.b*t+i.d*e+i.ty),this}quadraticCurveTo(t,e,i,r){this._tick++;const n=this._transform;this.activePath.quadraticCurveTo(n.a*t+n.c*e+n.tx,n.b*t+n.d*e+n.ty,n.a*i+n.c*r+n.tx,n.b*i+n.d*r+n.ty)}rect(t,e,i,r){return this._tick++,this.activePath.rect(t,e,i,r,this._transform.clone()),this}roundRect(t,e,i,r,n){return this._tick++,this.activePath.roundRect(t,e,i,r,n,this._transform.clone()),this}poly(t,e){return this._tick++,this.activePath.poly(t,e,this._transform.clone()),this}star(t,e,i,r,n,o){return this._tick++,this.activePath.star(t,e,i,r,n,o,this._transform.clone()),this}svg(t){this._tick++,Bm(t,this)}restore(){const t=this._stateStack.pop();t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle)}save(){this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}})}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,i,r,n,o){return t instanceof tt?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,i,r,n,o),this)}transform(t,e,i,r,n,o){return t instanceof tt?(this._transform.append(t),this):(sc.set(t,e,i,r,n,o),this._transform.append(sc),this)}translate(t,e){return this._transform.translate(t,e),this}clear(){return this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this.boundsDirty=!0)}get bounds(){if(!this.boundsDirty)return this._bounds;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const i=this.instructions[e],r=i.action;if(r==="fill"){const n=i.data;t.addBounds(n.path.bounds)}else if(r==="texture"){const n=i.data;t.pushMatrix(n.transform),t.addFrame(n.dx,n.dy,n.dx+n.dw,n.dy+n.dh),t.popMatrix()}}return t}containsPoint(t){const e=this.instructions;let i=!1;return e.forEach(r=>{var l;const n=r.data,o=n.path;if(!r.action||!o)return;const a=n.style,h=(l=o.shapePath)==null?void 0:l.shapePrimitives;this._forEachShape(h,c=>{var f;if(!a||!c)return;typeof a!="number"&&a.matrix?a.matrix.applyInverse(t,xi):xi.copyFrom(t),i=c.contains(xi.x,xi.y);const u=n.hole;if(!u)return;const d=(f=u.shapePath)==null?void 0:f.shapePrimitives;d&&this._forEachShape(d,p=>{p.contains(xi.x,xi.y)&&(i=!1)})})}),i}_forEachShape(t,e){t==null||t.forEach(i=>{const r=i==null?void 0:i.shape;r&&e(r)})}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const i=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(i),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(i)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this.activePath=null,this._bounds=null,this._stateStack=null,this.transformMatrix=null,this.customShader=null,this._transform=null}};let ci=Vs;ci.defaultFillStyle={color:0,alpha:1,texture:z.WHITE};ci.defaultStrokeStyle={width:1,color:0,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:z.WHITE};function Om(s,t=1){var i;const e=(i=Vt.RETINA_PREFIX)==null?void 0:i.exec(s);return e?parseFloat(e[1]):t}let ic=0,ua;const Um="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",Nm={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${Um}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},Dm={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let da,$m=class{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const e=URL.createObjectURL(new Blob([Nm.code],{type:"application/javascript"})),i=new Worker(e);i.addEventListener("message",r=>{i.terminate(),URL.revokeObjectURL(e),t(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){ua===void 0&&(ua=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<ua&&(da||(da=URL.createObjectURL(new Blob([Dm.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(da),t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const i=new Promise((r,n)=>{this.queue.push({id:t,arguments:e,resolve:r,reject:n})});return this.next(),i}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),i=e.id;this.resolveHash[ic]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:ic++,id:i})}};const rc=new $m;function Gm(s,t,e){return new z({source:s,label:e})}const Vm=[".jpeg",".jpg",".png",".webp",".avif"],Wm=["image/jpeg","image/png","image/webp","image/avif"];async function zm(s){const t=await Vt.ADAPTER.fetch(s);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${s}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const Hm={name:"loadTextures",extension:{type:Xe.LoadParser,priority:wd.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(s){return lm(s,Wm)||cm(s,Vm)},async load(s,t,e){var n;let i=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await rc.isImageBitmapSupported()?i=await rc.loadImageBitmap(s):i=await zm(s):i=await new Promise(o=>{i=new Image,i.crossOrigin=this.config.crossOrigin,i.src=s,i.complete?o(i):i.onload=()=>{o(i)}});const r=new Mo({resource:i,resolution:((n=t.data)==null?void 0:n.resolution)||Om(s),...t.data});return Gm(r,e,s)},unload(s){s.destroy(!0)}},Xm={extension:Xe.ResolveParser,test:Hm.test,parse:s=>{var t;return{resolution:parseFloat(((t=Vt.RETINA_PREFIX.exec(s))==null?void 0:t[1])??"1"),format:s.split(".").pop(),src:s}}};let Xt=class Od{constructor(t,e,i){this._x=e||0,this._y=i||0,this.observer=t}clone(t){return new Od(t,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.observer.onUpdate()),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.observer.onUpdate()),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=${0} y=${0} scope=${this.observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.observer.onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.observer.onUpdate(this))}};function jm(s,t,e){const i=s.length;let r;if(t>=i||e===0)return;e=t+e>i?i-t:e;const n=i-e;for(r=t;r<n;++r)s[r]=s[r+e];s.length=n}const Ym={removeChildren(s=0,t){const e=t??this.children.length,i=e-s,r=[];if(i>0&&i<=e){for(let n=e-1;n>=s;n--){const o=this.children[n];o&&(this.layerGroup&&this.layerGroup.removeChild(o),r.push(o),o.parent=null)}jm(this.children,s,e);for(let n=0;n<r.length;++n)this.emit("childRemoved",r[n],this,n),r[n].emit("removed",this);return r}else if(i===0&&this.children.length===0)return r;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(s){const t=this.getChildAt(s);return this.removeChild(t)},getChildAt(s){if(s<0||s>=this.children.length)throw new Error(`getChildAt: Index (${s}) does not exist.`);return this.children[s]},setChildIndex(s,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(s),this.addChildAt(s,t)},getChildIndex(s){const t=this.children.indexOf(s);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(s,t){const{children:e}=this;if(t<0||t>e.length)throw new Error(`${s}addChildAt: The index ${t} supplied is out of bounds ${e.length}`);if(s.parent){const i=s.parent.children.indexOf(s);if(s.parent===this&&i===t)return s;i!==-1&&s.parent.children.splice(i,1)}return t===e.length?e.push(s):e.splice(t,0,s),s.parent=this,s.didChange=!0,s.didViewUpdate=!1,s.updateFlags=15,this.layerGroup&&this.layerGroup.addChild(s),this.emit("childAdded",s,this,t),s.emit("added",this),s},swapChildren(s,t){if(s===t)return;const e=this.getChildIndex(s),i=this.getChildIndex(t);this.children[e]=t,this.children[i]=s},removeFromParent(){var s;(s=this.parent)==null||s.removeChild(this)}};let qm=class{constructor(t){this.pipe="filter",this.priority=1,this.filters=t==null?void 0:t.filters}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null}};const Ud=[];function Km(s){const t=Ud.pop()||new qm;return t.filters=s,t}function Zm(s){s.filters=null,Ud.push(s)}let Jm=class{constructor(t,e){this._pool=[],this._count=0,this._debug=!1,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool.push(new this._classType);this._count+=t}get(t){var i;let e=this._pool.pop();return e||(e=new this._classType),(i=e.init)==null||i.call(e,t),e}return(t){var e;if(this._pool.indexOf(t)!==-1){this._debug&&console.warn("Object already in pool",t);return}(e=t.reset)==null||e.call(t),this._pool.push(t)}get totalSize(){return this._count}get totalFree(){return this._pool.length}get totalUsed(){return this._count-this._pool.length}},Qm=class{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new Jm(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const i=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[i]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}};const nc=new Qm;let tg=class{constructor(){this._effectClasses=[],this.tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this.tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this.tests.length;e++){const i=this.tests[e];if(i.test(t))return nc.get(i.maskClass,t)}return t}returnMaskEffect(t){nc.return(t)}};const fh=new tg;Eo.handleByList(Xe.MaskEffect,fh._effectClasses);const eg={_mask:null,_filters:null,set mask(s){if(this._mask||(this._mask={mask:null,effect:null}),this._mask.mask===s||(this._mask.effect&&(this.removeEffect(this._mask.effect),fh.returnMaskEffect(this._mask.effect),this._mask.effect=null),this._mask.mask=s,s==null))return;const t=fh.getMaskEffect(s);this._mask.effect=t,this.addEffect(t)},get mask(){var s;return(s=this._mask)==null?void 0:s.mask},set filters(s){if(Array.isArray(s)||(s=[s]),this._filters||(this._filters={filters:null,effect:null}),this._filters.filters===s||(this._filters.effect&&(this.removeEffect(this._filters.effect),Zm(this._filters.effect),this._filters.effect=null),this._filters.filters=s,!s))return;const t=Km(s);this._filters.effect=t,this.addEffect(t)},get filters(){var s;return(s=this._filters)==null?void 0:s.filters}},sg={getChildByLabel(s,t=!1){const e=this.children;for(let i=0;i<e.length;i++){const r=e[i];if(r.label===s||s instanceof RegExp&&s.test(r.label))return r}if(t)for(let i=0;i<e.length;i++){const n=e[i].getChildByLabel(s,!0);if(n)return n}return null},getChildrenByLabel(s,t=!1,e=[]){const i=this.children;for(let r=0;r<i.length;r++){const n=i[r];(n.label===s||s instanceof RegExp&&s.test(n.label))&&e.push(n)}if(t)for(let r=0;r<i.length;r++)i[r].getChildrenByLabel(s,!0,e);return e}};function Ur(s,t){const e=t._scale,i=t._pivot,r=t.position,n=e._x,o=e._y,a=i._x,h=i._y;s.a=t._cx*n,s.b=t._sx*n,s.c=t._cy*o,s.d=t._sy*o,s.tx=r._x-(a*s.a+h*s.c),s.ty=r._y-(a*s.b+h*s.d)}function ig(s,t,e){e.clear();let i;return s.parent?t?i=s.parent.worldTransform:i=io(s,new tt):i=tt.IDENTITY,Nd(s,e,i,t),e.isValid||e.set(0,0,0,0),e}function Nd(s,t,e,i){var n,o;if(!s.visible||!s.measurable)return;let r;i?r=s.worldTransform:(s.didChange&&Ur(s.localTransform,s),r=tt.shared.appendFrom(s.localTransform,e).clone()),s.view&&(t.setMatrix(r),s.view.addBounds(t));for(let a=0;a<s.children.length;a++)Nd(s.children[a],t,r,i);for(let a=0;a<s.effects.length;a++)(o=(n=s.effects[a]).addBounds)==null||o.call(n,t)}function io(s,t){const e=s.parent;return e&&(io(e,t),e.didChange&&Ur(e.localTransform,e),t.append(e.localTransform)),t}function cr(s,t,e){t.clear(),e||(e=new tt),s.view&&(t.setMatrix(e),s.view.addBounds(t));for(let i=0;i<s.children.length;i++)Dd(s.children[i],t,e,s);return t.isValid||t.set(0,0,0,0),t}function Dd(s,t,e,i){var o,a;if(!s.visible||!s.measurable)return;s.didChange&&Ur(s.localTransform,s);const r=s.localTransform,n=tt.shared.appendFrom(r,e).clone();s.view&&(t.setMatrix(n),s.view.addBounds(t));for(let h=0;h<s.children.length;h++)Dd(s.children[h],t,n,i);for(let h=0;h<s.effects.length;h++)(a=(o=s.effects[h]).addLocalBounds)==null||a.call(o,t,i)}const bi=new pl,gn=new tt,rg={get width(){return this.scale.x*cr(this,bi,gn).width},set width(s){this.scale.x=s/cr(this,bi,gn).width},get height(){return this.scale.y*cr(this,bi,gn).height},set height(s){this.scale.y=s/cr(this,bi,gn).height},getLocalBounds(){return cr(this,bi,this.localTransform).rectangle},getBounds(s){return ig(this,s,bi).rectangle}},ng={_onRender:null,set onRender(s){const t=this.layerGroup;if(!s){this._onRender&&(t==null||t.removeOnRender(this)),this._onRender=null;return}this._onRender||t==null||t.addOnRender(this),this._onRender=s},get onRender(){return this._onRender}},og={getGlobalPosition(s=new Gt,t=!1){return this.parent?this.parent.toGlobal(this.position,s,t):(s.x=this.position.x,s.y=this.position.y),s},toGlobal(s,t,e=!1){if(!e){this.didChange&&Ur(this.localTransform,this);const i=io(this,new tt);return i.append(this.localTransform),i.apply(s,t)}return this.worldTransform.apply(s,t)},toLocal(s,t,e,i){if(t&&(s=t.toGlobal(s,e,i)),!i){this.didChange&&Ur(this.localTransform,this);const r=io(this,new tt);return r.append(this.localTransform),r.applyInverse(s,e)}return this.worldTransform.applyInverse(s,e)}};let ag=0,hg=class{constructor(){this.uid=ag++,this.instructions=[],this.instructionSize=0}reset(){this.instructionSize=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}lastInstruction(){return this.instructions[this.instructionSize-1]}},lg=class extends Zt{constructor({original:t,view:e}){super(),this.uid=ug(),this.view=e,this.original=t,this.layerTransform=new tt,this.layerColor=4294967295,this.layerVisibleRenderable=3,this.view.owner=this}get layerBlendMode(){return this.original.layerBlendMode}onViewUpdate(){this.didViewUpdate=!0,this.original.layerGroup.onChildViewUpdate(this)}get isRenderable(){return this.original.isRenderable}},cg=class{constructor(t){this.type="layer",this.root=null,this.rootRenderable=null,this.canBundle=!1,this.layerGroupParent=null,this.layerGroupChildren=[],this.children=[],this.worldTransform=new tt,this.worldColor=4294967295,this.childrenToUpdate={},this.updateTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new hg,this.onRenderContainers=[],this.root=t;const e=t.view;e&&(this.proxyRenderable=new lg({original:t,view:e})),this.addChild(t)}get localTransform(){return this.root.localTransform}get layerTransform(){return this.root.layerTransform}addLayerGroupChild(t){t.layerGroupParent&&t.layerGroupParent.removeLayerGroupChild(t),t.layerGroupParent=this,this.onChildUpdate(t.root),this.layerGroupChildren.push(t)}removeLayerGroupChild(t){t.root.didChange&&this.removeChildFromUpdate(t.root);const e=this.layerGroupChildren.indexOf(t);e>-1&&this.layerGroupChildren.splice(e,1),t.layerGroupParent=null}addChild(t){if(this.structureDidChange=!0,t!==this.root&&(this.children.push(t),t.updateTick=-1,t.parent===this.root?t.relativeLayerDepth=1:t.relativeLayerDepth=t.parent.relativeLayerDepth+1,t._onRender&&this.addOnRender(t)),t.layerGroup){if(t.layerGroup.root===t){this.addLayerGroupChild(t.layerGroup);return}}else t.layerGroup=this,t.didChange=!0;const e=t.children;t.isLayerRoot||this.onChildUpdate(t);for(let i=0;i<e.length;i++)this.addChild(e[i])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&this.removeOnRender(t),t.layerGroup.root!==t){const i=t.children;for(let r=0;r<i.length;r++)this.removeChild(i[r]);t.didChange&&t.layerGroup.removeChildFromUpdate(t),t.layerGroup=null}else this.removeLayerGroupChild(t.layerGroup);const e=this.children.indexOf(t);e>-1&&this.children.splice(e,1)}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeLayerDepth];e||(e=this.childrenToUpdate[t.relativeLayerDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.layerVisibleRenderable<3||(t.didViewUpdate=!1,this.instructionSet.renderPipes[t.view.type].updateRenderable(t))}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}removeChildFromUpdate(t){const e=this.childrenToUpdate[t.relativeLayerDepth];if(!e)return;const i=e.list.indexOf(t);i>-1&&e.list.splice(i,1),e.index--}get isRenderable(){const t=this.worldColor>>24&255;return this.root.localVisibleRenderable===3&&t>0}addOnRender(t){this.onRenderContainers.push(t)}removeOnRender(t){this.onRenderContainers.splice(this.onRenderContainers.indexOf(t),1)}runOnRender(){this.onRenderContainers.forEach(t=>{t._onRender()})}},$d=0;function ug(){return $d++}const oc=new Xt(null),ac=new Xt(null),hc=new Xt(null,1,1),lc=1,dg=2,cc=4;let F=class Gd extends Zt{constructor({label:t,layer:e,view:i}={}){super(),this.uid=$d++,this.label=null,this.updateFlags=15,this.isLayerRoot=!1,this.layerGroup=null,this.didChange=!1,this.didViewUpdate=!1,this.relativeLayerDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new tt,this.layerTransform=new tt,this.position=new Xt(this,0,0),this._scale=hc,this._pivot=ac,this._skew=oc,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=4294967295,this.layerColor=4294967295,this.localBlendMode="inherit",this.layerBlendMode="normal",this.localVisibleRenderable=3,this.layerVisibleRenderable=3,this.effects=[],t&&(this.label=t),e&&this.enableLayer(),i&&(this.view=i,this.view.owner=this)}static mixin(t){Object.defineProperties(Gd.prototype,Object.getOwnPropertyDescriptors(t))}addEffect(t){this.effects.indexOf(t)===-1&&(this.effects.push(t),this.effects.sort((i,r)=>i.priority-r.priority),!this.isLayerRoot&&this.layerGroup&&(this.layerGroup.structureDidChange=!0),this.updateIsSimple())}removeEffect(t){const e=this.effects.indexOf(t);e!==-1&&(this.effects.splice(e,1),!this.isLayerRoot&&this.layerGroup&&(this.layerGroup.structureDidChange=!0),this.updateIsSimple())}addChild(...t){if(t.length>1){for(let i=0;i<t.length;i++)this.addChild(t[i]);return t[0]}const e=t[0];return e.parent===this?(this.children.splice(this.children.indexOf(e),1),this.children.push(e),this.layerGroup&&!this.isLayerRoot&&(this.layerGroup.structureDidChange=!0),e):(e.parent&&e.parent.removeChild(e),this.children.push(e),e.parent=this,e.didChange=!0,e.didViewUpdate=!1,e.updateFlags=15,this.layerGroup&&this.layerGroup.addChild(e),e)}removeChild(...t){if(t.length>1){for(let r=0;r<t.length;r++)this.removeChild(t[r]);return t[0]}const e=t[0],i=this.children.indexOf(e);return i>-1&&(this.children.splice(i,1),this.layerGroup&&this.layerGroup.removeChild(e)),e.parent=null,e}onUpdate(t){if(t&&t===this._skew&&this.updateSkew(),!this.didChange)if(this.didChange=!0,this.isLayerRoot){const e=this.layerGroup.layerGroupParent;e&&e.onChildUpdate(this)}else this.layerGroup&&this.layerGroup.onChildUpdate(this)}onViewUpdate(){this.didViewUpdate||(this.didViewUpdate=!0,this.layerGroup&&this.layerGroup.onChildViewUpdate(this))}set layer(t){if(this.isLayerRoot&&t===!1)throw new Error("[Pixi] cannot undo a layer just yet");t&&this.enableLayer()}get layer(){return this.isLayerRoot}enableLayer(){if(this.layerGroup&&this.layerGroup.root===this)return;this.isLayerRoot=!0;const t=this.layerGroup;if(t&&t.removeChild(this),this.layerGroup=new cg(this),t){for(let e=0;e<t.layerGroupChildren.length;e++){const i=t.layerGroupChildren[e];let r=i.root;for(;r;){if(r===this){this.layerGroup.addLayerGroupChild(i);break}r=r.parent}}t.addLayerGroupChild(this.layerGroup)}this.updateIsSimple()}get worldTransform(){return this._worldTransform||(this._worldTransform=new tt),this.layerGroup&&(this.isLayerRoot?this._worldTransform.copyFrom(this.layerGroup.worldTransform):this._worldTransform.appendFrom(this.layerTransform,this.layerGroup.worldTransform)),this._worldTransform}get x(){return this.position.x}set x(t){this.position.x=t}get y(){return this.position.y}set y(t){this.position.y=t}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.onUpdate(this._skew))}get angle(){return this.rotation*sm}set angle(t){this.rotation=t*im}get pivot(){return this._pivot===ac&&(this._pivot=new Xt(this,0,0)),this._pivot}get skew(){return this._skew===oc&&(this._skew=new Xt(this,0,0)),this._skew}get scale(){return this._scale===hc&&(this._scale=new Xt(this,1,1)),this._scale}updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}set alpha(t){t=t*255|0,t!==(this.localColor>>24&255)&&(this.localColor=this.localColor&16777215|t<<24,this.updateFlags|=lc,this.onUpdate())}get alpha(){return(this.localColor>>24&255)/255}set tint(t){t=((t&255)<<16)+(t&65280)+(t>>16&255),t!==(this.localColor&16777215)&&(this.localColor=this.localColor&4278190080|t&16777215,this.updateFlags|=lc,this.onUpdate())}get tint(){const t=this.localColor&16777215;return((t&255)<<16)+(t&65280)+(t>>16&255)}set blendMode(t){this.localBlendMode!==t&&(this.layerGroup&&!this.isLayerRoot&&(this.layerGroup.structureDidChange=!0),this.updateFlags|=dg,this.localBlendMode=t,this.onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localVisibleRenderable&2)}set visible(t){const e=t?1:0;(this.localVisibleRenderable&2)>>1!==e&&(this.layerGroup&&!this.isLayerRoot&&(this.layerGroup.structureDidChange=!0),this.updateFlags|=cc,this.localVisibleRenderable=this.localVisibleRenderable&1|e<<1,this.onUpdate())}get renderable(){return!!(this.localVisibleRenderable&1)}set renderable(t){const e=t?1:0;(this.localVisibleRenderable&1)!==e&&(this.localVisibleRenderable=this.localVisibleRenderable&2|e,this.updateFlags|=cc,this.layerGroup&&!this.isLayerRoot&&(this.layerGroup.structureDidChange=!0),this.onUpdate())}get isRenderable(){const t=this.layerColor>>24&255;return this.localVisibleRenderable===3&&t>0}updateIsSimple(){this.isSimple=!this.isLayerRoot&&this.effects.length===0}destroy(t=!1){this.removeFromParent(),this.parent=null,this._mask=null,this._filters=null,this.effects=null,this.position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed"),this.removeAllListeners();const e=typeof t=="boolean"?t:t==null?void 0:t.children,i=this.removeChildren(0,this.children.length);if(e)for(let r=0;r<i.length;++r)i[r].destroy(t);this.view&&(this.view.destroy(t),this.view.owner=null)}};F.mixin(Ym);F.mixin(og);F.mixin(ng);F.mixin(rg);F.mixin(eg);F.mixin(sg);const an={onViewUpdate:()=>{}};let fg=0,pg=class{constructor(t){var e,i;this.owner=an,this.batched=!0,this.buildId=0,this.uid=fg++,this.type="sprite",this._bounds=[0,1,0,0],this._sourceBounds=[0,1,0,0],this.boundsDirty=!0,this.sourceBoundsDirty=!0,this.anchor=new Xt(this,((e=t.layout.defaultAnchor)==null?void 0:e.x)||0,((i=t.layout.defaultAnchor)==null?void 0:i.y)||0),this.texture=t}set texture(t){this._texture!==t&&(t.on("update",this.onUpdate,this),this._texture=t,t.off("update",this.onUpdate,this),this.onUpdate())}get texture(){return this._texture}get bounds(){return this.boundsDirty&&(this.updateBounds(),this.boundsDirty=!1),this._bounds}get sourceBounds(){return this.sourceBoundsDirty&&(this._updateSourceBounds(),this.sourceBoundsDirty=!1),this._sourceBounds}updateBounds(){const t=this._texture,e=t._source,i=t.layout,r=i.orig,n=i.trim,o=e.width,a=e.height,h=o*r.width,l=a*r.height,c=this.anchor,u=this._bounds;if(n){const d=o*n.width,f=a*n.height;u[1]=n.x*o-c._x*h,u[0]=u[1]+d,u[3]=n.y*a-c._y*l,u[2]=u[3]+f}else u[1]=-c._x*h,u[0]=u[1]+h,u[3]=-c._y*l,u[2]=u[3]+l}_updateSourceBounds(){const t=this.anchor,e=this._texture,i=e._source,n=e.layout.orig,o=this._sourceBounds,a=i.width*n.width,h=i.height*n.height;o[1]=-t._x*a,o[0]=o[1]+a,o[3]=-t._y*h,o[2]=o[3]+h}addBounds(t){if(this._texture._layout.trim){const i=this.sourceBounds;t.addFrame(i[0],i[2],i[1],i[3])}else{const i=this.bounds;t.addFrame(i[0],i[2],i[1],i[3])}}onUpdate(){this.didUpdate=!0,this.boundsDirty=!0,this.owner.onViewUpdate()}containsPoint(t){const e=this._texture.frameWidth,i=this._texture.frameHeight,r=-e*this.anchor.x;let n=0;return t.x>=r&&t.x<r+e&&(n=-i*this.anchor.y,t.y>=n&&t.y<n+i)}destroy(t=!1){if(this.anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const i=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(i)}this._texture=null,this._bounds=null,this._sourceBounds=null}},Et=class ph extends F{static from(t){return typeof t=="string"?new ph(Fe.get(t)):new ph(t)}constructor(t=z.EMPTY){t instanceof z&&(t={texture:t}),t.texture??(t.texture=z.EMPTY),super({view:new pg(t.texture),label:"Sprite",...t})}get anchor(){return this.view.anchor}get texture(){return this.view.texture}set texture(t){this.view.texture=t}};const _g="modulepreload",mg=function(s,t){return new URL(s,t).href},uc={},fa=function(t,e,i){if(!e||e.length===0)return t();const r=document.getElementsByTagName("link");return Promise.all(e.map(n=>{if(n=mg(n,i),n in uc)return;uc[n]=!0;const o=n.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!i)for(let c=r.length-1;c>=0;c--){const u=r[c];if(u.href===n&&(!o||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${n}"]${a}`))return;const l=document.createElement("link");if(l.rel=o?"stylesheet":_g,o||(l.as="script",l.crossOrigin=""),l.href=n,document.head.appendChild(l),o)return new Promise((c,u)=>{l.addEventListener("load",c),l.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>t())};let pa;function gg(){return typeof pa>"u"&&(pa=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:Vt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!Vt.ADAPTER.getWebGLRenderingContext())return!1;let r=Vt.ADAPTER.createCanvas().getContext("webgl2",t);const n=!!((e=r==null?void 0:r.getContextAttributes())!=null&&e.stencil);if(r){const o=r.getExtension("WEBGL_lose_context");o&&o.loseContext()}return r=null,n}catch{return!1}}()),pa}function yg(){return!!Vt.ADAPTER.getNavigator().gpu}const dc=["webgpu","webgl","canvas"];async function xg(s){let t=[],e;const{webgl:i,webgpu:r,...n}=s;s.preference?(t.push(s.preference),dc.forEach(h=>{h!==s.preference&&t.push(h)})):t=dc.slice();let o;(s.manageImports??!0)&&await fa(()=>import("./all-b6818898.js"),[],import.meta.url);for(let h=0;h<t.length;h++){const l=t[h];if(l==="webgpu"&&yg()){const{WebGPURenderer:c}=await fa(()=>import("./WebGPURenderer-b7c94bc0.js"),["./WebGPURenderer-b7c94bc0.js","./SystemManager-ab973f0b.js"],import.meta.url);o=c,e=r;break}else if(l==="webgl"&&gg()){const{WebGLRenderer:c}=await fa(()=>import("./WebGLRenderer-5cce7d8f.js"),["./WebGLRenderer-5cce7d8f.js","./SystemManager-ab973f0b.js"],import.meta.url);o=c,e=i;break}else if(l==="canvas")break}const a=new o;return await a.init({...n,...e}),a}const Vd=class{constructor(){this.stage=new F}async init(s){s={...s},this.renderer=await xg(s),Vd._plugins.forEach(t=>{t.init.call(this,s)})}render(){this.renderer.render(this.stage)}get canvas(){return this.renderer.canvas}};let ml=Vd;ml._plugins=[];Eo.handleByList(Xe.Application,ml._plugins);let bg=class{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<e;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}};const ro=s=>!Array.isArray(s);let wg=class{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,i)=>(this._parsersValidated=!1,t[e]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const i={promise:null,parser:null};return i.promise=(async()=>{var o,a;let r=null,n=null;if(e.loadParser&&(n=this._parserHash[e.loadParser],n||console.warn(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!n){for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];if(l.load&&((o=l.test)!=null&&o.call(l,t,e,this))){n=l;break}}if(!n)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await n.load(t,e,this),i.parser=n;for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];l.parse&&l.parse&&await((a=l.testParse)==null?void 0:a.call(l,r,e,this))&&(r=await l.parse(r,e,this)||r,i.parser=l)}return r})(),i}async load(t,e){this._parsersValidated||this._validateParsers();let i=0;const r={},n=ro(t),o=Le(t,l=>({alias:[l],src:l})),a=o.length,h=o.map(async l=>{const c=Lr.toAbsolute(l.src);if(!r[l.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,l)),r[l.src]=await this.promiseCache[c].promise,e&&e(++i/a)}catch(u){throw delete this.promiseCache[c],delete r[l.src],new Error(`[Loader.load] Failed to load ${c}.
${u}`)}});return await Promise.all(h),n?r[o[0].src]:r}async unload(t){const i=Le(t,r=>({alias:[r],src:r})).map(async r=>{var a,h;const n=Lr.toAbsolute(r.src),o=this.promiseCache[n];if(o){const l=await o.promise;(h=(a=o.parser)==null?void 0:a.unload)==null||h.call(a,l,r,this),delete this.promiseCache[n]}});await Promise.all(i)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(t[e.name]&&console.warn(`[Assets] loadParser name conflict "${e.name}"`),{...t,[e.name]:e}),{})}};function Wd(s,t,e,i,r){const n=t[e];for(let o=0;o<n.length;o++){const a=n[o];e<t.length-1?Wd(s.replace(i[e],a),t,e+1,i,r):r.push(s.replace(i[e],a))}}function vg(s){const t=/\{(.*?)\}/g,e=s.match(t),i=[];if(e){const r=[];e.forEach(n=>{const o=n.substring(1,n.length-1).split(",");r.push(o)}),Wd(s,r,0,e,i)}else i.push(s);return i}let Tg=class{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const i=[];Array.isArray(e)?e.forEach(r=>{const n=r.src??r.srcs,o=r.alias??r.name;let a;if(typeof o=="string"){const h=this._createBundleAssetId(t,o);i.push(h),a=[o,h]}else{const h=o.map(l=>this._createBundleAssetId(t,l));i.push(...h),a=[...o,...h]}this.add({...r,alias:a,src:n})}):Object.keys(e).forEach(r=>{const n=[r,this._createBundleAssetId(t,r)];if(typeof e[r]=="string")this.add({alias:n,src:e[r]});else if(Array.isArray(e[r]))this.add({alias:n,src:e[r]});else{const o=e[r],a=o.src??o.srcs;this.add({...o,alias:n,src:Array.isArray(a)?a:[a]})}i.push(...n)}),this._bundles[t]=i}add(t){const e=[];Array.isArray(t)?e.push(...t):e.push(t);const i=n=>{this.hasKey(n)&&console.warn(`[Resolver] already has key: ${n} overwriting`)};Le(e).forEach(n=>{const{alias:o,name:a,src:h,srcs:l}=n;let{data:c,format:u,loadParser:d}=n;const f=Le(h||l).map(_=>typeof _=="string"?vg(_):Array.isArray(_)?_:[_]),p=Le(o||a);Array.isArray(o)?o.forEach(i):i(o);const m=[];f.forEach(_=>{_.forEach(x=>{let g={};if(typeof x!="object"){g.src=x;for(let y=0;y<this._parsers.length;y++){const w=this._parsers[y];if(w.test(x)){g=w.parse(x);break}}}else c=x.data??c,u=x.format??u,d=x.loadParser??d,g={...g,...x};g=this.buildResolvedAsset(g,{aliases:p,data:c,format:u,loadParser:d}),m.push(g)})}),p.forEach(_=>{this._assetMap[_]=m})})}resolveBundle(t){const e=ro(t);t=Le(t);const i={};return t.forEach(r=>{const n=this._bundles[r];if(n){const o=this.resolve(n),a={};for(const h in o){const l=o[h];a[this._extractAssetIdFromBundle(r,h)]=l}i[r]=a}}),e?i[t[0]]:i}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const i={};for(const r in e)i[r]=e[r].src;return i}return e.src}resolve(t){const e=ro(t);t=Le(t);const i={};return t.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let n=this._assetMap[r];const o=n[0],a=this._getPreferredOrder(n);a==null||a.priority.forEach(h=>{a.params[h].forEach(l=>{const c=n.filter(u=>u[h]?u[h]===l:!1);c.length&&(n=c)})}),this._resolverHash[r]=n[0]??o}else this._resolverHash[r]=this.buildResolvedAsset({alias:[r],src:r},{});i[r]=this._resolverHash[r]}),e?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const i=t[0],r=this._preferredOrder.find(n=>n.params.format.includes(i.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}buildResolvedAsset(t,e){const{aliases:i,data:r,loadParser:n,format:o}=e;return(this._basePath||this._rootPath)&&(t.src=Lr.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=i??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...r||{},...t.data},t.loadParser=n??t.loadParser,t.format=o??t.src.split(".").pop(),t.srcs=t.src,t.name=t.alias,t}},Cg=class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Tg,this.loader=new wg,this.cache=Fe,this._backgroundLoader=new bg(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var n,o,a;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let h=t.manifest;typeof h=="string"&&(h=await this.load(h)),this.resolver.addManifest(h)}const e=((n=t.texturePreference)==null?void 0:n.resolution)??1,i=typeof e=="number"?[e]:e;let r=[];if((o=t.texturePreference)!=null&&o.format){const h=(a=t.texturePreference)==null?void 0:a.format;r=typeof h=="string"?[h]:h;for(const l of this._detections)await l.test()||(r=await l.remove(r))}else for(const h of this._detections)await h.test()&&(r=await h.add(r));this.resolver.prefer({params:{format:r,resolution:i}}),t.preferences&&this.setPreferences(t.preferences)}add(t){this.resolver.add(t)}async load(t,e){this._initialized||await this.init();const i=ro(t),r=Le(t).map(a=>{if(typeof a!="string"){this.add(a);const h=a.src||a.srcs,l=a.alias||a.name;return l&&Array.isArray(l)?l[0]:h&&Array.isArray(h)?h[0]:l||h}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),n=this.resolver.resolve(r),o=await this._mapLoadToResolve(n,e);return i?o[r[0]]:o}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let i=!1;typeof t=="string"&&(i=!0,t=[t]);const r=this.resolver.resolveBundle(t),n={},o=Object.keys(r);let a=0,h=0;const l=()=>{e==null||e(++a/h)},c=o.map(u=>{const d=r[u];return h+=Object.keys(d).length,this._mapLoadToResolve(d,l).then(f=>{n[u]=f})});return await Promise.all(c),i?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Fe.get(t);const e={};for(let i=0;i<t.length;i++)e[i]=Fe.get(t[i]);return e}async _mapLoadToResolve(t,e){const i=Object.values(t),r=Object.keys(t);this._backgroundLoader.active=!1;const n=await this.loader.load(i,e);this._backgroundLoader.active=!0;const o={};return i.forEach((a,h)=>{const l=n[a.src],c=[a.src];a.alias&&c.push(...a.alias),o[r[h]]=l,Fe.set(c,l)}),o}async unload(t){this._initialized||await this.init();const e=Le(t).map(r=>typeof r!="string"?r.src:r),i=this.resolver.resolve(e);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=Le(t);const e=this.resolver.resolveBundle(t),i=Object.keys(e).map(r=>this._unloadFromResolved(e[r]));await Promise.all(i)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(i=>{Fe.remove(i.src)}),await this.loader.unload(e)}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(i=>i in t).forEach(i=>{e.config[i]=t[i]})})}};const je=new Cg;Eo.handleByList(Xe.LoadParser,je.loader.parsers).handleByList(Xe.ResolveParser,je.resolver.parsers).handleByList(Xe.CacheParser,je.cache.parsers).handleByList(Xe.DetectionParser,je.detections);class fc{constructor(t){this.usageTick=0,this.dirty=!0,this.resources={};let e=0;for(const i in t){const r=t[i];this.setResource(r,e++)}this.updateKey()}update(){this.updateKey()}updateKey(){if(!this.dirty)return;this.dirty=!1;const t=[];let e=0;for(const i in this.resources)t[e++]=this.resources[i].resourceId;this.key=t.join("|")}setResource(t,e){var r,n;const i=this.resources[e];t!==i&&(i&&((r=t.off)==null||r.call(t,"change",this.onResourceChange,this)),(n=t.on)==null||n.call(t,"change",this.onResourceChange,this),this.resources[e]=t,this.dirty=!0)}getResource(t){return this.resources[t]}destroy(){var e;const t=this.resources;for(const i in t){const r=t[i];(e=r.off)==null||e.call(r,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(){this.dirty=!0,this.update()}}let Sg=class extends Zt{constructor({gpuProgram:t,glProgram:e,groups:i,resources:r,groupMap:n}){super(),this.uniformBindMap={},this.gpuProgram=t,this.glProgram=e;const o={};if(r&&i)throw new Error("[Shader] Cannot have both resources and groups");if(!r&&!i)throw new Error("[Shader] Must provide either resources or groups descriptor");if(!t&&i&&!n)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!t&&i&&n)for(const a in n)for(const h in n[a]){const l=n[a][h];o[l]={group:a,binding:h,name:l}}else if(t&&i&&!n){const a=t.structsAndGroups.groups;n={},a.forEach(h=>{n[h.group]=n[h.group]||{},n[h.group][h.binding]=h.name,o[h.name]=h})}else if(r){if(t){const a=t.structsAndGroups.groups;n={},a.forEach(h=>{n[h.group]=n[h.group]||{},n[h.group][h.binding]=h.name,o[h.name]=h})}else{n={},i={99:new fc};let a=0;for(const h in r)o[h]={group:99,binding:a,name:h},i[99].setResource(r[h],a),n[99]=n[99]||{},n[99][a]=h,a++}i={};for(const a in r){const h=a,l=r[a],c=o[h];c&&(i[c.group]=i[c.group]||new fc,i[c.group].setResource(l,c.binding))}}this.groups=i,this.uniformBindMap=n,this.resources=this._buildResourceAccessor(i,o)}_buildResourceAccessor(t,e){const i={};for(const r in e){const n=e[r];Object.defineProperty(i,n.name,{get(){return t[n.group].getResource(n.binding)},set(o){t[n.group].setResource(o,n.binding)}})}return i}destroy(t=!1){var e,i;this.emit("destroy",this),t&&((e=this.gpuProgram)==null||e.destroy(),(i=this.glProgram)==null||i.destroy()),this.gpuProgram=null,this.glProgram=null,this.groups=null,this.removeAllListeners(),this.uniformBindMap=null,this.resources=null}};const Ag={normal:0,additive:1,multiply:2,screen:3,overlay:4},_a=0,ma=1,ga=2,ya=3,xa=4,ba=5;let Pg=class zd{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<_a)}set blend(t){!!(this.data&1<<_a)!==t&&(this.data^=1<<_a)}get offsets(){return!!(this.data&1<<ma)}set offsets(t){!!(this.data&1<<ma)!==t&&(this.data^=1<<ma)}set cullMode(t){if(t==="none"){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=t==="front"}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<ga)}set culling(t){!!(this.data&1<<ga)!==t&&(this.data^=1<<ga)}get depthTest(){return!!(this.data&1<<ya)}set depthTest(t){!!(this.data&1<<ya)!==t&&(this.data^=1<<ya)}get depthMask(){return!!(this.data&1<<ba)}set depthMask(t){!!(this.data&1<<ba)!==t&&(this.data^=1<<ba)}get clockwiseFrontFace(){return!!(this.data&1<<xa)}set clockwiseFrontFace(t){!!(this.data&1<<xa)!==t&&(this.data^=1<<xa)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!=="none",this._blendMode=t,this._blendModeId=Ag[t]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new zd;return t.depthTest=!1,t.blend=!0,t}};const Hd=class extends Sg{constructor(t){t={...Hd.defaultOptions,...t},super({gpuProgram:t.gpuProgram,glProgram:t.glProgram,resources:t.resources}),this.enabled=!0,this._state=Pg.for2d(),this.padding=t.padding,typeof t.antialias=="boolean"?this.antialias=t.antialias?"on":"off":this.antialias=t.antialias??"inherit",this.resolution=t.resolution,this.blendRequired=t.blendRequired}apply(t,e,i,r){t.applyFilter(this,e,i,r)}get blendMode(){return this._state.blendMode}set blendMode(t){this._state.blendMode=t}};let Xd=Hd;Xd.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"inherit",blendRequired:!1};function Eg(s,{requestedPrecision:t,maxSupportedPrecision:e}){if(s.substring(0,9)!=="precision"){let i=t;if(t==="highp"&&e!=="highp"&&(i="mediump"),s.substring(0,8)!=="#version")return`precision ${i} float;
${s}`;const r=s.indexOf(`
`);return`${s.substring(0,r+1)}precision ${i} float;
${s.substring(r+1)}`}else if(e!=="highp"&&s.substring(0,15)==="precision highp")return s.replace("precision highp","precision mediump");return s}const Mg={},Ig={};function Rg(s,{name:t="pixi-program"},e=!0){t=t.replace(/\s+/g,"-"),t+=e?"-fragment":"-vertex";const i=e?Mg:Ig;if(i[t]?(i[t]++,t+=`-${i[t]}`):i[t]=1,s.indexOf("#define SHADER_NAME")!==-1)return s;const r=`#define SHADER_NAME ${t}`;if(s.substring(0,8)!=="#version")return`${r}
${s}`;const n=s.indexOf(`
`);return`${s.substring(0,n+1)}${r}
${s.substring(n+1)}`}function kg(s,{version:t="300 es"}){return s.substring(0,8)==="#version"?s:`#version ${t}
${s}`}const wa={ensurePrecision:Eg,setProgramName:Rg,setProgramVersion:kg},yr=class{constructor({fragment:s,vertex:t,name:e}){const i={ensurePrecision:{requestedPrecision:"highp",maxSupportedPrecision:"highp"},setProgramName:{name:e},setProgramVersion:{version:"300 es"}};Object.keys(wa).forEach(r=>{const n=i[r]??{};s=wa[r](s,n,!0),t=wa[r](t,n,!1)}),this.fragment=s,this.vertex=t,this.key=`${this.vertex}:${this.fragment}`}destroy(){this.fragment=null,this.vertex=null,this.attributeData=null,this.uniformData=null,this.uniformBlockData=null,this.transformFeedbackVaryings=null}static from(s){const t=`${s.vertex}:${s.fragment}`;return yr.programCached[t]||(yr.programCached[t]=new yr(s)),yr.programCached[t]}};let jd=yr;jd.programCached={};function Bg(s){var u;const t=new RegExp("(?<!\\/\\/.*)@(group|binding)\\(\\d+\\)[^;]+;","g"),e=/@group\((\d+)\)/,i=/@binding\((\d+)\)/,r=/var(<[^>]+>)? (\w+)/,n=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,a=/(\w+)\s*:\s*([\w\<\>]+)/g,h=/struct\s+(\w+)/,l=(u=s.match(t))==null?void 0:u.map(d=>({group:parseInt(d.match(e)[1],10),binding:parseInt(d.match(i)[1],10),name:d.match(r)[2],isUniform:d.match(r)[1]==="<uniform>",type:d.match(n)[1]}));if(!l)return{groups:[],structs:[]};const c=s.match(o).map(d=>{const f=d.match(h)[1],p=d.match(a).reduce((m,_)=>{const[x,g]=_.split(":");return m[x.trim()]=g.trim(),m},{});return{name:f,members:p}}).filter(({name:d})=>l.some(f=>f.type===d));return{groups:l,structs:c}}var xr=(s=>(s[s.VERTEX=1]="VERTEX",s[s.FRAGMENT=2]="FRAGMENT",s[s.COMPUTE=4]="COMPUTE",s))(xr||{});function Lg({groups:s}){const t=[];for(let e=0;e<s.length;e++){const i=s[e];t[i.group]||(t[i.group]=[]),i.isUniform?t[i.group].push({binding:i.binding,visibility:xr.VERTEX|xr.FRAGMENT,buffer:{type:"uniform"}}):i.type==="sampler"?t[i.group].push({binding:i.binding,visibility:xr.FRAGMENT,sampler:{type:"filtering"}}):i.type==="texture_2d"&&t[i.group].push({binding:i.binding,visibility:xr.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return t}function Fg({groups:s}){const t=[];for(let e=0;e<s.length;e++){const i=s[e];t[i.group]||(t[i.group]={}),t[i.group][i.name]=i.binding}return t}const br=class{constructor({fragment:s,vertex:t,compute:e,layout:i,gpuLayout:r}){this._layoutKey=0,this.fragment=s,this.vertex=t,this.compute=e;const n=Bg(this.fragment.source);this.structsAndGroups=n,this.layout=i??Fg(n),this.gpuLayout=r??Lg(n)}destroy(){this._gpuLayout=null,this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null,this.compute=null}static from(s){const t=`${s.vertex.source}:${s.fragment.source}:${s.fragment.entryPoint}:${s.vertex.entryPoint}`;return br.programCached[t]||(br.programCached[t]=new br(s)),br.programCached[t]}};let Yd=br;Yd.programCached={};let Og=0;function _h(){return Og++}const qd=class{constructor(s,t){this.uid=_h(),this.resourceType="uniformGroup",this.resourceId=this.uid,this.isUniformGroup=!0,this.dirtyId=0,t={...qd.DEFAULT,...t},this.uniformStructures=s;const e={};for(const i in s){const r=s[i];r.name=i,r.size=r.size??1,e[i]=r.value??r}this.uniforms=e,this.dirtyId=1,this.ubo=t.ubo,this.isStatic=t.isStatic,this.signature=Object.keys(e).map(i=>`${i}-${s[i].type}`).join("-")}update(){this.dirtyId++}};let Kd=qd;Kd.DEFAULT={ubo:!1,isStatic:!1};var Ug=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform vec4 inputSize;
uniform vec4 inputClamp;

out vec4 fragColor;

uniform vec2 uCenter;
uniform float uTime;
uniform float uSpeed;
uniform vec4 uWave;

uniform sampler2D myTexture;


const float PI = 3.14159;

void main()
{
    float uAmplitude = uWave[0];
    float uWavelength = uWave[1];
    float uBrightness = uWave[2];
    float uRadius = uWave[3];

    float halfWavelength = uWavelength * 0.5 / inputSize.x;
    float maxRadius = uRadius / inputSize.x;
    float currentRadius = uTime * uSpeed / inputSize.x;

    float fade = 1.0;

    if (maxRadius > 0.0) {
        if (currentRadius > maxRadius) {
            fragColor = texture(myTexture, vTextureCoord);
            return;
        }
        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);
    }

    vec2 dir = vec2(vTextureCoord - uCenter / inputSize.xy);
    dir.y *= inputSize.y / inputSize.x;
    float dist = length(dir);

    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {
        fragColor = texture(myTexture, vTextureCoord);
        return;
    }

    vec2 diffUV = normalize(dir);

    float diff = (dist - currentRadius) / halfWavelength;

    float p = 1.0 - pow(abs(diff), 2.0);

    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );
    float powDiff = 1.25 * sin(diff * PI) * p * ( uAmplitude * fade );

    vec2 offset = diffUV * powDiff / inputSize.xy;

    // Do clamp :
    vec2 coord = vTextureCoord + offset;
    vec2 clampedCoord = clamp(coord, inputClamp.xy, inputClamp.zw);
    vec4 color = texture(myTexture, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    // No clamp :
    // fragColor = texture(myTexture, vTextureCoord + offset);

    color.rgb *= 1.0 + (uBrightness - 1.0) * p * fade;

    fragColor = color;
}
`,Ng=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform globalUniforms {
  mat3 projectionMatrix;
  mat3 worldTransformMatrix;
  float worldAlpha;
};

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * outputFrame.zw + outputFrame.xy;
    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,pc=`struct GlobalUniforms {\\n  projectionMatrix:mat3x3<f32>,\\n  worldTransformMatrix:mat3x3<f32>,\\n  worldAlpha: f32\\n}\\n\\nstruct GlobalFilterUniforms {\\n  inputSize:vec4<f32>,\\n  inputPixel:vec4<f32>,\\n  inputClamp:vec4<f32>,\\n  outputFrame:vec4<f32>,\\n  backgroundFrame:vec4<f32>,\\n  globalFrame:vec4<f32>,\\n};\\n\\nstruct ShockWaveUniforms {\\n  uTime: f32,\\n  uOffset: vec2<f32>,\\n  uSpeed: f32,\\n  uWave: vec4<f32>,\\n};\\n\\n\\n\\n@group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;\\n\\n@group(1) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\\n@group(1) @binding(1) var myTexture: texture_2d<f32>;\\n@group(1) @binding(2) var mySampler : sampler;\\n@group(1) @binding(3) var backTexture: texture_2d<f32>;\\n\\n@group(2) @binding(0) var<uniform> shockwaveUniforms : ShockWaveUniforms;\\n\\nstruct VSOutput {\\n    @builtin(position) position: vec4<f32>,\\n    @location(0) uv : vec2<f32>,\\n    @location(1) backgroundUv : vec2<f32>,\\n  };\\n\\nfn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>\\n{\\n    var position = aPosition * gfu.outputFrame.zw + gfu.outputFrame.xy;\\n\\n    return vec4((globalUniforms.projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\\n}\\n\\nfn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\\n{\\n    return aPosition * (gfu.outputFrame.zw * gfu.inputSize.zw);\\n}\\n\\nfn filterBackgroundTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\\n{\\n    return aPosition * gfu.backgroundFrame.zw;\\n}\\n\\nfn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\\n{\\n  return  (aPosition.xy / gfu.globalFrame.zw) + (gfu.globalFrame.xy / gfu.globalFrame.zw);  \\n}\\n\\nfn getSize() -> vec2<f32>\\n{\\n  return gfu.globalFrame.zw;\\n}\\n  \\n@vertex\\nfn mainVertex(\\n  @location(0) aPosition : vec2<f32>, \\n) -> VSOutput {\\n  return VSOutput(\\n   filterVertexPosition(aPosition),\\n   filterTextureCoord(aPosition),\\n   filterBackgroundTextureCoord(aPosition),\\n  );\\n}\\n\\n\\n// @fragment\\n// fn mainFragment(\\n//   @location(0) uv: vec2<f32>,\\n//   @location(1) backgroundUv: vec2<f32>,\\n//   @builtin(position) position: vec4<f32>\\n// ) -> @location(0) vec4<f32> {\\n\\n//     var sample = textureSample(myTexture, mySampler, uv);\\n    \\n//     return sample.rgba;\\n// }\\n\\n@fragment\\nfn mainFragment(\\n  @location(0) uv: vec2<f32>,\\n  @location(1) backgroundUv: vec2<f32>,\\n  @builtin(position) position: vec4<f32>\\n) -> @location(0) vec4<f32> {\\n\\n  let uTime = shockwaveUniforms.uTime;\\n  let uOffset = shockwaveUniforms.uOffset;\\n  let uSpeed = shockwaveUniforms.uSpeed;\\n  let uAmplitude = shockwaveUniforms.uWave[0];\\n  let uWavelength = shockwaveUniforms.uWave[1];\\n  let uBrightness = shockwaveUniforms.uWave[2];\\n  let uRadius = shockwaveUniforms.uWave[3];\\n\\n  let halfWavelength: f32 = uWavelength * 0.5 / gfu.inputSize.x;\\n  let maxRadius: f32 = uRadius / gfu.inputSize.x;\\n  let currentRadius: f32 = uTime * uSpeed / gfu.inputSize.x;\\n\\n  var fade: f32 = 1.0;\\n  var returnColorOnly: bool = false;\\n\\n  if (maxRadius > 0.0) {\\n    if (currentRadius > maxRadius) {\\n      returnColorOnly = true;\\n    }\\n\\n    fade = 1.0 - pow(currentRadius / maxRadius, 2.0);\\n  }\\n\\n  var dir: vec2<f32> = vec2<f32>(uv - uOffset / gfu.inputSize.xy);\\n  dir.y *= gfu.inputSize.y / gfu.inputSize.x;\\n  \\n  let dist:f32 = length(dir);\\n  \\n  if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {\\n    returnColorOnly = true;\\n  }\\n\\n  let diffUV: vec2<f32> = normalize(dir);\\n  let diff: f32 = (dist - currentRadius) / halfWavelength;\\n  let p: f32 = 1.0 - pow(abs(diff), 2.0);\\n  let powDiff: f32 = 1.25 * sin(diff * PI) * p * ( uAmplitude * fade );\\n\\n  let offset: vec2<f32> = diffUV * powDiff / gfu.inputSize.xy;\\n\\n  // Do clamp :\\n  let coord: vec2<f32> = uv + offset;\\n  let clampedCoord: vec2<f32> = clamp(coord, gfu.inputClamp.xy, gfu.inputClamp.zw);\\n  \\n  var clampedColor: vec4<f32> = textureSample(myTexture, mySampler, clampedCoord);\\n\\n  if (boolVec2(coord, clampedCoord)) \\n  {\\n    clampedColor *= max(0.0, 1.0 - length(coord - clampedCoord));\\n  }\\n\\n  // No clamp :\\n  return select(clampedColor * vec4<f32>(vec3<f32>(1.0 + (uBrightness - 1.0) * p * fade), clampedColor.a), textureSample(myTexture, mySampler, uv), returnColorOnly);\\n}\\n\\nfn boolVec2(x: vec2<f32>, y: vec2<f32>) -> bool\\n{\\n  if (x.x == y.x && x.y == y.y)\\n  {\\n    return true;\\n  }\\n\\n  return false;\\n}\\n\\nconst PI: f32 = 3.14159265358979323846264;";
`;const Zd=class extends Xd{constructor(s={}){s={...Zd.DEFAULT,...s};const t=new Yd({vertex:{source:pc,entryPoint:"mainVertex"},fragment:{source:pc,entryPoint:"mainFragment"}}),e=new jd({vertex:Ng,fragment:Ug,name:"shockwave-filter"});super({gpuProgram:t,glProgram:e,resources:{shockwaveUniforms:new Kd({uTime:{value:0,type:"f32"},uCenter:{value:s.center,type:"vec2<f32>"},uSpeed:{value:s.speed,type:"f32"},uWave:{value:new Float32Array(4),type:"vec4<f32>"}})},resolution:1}),this.time=0,this.uniforms=this.resources.shockwaveUniforms.uniforms,Object.assign(this,s)}apply(s,t,e,i){this.uniforms.uTime=this.time,s.applyFilter(this,t,e,i)}get center(){return this.uniforms.uCenter}set center(s){this.uniforms.uCenter=s}get centerX(){return this.uniforms.uCenter.x}set centerX(s){this.uniforms.uCenter.x=s}get centerY(){return this.uniforms.uCenter.y}set centerY(s){this.uniforms.uCenter.y=s}get speed(){return this.uniforms.uSpeed}set speed(s){this.uniforms.uSpeed=s}get amplitude(){return this.uniforms.uWave[0]}set amplitude(s){this.uniforms.uWave[0]=s}get wavelength(){return this.uniforms.uWave[1]}set wavelength(s){this.uniforms.uWave[1]=s}get brightness(){return this.uniforms.uWave[2]}set brightness(s){this.uniforms.uWave[2]=s}get radius(){return this.uniforms.uWave[3]}set radius(s){this.uniforms.uWave[3]=s}};let Jd=Zd;Jd.DEFAULT={center:{x:0,y:0},speed:500,amplitude:30,wavelength:160,brightness:1,radius:-1};function _c(s){return s+=s===0?1:0,--s,s|=s>>>1,s|=s>>>2,s|=s>>>4,s|=s>>>8,s|=s>>>16,s+1}let Dg=0,Pr=class extends Zt{constructor({data:t,size:e,usage:i,label:r}){super(),this.resourceType="buffer",this.resourceId=_h(),this.uid=Dg++,this._updateID=1,t instanceof Array&&(t=new Float32Array(t)),this._data=t,e=e??(t==null?void 0:t.byteLength);const n=!!t;this.descriptor={size:e,usage:i,mappedAtCreation:n,label:r}}get data(){return this._data}set data(t){if(this._data!==t){const e=this._data;this._data=t,e.length!==t.length?(this.descriptor.size=t.byteLength,this.resourceId=_h(),this.emit("change",this)):this.emit("update",this)}}update(t){this._updateSize=t||this.descriptor.size,this._updateID++,this.emit("update",this)}destroy(){this.emit("destroy",this),this._data=null,this.descriptor=null,this.removeAllListeners()}};var ie=(s=>(s[s.MAP_READ=1]="MAP_READ",s[s.MAP_WRITE=2]="MAP_WRITE",s[s.COPY_SRC=4]="COPY_SRC",s[s.COPY_DST=8]="COPY_DST",s[s.INDEX=16]="INDEX",s[s.VERTEX=32]="VERTEX",s[s.UNIFORM=64]="UNIFORM",s[s.STORAGE=128]="STORAGE",s[s.INDIRECT=256]="INDIRECT",s[s.QUERY_RESOLVE=512]="QUERY_RESOLVE",s[s.STATIC=1024]="STATIC",s))(ie||{});function mc(s,t){if(!(s instanceof Pr)){let e=t?ie.INDEX:ie.VERTEX;s instanceof Array&&(t?(s=new Uint32Array(s),e=ie.INDEX|ie.COPY_DST):(s=new Float32Array(s),e=ie.VERTEX|ie.COPY_DST)),s=new Pr({data:s,label:"index-mesh-buffer",usage:e})}return s}let $g=1,Gg=class extends Zt{constructor({attributes:t,indexBuffer:e,topology:i}){super(),this.uid=$g++,this._layoutKey=0,this.tick=0,this.attributes=t,this.buffers=[];for(const r in t){const n=t[r];n.buffer=mc(n.buffer,!1),this.buffers.indexOf(n.buffer)===-1&&(this.buffers.push(n.buffer),n.buffer.on("update",this.onBufferUpdate,this))}e&&(this.indexBuffer=mc(e,!0),this.buffers.push(this.indexBuffer)),this.topology=i||"triangle-list"}setBufferAtIndex(t,e){const i=this.buffers[e];i.off("update",this.onBufferUpdate,this),t.on("update",this.onBufferUpdate,this),this.buffers[e]=t;for(const r in this.attributes){const n=this.attributes[r];n.buffer===i&&(n.buffer=t)}}onBufferUpdate(){this.tick=this.tick++,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.getBuffer(t).data.length/(e.stride/4||e.size)}return 0}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(e=>e.destroy()),this.attributes=null,this.buffers=null}};const Qd=class extends Gg{constructor(s={}){s={...Qd.defaultOptions,...s};const t=s.positions||new Float32Array([0,0,1,0,1,1,0,1]),e=s.uvs||new Float32Array([0,0,1,0,1,1,0,1]),i=s.indices||new Uint32Array([0,1,2,0,2,3]),r=new Pr({data:t,label:"attribute-mesh-positions",usage:ie.VERTEX|ie.COPY_DST}),n=new Pr({data:e,label:"attribute-mesh-uvs",usage:ie.VERTEX|ie.COPY_DST}),o=new Pr({data:i,label:"index-mesh-buffer",usage:ie.INDEX|ie.COPY_DST});super({attributes:{aPosition:{buffer:r,shaderLocation:0,format:"float32x2",stride:2*4,offset:0},aUV:{buffer:n,shaderLocation:1,format:"float32x2",stride:2*4,offset:0}},indexBuffer:o,topology:s.topology}),this.batchMode="auto"}get positions(){return this.attributes.aPosition.buffer.data}set positions(s){this.attributes.aPosition.buffer.data=s}get uvs(){return this.attributes.aUV.buffer.data}set uvs(s){this.attributes.aUV.buffer.data=s}get indices(){return this.indexBuffer.data}set indices(s){this.indexBuffer.data=s}};let tf=Qd;tf.defaultOptions={topology:"triangle-list"};const ef=class extends tf{constructor(s={}){super({}),this.build(s)}build(s){s={...ef.defaultOptions,...s},this.verticesX=this.verticesX??s.verticesX,this.verticesY=this.verticesY??s.verticesY,this.width=this.width??s.width,this.height=this.height??s.height;const t=this.verticesX*this.verticesY,e=[],i=[],r=[],n=this.verticesX-1,o=this.verticesY-1,a=this.width/n,h=this.height/o;for(let c=0;c<t;c++){const u=c%this.verticesX,d=c/this.verticesX|0;e.push(u*a,d*h),i.push(u/n,d/o)}const l=n*o;for(let c=0;c<l;c++){const u=c%n,d=c/n|0,f=d*this.verticesX+u,p=d*this.verticesX+u+1,m=(d+1)*this.verticesX+u,_=(d+1)*this.verticesX+u+1;r.push(f,p,m,p,_,m)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(i),this.indexBuffer.data=new Uint32Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}};let sf=ef;sf.defaultOptions={width:100,height:100,verticesX:10,verticesY:10};const rf=class extends sf{constructor(s){s={...rf.defaultOptions,...s},super({width:s.width,height:s.height,verticesX:4,verticesY:4}),this._textureMatrix=new tt,this.update(s)}update(s){this.updateUvs(s),this.updatePositions(s)}updatePositions(s){this.width=s.width??this.width,this.height=s.height??this.height,this._leftWidth=s.leftWidth??this._leftWidth,this._rightWidth=s.rightWidth??this._rightWidth,this._topHeight=s.topHeight??this._topHeight,this._bottomHeight=s.bottomHeight??this._bottomHeight;const t=this.positions,e=this._leftWidth+this._rightWidth,i=this.width>e?1:this.width/e,r=this._topHeight+this._bottomHeight,n=this.height>r?1:this.height/r,o=Math.min(i,n);t[9]=t[11]=t[13]=t[15]=this._topHeight*o,t[17]=t[19]=t[21]=t[23]=this.height-this._bottomHeight*o,t[25]=t[27]=t[29]=t[31]=this.height,t[2]=t[10]=t[18]=t[26]=this._leftWidth*o,t[4]=t[12]=t[20]=t[28]=this.width-this._rightWidth*o,t[6]=t[14]=t[22]=t[30]=this.width,this.getBuffer("aPosition").update()}updateUvs(s){this._originalWidth=s.originalWidth??this._originalWidth,this._originalHeight=s.originalHeight??this._originalHeight,this._leftWidth=s.leftWidth??this._leftWidth,this._rightWidth=s.rightWidth??this._rightWidth,this._topHeight=s.topHeight??this._topHeight,this._bottomHeight=s.bottomHeight??this._bottomHeight,s.textureMatrix&&this._textureMatrix.copyFrom(s.textureMatrix);const t=this._textureMatrix,e=this.uvs;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1;const i=1/this._originalWidth,r=1/this._originalHeight;e[2]=e[10]=e[18]=e[26]=i*this._leftWidth,e[9]=e[11]=e[13]=e[15]=r*this._topHeight,e[4]=e[12]=e[20]=e[28]=1-i*this._rightWidth,e[17]=e[19]=e[21]=e[23]=1-r*this._bottomHeight,Vg(t,e),this.getBuffer("aUV").update()}};let nf=rf;nf.defaultOptions={width:100,height:100,leftWidth:10,topHeight:10,rightWidth:10,bottomHeight:10,originalWidth:100,originalHeight:100};function Vg(s,t,e){e??(e=t);const i=s.a,r=s.b,n=s.c,o=s.d,a=s.tx,h=s.ty;for(let l=0;l<t.length;l+=2){const c=t[l],u=t[l+1];e[l]=c*i+u*n+a,e[l+1]=c*r+u*o+h}return e}let Wg=0;const gc=new Gn;class zg{constructor(t){this.uid=Wg++,this.type="mesh",this.canBundle=!0,this.owner=an,this.shader=t.shader,t.texture&&(this.texture=t.texture),this._geometry=t.geometry,this._geometry.on("update",this.onGeometryUpdate,this)}set shader(t){this._shader!==t&&(this._shader=t,this.onUpdate())}get shader(){return this._shader}set geometry(t){var e;this._geometry!==t&&((e=this._geometry)==null||e.off("update",this.onUpdate,this),t.on("update",this.onUpdate,this),this._geometry=t,this.onUpdate())}get geometry(){return this._geometry}set texture(t){this._texture!==t&&(this.shader&&(this.shader.resources.uTexture=t.source,this.shader.resources.uSampler=t.style),this._texture=t,this.onUpdate())}get texture(){return this._texture}addBounds(t){t.addVertexData(this.geometry.positions,0,this.geometry.positions.length)}containsPoint(t){const{x:e,y:i}=t,r=this.geometry.getBuffer("aPosition").data,n=gc.points,o=this.geometry.getIndex().data,a=o.length,h=this.geometry.topology==="triangle-strip"?3:1;for(let l=0;l+2<a;l+=h){const c=o[l]*2,u=o[l+1]*2,d=o[l+2]*2;if(n[0]=r[c],n[1]=r[c+1],n[2]=r[u],n[3]=r[u+1],n[4]=r[d],n[5]=r[d+1],gc.contains(e,i))return!0}return!1}get batched(){return this._shader?!1:this._geometry.batchMode==="auto"?this._geometry.positions.length/2<=100:this._geometry.batchMode==="batch"}destroy(t=!1){if(typeof t=="boolean"?t:t==null?void 0:t.texture){const i=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(i)}this._texture=null,this._geometry=null,this._shader=null}onGeometryUpdate(){this.onUpdate()}onUpdate(){this.owner.onViewUpdate()}}const of=class extends F{constructor(s){s instanceof z&&(s={texture:s}),s={...of.defaultOptions,...s};const t=s.texture,e=new nf({width:t.width,height:t.height,originalWidth:t.width,originalHeight:t.height,leftWidth:s.leftWidth,topHeight:s.topHeight,rightWidth:s.rightWidth,bottomHeight:s.bottomHeight,textureMatrix:t.textureMatrix.mapCoord});super({view:new zg({geometry:e,texture:t}),label:"NineSlicePlane",...s})}get width(){return this.view.geometry.width}set width(s){this.view.geometry.updatePositions({width:s})}get height(){return this.view.geometry.height}set height(s){this.view.geometry.updatePositions({height:s})}get leftWidth(){return this.view.geometry._leftWidth}set leftWidth(s){this.view.geometry.updateUvs({leftWidth:s})}get topHeight(){return this.view.geometry._topHeight}set topHeight(s){this.view.geometry.updateUvs({topHeight:s})}get rightWidth(){return this.view.geometry._rightWidth}set rightWidth(s){this.view.geometry.updateUvs({rightWidth:s})}get bottomHeight(){return this.view.geometry._bottomHeight}set bottomHeight(s){this.view.geometry.updateUvs({bottomHeight:s})}get texture(){return this.view.texture}set texture(s){s!==this.view.texture&&(this.view.geometry.updateUvs({originalWidth:s.width,originalHeight:s.height,textureMatrix:s.textureMatrix.mapCoord}),this.view.texture=s)}};let Li=of;Li.defaultOptions={texture:z.EMPTY,leftWidth:10,topHeight:10,rightWidth:10,bottomHeight:10};var mh={},Hg={get exports(){return mh},set exports(s){mh=s}};Hg.exports=Ro;mh.default=Ro;function Ro(s,t,e){e=e||2;var i=t&&t.length,r=i?t[0]*e:s.length,n=af(s,0,r,e,!0),o=[];if(!n||n.next===n.prev)return o;var a,h,l,c,u,d,f;if(i&&(n=Kg(s,t,n,e)),s.length>80*e){a=l=s[0],h=c=s[1];for(var p=e;p<r;p+=e)u=s[p],d=s[p+1],u<a&&(a=u),d<h&&(h=d),u>l&&(l=u),d>c&&(c=d);f=Math.max(l-a,c-h),f=f!==0?32767/f:0}return Nr(n,o,e,a,h,f,0),o}function af(s,t,e,i,r){var n,o;if(r===xh(s,t,e,i)>0)for(n=t;n<e;n+=i)o=yc(n,s[n],s[n+1],o);else for(n=e-i;n>=t;n-=i)o=yc(n,s[n],s[n+1],o);return o&&ko(o,o.next)&&($r(o),o=o.next),o}function ui(s,t){if(!s)return s;t||(t=s);var e=s,i;do if(i=!1,!e.steiner&&(ko(e,e.next)||pt(e.prev,e,e.next)===0)){if($r(e),e=t=e.prev,e===e.next)break;i=!0}else e=e.next;while(i||e!==t);return t}function Nr(s,t,e,i,r,n,o){if(s){!o&&n&&ey(s,i,r,n);for(var a=s,h,l;s.prev!==s.next;){if(h=s.prev,l=s.next,n?jg(s,i,r,n):Xg(s)){t.push(h.i/e|0),t.push(s.i/e|0),t.push(l.i/e|0),$r(s),s=l.next,a=l.next;continue}if(s=l,s===a){o?o===1?(s=Yg(ui(s),t,e),Nr(s,t,e,i,r,n,2)):o===2&&qg(s,t,e,i,r,n):Nr(ui(s),t,e,i,r,n,1);break}}}}function Xg(s){var t=s.prev,e=s,i=s.next;if(pt(t,e,i)>=0)return!1;for(var r=t.x,n=e.x,o=i.x,a=t.y,h=e.y,l=i.y,c=r<n?r<o?r:o:n<o?n:o,u=a<h?a<l?a:l:h<l?h:l,d=r>n?r>o?r:o:n>o?n:o,f=a>h?a>l?a:l:h>l?h:l,p=i.next;p!==t;){if(p.x>=c&&p.x<=d&&p.y>=u&&p.y<=f&&Fi(r,a,n,h,o,l,p.x,p.y)&&pt(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function jg(s,t,e,i){var r=s.prev,n=s,o=s.next;if(pt(r,n,o)>=0)return!1;for(var a=r.x,h=n.x,l=o.x,c=r.y,u=n.y,d=o.y,f=a<h?a<l?a:l:h<l?h:l,p=c<u?c<d?c:d:u<d?u:d,m=a>h?a>l?a:l:h>l?h:l,_=c>u?c>d?c:d:u>d?u:d,x=gh(f,p,t,e,i),g=gh(m,_,t,e,i),y=s.prevZ,w=s.nextZ;y&&y.z>=x&&w&&w.z<=g;){if(y.x>=f&&y.x<=m&&y.y>=p&&y.y<=_&&y!==r&&y!==o&&Fi(a,c,h,u,l,d,y.x,y.y)&&pt(y.prev,y,y.next)>=0||(y=y.prevZ,w.x>=f&&w.x<=m&&w.y>=p&&w.y<=_&&w!==r&&w!==o&&Fi(a,c,h,u,l,d,w.x,w.y)&&pt(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;y&&y.z>=x;){if(y.x>=f&&y.x<=m&&y.y>=p&&y.y<=_&&y!==r&&y!==o&&Fi(a,c,h,u,l,d,y.x,y.y)&&pt(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;w&&w.z<=g;){if(w.x>=f&&w.x<=m&&w.y>=p&&w.y<=_&&w!==r&&w!==o&&Fi(a,c,h,u,l,d,w.x,w.y)&&pt(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function Yg(s,t,e){var i=s;do{var r=i.prev,n=i.next.next;!ko(r,n)&&hf(r,i,i.next,n)&&Dr(r,n)&&Dr(n,r)&&(t.push(r.i/e|0),t.push(i.i/e|0),t.push(n.i/e|0),$r(i),$r(i.next),i=s=n),i=i.next}while(i!==s);return ui(i)}function qg(s,t,e,i,r,n){var o=s;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&ry(o,a)){var h=lf(o,a);o=ui(o,o.next),h=ui(h,h.next),Nr(o,t,e,i,r,n,0),Nr(h,t,e,i,r,n,0);return}a=a.next}o=o.next}while(o!==s)}function Kg(s,t,e,i){var r=[],n,o,a,h,l;for(n=0,o=t.length;n<o;n++)a=t[n]*i,h=n<o-1?t[n+1]*i:s.length,l=af(s,a,h,i,!1),l===l.next&&(l.steiner=!0),r.push(iy(l));for(r.sort(Zg),n=0;n<r.length;n++)e=Jg(r[n],e);return e}function Zg(s,t){return s.x-t.x}function Jg(s,t){var e=Qg(s,t);if(!e)return t;var i=lf(e,s);return ui(i,i.next),ui(e,e.next)}function Qg(s,t){var e=t,i=s.x,r=s.y,n=-1/0,o;do{if(r<=e.y&&r>=e.next.y&&e.next.y!==e.y){var a=e.x+(r-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(a<=i&&a>n&&(n=a,o=e.x<e.next.x?e:e.next,a===i))return o}e=e.next}while(e!==t);if(!o)return null;var h=o,l=o.x,c=o.y,u=1/0,d;e=o;do i>=e.x&&e.x>=l&&i!==e.x&&Fi(r<c?i:n,r,l,c,r<c?n:i,r,e.x,e.y)&&(d=Math.abs(r-e.y)/(i-e.x),Dr(e,s)&&(d<u||d===u&&(e.x>o.x||e.x===o.x&&ty(o,e)))&&(o=e,u=d)),e=e.next;while(e!==h);return o}function ty(s,t){return pt(s.prev,s,t.prev)<0&&pt(t.next,s,s.next)<0}function ey(s,t,e,i){var r=s;do r.z===0&&(r.z=gh(r.x,r.y,t,e,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==s);r.prevZ.nextZ=null,r.prevZ=null,sy(r)}function sy(s){var t,e,i,r,n,o,a,h,l=1;do{for(e=s,s=null,n=null,o=0;e;){for(o++,i=e,a=0,t=0;t<l&&(a++,i=i.nextZ,!!i);t++);for(h=l;a>0||h>0&&i;)a!==0&&(h===0||!i||e.z<=i.z)?(r=e,e=e.nextZ,a--):(r=i,i=i.nextZ,h--),n?n.nextZ=r:s=r,r.prevZ=n,n=r;e=i}n.nextZ=null,l*=2}while(o>1);return s}function gh(s,t,e,i,r){return s=(s-e)*r|0,t=(t-i)*r|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,s|t<<1}function iy(s){var t=s,e=s;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==s);return e}function Fi(s,t,e,i,r,n,o,a){return(r-o)*(t-a)>=(s-o)*(n-a)&&(s-o)*(i-a)>=(e-o)*(t-a)&&(e-o)*(n-a)>=(r-o)*(i-a)}function ry(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!ny(s,t)&&(Dr(s,t)&&Dr(t,s)&&oy(s,t)&&(pt(s.prev,s,t.prev)||pt(s,t.prev,t))||ko(s,t)&&pt(s.prev,s,s.next)>0&&pt(t.prev,t,t.next)>0)}function pt(s,t,e){return(t.y-s.y)*(e.x-t.x)-(t.x-s.x)*(e.y-t.y)}function ko(s,t){return s.x===t.x&&s.y===t.y}function hf(s,t,e,i){var r=xn(pt(s,t,e)),n=xn(pt(s,t,i)),o=xn(pt(e,i,s)),a=xn(pt(e,i,t));return!!(r!==n&&o!==a||r===0&&yn(s,e,t)||n===0&&yn(s,i,t)||o===0&&yn(e,s,i)||a===0&&yn(e,t,i))}function yn(s,t,e){return t.x<=Math.max(s.x,e.x)&&t.x>=Math.min(s.x,e.x)&&t.y<=Math.max(s.y,e.y)&&t.y>=Math.min(s.y,e.y)}function xn(s){return s>0?1:s<0?-1:0}function ny(s,t){var e=s;do{if(e.i!==s.i&&e.next.i!==s.i&&e.i!==t.i&&e.next.i!==t.i&&hf(e,e.next,s,t))return!0;e=e.next}while(e!==s);return!1}function Dr(s,t){return pt(s.prev,s,s.next)<0?pt(s,t,s.next)>=0&&pt(s,s.prev,t)>=0:pt(s,t,s.prev)<0||pt(s,s.next,t)<0}function oy(s,t){var e=s,i=!1,r=(s.x+t.x)/2,n=(s.y+t.y)/2;do e.y>n!=e.next.y>n&&e.next.y!==e.y&&r<(e.next.x-e.x)*(n-e.y)/(e.next.y-e.y)+e.x&&(i=!i),e=e.next;while(e!==s);return i}function lf(s,t){var e=new yh(s.i,s.x,s.y),i=new yh(t.i,t.x,t.y),r=s.next,n=t.prev;return s.next=t,t.prev=s,e.next=r,r.prev=e,i.next=e,e.prev=i,n.next=i,i.prev=n,i}function yc(s,t,e,i){var r=new yh(s,t,e);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function $r(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function yh(s,t,e){this.i=s,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Ro.deviation=function(s,t,e,i){var r=t&&t.length,n=r?t[0]*e:s.length,o=Math.abs(xh(s,0,n,e));if(r)for(var a=0,h=t.length;a<h;a++){var l=t[a]*e,c=a<h-1?t[a+1]*e:s.length;o-=Math.abs(xh(s,l,c,e))}var u=0;for(a=0;a<i.length;a+=3){var d=i[a]*e,f=i[a+1]*e,p=i[a+2]*e;u+=Math.abs((s[d]-s[p])*(s[f+1]-s[d+1])-(s[d]-s[f])*(s[p+1]-s[d+1]))}return o===0&&u===0?0:Math.abs((u-o)/o)};function xh(s,t,e,i){for(var r=0,n=t,o=e-i;n<e;n+=i)r+=(s[o]-s[n])*(s[n+1]+s[o+1]),o=n;return r}Ro.flatten=function(s){for(var t=s[0][0].length,e={vertices:[],holes:[],dimensions:t},i=0,r=0;r<s.length;r++){for(var n=0;n<s[r].length;n++)for(var o=0;o<t;o++)e.vertices.push(s[r][n][o]);r>0&&(i+=s[r-1].length,e.holes.push(i))}return e};let ay=0;class hy{constructor(t){this.uid=ay++,this.canBundle=!0,this.owner=an,this.type="graphics",this._context=t||new ci,this._context.on("update",this.onGraphicsContextUpdate,this)}set context(t){t!==this._context&&(this._context.off("update",this.onGraphicsContextUpdate,this),this._context=t,this._context.on("update",this.onGraphicsContextUpdate,this),this.onGraphicsContextUpdate())}get context(){return this._context}addBounds(t){t.addBounds(this._context.bounds)}containsPoint(t){return this._context.containsPoint(t)}onGraphicsContextUpdate(){this.didUpdate=!0,this.owner.onViewUpdate()}destroy(t=!1){this.owner=null,(typeof t=="boolean"?t:t==null?void 0:t.context)&&this._context.destroy(t),this._context=null}}class Ki extends F{constructor(t){t instanceof ci&&(t={context:t}),super({view:new hy(t==null?void 0:t.context),label:"Graphics",...t})}get context(){return this.view.context}set context(t){this.view.context=t}}function ly(s,t=[]){return t[0]=(s>>16&255)/255,t[1]=(s>>8&255)/255,t[2]=(s&255)/255,t}function QA(s){let t=s.toString(16);return t="000000".substring(0,6-t.length)+t,`#${t}`}let cy=class{constructor(t){this.poolKeyHash={},this.canvasPool={},this.canvasOptions=t||{},this.enableFullScreen=!1}createCanvasAndContext(t,e){const i=Vt.ADAPTER.createCanvas();i.width=t,i.height=e;const r=i.getContext("2d");return{canvas:i,context:r}}getOptimalCanvasAndContext(t,e,i=1){t=Math.ceil(t*i-1e-6),e=Math.ceil(e*i-1e-6),t=_c(t),e=_c(e);const r=(t<<17)+(e<<1);this.canvasPool[r]||(this.canvasPool[r]=[]);let n=this.canvasPool[r].pop();return n||(n=this.createCanvasAndContext(t,e)),n}returnCanvasAndContext(t){const{width:e,height:i}=t.canvas,r=(e<<17)+(i<<1);this.canvasPool[r].push(t)}clear(){this.canvasPool={}}};const xc=new cy;var cf=(s=>(s[s.NPM=0]="NPM",s[s.UNPACK=1]="UNPACK",s[s.PMA=2]="PMA",s[s.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",s[s.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",s[s.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",s))(cf||{});const uy=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function bh(s){const t=typeof s.fontSize=="number"?`${s.fontSize}px`:s.fontSize;let e=s.fontFamily;Array.isArray(s.fontFamily)||(e=s.fontFamily.split(","));for(let i=e.length-1;i>=0;i--){let r=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!uy.includes(r)&&(r=`"${r}"`),e[i]=r}return`${s.fontStyle} ${s.fontVariant} ${s.fontWeight} ${t} ${e.join(",")}`}const va={willReadFrequently:!0},k=class{static get experimentalLetterSpacingSupported(){let t=k._experimentalLetterSpacingSupported;if(t!==void 0){const e=Vt.ADAPTER.getCanvasRenderingContext2D().prototype;t=k._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,i,r,n,o,a,h,l){this.text=t,this.style=e,this.width=i,this.height=r,this.lines=n,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=h,this.fontProperties=l}static measureText(t=" ",e,i=k._canvas,r=e.wordWrap){var g;const n=`${t}:${e.styleKey}`;if(k._measurementCache[n])return k._measurementCache[n];const o=bh(e),a=k.measureFont(o);a.fontSize===0&&(a.fontSize=e.fontSize,a.ascent=e.fontSize);const h=k.__context;h.font=o;const c=(r?k.wordWrap(t,e,i):t).split(/(?:\r\n|\r|\n)/),u=new Array(c.length);let d=0;for(let y=0;y<c.length;y++){const w=k._measureText(c[y],e.letterSpacing,h);u[y]=w,d=Math.max(d,w)}const f=((g=e.stroke)==null?void 0:g.width)||0;let p=d+f;e.dropShadow&&(p+=e.dropShadow.distance);const m=e.lineHeight||a.fontSize+f;let _=Math.max(m,a.fontSize+f*2)+(c.length-1)*(m+e.leading);return e.dropShadow&&(_+=e.dropShadow.distance),new k(t,e,p,_,c,u,m+e.leading,d,a)}static _measureText(t,e,i){let r=!1;k.experimentalLetterSpacingSupported&&(k.experimentalLetterSpacing?(i.letterSpacing=`${e}px`,i.textLetterSpacing=`${e}px`,r=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));let n=i.measureText(t).width;return n>0&&(r?n-=e:n+=(k.graphemeSegmenter(t).length-1)*e),n}static wordWrap(t,e,i=k._canvas){const r=i.getContext("2d",va);let n=0,o="",a="";const h=Object.create(null),{letterSpacing:l,whiteSpace:c}=e,u=k.collapseSpaces(c),d=k.collapseNewlines(c);let f=!u;const p=e.wordWrapWidth+l,m=k.tokenize(t);for(let _=0;_<m.length;_++){let x=m[_];if(k.isNewline(x)){if(!d){a+=k.addLine(o),f=!u,o="",n=0;continue}x=" "}if(u){const y=k.isBreakingSpace(x),w=k.isBreakingSpace(o[o.length-1]);if(y&&w)continue}const g=k.getFromCache(x,l,h,r);if(g>p)if(o!==""&&(a+=k.addLine(o),o="",n=0),k.canBreakWords(x,e.breakWords)){const y=k.wordWrapSplit(x);for(let w=0;w<y.length;w++){let v=y[w],S=v,C=1;for(;y[w+C];){const A=y[w+C];if(!k.canBreakChars(S,A,x,w,e.breakWords))v+=A;else break;S=A,C++}w+=C-1;const T=k.getFromCache(v,l,h,r);T+n>p&&(a+=k.addLine(o),f=!1,o="",n=0),o+=v,n+=T}}else{o.length>0&&(a+=k.addLine(o),o="",n=0);const y=_===m.length-1;a+=k.addLine(x,!y),f=!1,o="",n=0}else g+n>p&&(f=!1,a+=k.addLine(o),o="",n=0),(o.length>0||!k.isBreakingSpace(x)||f)&&(o+=x,n+=g)}return a+=k.addLine(o,!1),a}static addLine(t,e=!0){return t=k.trimRight(t),t=e?`${t}
`:t,t}static getFromCache(t,e,i,r){let n=i[t];return typeof n!="number"&&(n=k._measureText(t,e,r)+e,i[t]=n),n}static collapseSpaces(t){return t==="normal"||t==="pre-line"}static collapseNewlines(t){return t==="normal"}static trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const i=t[e];if(!k.isBreakingSpace(i))break;t=t.slice(0,-1)}return t}static isNewline(t){return typeof t!="string"?!1:k._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:k._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){const e=[];let i="";if(typeof t!="string")return e;for(let r=0;r<t.length;r++){const n=t[r],o=t[r+1];if(k.isBreakingSpace(n,o)||k.isNewline(n)){i!==""&&(e.push(i),i=""),e.push(n);continue}i+=n}return i!==""&&e.push(i),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,i,r,n){return!0}static wordWrapSplit(t){return k.graphemeSegmenter(t)}static measureFont(t){if(k._fonts[t])return k._fonts[t];const e=k._context;e.font=t;const i=e.measureText(k.METRICS_STRING+k.BASELINE_SYMBOL),r={ascent:i.actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent,fontSize:i.actualBoundingBoxAscent+i.actualBoundingBoxDescent};return k._fonts[t]=r,r}static clearMetrics(t=""){t?delete k._fonts[t]:k._fonts={}}static get _canvas(){if(!k.__canvas){let t;try{const e=new OffscreenCanvas(0,0),i=e.getContext("2d",va);if(i!=null&&i.measureText)return k.__canvas=e,e;t=Vt.ADAPTER.createCanvas()}catch{t=Vt.ADAPTER.createCanvas()}t.width=t.height=10,k.__canvas=t}return k.__canvas}static get _context(){return k.__context||(k.__context=k._canvas.getContext("2d",va)),k.__context}};let ce=k;ce.METRICS_STRING="|q";ce.BASELINE_SYMBOL="M";ce.BASELINE_MULTIPLIER=1.4;ce.HEIGHT_MULTIPLIER=2;ce.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const s=new Intl.Segmenter;return t=>[...s.segment(t)].map(e=>e.segment)}return s=>[...s]})();ce.experimentalLetterSpacing=!1;ce._fonts={};ce._newlines=[10,13];ce._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];ce._measurementCache={};function bc(s,t){if(s.texture===z.WHITE&&!s.fill)return lh(s.color);if(s.fill){if(s.fill instanceof _l){const e=s.fill,i=t.createPattern(e.texture.source.resource,"repeat"),r=e.transform.copyTo(tt.shared);return r.scale(e.texture.frameWidth,e.texture.frameHeight),i.setTransform(r),i}else if(s.fill instanceof Or){const e=s.fill;if(e.type==="linear"){const i=t.createLinearGradient(e.x0,e.y0,e.x1,e.y1);return e.gradientStops.forEach(r=>{i.addColorStop(r.offset,lh(r.color))}),i}}}else{const e=t.createPattern(s.texture.source.resource,"repeat"),i=s.matrix.copyTo(tt.shared);return i.scale(s.texture.frameWidth,s.texture.frameHeight),e.setTransform(i),e}return console.warn("[PixiJS] FillStyle not recognised",s),"red"}const wc=["fontFamily","fontStyle","fontVariant","fontWeight","breakWords","align","leading","letterSpacing","lineHeight","textBaseline","whiteSpace","wordWrap","wordWrapWidth","padding"],Ei=class extends Zt{constructor(t={}){super();const e={...Ei.defaultTextStyle,...t};for(const i in Ei.defaultTextStyle){const r=i;this[r]=e[i]}this.dropShadow=null,typeof e.fill=="string"?this.fontSize=parseInt(e.fontSize,10):this.fontSize=e.fontSize,t.dropShadow&&(t.dropShadow instanceof Boolean?t.dropShadow===!0&&(this.dropShadow={...Ei.defaultTextStyle.dropShadow}):this.dropShadow={...Ei.defaultTextStyle.dropShadow,...t.dropShadow}),this.update()}generateKey(){const t=[];let e=0;for(let i=0;i<wc.length;i++){const r=wc[i];t[e++]=this[r]}return e=uf(this._fill,t,e),e=dy(this._stroke,t,e),this._styleKey=t.join("-"),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}get fill(){return this._originalFill}set fill(t){t!==this._fill&&(this._originalFill=t,this._fill=so(t,ci.defaultFillStyle))}get stroke(){return this._originalStroke}set stroke(t){t!==this._fill&&(this._originalFill=t,this._stroke=so(t,ci.defaultStrokeStyle))}get styleKey(){return this._styleKey||this.generateKey()}clone(){return new Ei({align:this.align,breakWords:this.breakWords,dropShadow:this.dropShadow,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(t=!1){var i,r,n,o;if(this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const a=typeof t=="boolean"?t:t==null?void 0:t.textureSource;(i=this._fill)!=null&&i.texture&&this._fill.texture.destroy(a),(r=this._originalFill)!=null&&r.texture&&this._originalFill.texture.destroy(a),(n=this._stroke)!=null&&n.texture&&this._stroke.texture.destroy(a),(o=this._originalStroke)!=null&&o.texture&&this._originalStroke.texture.destroy(a)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}};let ti=Ei;ti.defaultTextStyle={align:"left",breakWords:!1,dropShadow:{alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5},fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function uf(s,t,e){var i;return s&&(t[e++]=s.color,t[e++]=s.alpha,t[e++]=(i=s.fill)==null?void 0:i.uid),e}function dy(s,t,e){return s&&(e=uf(s,t,e),t[e++]=s.width,t[e++]=s.alignment,t[e++]=s.cap,t[e++]=s.join,t[e++]=s.miterLimit),e}function fy(s){typeof s=="string"&&(s=[s]);const t=[];for(let e=0,i=s.length;e<i;e++){const r=s[e];if(Array.isArray(r)){if(r.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);const n=r[0].charCodeAt(0),o=r[1].charCodeAt(0);if(o<n)throw new Error("[BitmapFont]: Invalid character range.");for(let a=n,h=o;a<=h;a++)t.push(String.fromCharCode(a))}else t.push(...Array.from(r))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}let py=class extends Zt{constructor(t){super(),this.baseRenderedFontSize=100,this.baseMeasurementFontSize=100,this.padding=4,this.baseLineOffset=0,this.pages=[],this.chars={},this.lineHeight=0,this.measureCache={},this.currentChars=[],this.dynamic=!0,this.currentX=0,this.currentY=0,this.currentPageIndex=-1,this.resolution=1,this.distanceField={fieldType:"none",distanceRange:0},this.pages=[];const e=t;this.dynamic=!0;let i;e.style instanceof ti?i=e.style.clone():i=new ti(e.style),i.fontSize=this.baseMeasurementFontSize,e.overrideFill&&(i._fill.color=16777215,i._fill.alpha=1,i._fill.texture=z.WHITE,i._fill.fill=null),this.style=i;const r=bh(i);this.fontMetrics=ce.measureFont(r),this.lineHeight=i.lineHeight||this.fontMetrics.fontSize||i.fontSize}ensureCharacters(t){var m,_;const e=fy(t).filter(x=>!this.currentChars.includes(x)).filter((x,g,y)=>y.indexOf(x)===g);if(!e.length)return;this.currentChars=[...this.currentChars,...e];let i;this.currentPageIndex===-1?i=this.nextPage():i=this.pages[this.currentPageIndex];let{canvas:r,context:n}=i.canvasAndContext,o=i.texture.source;const a=this.style;let h=this.currentX,l=this.currentY;const c=this.baseRenderedFontSize/this.baseMeasurementFontSize,u=this.padding*c,d=a.fontStyle==="italic"?2:1;let f=0,p=!1;for(let x=0;x<e.length;x++){const g=e[x],y=ce.measureText(g,a,r,!1),w=d*y.width*c,v=y.height*c,S=w+u*2,C=v+u*2;if(p=!1,g!==`
`&&g!=="\r"&&g!=="	"&&g!==" "&&(p=!0,f=Math.ceil(Math.max(C,f))),h+S>512&&(l+=f,f=C,h=0,l+f>512)){o.update();const A=this.nextPage();r=A.canvasAndContext.canvas,n=A.canvasAndContext.context,o=A.texture.source,l=0}const T=w/c-(((m=a.dropShadow)==null?void 0:m.distance)??0)-(((_=a._stroke)==null?void 0:_.width)??0);if(this.chars[g]={id:g.codePointAt(0),xOffset:-this.padding,yOffset:-this.padding,xAdvance:T,kerning:{}},p){this.drawGlyph(n,y,h+u,l+u,c,a);const A=o.width*c,P=o.height*c,I=new Ge(h/A,l/P,S/A,C/P);this.chars[g].texture=new z({source:o,layout:{frame:I}}),h+=Math.ceil(S)}}o.update(),this.currentX=h,this.currentY=l,this.applyKerning(e,n)}applyKerning(t,e){const i=this.measureCache;for(let r=0;r<t.length;r++){const n=t[r];for(let o=0;o<this.currentChars.length;o++){const a=this.currentChars[o];let h=i[n];h||(h=i[n]=e.measureText(n).width);let l=i[a];l||(l=i[a]=e.measureText(a).width);let c=e.measureText(n+a).width,u=c-(h+l);u&&(this.chars[n].kerning[a]=u),c=e.measureText(n+a).width,u=c-(h+l),u&&(this.chars[a].kerning[n]=u)}}}nextPage(){this.currentPageIndex++;const t=this.resolution,e=xc.getOptimalCanvasAndContext(512,512,t);this.setupContext(e.context,this.style,t);const i=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),r=new z({source:new Mo({resource:e.canvas,resolution:i,alphaMode:cf.PMA})}),n={canvasAndContext:e,texture:r};return this.pages[this.currentPageIndex]=n,n}setupContext(t,e,i){e.fontSize=this.baseRenderedFontSize,t.scale(i,i),t.font=bh(e),e.fontSize=this.baseMeasurementFontSize,t.textBaseline=e.textBaseline;const r=e._stroke,n=(r==null?void 0:r.width)??0;if(r&&(t.lineWidth=n,t.lineJoin=r.join,t.miterLimit=r.miterLimit,t.strokeStyle=bc(r,t)),e._fill&&(t.fillStyle=bc(e._fill,t)),e.dropShadow){const o=e.dropShadow,a=ns(o.color),h=ly(a),l=o.blur*i,c=o.distance*i;t.shadowColor=`rgba(${h[0]*255},${h[1]*255},${h[2]*255},${o.alpha})`,t.shadowBlur=l,t.shadowOffsetX=Math.cos(o.angle)*c,t.shadowOffsetY=Math.sin(o.angle)*c}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}drawGlyph(t,e,i,r,n,o){const a=e.text,h=e.fontProperties,l=o._stroke,c=((l==null?void 0:l.width)??0)*n,u=i+c/2,d=r-c/2,f=h.descent*n,p=e.lineHeight*n;o.stroke&&c&&t.strokeText(a,u,d+p-f),o._fill&&t.fillText(a,u,d+p-f)}destroy(){this.emit("destroy",this),this.removeAllListeners();for(const t in this.chars)this.chars[t].texture.destroy();this.chars=null;for(let t=0;t<this.pages.length;t++){const{canvasAndContext:e,texture:i}=this.pages[t];xc.returnCanvasAndContext(e),i.destroy(!0)}this.pages=null}};function _y(s,t,e){const i={width:0,height:0,offsetY:0,scale:t.fontSize/e.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};i.offsetY=e.baseLineOffset;let r=i.lines[0],n=null,o=!0;const a={spaceWord:!1,width:0,start:0,index:0,positions:[],chars:[]},h=f=>{const p=r.width;for(let m=0;m<a.index;m++){const _=f.positions[m];r.chars.push(f.chars[m]),r.charPositions.push(_+p)}r.width+=f.width,o=!1,a.width=0,a.index=0,a.chars.length=0},l=()=>{let f=r.chars.length-1,p=r.chars[f];for(;p===" ";)r.width-=e.chars[p].xAdvance,p=r.chars[--f];i.width=Math.max(i.width,r.width),r={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},o=!0,i.lines.push(r),i.height+=e.lineHeight},c=e.baseMeasurementFontSize/t.fontSize,u=t.letterSpacing*c,d=t.wordWrapWidth*c;for(let f=0;f<s.length+1;f++){let p;const m=f===s.length;m||(p=s[f]);const _=e.chars[p];if(/(?:\s)/.test(p)||p==="\r"||p===`
`||m){if(!o&&t.wordWrap&&r.width+a.width-u>d?(l(),h(a),m||r.charPositions.push(0)):(a.start=r.width,h(a),m||r.charPositions.push(0)),p==="\r"||p===`
`)r.width!==0&&l();else if(!m){const w=_.xAdvance+(_.kerning[n]||0)+u;r.width+=w,r.spaceWidth=w,r.spacesIndex.push(r.charPositions.length),r.chars.push(p)}}else{const y=_.kerning[n]||0,w=_.xAdvance+y+u;a.positions[a.index++]=a.width+y,a.chars.push(p),a.width+=w}n=p}return l(),t.align==="center"?my(i):t.align==="right"?gy(i):t.align==="justify"&&yy(i),i}function my(s){for(let t=0;t<s.lines.length;t++){const e=s.lines[t],i=s.width/2-e.width/2;for(let r=0;r<e.charPositions.length;r++)e.charPositions[r]+=i}}function gy(s){for(let t=0;t<s.lines.length;t++){const e=s.lines[t],i=s.width-e.width;for(let r=0;r<e.charPositions.length;r++)e.charPositions[r]+=i}}function yy(s){const t=s.width;for(let e=0;e<s.lines.length;e++){const i=s.lines[e];let r=0,n=i.spacesIndex[r++],o=0;const a=i.spacesIndex.length,l=(t-i.width)/a;for(let c=0;c<i.charPositions.length;c++)c===n&&(n=i.spacesIndex[r++],o+=l),i.charPositions[c]+=o}}let xy=class{getFont(t,e){var o;let i=e.fontFamily,r=!0;e._fill.fill&&(i+=e._fill.fill.uid,r=!1),Fe.has(i)||Fe.set(i,new py({style:e,overrideFill:r}));const n=Fe.get(i);return(o=n.ensureCharacters)==null||o.call(n,t),n}getLayout(t,e){const i=this.getFont(t,e);return _y(t.split(""),e,i)}measureText(t,e){return this.getLayout(t,e)}};const by=new xy;let wy=0;const vy={canvas:"text",html:"text",bitmap:"bitmapText"},Vn=class{constructor(t){this.uid=wy++,this.batched=!0,this.type="text",this.owner=an,this._bounds=[0,1,0,0],this.boundsDirty=!0,this._autoResolution=Vn.defaultAutoResolution,this._resolution=Vn.defaultResolution,this.didUpdate=!0,this.text=t.text??"",this._style=t.style instanceof ti?t.style:new ti(t.style);const e=t.renderMode??this.detectRenderType(this._style);this.type=vy[e],this.anchor=new Xt(this,0,0),this._resolution=t.resolution??Vn.defaultResolution}set text(t){t=t.toString(),this._text!==t&&(this._text=t,this.onUpdate())}get text(){return this._text}get style(){return this._style}set style(t){var e;t=t||{},(e=this._style)==null||e.off("update",this.onUpdate,this),t instanceof ti?this._style=t:this._style=new ti(t),this._style.on("update",this.onUpdate,this),this.onUpdate()}set resolution(t){this._resolution=t}get resolution(){return this._resolution}get bounds(){return this.boundsDirty&&(this.updateBounds(),this.boundsDirty=!1),this._bounds}updateBounds(){const t=this._bounds;if(this.type==="bitmapText"){const e=by.measureText(this.text,this._style),i=e.scale,r=e.offsetY*i;t[0]=0,t[1]=r,t[2]=e.width*i,t[3]=e.height*i+r}else{const e=ce.measureText(this.text,this._style);t[0]=0,t[1]=0,t[2]=e.width,t[3]=e.height}}addBounds(t){const e=this.bounds;t.addFrame(e[0],e[1],e[2],e[3])}onUpdate(){this.didUpdate=!0,this.boundsDirty=!0,this.owner.onViewUpdate()}_getKey(){return`${this.text}:${this._style.styleKey}`}containsPoint(t){const e=this.bounds[2],i=this.bounds[3],r=-e*this.anchor.x;let n=0;return t.x>=r&&t.x<r+e&&(n=-i*this.anchor.y,t.y>=n&&t.y<n+i)}detectRenderType(t){return Fe.has(t.fontFamily)?"bitmap":"canvas"}destroy(t=!1){this.owner=null,this._bounds=null,this.anchor=null,this._style.destroy(t),this._style=null,this._text=null}};let gl=Vn;gl.defaultResolution=1;gl.defaultAutoResolution=!0;let Ct=class extends F{constructor(t){super({view:new gl(t),label:"Text",...t})}get anchor(){return this.view.anchor}set text(t){this.view.text=t}get text(){return this.view.text}set style(t){this.view.style=t}get style(){return this.view.style}},Ty=class{constructor({matrix:t,observer:e}={}){this.dirty=!0,this._matrix=t??new tt,this.observer=e,this.position=new Xt(this,0,0),this.scale=new Xt(this,1,1),this.pivot=new Xt(this,0,0),this.skew=new Xt(this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1}get matrix(){const t=this._matrix;return this.dirty&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this.dirty=!1),t}onUpdate(t){var e;this.dirty=!0,t===this.skew&&this.updateSkew(),(e=this.observer)==null||e.onUpdate(this)}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this.dirty=!0}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}setFromMatrix(t){t.decompose(this),this.dirty=!0}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}},Cy=0;const df=class{constructor(s){this.batched=!0,this.owner=an,this.uid=Cy++,this.type="tilingSprite",this.onRenderableUpdate=to,this._bounds=[0,1,0,0],this.boundsDirty=!0,s={...df.defaultOptions,...s},this.anchor=new Xt(this,0,0),this.applyAnchorToTexture=s.applyAnchorToTexture,this.texture=s.texture,this._width=s.width,this._height=s.height,this.tileTransform=new Ty({observer:this})}get bounds(){return this.boundsDirty&&(this.updateBounds(),this.boundsDirty=!1),this._bounds}updateBounds(){const s=this._bounds,t=this.anchor,e=this._width,i=this._height;s[1]=-t._x*e,s[0]=s[1]+e,s[3]=-t._y*i,s[2]=s[3]+i}addBounds(s){const t=this.bounds;s.addFrame(t[0],t[1],t[2],t[3])}set texture(s){this._texture!==s&&(this._texture=s,this.onUpdate())}get texture(){return this._texture}set width(s){this._width=s,this.onUpdate()}get width(){return this._width}set height(s){this._height=s,this.onUpdate()}get height(){return this._height}onUpdate(){this.boundsDirty=!0,this.didUpdate=!0,this.owner.onViewUpdate()}containsPoint(s){const t=this.bounds[2],e=this.bounds[3],i=-t*this.anchor.x;let r=0;return s.x>=i&&s.x<i+t&&(r=-e*this.anchor.y,s.y>=r&&s.y<r+e)}destroy(s=!1){if(this.onRenderableUpdate=to,this.anchor=null,this.tileTransform=null,this._bounds=null,typeof s=="boolean"?s:s==null?void 0:s.texture){const e=typeof s=="boolean"?s:s==null?void 0:s.textureSource;this._texture.destroy(e)}this._texture=null}};let ff=df;ff.defaultOptions={texture:z.WHITE,width:256,height:256,applyAnchorToTexture:!1};class hn extends F{constructor(t){super({view:new ff(t),label:"TilingSprite",...t})}set texture(t){this.view.texture=t}get texture(){return this.view.texture}get anchor(){return this.view.anchor}get width(){return this.view.width}set width(t){this.view.width=t}get height(){return this.view.height}set height(t){this.view.height=t}get tilePosition(){return this.view.tileTransform.position}set tilePosition(t){this.view.tileTransform.position.copyFrom(t)}get tileScale(){return this.view.tileTransform.scale}set tileScale(t){this.view.tileTransform.scale.copyFrom(t)}set tileRotation(t){this.view.tileTransform.rotation=t}get tileRotation(){return this.view.tileTransform.rotation}get tileTransform(){return this.view.tileTransform}}const Sy=[{name:"default",assets:[{name:"audio/bubble-land-sfx.wav",srcs:["./audio/bubble-land-sfx.mp3","./audio/bubble-land-sfx.ogg"]},{name:"audio/bubbles-falling.wav",srcs:["./audio/bubbles-falling.mp3","./audio/bubbles-falling.ogg"]},{name:"audio/bubbo-bubbo-bg-music.wav",srcs:["./audio/bubbo-bubbo-bg-music.mp3","./audio/bubbo-bubbo-bg-music.ogg"]},{name:"audio/cannon-move.wav",srcs:["./audio/cannon-move.mp3","./audio/cannon-move.ogg"]},{name:"audio/powerup-bomb.wav",srcs:["./audio/powerup-bomb.mp3","./audio/powerup-bomb.ogg"]},{name:"audio/powerup-super.wav",srcs:["./audio/powerup-super.mp3","./audio/powerup-super.ogg"]},{name:"audio/powerup-time.wav",srcs:["./audio/powerup-time.mp3","./audio/powerup-time.ogg"]},{name:"audio/primary-button-press.wav",srcs:["./audio/primary-button-press.mp3","./audio/primary-button-press.ogg"]},{name:"audio/secondary-button-press.wav",srcs:["./audio/secondary-button-press.mp3","./audio/secondary-button-press.ogg"]},{name:"fonts/Bungee-Regular.ttf",srcs:["./fonts/Bungee-Regular.woff2"]},{name:"fonts/OpenSans-SemiBold.ttf",srcs:["./fonts/OpenSans-SemiBold.woff2"]},{name:"images/favicon.png",srcs:["images/favicon.png"]}]},{name:"images/game-screen",assets:[{name:"images/game-screen/game-screen.json",srcs:["images/game-screen/game-screen@1x.json","images/game-screen/game-screen@0.5x.json"],data:{tags:{m:!0,tps:!0}}}]},{name:"images/pause-overlay",assets:[{name:"images/pause-overlay/pause-panel.png",srcs:["images/pause-overlay/pause-panel.png"],data:{tags:{m:!0}}}]},{name:"images/preload",assets:[{name:"images/preload/preload.json",srcs:["images/preload/preload@1x.json","images/preload/preload@0.5x.json"],data:{tags:{m:!0,tps:!0}}}]},{name:"images/results-screen",assets:[{name:"images/results-screen/results-screen.json",srcs:["images/results-screen/results-screen@1x.json","images/results-screen/results-screen@0.5x.json"],data:{tags:{m:!0,tps:!0}}}]},{name:"images/title-screen",assets:[{name:"images/title-screen/title-screen.json",srcs:["images/title-screen/title-screen@1x.json","images/title-screen/title-screen@0.5x.json"],data:{tags:{m:!0,tps:!0}}}]}],wh={bundles:Sy},Ay={extension:Xe.ResolveParser,test:s=>Vt.RETINA_PREFIX.test(s)&&s.endsWith(".json"),parse:Xm.parse};Eo.add(Ay);async function Py(){await je.init({manifest:wh}),await je.loadBundle(["images/preload","default"]);const s=wh.bundles.map(t=>t.name);je.backgroundLoadBundle(s)}function Ey(s){const t=wh.bundles.find(e=>e.name===s);if(!t)return!1;for(const e of t.assets)if(!je.cache.has(e.name))return!1;return!0}function My(s){for(const t of s)if(!Ey(t))return!1;return!0}var mi=(s=>(s[s.WEBGL_LEGACY=0]="WEBGL_LEGACY",s[s.WEBGL=1]="WEBGL",s[s.WEBGL2=2]="WEBGL2",s))(mi||{}),vh=(s=>(s[s.COLOR=16384]="COLOR",s[s.DEPTH=256]="DEPTH",s[s.STENCIL=1024]="STENCIL",s))(vh||{}),N=(s=>(s[s.NORMAL=0]="NORMAL",s[s.ADD=1]="ADD",s[s.MULTIPLY=2]="MULTIPLY",s[s.SCREEN=3]="SCREEN",s[s.OVERLAY=4]="OVERLAY",s[s.DARKEN=5]="DARKEN",s[s.LIGHTEN=6]="LIGHTEN",s[s.COLOR_DODGE=7]="COLOR_DODGE",s[s.COLOR_BURN=8]="COLOR_BURN",s[s.HARD_LIGHT=9]="HARD_LIGHT",s[s.SOFT_LIGHT=10]="SOFT_LIGHT",s[s.DIFFERENCE=11]="DIFFERENCE",s[s.EXCLUSION=12]="EXCLUSION",s[s.HUE=13]="HUE",s[s.SATURATION=14]="SATURATION",s[s.COLOR=15]="COLOR",s[s.LUMINOSITY=16]="LUMINOSITY",s[s.NORMAL_NPM=17]="NORMAL_NPM",s[s.ADD_NPM=18]="ADD_NPM",s[s.SCREEN_NPM=19]="SCREEN_NPM",s[s.NONE=20]="NONE",s[s.SRC_OVER=0]="SRC_OVER",s[s.SRC_IN=21]="SRC_IN",s[s.SRC_OUT=22]="SRC_OUT",s[s.SRC_ATOP=23]="SRC_ATOP",s[s.DST_OVER=24]="DST_OVER",s[s.DST_IN=25]="DST_IN",s[s.DST_OUT=26]="DST_OUT",s[s.DST_ATOP=27]="DST_ATOP",s[s.ERASE=26]="ERASE",s[s.SUBTRACT=28]="SUBTRACT",s[s.XOR=29]="XOR",s))(N||{}),no=(s=>(s[s.POINTS=0]="POINTS",s[s.LINES=1]="LINES",s[s.LINE_LOOP=2]="LINE_LOOP",s[s.LINE_STRIP=3]="LINE_STRIP",s[s.TRIANGLES=4]="TRIANGLES",s[s.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",s[s.TRIANGLE_FAN=6]="TRIANGLE_FAN",s))(no||{}),E=(s=>(s[s.RGBA=6408]="RGBA",s[s.RGB=6407]="RGB",s[s.RG=33319]="RG",s[s.RED=6403]="RED",s[s.RGBA_INTEGER=36249]="RGBA_INTEGER",s[s.RGB_INTEGER=36248]="RGB_INTEGER",s[s.RG_INTEGER=33320]="RG_INTEGER",s[s.RED_INTEGER=36244]="RED_INTEGER",s[s.ALPHA=6406]="ALPHA",s[s.LUMINANCE=6409]="LUMINANCE",s[s.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",s[s.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",s[s.DEPTH_STENCIL=34041]="DEPTH_STENCIL",s))(E||{}),$i=(s=>(s[s.TEXTURE_2D=3553]="TEXTURE_2D",s[s.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",s[s.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",s[s.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",s[s.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",s[s.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",s[s.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",s[s.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",s[s.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",s))($i||{}),K=(s=>(s[s.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",s[s.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",s[s.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",s[s.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",s[s.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",s[s.UNSIGNED_INT=5125]="UNSIGNED_INT",s[s.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",s[s.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",s[s.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",s[s.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",s[s.BYTE=5120]="BYTE",s[s.SHORT=5122]="SHORT",s[s.INT=5124]="INT",s[s.FLOAT=5126]="FLOAT",s[s.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",s[s.HALF_FLOAT=36193]="HALF_FLOAT",s))(K||{}),Th=(s=>(s[s.FLOAT=0]="FLOAT",s[s.INT=1]="INT",s[s.UINT=2]="UINT",s))(Th||{}),os=(s=>(s[s.NEAREST=0]="NEAREST",s[s.LINEAR=1]="LINEAR",s))(os||{}),yl=(s=>(s[s.CLAMP=33071]="CLAMP",s[s.REPEAT=10497]="REPEAT",s[s.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",s))(yl||{}),di=(s=>(s[s.OFF=0]="OFF",s[s.POW2=1]="POW2",s[s.ON=2]="ON",s[s.ON_MANUAL=3]="ON_MANUAL",s))(di||{}),Is=(s=>(s[s.NPM=0]="NPM",s[s.UNPACK=1]="UNPACK",s[s.PMA=2]="PMA",s[s.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",s[s.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",s[s.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",s))(Is||{}),Ws=(s=>(s[s.NO=0]="NO",s[s.YES=1]="YES",s[s.AUTO=2]="AUTO",s[s.BLEND=0]="BLEND",s[s.CLEAR=1]="CLEAR",s[s.BLIT=2]="BLIT",s))(Ws||{}),xl=(s=>(s[s.AUTO=0]="AUTO",s[s.MANUAL=1]="MANUAL",s))(xl||{}),xe=(s=>(s.LOW="lowp",s.MEDIUM="mediump",s.HIGH="highp",s))(xe||{}),Pt=(s=>(s[s.NONE=0]="NONE",s[s.SCISSOR=1]="SCISSOR",s[s.STENCIL=2]="STENCIL",s[s.SPRITE=3]="SPRITE",s[s.COLOR=4]="COLOR",s))(Pt||{}),bt=(s=>(s[s.NONE=0]="NONE",s[s.LOW=2]="LOW",s[s.MEDIUM=4]="MEDIUM",s[s.HIGH=8]="HIGH",s))(bt||{}),Ye=(s=>(s[s.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",s[s.ARRAY_BUFFER=34962]="ARRAY_BUFFER",s[s.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",s))(Ye||{});const Iy={createCanvas:(s,t)=>{const e=document.createElement("canvas");return e.width=s,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(s,t)=>fetch(s,t),parseXML:s=>new DOMParser().parseFromString(s,"text/xml")},V={ADAPTER:Iy,RESOLUTION:1,RENDER_OPTIONS:{view:null,width:800,height:600,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,clearBeforeRender:!0,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,hello:!1},CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Ta=/iPhone/i,vc=/iPod/i,Tc=/iPad/i,Cc=/\biOS-universal(?:.+)Mac\b/i,Ca=/\bAndroid(?:.+)Mobile\b/i,Sc=/Android/i,wi=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,bn=/Silk/i,es=/Windows Phone/i,Ac=/\bWindows(?:.+)ARM\b/i,Pc=/BlackBerry/i,Ec=/BB10/i,Mc=/Opera Mini/i,Ic=/\b(CriOS|Chrome)(?:.+)Mobile/i,Rc=/Mobile(?:.+)Firefox\b/i,kc=function(s){return typeof s<"u"&&s.platform==="MacIntel"&&typeof s.maxTouchPoints=="number"&&s.maxTouchPoints>1&&typeof MSStream>"u"};function Ry(s){return function(t){return t.test(s)}}function ky(s){var t={userAgent:"",platform:"",maxTouchPoints:0};!s&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof s=="string"?t.userAgent=s:s&&s.userAgent&&(t={userAgent:s.userAgent,platform:s.platform,maxTouchPoints:s.maxTouchPoints||0});var e=t.userAgent,i=e.split("[FBAN");typeof i[1]<"u"&&(e=i[0]),i=e.split("Twitter"),typeof i[1]<"u"&&(e=i[0]);var r=Ry(e),n={apple:{phone:r(Ta)&&!r(es),ipod:r(vc),tablet:!r(Ta)&&(r(Tc)||kc(t))&&!r(es),universal:r(Cc),device:(r(Ta)||r(vc)||r(Tc)||r(Cc)||kc(t))&&!r(es)},amazon:{phone:r(wi),tablet:!r(wi)&&r(bn),device:r(wi)||r(bn)},android:{phone:!r(es)&&r(wi)||!r(es)&&r(Ca),tablet:!r(es)&&!r(wi)&&!r(Ca)&&(r(bn)||r(Sc)),device:!r(es)&&(r(wi)||r(bn)||r(Ca)||r(Sc))||r(/\bokhttp\b/i)},windows:{phone:r(es),tablet:r(Ac),device:r(es)||r(Ac)},other:{blackberry:r(Pc),blackberry10:r(Ec),opera:r(Mc),firefox:r(Rc),chrome:r(Ic),device:r(Pc)||r(Ec)||r(Mc)||r(Rc)||r(Ic)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}const Oi=ky(globalThis.navigator);V.RETINA_PREFIX=/@([0-9\.]+)x/;V.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Ze={},By={get exports(){return Ze},set exports(s){Ze=s}};(function(s){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function r(h,l,c){this.fn=h,this.context=l,this.once=c||!1}function n(h,l,c,u,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new r(c,u||h,d),p=e?e+l:l;return h._events[p]?h._events[p].fn?h._events[p]=[h._events[p],f]:h._events[p].push(f):(h._events[p]=f,h._eventsCount++),h}function o(h,l){--h._eventsCount===0?h._events=new i:delete h._events[l]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],c,u;if(this._eventsCount===0)return l;for(u in c=this._events)t.call(c,u)&&l.push(e?u.slice(1):u);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},a.prototype.listeners=function(l){var c=e?e+l:l,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,f=u.length,p=new Array(f);d<f;d++)p[d]=u[d].fn;return p},a.prototype.listenerCount=function(l){var c=e?e+l:l,u=this._events[c];return u?u.fn?1:u.length:0},a.prototype.emit=function(l,c,u,d,f,p){var m=e?e+l:l;if(!this._events[m])return!1;var _=this._events[m],x=arguments.length,g,y;if(_.fn){switch(_.once&&this.removeListener(l,_.fn,void 0,!0),x){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,c),!0;case 3:return _.fn.call(_.context,c,u),!0;case 4:return _.fn.call(_.context,c,u,d),!0;case 5:return _.fn.call(_.context,c,u,d,f),!0;case 6:return _.fn.call(_.context,c,u,d,f,p),!0}for(y=1,g=new Array(x-1);y<x;y++)g[y-1]=arguments[y];_.fn.apply(_.context,g)}else{var w=_.length,v;for(y=0;y<w;y++)switch(_[y].once&&this.removeListener(l,_[y].fn,void 0,!0),x){case 1:_[y].fn.call(_[y].context);break;case 2:_[y].fn.call(_[y].context,c);break;case 3:_[y].fn.call(_[y].context,c,u);break;case 4:_[y].fn.call(_[y].context,c,u,d);break;default:if(!g)for(v=1,g=new Array(x-1);v<x;v++)g[v-1]=arguments[v];_[y].fn.apply(_[y].context,g)}}return!0},a.prototype.on=function(l,c,u){return n(this,l,c,u,!1)},a.prototype.once=function(l,c,u){return n(this,l,c,u,!0)},a.prototype.removeListener=function(l,c,u,d){var f=e?e+l:l;if(!this._events[f])return this;if(!c)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===c&&(!d||p.once)&&(!u||p.context===u)&&o(this,f);else{for(var m=0,_=[],x=p.length;m<x;m++)(p[m].fn!==c||d&&!p[m].once||u&&p[m].context!==u)&&_.push(p[m]);_.length?this._events[f]=_.length===1?_[0]:_:o(this,f)}return this},a.prototype.removeAllListeners=function(l){var c;return l?(c=e?e+l:l,this._events[c]&&o(this,c)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,s.exports=a})(By);var oo={},Ly={get exports(){return oo},set exports(s){oo=s}};/*! https://mths.be/punycode v1.3.2 by @mathias */(function(s,t){(function(e){var i=t&&!t.nodeType&&t,r=s&&!s.nodeType&&s,n=typeof na=="object"&&na;(n.global===n||n.window===n||n.self===n)&&(e=n);var o,a=2147483647,h=36,l=1,c=26,u=38,d=700,f=72,p=128,m="-",_=/^xn--/,x=/[^\x20-\x7E]/,g=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=h-l,v=Math.floor,S=String.fromCharCode,C;function T(R){throw RangeError(y[R])}function A(R,U){for(var W=R.length,nt=[];W--;)nt[W]=U(R[W]);return nt}function P(R,U){var W=R.split("@"),nt="";W.length>1&&(nt=W[0]+"@",R=W[1]),R=R.replace(g,".");var J=R.split("."),lt=A(J,U).join(".");return nt+lt}function I(R){for(var U=[],W=0,nt=R.length,J,lt;W<nt;)J=R.charCodeAt(W++),J>=55296&&J<=56319&&W<nt?(lt=R.charCodeAt(W++),(lt&64512)==56320?U.push(((J&1023)<<10)+(lt&1023)+65536):(U.push(J),W--)):U.push(J);return U}function Z(R){return A(R,function(U){var W="";return U>65535&&(U-=65536,W+=S(U>>>10&1023|55296),U=56320|U&1023),W+=S(U),W}).join("")}function q(R){return R-48<10?R-22:R-65<26?R-65:R-97<26?R-97:h}function j(R,U){return R+22+75*(R<26)-((U!=0)<<5)}function H(R,U,W){var nt=0;for(R=W?v(R/d):R>>1,R+=v(R/U);R>w*c>>1;nt+=h)R=v(R/w);return v(nt+(w+1)*R/(R+u))}function st(R){var U=[],W=R.length,nt,J=0,lt=p,Rt=f,Qt,Ae,Ve,ts,Lt,_e,Pe,ms,Ls;for(Qt=R.lastIndexOf(m),Qt<0&&(Qt=0),Ae=0;Ae<Qt;++Ae)R.charCodeAt(Ae)>=128&&T("not-basic"),U.push(R.charCodeAt(Ae));for(Ve=Qt>0?Qt+1:0;Ve<W;){for(ts=J,Lt=1,_e=h;Ve>=W&&T("invalid-input"),Pe=q(R.charCodeAt(Ve++)),(Pe>=h||Pe>v((a-J)/Lt))&&T("overflow"),J+=Pe*Lt,ms=_e<=Rt?l:_e>=Rt+c?c:_e-Rt,!(Pe<ms);_e+=h)Ls=h-ms,Lt>v(a/Ls)&&T("overflow"),Lt*=Ls;nt=U.length+1,Rt=H(J-ts,nt,ts==0),v(J/nt)>a-lt&&T("overflow"),lt+=v(J/nt),J%=nt,U.splice(J++,0,lt)}return Z(U)}function at(R){var U,W,nt,J,lt,Rt,Qt,Ae,Ve,ts,Lt,_e=[],Pe,ms,Ls,ra;for(R=I(R),Pe=R.length,U=p,W=0,lt=f,Rt=0;Rt<Pe;++Rt)Lt=R[Rt],Lt<128&&_e.push(S(Lt));for(nt=J=_e.length,J&&_e.push(m);nt<Pe;){for(Qt=a,Rt=0;Rt<Pe;++Rt)Lt=R[Rt],Lt>=U&&Lt<Qt&&(Qt=Lt);for(ms=nt+1,Qt-U>v((a-W)/ms)&&T("overflow"),W+=(Qt-U)*ms,U=Qt,Rt=0;Rt<Pe;++Rt)if(Lt=R[Rt],Lt<U&&++W>a&&T("overflow"),Lt==U){for(Ae=W,Ve=h;ts=Ve<=lt?l:Ve>=lt+c?c:Ve-lt,!(Ae<ts);Ve+=h)ra=Ae-ts,Ls=h-ts,_e.push(S(j(ts+ra%Ls,0))),Ae=v(ra/Ls);_e.push(S(j(Ae,0))),lt=H(W,ms,nt==J),W=0,++nt}++W,++U}return _e.join("")}function It(R){return P(R,function(U){return _.test(U)?st(U.slice(4).toLowerCase()):U})}function Qe(R){return P(R,function(U){return x.test(U)?"xn--"+at(U):U})}if(o={version:"1.3.2",ucs2:{decode:I,encode:Z},decode:st,encode:at,toASCII:Qe,toUnicode:It},i&&r)if(s.exports==i)r.exports=o;else for(C in o)o.hasOwnProperty(C)&&(i[C]=o[C]);else e.punycode=o})(na)})(Ly,oo);var Fy={isString:function(s){return typeof s=="string"},isObject:function(s){return typeof s=="object"&&s!==null},isNull:function(s){return s===null},isNullOrUndefined:function(s){return s==null}},Gr={};function Oy(s,t){return Object.prototype.hasOwnProperty.call(s,t)}var Uy=function(s,t,e,i){t=t||"&",e=e||"=";var r={};if(typeof s!="string"||s.length===0)return r;var n=/\+/g;s=s.split(t);var o=1e3;i&&typeof i.maxKeys=="number"&&(o=i.maxKeys);var a=s.length;o>0&&a>o&&(a=o);for(var h=0;h<a;++h){var l=s[h].replace(n,"%20"),c=l.indexOf(e),u,d,f,p;c>=0?(u=l.substr(0,c),d=l.substr(c+1)):(u=l,d=""),f=decodeURIComponent(u),p=decodeURIComponent(d),Oy(r,f)?Array.isArray(r[f])?r[f].push(p):r[f]=[r[f],p]:r[f]=p}return r},ur=function(s){switch(typeof s){case"string":return s;case"boolean":return s?"true":"false";case"number":return isFinite(s)?s:"";default:return""}},Ny=function(s,t,e,i){return t=t||"&",e=e||"=",s===null&&(s=void 0),typeof s=="object"?Object.keys(s).map(function(r){var n=encodeURIComponent(ur(r))+e;return Array.isArray(s[r])?s[r].map(function(o){return n+encodeURIComponent(ur(o))}).join(t):n+encodeURIComponent(ur(s[r]))}).join(t):i?encodeURIComponent(ur(i))+e+encodeURIComponent(ur(s)):""};Gr.decode=Gr.parse=Uy;Gr.encode=Gr.stringify=Ny;var Dy=oo,ze=Fy,$y=Bo,Gy=Jy,Vy=Zy;function Oe(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Wy=/^([a-z0-9.+-]+:)/i,zy=/:[0-9]*$/,Hy=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Xy=["<",">",'"',"`"," ","\r",`
`,"	"],jy=["{","}","|","\\","^","`"].concat(Xy),Ch=["'"].concat(jy),Bc=["%","/","?",";","#"].concat(Ch),Lc=["/","?","#"],Yy=255,Fc=/^[+a-z0-9A-Z_-]{0,63}$/,qy=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Ky={javascript:!0,"javascript:":!0},Sh={javascript:!0,"javascript:":!0},Gi={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Ah=Gr;function Bo(s,t,e){if(s&&ze.isObject(s)&&s instanceof Oe)return s;var i=new Oe;return i.parse(s,t,e),i}Oe.prototype.parse=function(s,t,e){if(!ze.isString(s))throw new TypeError("Parameter 'url' must be a string, not "+typeof s);var i=s.indexOf("?"),r=i!==-1&&i<s.indexOf("#")?"?":"#",n=s.split(r),o=/\\/g;n[0]=n[0].replace(o,"/"),s=n.join(r);var a=s;if(a=a.trim(),!e&&s.split("#").length===1){var h=Hy.exec(a);if(h)return this.path=a,this.href=a,this.pathname=h[1],h[2]?(this.search=h[2],t?this.query=Ah.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var l=Wy.exec(a);if(l){l=l[0];var c=l.toLowerCase();this.protocol=c,a=a.substr(l.length)}if(e||l||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var u=a.substr(0,2)==="//";u&&!(l&&Sh[l])&&(a=a.substr(2),this.slashes=!0)}if(!Sh[l]&&(u||l&&!Gi[l])){for(var d=-1,f=0;f<Lc.length;f++){var p=a.indexOf(Lc[f]);p!==-1&&(d===-1||p<d)&&(d=p)}var m,_;d===-1?_=a.lastIndexOf("@"):_=a.lastIndexOf("@",d),_!==-1&&(m=a.slice(0,_),a=a.slice(_+1),this.auth=decodeURIComponent(m)),d=-1;for(var f=0;f<Bc.length;f++){var p=a.indexOf(Bc[f]);p!==-1&&(d===-1||p<d)&&(d=p)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var x=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!x)for(var g=this.hostname.split(/\./),f=0,y=g.length;f<y;f++){var w=g[f];if(w&&!w.match(Fc)){for(var v="",S=0,C=w.length;S<C;S++)w.charCodeAt(S)>127?v+="x":v+=w[S];if(!v.match(Fc)){var T=g.slice(0,f),A=g.slice(f+1),P=w.match(qy);P&&(T.push(P[1]),A.unshift(P[2])),A.length&&(a="/"+A.join(".")+a),this.hostname=T.join(".");break}}}this.hostname.length>Yy?this.hostname="":this.hostname=this.hostname.toLowerCase(),x||(this.hostname=Dy.toASCII(this.hostname));var I=this.port?":"+this.port:"",Z=this.hostname||"";this.host=Z+I,this.href+=this.host,x&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!Ky[c])for(var f=0,y=Ch.length;f<y;f++){var q=Ch[f];if(a.indexOf(q)!==-1){var j=encodeURIComponent(q);j===q&&(j=escape(q)),a=a.split(q).join(j)}}var H=a.indexOf("#");H!==-1&&(this.hash=a.substr(H),a=a.slice(0,H));var st=a.indexOf("?");if(st!==-1?(this.search=a.substr(st),this.query=a.substr(st+1),t&&(this.query=Ah.parse(this.query)),a=a.slice(0,st)):t&&(this.search="",this.query={}),a&&(this.pathname=a),Gi[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var I=this.pathname||"",at=this.search||"";this.path=I+at}return this.href=this.format(),this};function Zy(s){return ze.isString(s)&&(s=Bo(s)),s instanceof Oe?s.format():Oe.prototype.format.call(s)}Oe.prototype.format=function(){var s=this.auth||"";s&&(s=encodeURIComponent(s),s=s.replace(/%3A/i,":"),s+="@");var t=this.protocol||"",e=this.pathname||"",i=this.hash||"",r=!1,n="";this.host?r=s+this.host:this.hostname&&(r=s+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&ze.isObject(this.query)&&Object.keys(this.query).length&&(n=Ah.stringify(this.query));var o=this.search||n&&"?"+n||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||Gi[t])&&r!==!1?(r="//"+(r||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):r||(r=""),i&&i.charAt(0)!=="#"&&(i="#"+i),o&&o.charAt(0)!=="?"&&(o="?"+o),e=e.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),t+r+e+o+i};function Jy(s,t){return Bo(s,!1,!0).resolve(t)}Oe.prototype.resolve=function(s){return this.resolveObject(Bo(s,!1,!0)).format()};Oe.prototype.resolveObject=function(s){if(ze.isString(s)){var t=new Oe;t.parse(s,!1,!0),s=t}for(var e=new Oe,i=Object.keys(this),r=0;r<i.length;r++){var n=i[r];e[n]=this[n]}if(e.hash=s.hash,s.href==="")return e.href=e.format(),e;if(s.slashes&&!s.protocol){for(var o=Object.keys(s),a=0;a<o.length;a++){var h=o[a];h!=="protocol"&&(e[h]=s[h])}return Gi[e.protocol]&&e.hostname&&!e.pathname&&(e.path=e.pathname="/"),e.href=e.format(),e}if(s.protocol&&s.protocol!==e.protocol){if(!Gi[s.protocol]){for(var l=Object.keys(s),c=0;c<l.length;c++){var u=l[c];e[u]=s[u]}return e.href=e.format(),e}if(e.protocol=s.protocol,!s.host&&!Sh[s.protocol]){for(var y=(s.pathname||"").split("/");y.length&&!(s.host=y.shift()););s.host||(s.host=""),s.hostname||(s.hostname=""),y[0]!==""&&y.unshift(""),y.length<2&&y.unshift(""),e.pathname=y.join("/")}else e.pathname=s.pathname;if(e.search=s.search,e.query=s.query,e.host=s.host||"",e.auth=s.auth,e.hostname=s.hostname||s.host,e.port=s.port,e.pathname||e.search){var d=e.pathname||"",f=e.search||"";e.path=d+f}return e.slashes=e.slashes||s.slashes,e.href=e.format(),e}var p=e.pathname&&e.pathname.charAt(0)==="/",m=s.host||s.pathname&&s.pathname.charAt(0)==="/",_=m||p||e.host&&s.pathname,x=_,g=e.pathname&&e.pathname.split("/")||[],y=s.pathname&&s.pathname.split("/")||[],w=e.protocol&&!Gi[e.protocol];if(w&&(e.hostname="",e.port=null,e.host&&(g[0]===""?g[0]=e.host:g.unshift(e.host)),e.host="",s.protocol&&(s.hostname=null,s.port=null,s.host&&(y[0]===""?y[0]=s.host:y.unshift(s.host)),s.host=null),_=_&&(y[0]===""||g[0]==="")),m)e.host=s.host||s.host===""?s.host:e.host,e.hostname=s.hostname||s.hostname===""?s.hostname:e.hostname,e.search=s.search,e.query=s.query,g=y;else if(y.length)g||(g=[]),g.pop(),g=g.concat(y),e.search=s.search,e.query=s.query;else if(!ze.isNullOrUndefined(s.search)){if(w){e.hostname=e.host=g.shift();var v=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;v&&(e.auth=v.shift(),e.host=e.hostname=v.shift())}return e.search=s.search,e.query=s.query,(!ze.isNull(e.pathname)||!ze.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!g.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var S=g.slice(-1)[0],C=(e.host||s.host||g.length>1)&&(S==="."||S==="..")||S==="",T=0,A=g.length;A>=0;A--)S=g[A],S==="."?g.splice(A,1):S===".."?(g.splice(A,1),T++):T&&(g.splice(A,1),T--);if(!_&&!x)for(;T--;T)g.unshift("..");_&&g[0]!==""&&(!g[0]||g[0].charAt(0)!=="/")&&g.unshift(""),C&&g.join("/").substr(-1)!=="/"&&g.push("");var P=g[0]===""||g[0]&&g[0].charAt(0)==="/";if(w){e.hostname=e.host=P?"":g.length?g.shift():"";var v=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;v&&(e.auth=v.shift(),e.host=e.hostname=v.shift())}return _=_||e.host&&g.length,_&&!P&&g.unshift(""),g.length?e.pathname=g.join("/"):(e.pathname=null,e.path=null),(!ze.isNull(e.pathname)||!ze.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=s.auth||e.auth,e.slashes=e.slashes||s.slashes,e.href=e.format(),e};Oe.prototype.parseHost=function(){var s=this.host,t=zy.exec(s);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),s=s.substr(0,s.length-t.length)),s&&(this.hostname=s)};const Qy={parse:$y,format:Vy,resolve:Gy};function Me(s){if(typeof s!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(s)}`)}function dr(s){return s.split("?")[0].split("#")[0]}function t0(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function e0(s,t,e){return s.replace(new RegExp(t0(t),"g"),e)}function s0(s,t){let e="",i=0,r=-1,n=0,o=-1;for(let a=0;a<=s.length;++a){if(a<s.length)o=s.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||n===1))if(r!==a-1&&n===2){if(e.length<2||i!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const h=e.lastIndexOf("/");if(h!==e.length-1){h===-1?(e="",i=0):(e=e.slice(0,h),i=e.length-1-e.lastIndexOf("/")),r=a,n=0;continue}}else if(e.length===2||e.length===1){e="",i=0,r=a,n=0;continue}}t&&(e.length>0?e+="/..":e="..",i=2)}else e.length>0?e+=`/${s.slice(r+1,a)}`:e=s.slice(r+1,a),i=a-r-1;r=a,n=0}else o===46&&n!==-1?++n:n=-1}return e}const Jt={toPosix(s){return e0(s,"\\","/")},isUrl(s){return/^https?:/.test(this.toPosix(s))},isDataUrl(s){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(s)},hasProtocol(s){return/^[^/:]+:\//.test(this.toPosix(s))},getProtocol(s){Me(s),s=this.toPosix(s);let t="";const e=/^file:\/\/\//.exec(s),i=/^[^/:]+:\/\//.exec(s),r=/^[^/:]+:\//.exec(s);if(e||i||r){const n=(e==null?void 0:e[0])||(i==null?void 0:i[0])||(r==null?void 0:r[0]);t=n,s=s.slice(n.length)}return t},toAbsolute(s,t,e){if(this.isDataUrl(s))return s;const i=dr(this.toPosix(t??V.ADAPTER.getBaseUrl())),r=dr(this.toPosix(e??this.rootname(i)));return Me(s),s=this.toPosix(s),s.startsWith("/")?Jt.join(r,s.slice(1)):this.isAbsolute(s)?s:this.join(i,s)},normalize(s){if(s=this.toPosix(s),Me(s),s.length===0)return".";let t="";const e=s.startsWith("/");this.hasProtocol(s)&&(t=this.rootname(s),s=s.slice(t.length));const i=s.endsWith("/");return s=s0(s,!1),s.length>0&&i&&(s+="/"),e?`/${s}`:t+s},isAbsolute(s){return Me(s),s=this.toPosix(s),this.hasProtocol(s)?!0:s.startsWith("/")},join(...s){if(s.length===0)return".";let t;for(let e=0;e<s.length;++e){const i=s[e];if(Me(i),i.length>0)if(t===void 0)t=i;else{const r=s[e-1]??"";this.extname(r)?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(s){if(Me(s),s.length===0)return".";s=this.toPosix(s);let t=s.charCodeAt(0);const e=t===47;let i=-1,r=!0;const n=this.getProtocol(s),o=s;s=s.slice(n.length);for(let a=s.length-1;a>=1;--a)if(t=s.charCodeAt(a),t===47){if(!r){i=a;break}}else r=!1;return i===-1?e?"/":this.isUrl(o)?n+s:n:e&&i===1?"//":n+s.slice(0,i)},rootname(s){Me(s),s=this.toPosix(s);let t="";if(s.startsWith("/")?t="/":t=this.getProtocol(s),this.isUrl(s)){const e=s.indexOf("/",t.length);e!==-1?t=s.slice(0,e):t=s,t.endsWith("/")||(t+="/")}return t},basename(s,t){Me(s),t&&Me(t),s=dr(this.toPosix(s));let e=0,i=-1,r=!0,n;if(t!==void 0&&t.length>0&&t.length<=s.length){if(t.length===s.length&&t===s)return"";let o=t.length-1,a=-1;for(n=s.length-1;n>=0;--n){const h=s.charCodeAt(n);if(h===47){if(!r){e=n+1;break}}else a===-1&&(r=!1,a=n+1),o>=0&&(h===t.charCodeAt(o)?--o===-1&&(i=n):(o=-1,i=a))}return e===i?i=a:i===-1&&(i=s.length),s.slice(e,i)}for(n=s.length-1;n>=0;--n)if(s.charCodeAt(n)===47){if(!r){e=n+1;break}}else i===-1&&(r=!1,i=n+1);return i===-1?"":s.slice(e,i)},extname(s){Me(s),s=dr(this.toPosix(s));let t=-1,e=0,i=-1,r=!0,n=0;for(let o=s.length-1;o>=0;--o){const a=s.charCodeAt(o);if(a===47){if(!r){e=o+1;break}continue}i===-1&&(r=!1,i=o+1),a===46?t===-1?t=o:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||i===-1||n===0||n===1&&t===i-1&&t===e+1?"":s.slice(t,i)},parse(s){Me(s);const t={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return t;s=dr(this.toPosix(s));let e=s.charCodeAt(0);const i=this.isAbsolute(s);let r;t.root=this.rootname(s),i||this.hasProtocol(s)?r=1:r=0;let n=-1,o=0,a=-1,h=!0,l=s.length-1,c=0;for(;l>=r;--l){if(e=s.charCodeAt(l),e===47){if(!h){o=l+1;break}continue}a===-1&&(h=!1,a=l+1),e===46?n===-1?n=l:c!==1&&(c=1):n!==-1&&(c=-1)}return n===-1||a===-1||c===0||c===1&&n===a-1&&n===o+1?a!==-1&&(o===0&&i?t.base=t.name=s.slice(1,a):t.base=t.name=s.slice(o,a)):(o===0&&i?(t.name=s.slice(1,n),t.base=s.slice(1,a)):(t.name=s.slice(o,n),t.base=s.slice(o,a)),t.ext=s.slice(n,a)),t.dir=this.dirname(s),t},sep:"/",delimiter:":"},Oc={};function et(s,t,e=3){if(Oc[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`):(i=i.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${s}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${s}`),console.warn(i))),Oc[t]=!0}let Sa;function i0(){return typeof Sa>"u"&&(Sa=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:V.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!V.ADAPTER.getWebGLRenderingContext())return!1;const i=V.ADAPTER.createCanvas();let r=i.getContext("webgl",t)||i.getContext("experimental-webgl",t);const n=!!((e=r==null?void 0:r.getContextAttributes())!=null&&e.stencil);if(r){const o=r.getExtension("WEBGL_lose_context");o&&o.loseContext()}return r=null,n}catch{return!1}}()),Sa}var r0="#f0f8ff",n0="#faebd7",o0="#00ffff",a0="#7fffd4",h0="#f0ffff",l0="#f5f5dc",c0="#ffe4c4",u0="#000000",d0="#ffebcd",f0="#0000ff",p0="#8a2be2",_0="#a52a2a",m0="#deb887",g0="#5f9ea0",y0="#7fff00",x0="#d2691e",b0="#ff7f50",w0="#6495ed",v0="#fff8dc",T0="#dc143c",C0="#00ffff",S0="#00008b",A0="#008b8b",P0="#b8860b",E0="#a9a9a9",M0="#006400",I0="#a9a9a9",R0="#bdb76b",k0="#8b008b",B0="#556b2f",L0="#ff8c00",F0="#9932cc",O0="#8b0000",U0="#e9967a",N0="#8fbc8f",D0="#483d8b",$0="#2f4f4f",G0="#2f4f4f",V0="#00ced1",W0="#9400d3",z0="#ff1493",H0="#00bfff",X0="#696969",j0="#696969",Y0="#1e90ff",q0="#b22222",K0="#fffaf0",Z0="#228b22",J0="#ff00ff",Q0="#dcdcdc",tx="#f8f8ff",ex="#daa520",sx="#ffd700",ix="#808080",rx="#008000",nx="#adff2f",ox="#808080",ax="#f0fff0",hx="#ff69b4",lx="#cd5c5c",cx="#4b0082",ux="#fffff0",dx="#f0e68c",fx="#fff0f5",px="#e6e6fa",_x="#7cfc00",mx="#fffacd",gx="#add8e6",yx="#f08080",xx="#e0ffff",bx="#fafad2",wx="#d3d3d3",vx="#90ee90",Tx="#d3d3d3",Cx="#ffb6c1",Sx="#ffa07a",Ax="#20b2aa",Px="#87cefa",Ex="#778899",Mx="#778899",Ix="#b0c4de",Rx="#ffffe0",kx="#00ff00",Bx="#32cd32",Lx="#faf0e6",Fx="#ff00ff",Ox="#800000",Ux="#66cdaa",Nx="#0000cd",Dx="#ba55d3",$x="#9370db",Gx="#3cb371",Vx="#7b68ee",Wx="#00fa9a",zx="#48d1cc",Hx="#c71585",Xx="#191970",jx="#f5fffa",Yx="#ffe4e1",qx="#ffe4b5",Kx="#ffdead",Zx="#000080",Jx="#fdf5e6",Qx="#808000",tb="#6b8e23",eb="#ffa500",sb="#ff4500",ib="#da70d6",rb="#eee8aa",nb="#98fb98",ob="#afeeee",ab="#db7093",hb="#ffefd5",lb="#ffdab9",cb="#cd853f",ub="#ffc0cb",db="#dda0dd",fb="#b0e0e6",pb="#800080",_b="#663399",mb="#ff0000",gb="#bc8f8f",yb="#4169e1",xb="#8b4513",bb="#fa8072",wb="#f4a460",vb="#2e8b57",Tb="#fff5ee",Cb="#a0522d",Sb="#c0c0c0",Ab="#87ceeb",Pb="#6a5acd",Eb="#708090",Mb="#708090",Ib="#fffafa",Rb="#00ff7f",kb="#4682b4",Bb="#d2b48c",Lb="#008080",Fb="#d8bfd8",Ob="#ff6347",Ub="#40e0d0",Nb="#ee82ee",Db="#f5deb3",$b="#ffffff",Gb="#f5f5f5",Vb="#ffff00",Wb="#9acd32",zb={aliceblue:r0,antiquewhite:n0,aqua:o0,aquamarine:a0,azure:h0,beige:l0,bisque:c0,black:u0,blanchedalmond:d0,blue:f0,blueviolet:p0,brown:_0,burlywood:m0,cadetblue:g0,chartreuse:y0,chocolate:x0,coral:b0,cornflowerblue:w0,cornsilk:v0,crimson:T0,cyan:C0,darkblue:S0,darkcyan:A0,darkgoldenrod:P0,darkgray:E0,darkgreen:M0,darkgrey:I0,darkkhaki:R0,darkmagenta:k0,darkolivegreen:B0,darkorange:L0,darkorchid:F0,darkred:O0,darksalmon:U0,darkseagreen:N0,darkslateblue:D0,darkslategray:$0,darkslategrey:G0,darkturquoise:V0,darkviolet:W0,deeppink:z0,deepskyblue:H0,dimgray:X0,dimgrey:j0,dodgerblue:Y0,firebrick:q0,floralwhite:K0,forestgreen:Z0,fuchsia:J0,gainsboro:Q0,ghostwhite:tx,goldenrod:ex,gold:sx,gray:ix,green:rx,greenyellow:nx,grey:ox,honeydew:ax,hotpink:hx,indianred:lx,indigo:cx,ivory:ux,khaki:dx,lavenderblush:fx,lavender:px,lawngreen:_x,lemonchiffon:mx,lightblue:gx,lightcoral:yx,lightcyan:xx,lightgoldenrodyellow:bx,lightgray:wx,lightgreen:vx,lightgrey:Tx,lightpink:Cx,lightsalmon:Sx,lightseagreen:Ax,lightskyblue:Px,lightslategray:Ex,lightslategrey:Mx,lightsteelblue:Ix,lightyellow:Rx,lime:kx,limegreen:Bx,linen:Lx,magenta:Fx,maroon:Ox,mediumaquamarine:Ux,mediumblue:Nx,mediumorchid:Dx,mediumpurple:$x,mediumseagreen:Gx,mediumslateblue:Vx,mediumspringgreen:Wx,mediumturquoise:zx,mediumvioletred:Hx,midnightblue:Xx,mintcream:jx,mistyrose:Yx,moccasin:qx,navajowhite:Kx,navy:Zx,oldlace:Jx,olive:Qx,olivedrab:tb,orange:eb,orangered:sb,orchid:ib,palegoldenrod:rb,palegreen:nb,paleturquoise:ob,palevioletred:ab,papayawhip:hb,peachpuff:lb,peru:cb,pink:ub,plum:db,powderblue:fb,purple:pb,rebeccapurple:_b,red:mb,rosybrown:gb,royalblue:yb,saddlebrown:xb,salmon:bb,sandybrown:wb,seagreen:vb,seashell:Tb,sienna:Cb,silver:Sb,skyblue:Ab,slateblue:Pb,slategray:Eb,slategrey:Mb,snow:Ib,springgreen:Rb,steelblue:kb,tan:Bb,teal:Lb,thistle:Fb,tomato:Ob,turquoise:Ub,violet:Nb,wheat:Db,white:$b,whitesmoke:Gb,yellow:Vb,yellowgreen:Wb};function Hb(s,t=[]){return t[0]=(s>>16&255)/255,t[1]=(s>>8&255)/255,t[2]=(s&255)/255,t}function Xb(s){let t=s.toString(16);return t="000000".substring(0,6-t.length)+t,`#${t}`}function jb(s){if(typeof s=="string"&&(s=zb[s.toLowerCase()]||s,s[0]==="#"&&(s=s.slice(1)),s.length===3)){const[t,e,i]=s;s=t+t+e+e+i+i}return parseInt(s,16)}function Yb(){const s=[],t=[];for(let i=0;i<32;i++)s[i]=i,t[i]=i;s[N.NORMAL_NPM]=N.NORMAL,s[N.ADD_NPM]=N.ADD,s[N.SCREEN_NPM]=N.SCREEN,t[N.NORMAL]=N.NORMAL_NPM,t[N.ADD]=N.ADD_NPM,t[N.SCREEN]=N.SCREEN_NPM;const e=[];return e.push(t),e.push(s),e}const qb=Yb();function Kb(s,t){if(t===1)return(t*255<<24)+s;if(t===0)return 0;let e=s>>16&255,i=s>>8&255,r=s&255;return e=e*t+.5|0,i=i*t+.5|0,r=r*t+.5|0,(t*255<<24)+(e<<16)+(i<<8)+r}function pf(s){if(s.BYTES_PER_ELEMENT===4)return s instanceof Float32Array?"Float32Array":s instanceof Uint32Array?"Uint32Array":"Int32Array";if(s.BYTES_PER_ELEMENT===2){if(s instanceof Uint16Array)return"Uint16Array"}else if(s.BYTES_PER_ELEMENT===1&&s instanceof Uint8Array)return"Uint8Array";return null}function ao(s){return s+=s===0?1:0,--s,s|=s>>>1,s|=s>>>2,s|=s>>>4,s|=s>>>8,s|=s>>>16,s+1}function Uc(s){return!(s&s-1)&&!!s}function Nc(s){let t=(s>65535?1:0)<<4;s>>>=t;let e=(s>255?1:0)<<3;return s>>>=e,t|=e,e=(s>15?1:0)<<2,s>>>=e,t|=e,e=(s>3?1:0)<<1,s>>>=e,t|=e,t|s>>1}function Zb(s,t,e){const i=s.length;let r;if(t>=i||e===0)return;e=t+e>i?i-t:e;const n=i-e;for(r=t;r<n;++r)s[r]=s[r+e];s.length=n}let Jb=0;function Vr(){return++Jb}const Dc={},We=Object.create(null),gs=Object.create(null);let wn;function Qb(s,t=globalThis.location){if(s.startsWith("data:"))return"";t=t||globalThis.location,wn||(wn=document.createElement("a")),wn.href=s;const e=Qy.parse(wn.href),i=!e.port&&t.port===""||e.port===t.port;return e.hostname!==t.hostname||!i||e.protocol!==t.protocol?"anonymous":""}function ho(s,t=1){var i;const e=(i=V.RETINA_PREFIX)==null?void 0:i.exec(s);return e?parseFloat(e[1]):t}var L=(s=>(s.Renderer="renderer",s.Application="application",s.RendererSystem="renderer-webgl-system",s.RendererPlugin="renderer-webgl-plugin",s.CanvasRendererSystem="renderer-canvas-system",s.CanvasRendererPlugin="renderer-canvas-plugin",s.Asset="asset",s.LoadParser="load-parser",s.ResolveParser="resolve-parser",s.CacheParser="cache-parser",s.DetectionParser="detection-parser",s))(L||{});const Ph=s=>{if(typeof s=="function"||typeof s=="object"&&s.extension){if(!s.extension)throw new Error("Extension class must have an extension object");s={...typeof s.extension!="object"?{type:s.extension}:s.extension,ref:s}}if(typeof s=="object")s={...s};else throw new Error("Invalid extension type");return typeof s.type=="string"&&(s.type=[s.type]),s},$c=(s,t)=>Ph(s).priority??t,$={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...s){return s.map(Ph).forEach(t=>{t.type.forEach(e=>{var i,r;return(r=(i=this._removeHandlers)[e])==null?void 0:r.call(i,t)})}),this},add(...s){return s.map(Ph).forEach(t=>{t.type.forEach(e=>{const i=this._addHandlers,r=this._queue;i[e]?i[e](t):(r[e]=r[e]||[],r[e].push(t))})}),this},handle(s,t,e){const i=this._addHandlers,r=this._removeHandlers;if(i[s]||r[s])throw new Error(`Extension type ${s} already has a handler`);i[s]=t,r[s]=e;const n=this._queue;return n[s]&&(n[s].forEach(o=>t(o)),delete n[s]),this},handleByMap(s,t){return this.handle(s,e=>{t[e.name]=e.ref},e=>{delete t[e.name]})},handleByList(s,t,e=-1){return this.handle(s,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((r,n)=>$c(n,e)-$c(r,e)))},i=>{const r=t.indexOf(i.ref);r!==-1&&t.splice(r,1)})}};class tw{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const ew=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function sw(s){let t="";for(let e=0;e<s;++e)e>0&&(t+=`
else `),e<s-1&&(t+=`if(test == ${e}.0){}`);return t}function iw(s,t){if(s===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);for(;;){const i=ew.replace(/%forloop%/gi,sw(s));if(t.shaderSource(e,i),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))s=s/2|0;else break}return s}const Aa=0,Pa=1,Ea=2,Ma=3,Ia=4,Ra=5;class ln{constructor(){this.data=0,this.blendMode=N.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Aa)}set blend(t){!!(this.data&1<<Aa)!==t&&(this.data^=1<<Aa)}get offsets(){return!!(this.data&1<<Pa)}set offsets(t){!!(this.data&1<<Pa)!==t&&(this.data^=1<<Pa)}get culling(){return!!(this.data&1<<Ea)}set culling(t){!!(this.data&1<<Ea)!==t&&(this.data^=1<<Ea)}get depthTest(){return!!(this.data&1<<Ma)}set depthTest(t){!!(this.data&1<<Ma)!==t&&(this.data^=1<<Ma)}get depthMask(){return!!(this.data&1<<Ra)}set depthMask(t){!!(this.data&1<<Ra)!==t&&(this.data^=1<<Ra)}get clockwiseFrontFace(){return!!(this.data&1<<Ia)}set clockwiseFrontFace(t){!!(this.data&1<<Ia)!==t&&(this.data^=1<<Ia)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==N.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new ln;return t.depthTest=!1,t.blend=!0,t}}const Eh=[];function _f(s,t){if(!s)return null;let e="";if(typeof s=="string"){const i=/\.(\w{3,4})(?:$|\?|#)/i.exec(s);i&&(e=i[1].toLowerCase())}for(let i=Eh.length-1;i>=0;--i){const r=Eh[i];if(r.test&&r.test(s,e))return new r(s,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class Ue{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,i,r,n,o,a,h){if(arguments.length>8)throw new Error("max arguments reached");const{name:l,items:c}=this;this._aliasCount++;for(let u=0,d=c.length;u<d;u++)c[u][l](t,e,i,r,n,o,a,h);return c===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(Ue.prototype,{dispatch:{value:Ue.prototype.emit},run:{value:Ue.prototype.emit}});class Wr{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Ue("setRealSize"),this.onUpdate=new Ue("update"),this.onError=new Ue("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class bl extends Wr{constructor(t,e){const{width:i,height:r}=e||{};if(!i||!r)throw new Error("BufferResource width or height invalid");super(i,r),this.data=t}upload(t,e,i){const r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Is.UNPACK);const n=e.realWidth,o=e.realHeight;return i.width===n&&i.height===o?r.texSubImage2D(e.target,0,0,0,n,o,e.format,i.type,this.data):(i.width=n,i.height=o,r.texImage2D(e.target,0,i.internalFormat,n,o,0,e.format,i.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}const rw={scaleMode:os.NEAREST,format:E.RGBA,alphaMode:Is.NPM},Mi=class extends Ze{constructor(s=null,t=null){super(),t=Object.assign({},Mi.defaultOptions,t);const{alphaMode:e,mipmap:i,anisotropicLevel:r,scaleMode:n,width:o,height:a,wrapMode:h,format:l,type:c,target:u,resolution:d,resourceOptions:f}=t;s&&!(s instanceof Wr)&&(s=_f(s,f),s.internal=!0),this.resolution=d||V.RESOLUTION,this.width=Math.round((o||0)*this.resolution)/this.resolution,this.height=Math.round((a||0)*this.resolution)/this.resolution,this._mipmap=i,this.anisotropicLevel=r,this._wrapMode=h,this._scaleMode=n,this.format=l,this.type=c,this.target=u,this.alphaMode=e,this.uid=Vr(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=o>0&&a>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(s)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(s){this._mipmap!==s&&(this._mipmap=s,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(s){this._scaleMode!==s&&(this._scaleMode=s,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(s){this._wrapMode!==s&&(this._wrapMode=s,this.dirtyStyleId++)}setStyle(s,t){let e;return s!==void 0&&s!==this.scaleMode&&(this.scaleMode=s,e=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,e=!0),e&&this.dirtyStyleId++,this}setSize(s,t,e){return e=e||this.resolution,this.setRealSize(s*e,t*e,e)}setRealSize(s,t,e){return this.resolution=e||this.resolution,this.width=Math.round(s)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Uc(this.realWidth)&&Uc(this.realHeight)}setResolution(s){const t=this.resolution;return t===s?this:(this.resolution=s,this.valid&&(this.width=Math.round(this.width*t)/s,this.height=Math.round(this.height*t)/s,this.emit("update",this)),this._refreshPOT(),this)}setResource(s){if(this.resource===s)return this;if(this.resource)throw new Error("Resource can be set only once");return s.bind(this),this.resource=s,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(s){this.emit("error",this,s)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete gs[this.cacheId],delete We[this.cacheId],this.cacheId=null),this.dispose(),Mi.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(s,t,e=V.STRICT_TEXTURE_CACHE){const i=typeof s=="string";let r=null;if(i)r=s;else{if(!s._pixiId){const o=(t==null?void 0:t.pixiIdPrefix)||"pixiid";s._pixiId=`${o}_${Vr()}`}r=s._pixiId}let n=gs[r];if(i&&e&&!n)throw new Error(`The cacheId "${r}" does not exist in BaseTextureCache.`);return n||(n=new Mi(s,t),n.cacheId=r,Mi.addToCache(n,r)),n}static fromBuffer(s,t,e,i){s=s||new Float32Array(t*e*4);const r=new bl(s,{width:t,height:e}),n=s instanceof Float32Array?K.FLOAT:K.UNSIGNED_BYTE;return new Mi(r,Object.assign({},rw,i||{width:t,height:e,type:n}))}static addToCache(s,t){t&&(s.textureCacheIds.includes(t)||s.textureCacheIds.push(t),gs[t]&&gs[t]!==s&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),gs[t]=s)}static removeFromCache(s){if(typeof s=="string"){const t=gs[s];if(t){const e=t.textureCacheIds.indexOf(s);return e>-1&&t.textureCacheIds.splice(e,1),delete gs[s],t}}else if(s!=null&&s.textureCacheIds){for(let t=0;t<s.textureCacheIds.length;++t)delete gs[s.textureCacheIds[t]];return s.textureCacheIds.length=0,s}return null}};let Y=Mi;Y.defaultOptions={mipmap:di.POW2,anisotropicLevel:0,scaleMode:os.LINEAR,wrapMode:yl.CLAMP,alphaMode:Is.UNPACK,target:$i.TEXTURE_2D,format:E.RGBA,type:K.UNSIGNED_BYTE};Y._globalBatch=0;class nw{constructor(){this.texArray=null,this.blend=0,this.type=no.TRIANGLES,this.start=0,this.size=0,this.data=null}}let ow=0;class $t{constructor(t,e=!0,i=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=ow++,this.disposeRunner=new Ue("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?Ye.ELEMENT_ARRAY_BUFFER:Ye.ARRAY_BUFFER}get index(){return this.type===Ye.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new $t(t)}}class lo{constructor(t,e=0,i=!1,r=K.FLOAT,n,o,a,h=1){this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=n,this.start=o,this.instance=a,this.divisor=h}destroy(){this.buffer=null}static from(t,e,i,r,n){return new lo(t,e,i,r,n)}}const aw={Float32Array,Uint32Array,Int32Array,Uint8Array};function hw(s,t){let e=0,i=0;const r={};for(let h=0;h<s.length;h++)i+=t[h],e+=s[h].length;const n=new ArrayBuffer(e*4);let o=null,a=0;for(let h=0;h<s.length;h++){const l=t[h],c=s[h],u=pf(c);r[u]||(r[u]=new aw[u](n)),o=r[u];for(let d=0;d<c.length;d++){const f=(d/l|0)*i+a,p=d%l;o[f+p]=c[d]}a+=l}return new Float32Array(n)}const Gc={5126:4,5123:2,5121:1};let lw=0;const cw={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Zi{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=lw++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Ue("disposeGeometry"),this.refCount=0}addAttribute(t,e,i=0,r=!1,n,o,a,h=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof $t||(e instanceof Array&&(e=new Float32Array(e)),e=new $t(e));const l=t.split("|");if(l.length>1){for(let u=0;u<l.length;u++)this.addAttribute(l[u],e,i,r,n);return this}let c=this.buffers.indexOf(e);return c===-1&&(this.buffers.push(e),c=this.buffers.length-1),this.attributes[t]=new lo(c,i,r,n,o,a,h),this.instanced=this.instanced||h,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof $t||(t instanceof Array&&(t=new Uint16Array(t)),t=new $t(t)),t.type=Ye.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],e=[],i=new $t;let r;for(r in this.attributes){const n=this.attributes[r],o=this.buffers[n.buffer];t.push(o.data),e.push(n.size*Gc[n.type]/4),n.buffer=0}for(i.data=hw(t,e),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new Zi;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new $t(this.buffers[e].data.slice(0));for(const e in this.attributes){const i=this.attributes[e];t.attributes[e]=new lo(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=Ye.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new Zi,i=[],r=[],n=[];let o;for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)r[h]=r[h]||0,r[h]+=o.buffers[h].data.length,n[h]=0}for(let a=0;a<o.buffers.length;a++)i[a]=new cw[pf(o.buffers[a].data)](r[a]),e.buffers[a]=new $t(i[a]);for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)i[h].set(o.buffers[h].data,n[h]),n[h]+=o.buffers[h].data.length}if(e.attributes=o.attributes,o.indexBuffer){e.indexBuffer=e.buffers[o.buffers.indexOf(o.indexBuffer)],e.indexBuffer.type=Ye.ELEMENT_ARRAY_BUFFER;let a=0,h=0,l=0,c=0;for(let u=0;u<o.buffers.length;u++)if(o.buffers[u]!==o.indexBuffer){c=u;break}for(const u in o.attributes){const d=o.attributes[u];(d.buffer|0)===c&&(h+=d.size*Gc[d.type]/4)}for(let u=0;u<t.length;u++){const d=t[u].indexBuffer.data;for(let f=0;f<d.length;f++)e.indexBuffer.data[f+l]+=a;a+=t[u].buffers[c].data.length/h,l+=d.length}}return e}}class uw extends Zi{constructor(t=!1){super(),this._buffer=new $t(null,t,!1),this._indexBuffer=new $t(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,K.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,K.FLOAT).addAttribute("aColor",this._buffer,4,!0,K.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,K.FLOAT).addIndex(this._indexBuffer)}}const dw=Math.PI*2;var mf=(s=>(s[s.POLY=0]="POLY",s[s.RECT=1]="RECT",s[s.CIRC=2]="CIRC",s[s.ELIP=3]="ELIP",s[s.RREC=4]="RREC",s))(mf||{});let be=class gf{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new gf(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}};const vn=[new be,new be,new be,new be];let Bt=class Mh{constructor(t=0,e=0,i=0,r=0){this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=mf.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Mh(0,0,0,0)}clone(){return new Mh(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const T=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=T)return!1;const P=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>P}const i=this.left,r=this.right,n=this.top,o=this.bottom;if(r<=i||o<=n)return!1;const a=vn[0].set(t.left,t.top),h=vn[1].set(t.left,t.bottom),l=vn[2].set(t.right,t.top),c=vn[3].set(t.right,t.bottom);if(l.x<=a.x||h.y<=a.y)return!1;const u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(a,a),e.apply(h,h),e.apply(l,l),e.apply(c,c),Math.max(a.x,h.x,l.x,c.x)<=i||Math.min(a.x,h.x,l.x,c.x)>=r||Math.max(a.y,h.y,l.y,c.y)<=n||Math.min(a.y,h.y,l.y,c.y)>=o))return!1;const d=u*(h.y-a.y),f=u*(a.x-h.x),p=d*i+f*n,m=d*r+f*n,_=d*i+f*o,x=d*r+f*o;if(Math.max(p,m,_,x)<=d*a.x+f*a.y||Math.min(p,m,_,x)>=d*c.x+f*c.y)return!1;const g=u*(a.y-l.y),y=u*(l.x-a.x),w=g*i+y*n,v=g*r+y*n,S=g*i+y*o,C=g*r+y*o;return!(Math.max(w,v,S,C)<=g*a.x+y*a.y||Math.min(w,v,S,C)>=g*c.x+y*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this}ceil(t=1,e=.001){const i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}},ue=class Wn{constructor(t=1,e=0,i=0,r=1,n=0,o=0){this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,i,r,n,o){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,e){e=e||new be;const i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e}applyInverse(t,e){e=e||new be;const i=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*i*r+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,o=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=o*e-this.ty*i,this.ty=o*i+this.ty*e,this}append(t){const e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this}setTransform(t,e,i,r,n,o,a,h,l){return this.a=Math.cos(a+l)*n,this.b=Math.sin(a+l)*n,this.c=-Math.sin(a-h)*o,this.d=Math.cos(a-h)*o,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,i=this.b,r=this.c,n=this.d,o=t.pivot,a=-Math.atan2(-r,n),h=Math.atan2(i,e),l=Math.abs(a+h);return l<1e-5||Math.abs(dw-l)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=h),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx+(o.x*e+o.y*r),t.position.y=this.ty+(o.x*i+o.y*n),t}invert(){const t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,o=t*r-e*i;return this.a=r/o,this.b=-e/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-r*n)/o,this.ty=-(t*this.ty-e*n)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Wn;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new Wn}static get TEMP_MATRIX(){return new Wn}};const zs=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Hs=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Xs=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],js=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Ih=[],yf=[],Tn=Math.sign;function fw(){for(let s=0;s<16;s++){const t=[];Ih.push(t);for(let e=0;e<16;e++){const i=Tn(zs[s]*zs[e]+Xs[s]*Hs[e]),r=Tn(Hs[s]*zs[e]+js[s]*Hs[e]),n=Tn(zs[s]*Xs[e]+Xs[s]*js[e]),o=Tn(Hs[s]*Xs[e]+js[s]*js[e]);for(let a=0;a<16;a++)if(zs[a]===i&&Hs[a]===r&&Xs[a]===n&&js[a]===o){t.push(a);break}}}for(let s=0;s<16;s++){const t=new ue;t.set(zs[s],Hs[s],Xs[s],js[s],0,0),yf.push(t)}}fw();const ut={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:s=>zs[s],uY:s=>Hs[s],vX:s=>Xs[s],vY:s=>js[s],inv:s=>s&8?s&15:-s&7,add:(s,t)=>Ih[s][t],sub:(s,t)=>Ih[s][ut.inv(t)],rotate180:s=>s^4,isVertical:s=>(s&3)===2,byDirection:(s,t)=>Math.abs(s)*2<=Math.abs(t)?t>=0?ut.S:ut.N:Math.abs(t)*2<=Math.abs(s)?s>0?ut.E:ut.W:t>0?s>0?ut.SE:ut.SW:s>0?ut.NE:ut.NW,matrixAppendRotationInv:(s,t,e=0,i=0)=>{const r=yf[ut.inv(t)];r.tx=e,r.ty=i,s.append(r)}};let Cn=class xf{constructor(t,e,i=0,r=0){this._x=i,this._y=r,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new xf(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=${0} y=${0} scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}};const bf=class{constructor(){this.worldTransform=new ue,this.localTransform=new ue,this.position=new Cn(this.onChange,this,0,0),this.scale=new Cn(this.onChange,this,1,1),this.pivot=new Cn(this.onChange,this,0,0),this.skew=new Cn(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const s=this.localTransform;this._localID!==this._currentLocalID&&(s.a=this._cx*this.scale.x,s.b=this._sx*this.scale.x,s.c=this._cy*this.scale.y,s.d=this._sy*this.scale.y,s.tx=this.position.x-(this.pivot.x*s.a+this.pivot.y*s.c),s.ty=this.position.y-(this.pivot.x*s.b+this.pivot.y*s.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(s){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==s._worldID){const e=s.worldTransform,i=this.worldTransform;i.a=t.a*e.a+t.b*e.c,i.b=t.a*e.b+t.b*e.d,i.c=t.c*e.a+t.d*e.c,i.d=t.c*e.b+t.d*e.d,i.tx=t.tx*e.a+t.ty*e.c+e.tx,i.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=s._worldID,this._worldID++}}setFromMatrix(s){s.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(s){this._rotation!==s&&(this._rotation=s,this.updateSkew())}};let wf=bf;wf.IDENTITY=new bf;var pw=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,_w=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Vc(s,t,e){const i=s.createShader(t);return s.shaderSource(i,e),s.compileShader(i),i}function ka(s){const t=new Array(s);for(let e=0;e<t.length;e++)t[e]=!1;return t}function vf(s,t){switch(s){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return ka(2*t);case"bvec3":return ka(3*t);case"bvec4":return ka(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Vi=[{test:s=>s.type==="float"&&s.size===1&&!s.isArray,code:s=>`
            if(uv["${s}"] !== ud["${s}"].value)
            {
                ud["${s}"].value = uv["${s}"]
                gl.uniform1f(ud["${s}"].location, uv["${s}"])
            }
            `},{test:(s,t)=>(s.type==="sampler2D"||s.type==="samplerCube"||s.type==="sampler2DArray")&&s.size===1&&!s.isArray&&(t==null||t.castToBaseTexture!==void 0),code:s=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${s}"], t);

            if(ud["${s}"].value !== t)
            {
                ud["${s}"].value = t;
                gl.uniform1i(ud["${s}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(s,t)=>s.type==="mat3"&&s.size===1&&!s.isArray&&t.a!==void 0,code:s=>`
            gl.uniformMatrix3fv(ud["${s}"].location, false, uv["${s}"].toArray(true));
            `,codeUbo:s=>`
                var ${s}_matrix = uv.${s}.toArray(true);

                data[offset] = ${s}_matrix[0];
                data[offset+1] = ${s}_matrix[1];
                data[offset+2] = ${s}_matrix[2];
        
                data[offset + 4] = ${s}_matrix[3];
                data[offset + 5] = ${s}_matrix[4];
                data[offset + 6] = ${s}_matrix[5];
        
                data[offset + 8] = ${s}_matrix[6];
                data[offset + 9] = ${s}_matrix[7];
                data[offset + 10] = ${s}_matrix[8];
            `},{test:(s,t)=>s.type==="vec2"&&s.size===1&&!s.isArray&&t.x!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${s}"].location, v.x, v.y);
                }`,codeUbo:s=>`
                v = uv.${s};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:s=>s.type==="vec2"&&s.size===1&&!s.isArray,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${s}"].location, v[0], v[1]);
                }
            `},{test:(s,t)=>s.type==="vec4"&&s.size===1&&!s.isArray&&t.width!==void 0,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${s}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:s=>`
                    v = uv.${s};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:s=>s.type==="vec4"&&s.size===1&&!s.isArray,code:s=>`
                cv = ud["${s}"].value;
                v = uv["${s}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${s}"].location, v[0], v[1], v[2], v[3])
                }`}],mw={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},gw={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function yw(s,t){var i;const e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const r in s.uniforms){const n=t[r];if(!n){(i=s.uniforms[r])!=null&&i.group&&(s.uniforms[r].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${r}, syncData);
                    `));continue}const o=s.uniforms[r];let a=!1;for(let h=0;h<Vi.length;h++)if(Vi[h].test(n,o)){e.push(Vi[h].code(r,o)),a=!0;break}if(!a){const l=(n.size===1&&!n.isArray?mw:gw)[n.type].replace("location",`ud["${r}"].location`);e.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${l};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}const Tf={};let vi=Tf;function xw(){if(vi===Tf||vi!=null&&vi.isContextLost()){const s=V.ADAPTER.createCanvas();let t;V.PREFER_ENV>=mi.WEBGL2&&(t=s.getContext("webgl2",{})),t||(t=s.getContext("webgl",{})||s.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),vi=t}return vi}let Sn;function bw(){if(!Sn){Sn=xe.MEDIUM;const s=xw();s&&s.getShaderPrecisionFormat&&(Sn=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision?xe.HIGH:xe.MEDIUM)}return Sn}function Wc(s,t){const e=s.getShaderSource(t).split(`
`).map((l,c)=>`${c}: ${l}`),i=s.getShaderInfoLog(t),r=i.split(`
`),n={},o=r.map(l=>parseFloat(l.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(l=>l&&!n[l]?(n[l]=!0,!0):!1),a=[""];o.forEach(l=>{e[l-1]=`%c${e[l-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const h=e.join(`
`);a[0]=h,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function ww(s,t,e,i){s.getProgramParameter(t,s.LINK_STATUS)||(s.getShaderParameter(e,s.COMPILE_STATUS)||Wc(s,e),s.getShaderParameter(i,s.COMPILE_STATUS)||Wc(s,i),console.error("PixiJS Error: Could not initialize shader."),s.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",s.getProgramInfoLog(t)))}const vw={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Cf(s){return vw[s]}let An=null;const zc={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Sf(s,t){if(!An){const e=Object.keys(zc);An={};for(let i=0;i<e.length;++i){const r=e[i];An[s[r]]=zc[r]}}return An[t]}function Hc(s,t,e){if(s.substring(0,9)!=="precision"){let i=t;return t===xe.HIGH&&e!==xe.HIGH&&(i=xe.MEDIUM),`precision ${i} float;
${s}`}else if(e!==xe.HIGH&&s.substring(0,15)==="precision highp")return s.replace("precision highp","precision mediump");return s}let fr;function Tw(){if(typeof fr=="boolean")return fr;try{fr=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{fr=!1}return fr}let Cw=0;const Pn={},Ii=class{constructor(s,t,e="pixi-shader",i={}){this.extra={},this.id=Cw++,this.vertexSrc=s||Ii.defaultVertexSrc,this.fragmentSrc=t||Ii.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=i,this.vertexSrc.substring(0,8)!=="#version"&&(e=e.replace(/\s+/g,"-"),Pn[e]?(Pn[e]++,e+=`-${Pn[e]}`):Pn[e]=1,this.vertexSrc=`#define SHADER_NAME ${e}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${e}
${this.fragmentSrc}`,this.vertexSrc=Hc(this.vertexSrc,Ii.defaultVertexPrecision,xe.HIGH),this.fragmentSrc=Hc(this.fragmentSrc,Ii.defaultFragmentPrecision,bw())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return _w}static get defaultFragmentSrc(){return pw}static from(s,t,e){const i=s+t;let r=Dc[i];return r||(Dc[i]=r=new Ii(s,t,e)),r}};let as=Ii;as.defaultVertexPrecision=xe.HIGH;as.defaultFragmentPrecision=Oi.apple.device?xe.HIGH:xe.MEDIUM;let Sw=0;class qe{constructor(t,e,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Sw++,this.static=!!e,this.ubo=!!i,t instanceof $t?(this.buffer=t,this.buffer.type=Ye.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new $t(new Float32Array(1)),this.buffer.type=Ye.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,i){if(!this.ubo)this.uniforms[t]=new qe(e,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,i){return new qe(t,e,i)}static uboFrom(t,e){return new qe(t,e??!0,!0)}}class Lo{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof qe?this.uniformGroup=e:this.uniformGroup=new qe(e):this.uniformGroup=new qe({}),this.disposeRunner=new Ue("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const i in e.uniforms){const r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,i){const r=as.from(t,e);return new Lo(r,i)}}class Aw{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const i=new Int32Array(t);for(let n=0;n<t;n++)i[n]=n;this.defaultGroupCache[t]=qe.from({uSamplers:i},!0);let r=this.fragTemplate;r=r.replace(/%count%/gi,`${t}`),r=r.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new as(this.vertexSrc,r)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new ue,default:this.defaultGroupCache[t]};return new Lo(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let i=0;i<t;i++)i>0&&(e+=`
else `),i<t-1&&(e+=`if(vTextureId < ${i}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}class Pw{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function Ew(){return!Oi.apple.device}function Mw(s){let t=!0;const e=V.ADAPTER.getNavigator();if(Oi.tablet||Oi.phone){if(Oi.apple.device){const i=e.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(t=!1)}if(Oi.android.device){const i=e.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(t=!1)}}return t?s:4}class Af{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var Iw=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,Rw=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const Ie=class extends Af{constructor(s){super(s),this.setShaderGenerator(),this.geometryClass=uw,this.vertexSize=6,this.state=ln.for2d(),this.size=Ie.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),s.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??Mw(32),this._defaultMaxTextures}static set defaultMaxTextures(s){this._defaultMaxTextures=s}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??Ew(),this._canUploadSameBuffer}static set canUploadSameBuffer(s){this._canUploadSameBuffer=s}get MAX_TEXTURES(){return et("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return Rw}static get defaultFragmentTemplate(){return Iw}setShaderGenerator({vertex:s=Ie.defaultVertexSrc,fragment:t=Ie.defaultFragmentTemplate}={}){this.shaderGenerator=new Aw(s,t)}contextChange(){const s=this.renderer.gl;V.PREFER_ENV===mi.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),Ie.defaultMaxTextures),this.maxTextures=iw(this.maxTextures,s)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:s,_textureArrayPool:t}=Ie,e=this.size/4,i=Math.floor(e/this.maxTextures)+1;for(;s.length<e;)s.push(new nw);for(;t.length<i;)t.push(new Pw);for(let r=0;r<this.maxTextures;r++)this._tempBoundTextures[r]=null}onPrerender(){this._flushId=0}render(s){s._texture.valid&&(this._vertexCount+s.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=s.vertexData.length/2,this._indexCount+=s.indices.length,this._bufferedTextures[this._bufferSize]=s._texture.baseTexture,this._bufferedElements[this._bufferSize++]=s)}buildTexturesAndDrawCalls(){const{_bufferedTextures:s,maxTextures:t}=this,e=Ie._textureArrayPool,i=this.renderer.batch,r=this._tempBoundTextures,n=this.renderer.textureGC.count;let o=++Y._globalBatch,a=0,h=e[0],l=0;i.copyBoundTextures(r,t);for(let c=0;c<this._bufferSize;++c){const u=s[c];s[c]=null,u._batchEnabled!==o&&(h.count>=t&&(i.boundArray(h,r,o,t),this.buildDrawCalls(h,l,c),l=c,h=e[++a],++o),u._batchEnabled=o,u.touched=n,h.elements[h.count++]=u)}h.count>0&&(i.boundArray(h,r,o,t),this.buildDrawCalls(h,l,this._bufferSize),++a,++o);for(let c=0;c<r.length;c++)r[c]=null;Y._globalBatch=o}buildDrawCalls(s,t,e){const{_bufferedElements:i,_attributeBuffer:r,_indexBuffer:n,vertexSize:o}=this,a=Ie._drawCallPool;let h=this._dcIndex,l=this._aIndex,c=this._iIndex,u=a[h];u.start=this._iIndex,u.texArray=s;for(let d=t;d<e;++d){const f=i[d],p=f._texture.baseTexture,m=qb[p.alphaMode?1:0][f.blendMode];i[d]=null,t<d&&u.blend!==m&&(u.size=c-u.start,t=d,u=a[++h],u.texArray=s,u.start=c),this.packInterleavedGeometry(f,r,n,l,c),l+=f.vertexData.length/2*o,c+=f.indices.length,u.blend=m}t<e&&(u.size=c-u.start,++h),this._dcIndex=h,this._aIndex=l,this._iIndex=c}bindAndClearTexArray(s){const t=this.renderer.texture;for(let e=0;e<s.count;e++)t.bind(s.elements[e],s.ids[e]),s.elements[e]=null;s.count=0}updateGeometry(){const{_packedGeometries:s,_attributeBuffer:t,_indexBuffer:e}=this;Ie.canUploadSameBuffer?(s[this._flushId]._buffer.update(t.rawBinaryData),s[this._flushId]._indexBuffer.update(e),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,s[this._flushId]=new this.geometryClass),s[this._flushId]._buffer.update(t.rawBinaryData),s[this._flushId]._indexBuffer.update(e),this.renderer.geometry.bind(s[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const s=this._dcIndex,{gl:t,state:e}=this.renderer,i=Ie._drawCallPool;let r=null;for(let n=0;n<s;n++){const{texArray:o,type:a,size:h,start:l,blend:c}=i[n];r!==o&&(r=o,this.bindAndClearTexArray(o)),this.state.blendMode=c,e.set(this.state),t.drawElements(a,h,t.UNSIGNED_SHORT,l*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Ie.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let s=0;s<this._packedGeometryPoolSize;s++)this._packedGeometries[s]&&this._packedGeometries[s].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(s){const t=ao(Math.ceil(s/8)),e=Nc(t),i=t*8;this._aBuffers.length<=e&&(this._iBuffers.length=e+1);let r=this._aBuffers[i];return r||(this._aBuffers[i]=r=new tw(i*this.vertexSize*4)),r}getIndexBuffer(s){const t=ao(Math.ceil(s/12)),e=Nc(t),i=t*12;this._iBuffers.length<=e&&(this._iBuffers.length=e+1);let r=this._iBuffers[e];return r||(this._iBuffers[e]=r=new Uint16Array(i)),r}packInterleavedGeometry(s,t,e,i,r){const{uint32View:n,float32View:o}=t,a=i/this.vertexSize,h=s.uvs,l=s.indices,c=s.vertexData,u=s._texture.baseTexture._batchLocation,d=Math.min(s.worldAlpha,1),f=d<1&&s._texture.baseTexture.alphaMode?Kb(s._tintRGB,d):s._tintRGB+(d*255<<24);for(let p=0;p<c.length;p+=2)o[i++]=c[p],o[i++]=c[p+1],o[i++]=h[p],o[i++]=h[p+1],n[i++]=f,o[i++]=u;for(let p=0;p<l.length;p++)e[r++]=a+l[p]}};let ke=Ie;ke.defaultBatchSize=4096;ke.extension={name:"batch",type:L.RendererPlugin};ke._drawCallPool=[];ke._textureArrayPool=[];$.add(ke);var kw=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,Bw=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const wr=class extends Lo{constructor(s,t,e){const i=as.from(s||wr.defaultVertexSrc,t||wr.defaultFragmentSrc);super(i,e),this.padding=0,this.resolution=wr.defaultResolution,this.multisample=wr.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new ln}apply(s,t,e,i,r){s.applyFilter(this,t,e,i)}get blendMode(){return this.state.blendMode}set blendMode(s){this.state.blendMode=s}get resolution(){return this._resolution}set resolution(s){this._resolution=s}static get defaultVertexSrc(){return Bw}static get defaultFragmentSrc(){return kw}};let ys=wr;ys.defaultResolution=1;ys.defaultMultisample=bt.NONE;class Pf{constructor(){this.clearBeforeRender=!0,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,1],this._backgroundColorString="#000000",this.color=this._backgroundColor,this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender,t.color&&(this.color=typeof t.color=="string"?jb(t.color):t.color),this.alpha=t.alpha}get color(){return this._backgroundColor}set color(t){this._backgroundColor=t,this._backgroundColorString=Xb(t),Hb(t,this._backgroundColorRgba)}get alpha(){return this._backgroundColorRgba[3]}set alpha(t){this._backgroundColorRgba[3]=t}get colorRgba(){return this._backgroundColorRgba}get colorString(){return this._backgroundColorString}destroy(){}}Pf.extension={type:[L.RendererSystem,L.CanvasRendererSystem],name:"background"};$.add(Pf);class Ef{constructor(t){this.renderer=t,this.emptyRenderer=new Af(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:i}=this.renderer.texture;for(let r=e-1;r>=0;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)}boundArray(t,e,i,r){const{elements:n,ids:o,count:a}=t;let h=0;for(let l=0;l<a;l++){const c=n[l],u=c._batchLocation;if(u>=0&&u<r&&e[u]===c){o[l]=u;continue}for(;h<r;){const d=e[h];if(d&&d._batchEnabled===i&&d._batchLocation===h){h++;continue}o[l]=h,c._batchLocation=h,e[h]=c;break}}}destroy(){this.renderer=null}}Ef.extension={type:L.RendererSystem,name:"batch"};$.add(Ef);let Xc=0;class Mf{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Xc++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,i=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:i,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Xc++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let i;if(V.PREFER_ENV>=mi.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=i||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Mf.extension={type:L.RendererSystem,name:"context"};$.add(Mf);class Lw extends bl{upload(t,e,i){const r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Is.UNPACK);const n=e.realWidth,o=e.realHeight;return i.width===n&&i.height===o?r.texSubImage2D(e.target,0,0,0,n,o,e.format,i.type,this.data):(i.width=n,i.height=o,r.texImage2D(e.target,0,i.internalFormat,n,o,0,e.format,i.type,this.data)),!0}}class Rh{constructor(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Ue("disposeFramebuffer"),this.multisample=bt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new Y(null,{scaleMode:os.NEAREST,resolution:1,mipmap:di.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new Y(new Lw(null,{width:this.width,height:this.height}),{scaleMode:os.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:di.OFF,format:E.DEPTH_COMPONENT,type:K.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){const r=this.colorTextures[i],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){const i=this.depthTexture.resolution;this.depthTexture.setSize(t/i,e/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class If extends Y{constructor(t={}){if(typeof t=="number"){const e=arguments[0],i=arguments[1],r=arguments[2],n=arguments[3];t={width:e,height:i,scaleMode:r,resolution:n}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=bt.NONE),super(null,t),this.mipmap=di.OFF,this.valid=!0,this.clearColor=[0,0,0,0],this.framebuffer=new Rh(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class Ss extends Wr{constructor(t){const e=t,i=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;super(i,r),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,i){i===void 0&&!e.startsWith("data:")?t.crossOrigin=Qb(e):i!==!1&&(t.crossOrigin=typeof i=="string"?i:"anonymous")}upload(t,e,i,r){const n=t.gl,o=e.realWidth,a=e.realHeight;if(r=r||this.source,typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement){if(!r.complete||r.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement&&r.readyState<=1&&r.buffered.length===0)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Is.UNPACK),!this.noSubImage&&e.target===n.TEXTURE_2D&&i.width===o&&i.height===a?n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,i.type,r):(i.width=o,i.height=a,n.texImage2D(e.target,0,i.internalFormat,e.format,i.type,r)),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(e,i),super.update()}dispose(){this.source=null}}class Rf extends Ss{constructor(t,e){if(e=e||{},typeof t=="string"){const i=new Image;Ss.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??V.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,i)=>{const r=this.source;this.url=r.src;const n=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.resize(r.width,r.height),this._load=null,this.createBitmap?e(this.process()):e(this))};r.complete&&r.src?n():(r.onload=n,r.onerror=o=>{i(o),this.onError.emit(o)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,i=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:i?"cors":"no-cors"}).then(r=>r.blob()).then(r=>e(r,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Is.UNPACK?"premultiply":"none"})).then(r=>this.destroyed?Promise.reject():(this.bitmap=r,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,i){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,i,this.bitmap),!this.preserveBitmap){let r=!0;const n=e._glTextures;for(const o in n){const a=n[o];if(a!==i&&a.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class kf{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,i){const r=e.width,n=e.height;if(i){const o=t.width/2/r,a=t.height/2/n,h=t.x/r+o,l=t.y/n+a;i=ut.add(i,ut.NW),this.x0=h+o*ut.uX(i),this.y0=l+a*ut.uY(i),i=ut.add(i,2),this.x1=h+o*ut.uX(i),this.y1=l+a*ut.uY(i),i=ut.add(i,2),this.x2=h+o*ut.uX(i),this.y2=l+a*ut.uY(i),i=ut.add(i,2),this.x3=h+o*ut.uX(i),this.y3=l+a*ut.uY(i)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const jc=new kf;function En(s){s.destroy=function(){},s.on=function(){},s.once=function(){},s.emit=function(){}}let Wi=class ot extends Ze{constructor(t,e,i,r,n,o){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new Bt(0,0,1,1)),t instanceof ot&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this._uvs=jc,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),n===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new be(o.x,o.y):new be(0,0),this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:e}=this.baseTexture;e!=null&&e.url&&We[e.url]&&ot.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,ot.removeFromCache(this),this.textureCacheIds=null}clone(){var r;const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),i=new ot(this.baseTexture,!this.noFrame&&t,e,(r=this.trim)==null?void 0:r.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(i._frame=t),i}updateUvs(){this._uvs===jc&&(this._uvs=new kf),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},i=V.STRICT_TEXTURE_CACHE){const r=typeof t=="string";let n=null;if(r)n=t;else if(t instanceof Y){if(!t.cacheId){const a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${a}-${Vr()}`,Y.addToCache(t,t.cacheId)}n=t.cacheId}else{if(!t._pixiId){const a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${a}_${Vr()}`}n=t._pixiId}let o=We[n];if(r&&i&&!o)throw new Error(`The cacheId "${n}" does not exist in TextureCache.`);return!o&&!(t instanceof Y)?(e.resolution||(e.resolution=ho(t)),o=new ot(new Y(t,e)),o.baseTexture.cacheId=n,Y.addToCache(o.baseTexture,n),ot.addToCache(o,n)):!o&&t instanceof Y&&(o=new ot(t),ot.addToCache(o,n)),o}static fromURL(t,e){const i=Object.assign({autoLoad:!1},e==null?void 0:e.resourceOptions),r=ot.from(t,Object.assign({resourceOptions:i},e),!1),n=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):n.load().then(()=>Promise.resolve(r))}static fromBuffer(t,e,i,r){return new ot(Y.fromBuffer(t,e,i,r))}static fromLoader(t,e,i,r){const n=new Y(t,Object.assign({scaleMode:Y.defaultOptions.scaleMode,resolution:ho(e)},r)),{resource:o}=n;o instanceof Rf&&(o.url=e);const a=new ot(n);return i||(i=e),Y.addToCache(a.baseTexture,i),ot.addToCache(a,i),i!==e&&(Y.addToCache(a.baseTexture,e),ot.addToCache(a,e)),a.baseTexture.valid?Promise.resolve(a):new Promise(h=>{a.baseTexture.once("loaded",()=>h(a))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),We[e]&&We[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),We[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=We[t];if(e){const i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete We[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)We[t.textureCacheIds[e]]===t&&delete We[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:i,width:r,height:n}=t,o=e+r>this.baseTexture.width,a=i+n>this.baseTexture.height;if(o||a){const h=o&&a?"and":"or",l=`X: ${e} + ${r} = ${e+r} > ${this.baseTexture.width}`,c=`Y: ${i} + ${n} = ${i+n} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${l} ${h} ${c}`)}this.valid=r&&n&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return ot._EMPTY||(ot._EMPTY=new ot(new Y),En(ot._EMPTY),En(ot._EMPTY.baseTexture)),ot._EMPTY}static get WHITE(){if(!ot._WHITE){const t=V.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),ot._WHITE=new ot(Y.from(t)),En(ot._WHITE),En(ot._WHITE.baseTexture)}return ot._WHITE}};class Fo extends Wi{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,i=!0){const r=this.baseTexture.resolution,n=Math.round(t*r)/r,o=Math.round(e*r)/r;this.valid=n>0&&o>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=o,i&&this.baseTexture.resize(n,o),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new Fo(new If(t))}}class Bf{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,i=bt.NONE){const r=new If(Object.assign({width:t,height:e,resolution:1,multisample:i},this.textureOptions));return new Fo(r)}getOptimalTexture(t,e,i=1,r=bt.NONE){let n;t=Math.ceil(t*i-1e-6),e=Math.ceil(e*i-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=ao(t),e=ao(e),n=((t&65535)<<16|e&65535)>>>0,r>1&&(n+=r*4294967296)):n=r>1?-r:-1,this.texturePool[n]||(this.texturePool[n]=[]);let o=this.texturePool[n].pop();return o||(o=this.createTexture(t,e,r)),o.filterPoolKey=n,o.setResolution(i),o}getFilterTexture(t,e,i){const r=this.getOptimalTexture(t.width,t.height,e||t.resolution,i||bt.NONE);return r.filterFrame=t.filterFrame,r}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const e in this.texturePool){const i=this.texturePool[e];if(i)for(let r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const i=this.texturePool[e];if(i)for(let r=0;r<i.length;r++)i[r].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}Bf.SCREEN_KEY=-1;class Fw extends Zi{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class Ow extends Zi{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new $t(this.vertices),this.uvBuffer=new $t(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class Uw{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=bt.NONE,this.sourceFrame=new Bt,this.destinationFrame=new Bt,this.bindingSourceFrame=new Bt,this.bindingDestinationFrame=new Bt,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Mn=[new be,new be,new be,new be],Ba=new ue;class Lf{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Bf,this.statePool=[],this.quad=new Fw,this.quadUv=new Ow,this.tempRect=new Bt,this.activeState={},this.globalUniforms=new qe({outputFrame:new Bt,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const i=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new Uw,o=this.renderer.renderTexture;let a=e[0].resolution,h=e[0].multisample,l=e[0].padding,c=e[0].autoFit,u=e[0].legacy??!0;for(let p=1;p<e.length;p++){const m=e[p];a=Math.min(a,m.resolution),h=Math.min(h,m.multisample),l=this.useMaxPadding?Math.max(l,m.padding):l+m.padding,c=c&&m.autoFit,u=u||(m.legacy??!0)}r.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),r.push(n),n.resolution=a,n.multisample=h,n.legacy=u,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(l);const d=this.tempRect.copyFrom(o.sourceFrame);i.projection.transform&&this.transformAABB(Ba.copyFrom(i.projection.transform).invert(),d),c?(n.sourceFrame.fit(d),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(d)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,o.current?o.current.resolution:i.resolution,o.sourceFrame,o.destinationFrame,i.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,a,h),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;const f=this.tempRect;f.x=0,f.y=0,f.width=n.sourceFrame.width,f.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(o.sourceFrame),n.bindingDestinationFrame.copyFrom(o.destinationFrame),n.transform=i.projection.transform,i.projection.transform=null,o.bind(n.renderTexture,n.sourceFrame,f),i.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;const r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;const n=r.inputSize,o=r.inputPixel,a=r.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],o[0]=Math.round(n[0]*e.resolution),o[1]=Math.round(n[1]*e.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=e.sourceFrame.width*n[2]-.5*o[2],a[3]=e.sourceFrame.height*n[3]-.5*o[3],e.legacy){const l=r.filterArea;l[0]=e.destinationFrame.width,l[1]=e.destinationFrame.height,l[2]=e.sourceFrame.x,l[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();const h=t[t.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,e.renderTexture,h.renderTexture,Ws.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let l=e.renderTexture,c=this.getOptimalFilterTexture(l.width,l.height,e.resolution);c.filterFrame=l.filterFrame;let u=0;for(u=0;u<i.length-1;++u){u===1&&e.multisample>1&&(c=this.getOptimalFilterTexture(l.width,l.height,e.resolution),c.filterFrame=l.filterFrame),i[u].apply(this,l,c,Ws.CLEAR,e);const d=l;l=c,c=d}i[u].apply(this,l,h.renderTexture,Ws.BLEND,e),u>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(l),this.returnFilterTexture(c)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=Ws.CLEAR){const{renderTexture:i,state:r}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t!=null&&t.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=t.filterFrame.width,o.height=t.filterFrame.height,i.bind(t,t.filterFrame,o)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const n=r.stateId&1||this.forceClear;(e===Ws.CLEAR||e===Ws.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,i,r){const n=this.renderer;n.state.set(t.state),this.bindAndClear(i,r),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(no.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(no.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:i,destinationFrame:r}=this.activeState,{orig:n}=e._texture,o=t.set(r.width,0,0,r.height,i.x,i.y),a=e.worldTransform.copyTo(ue.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/n.width,1/n.height),o.translate(e.anchor.x,e.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,i=1,r=bt.NONE){return this.texturePool.getOptimalTexture(t,e,i,r)}getFilterTexture(t,e,i){if(typeof t=="number"){const n=t;t=e,e=n}t=t||this.activeState.renderTexture;const r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,i||bt.NONE);return r.filterFrame=t.filterFrame,r}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const i=Mn[0],r=Mn[1],n=Mn[2],o=Mn[3];i.set(e.left,e.top),r.set(e.left,e.bottom),n.set(e.right,e.top),o.set(e.right,e.bottom),t.apply(i,i),t.apply(r,r),t.apply(n,n),t.apply(o,o);const a=Math.min(i.x,r.x,n.x,o.x),h=Math.min(i.y,r.y,n.y,o.y),l=Math.max(i.x,r.x,n.x,o.x),c=Math.max(i.y,r.y,n.y,o.y);e.x=a,e.y=h,e.width=l-a,e.height=c-h}roundFrame(t,e,i,r,n){if(!(t.width<=0||t.height<=0||i.width<=0||i.height<=0)){if(n){const{a:o,b:a,c:h,d:l}=n;if((Math.abs(a)>1e-4||Math.abs(h)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(l)>1e-4))return}n=n?Ba.copyFrom(n):Ba.identity(),n.translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.transformAABB(n,t),t.ceil(e),this.transformAABB(n.invert(),t)}}}Lf.extension={type:L.RendererSystem,name:"filter"};$.add(Lf);class Nw{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=bt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const Dw=new Bt;class Ff{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Rh(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Bt,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;V.PREFER_ENV===mi.WEBGL_LEGACY&&(e=null,i=null),e?t.drawBuffers=r=>e.drawBuffersWEBGL(r):(this.hasMRT=!1,t.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,i=0){const{gl:r}=this;if(t){const n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==i&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=i),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,i)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let o=0;o<t.colorTextures.length;o++){const a=t.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const o=e.width>>i,a=e.height>>i,h=o/e.width;this.setViewport(e.x*h,e.y*h,o,a)}else{const o=t.width>>i,a=t.height>>i;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,i,r){const n=this.viewport;t=Math.round(t),e=Math.round(e),i=Math.round(i),r=Math.round(r),(n.width!==i||n.height!==r||n.x!==t||n.y!==e)&&(n.x=t,n.y=e,n.width=i,n.height=r,this.gl.viewport(t,e,i,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,i,r,n=vh.COLOR|vh.DEPTH){const{gl:o}=this;o.clearColor(t,e,i,r),o.clear(n)}initFramebuffer(t){const{gl:e}=this,i=new Nw(e.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i}resizeFramebuffer(t){const{gl:e}=this,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),i.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));const r=t.colorTextures;let n=r.length;e.drawBuffers||(n=Math.min(n,1));for(let o=0;o<n;o++){const a=r[o],h=a.parentTextureArray||a;this.renderer.texture.bind(h,0),o===0&&i.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,i.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:i}=this,r=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures;let o=n.length;i.drawBuffers||(o=Math.min(o,1)),r.multisample>1&&this.canMultisampleFramebuffer(t)?r.msaaBuffer=r.msaaBuffer||i.createRenderbuffer():r.msaaBuffer&&(i.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));const a=[];for(let h=0;h<o;h++){const l=n[h],c=l.parentTextureArray||l;this.renderer.texture.bind(c,0),h===0&&r.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,r.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,r.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+h,l.target,c._glTextures[this.CONTEXT_UID].texture,e),a.push(i.COLOR_ATTACHMENT0+h))}if(a.length>1&&i.drawBuffers(a),t.depthTexture&&this.writeDepthTexture){const l=t.depthTexture;this.renderer.texture.bind(l,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,e)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(r.stencil=r.stencil||i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,r.stencil),r.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,r.multisample,i.DEPTH24_STENCIL8,t.width,t.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,r.stencil)):r.stencil&&(i.deleteRenderbuffer(r.stencil),r.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let i=bt.NONE;if(t<=1||e===null)return i;for(let r=0;r<e.length;r++)if(e[r]<=t){i=e[r];break}return i===1&&(i=bt.NONE),i}blit(t,e,i){const{current:r,renderer:n,gl:o,CONTEXT_UID:a}=this;if(n.context.webGLVersion!==2||!r)return;const h=r.glFramebuffers[a];if(!h)return;if(!t){if(!h.msaaBuffer)return;const c=r.colorTextures[0];if(!c)return;h.blitFramebuffer||(h.blitFramebuffer=new Rh(r.width,r.height),h.blitFramebuffer.addColorTexture(0,c)),t=h.blitFramebuffer,t.colorTextures[0]!==c&&(t.colorTextures[0]=c,t.dirtyId++,t.dirtyFormat++),(t.width!==r.width||t.height!==r.height)&&(t.width=r.width,t.height=r.height,t.dirtyId++,t.dirtySize++)}e||(e=Dw,e.width=r.width,e.height=r.height),i||(i=e);const l=e.width===i.width&&e.height===i.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,h.framebuffer),o.blitFramebuffer(e.left,e.top,e.right,e.bottom,i.left,i.top,i.right,i.bottom,o.COLOR_BUFFER_BIT,l?o.NEAREST:o.LINEAR)}disposeFramebuffer(t,e){const i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!i)return;delete t.glFramebuffers[this.CONTEXT_UID];const n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&r.deleteRenderbuffer(i.msaaBuffer),i.stencil&&r.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&i.blitFramebuffer.dispose()}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil)return;t.stencil=!0;const i=t.width,r=t.height,n=this.gl,o=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,o),e.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,e.multisample,n.DEPTH24_STENCIL8,i,r):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,i,r),e.stencil=o,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new Bt}destroy(){this.renderer=null}}Ff.extension={type:L.RendererSystem,name:"framebuffer"};$.add(Ff);const La={5126:4,5123:2,5121:1};class Of{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;V.PREFER_ENV===mi.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=()=>i.createVertexArrayOES(),t.bindVertexArray=r=>i.bindVertexArrayOES(r),t.deleteVertexArray=r=>i.deleteVertexArrayOES(r)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){const i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=(r,n)=>i.vertexAttribDivisorANGLE(r,n),t.drawElementsInstanced=(r,n,o,a,h)=>i.drawElementsInstancedANGLE(r,n,o,a,h),t.drawArraysInstanced=(r,n,o,a)=>i.drawArraysInstancedANGLE(r,n,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:i}=this;let r=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={},n=!0);const o=r[e.program.id]||this.initGeometryVao(t,e,n);this._activeGeometry=t,this._activeVao!==o&&(this._activeVao=o,this.hasVao?i.bindVertexArray(o):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let i=0;i<t.buffers.length;i++){const r=t.buffers[i];e.update(r)}}checkCompatibility(t,e){const i=t.attributes,r=e.attributeData;for(const n in r)if(!i[n])throw new Error(`shader and geometry incompatible, geometry missing the "${n}" attribute`)}getSignature(t,e){const i=t.attributes,r=e.attributeData,n=["g",t.id];for(const o in i)r[o]&&n.push(o,r[o].location);return n.join("-")}initGeometryVao(t,e,i=!0){const r=this.gl,n=this.CONTEXT_UID,o=this.renderer.buffer,a=e.program;a.glPrograms[n]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,a);const h=this.getSignature(t,a),l=t.glVertexArrayObjects[this.CONTEXT_UID];let c=l[h];if(c)return l[a.id]=c,c;const u=t.buffers,d=t.attributes,f={},p={};for(const m in u)f[m]=0,p[m]=0;for(const m in d)!d[m].size&&a.attributeData[m]?d[m].size=a.attributeData[m].size:d[m].size||console.warn(`PIXI Geometry attribute '${m}' size cannot be determined (likely the bound shader does not have the attribute)`),f[d[m].buffer]+=d[m].size*La[d[m].type];for(const m in d){const _=d[m],x=_.size;_.stride===void 0&&(f[_.buffer]===x*La[_.type]?_.stride=0:_.stride=f[_.buffer]),_.start===void 0&&(_.start=p[_.buffer],p[_.buffer]+=x*La[_.type])}c=r.createVertexArray(),r.bindVertexArray(c);for(let m=0;m<u.length;m++){const _=u[m];o.bind(_),i&&_._glBuffers[n].refCount++}return this.activateVao(t,a),l[a.id]=c,l[h]=c,r.bindVertexArray(null),o.unbind(Ye.ARRAY_BUFFER),c}disposeGeometry(t,e){var a;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(t.disposeRunner.remove(this),!!i){if(o)for(let h=0;h<n.length;h++){const l=n[h]._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!e&&o.dispose(n[h],e))}if(!e){for(const h in i)if(h[0]==="g"){const l=i[h];this._activeVao===l&&this.unbind(),r.deleteVertexArray(l)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t)}activateVao(t,e){const i=this.gl,r=this.CONTEXT_UID,n=this.renderer.buffer,o=t.buffers,a=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);let h=null;for(const l in a){const c=a[l],u=o[c.buffer],d=u._glBuffers[r];if(e.attributeData[l]){h!==d&&(n.bind(u),h=d);const f=e.attributeData[l].location;if(i.enableVertexAttribArray(f),i.vertexAttribPointer(f,c.size,c.type||i.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)i.vertexAttribDivisor(f,c.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,i,r){const{gl:n}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,h=a===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?n.drawElementsInstanced(t,e||o.indexBuffer.data.length,h,(i||0)*a,r||1):n.drawElements(t,e||o.indexBuffer.data.length,h,(i||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?n.drawArraysInstanced(t,i,e||o.getSize(),r||1):n.drawArrays(t,i,e||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}Of.extension={type:L.RendererSystem,name:"geometry"};$.add(Of);const Yc=new ue;let $w=class{constructor(t,e){this._texture=t,this.mapCoord=new ue,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);const i=this.mapCoord;for(let r=0;r<t.length;r+=2){const n=t[r],o=t[r+1];e[r]=n*i.a+o*i.c+i.tx,e[r+1]=n*i.b+o*i.d+i.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);const r=e.orig,n=e.trim;n&&(Yc.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Yc));const o=e.baseTexture,a=this.uClampFrame,h=this.clampMargin/o.resolution,l=this.clampOffset;return a[0]=(e._frame.x+h+l)/o.width,a[1]=(e._frame.y+h+l)/o.height,a[2]=(e._frame.x+e._frame.width-h+l)/o.width,a[3]=(e._frame.y+e._frame.height-h+l)/o.height,this.uClampOffset[0]=l/o.realWidth,this.uClampOffset[1]=l/o.realHeight,this.isSimple=e._frame.width===o.width&&e._frame.height===o.height&&e.rotate===0,!0}};var Gw=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,Vw=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class Ww extends ys{constructor(t,e,i){let r=null;typeof t!="string"&&e===void 0&&i===void 0&&(r=t,t=void 0,e=void 0,i=void 0),super(t||Vw,e||Gw,i),this.maskSprite=r,this.maskMatrix=new ue}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,i,r){const n=this._maskSprite,o=n._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new $w(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,e,i,r))}}class zw{constructor(t=null){this.type=Pt.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=ys.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=Pt.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Uf{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let i=e;if(!i.isMaskData){const n=this.maskDataPool.pop()||new zw;n.pooled=!0,n.maskObject=e,i=n}const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(r),i._colorMask=r?r._colorMask:15,i.autoDetect&&this.detect(i),i._target=t,i.type!==Pt.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case Pt.SCISSOR:this.renderer.scissor.push(i);break;case Pt.STENCIL:this.renderer.stencil.push(i);break;case Pt.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case Pt.COLOR:this.pushColorMask(i);break}i.type===Pt.SPRITE&&this.maskStack.push(i)}pop(t){const e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case Pt.SCISSOR:this.renderer.scissor.pop(e);break;case Pt.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Pt.SPRITE:this.popSpriteMask(e);break;case Pt.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){const i=this.maskStack[this.maskStack.length-1];i.type===Pt.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=Pt.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=Pt.SCISSOR:t.type=Pt.STENCIL:t.type=Pt.COLOR}pushSpriteMask(t){const{maskObject:e}=t,i=t._target;let r=t._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new Ww]));const n=this.renderer,o=n.renderTexture;let a,h;if(o.current){const c=o.current;a=t.resolution||c.resolution,h=t.multisample??c.multisample}else a=t.resolution||n.resolution,h=t.multisample??n.multisample;r[0].resolution=a,r[0].multisample=h,r[0].maskSprite=e;const l=i.filterArea;i.filterArea=e.getBounds(!0),n.filter.push(i,r),i.filterArea=l,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,i=t._colorMask=e&t.colorMask;i!==e&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(t){const e=t._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==e&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}}Uf.extension={type:L.RendererSystem,name:"mask"};$.add(Uf);class Nf{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,i=this.getStackLength();this.maskStack=t;const r=this.getStackLength();r!==i&&(r===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const qc=new ue,Kc=[],zn=class extends Nf{constructor(s){super(s),this.glConst=V.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const s=this.maskStack[this.maskStack.length-1];return s?s._scissorCounter:0}calcScissorRect(s){if(s._scissorRectLocal)return;const t=s._scissorRect,{maskObject:e}=s,{renderer:i}=this,r=i.renderTexture,n=e.getBounds(!0,Kc.pop()??new Bt);this.roundFrameToPixels(n,r.current?r.current.resolution:i.resolution,r.sourceFrame,r.destinationFrame,i.projection.transform),t&&n.fit(t),s._scissorRectLocal=n}static isMatrixRotated(s){if(!s)return!1;const{a:t,b:e,c:i,d:r}=s;return(Math.abs(e)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(r)>1e-4)}testScissor(s){const{maskObject:t}=s;if(!t.isFastRect||!t.isFastRect()||zn.isMatrixRotated(t.worldTransform)||zn.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(s);const e=s._scissorRectLocal;return e.width>0&&e.height>0}roundFrameToPixels(s,t,e,i,r){zn.isMatrixRotated(r)||(r=r?qc.copyFrom(r):qc.identity(),r.translate(-e.x,-e.y).scale(i.width/e.width,i.height/e.height).translate(i.x,i.y),this.renderer.filter.transformAABB(r,s),s.fit(i),s.x=Math.round(s.x*t),s.y=Math.round(s.y*t),s.width=Math.round(s.width*t),s.height=Math.round(s.height*t))}push(s){s._scissorRectLocal||this.calcScissorRect(s);const{gl:t}=this.renderer;s._scissorRect||t.enable(t.SCISSOR_TEST),s._scissorCounter++,s._scissorRect=s._scissorRectLocal,this._useCurrent()}pop(s){const{gl:t}=this.renderer;s&&Kc.push(s._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const s=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=s.y:t=this.renderer.height-s.height-s.y,this.renderer.gl.scissor(s.x,t,s.width,s.height)}};let Df=zn;Df.extension={type:L.RendererSystem,name:"scissor"};$.add(Df);class $f extends Nf{constructor(t){super(t),this.glConst=V.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:i}=this.renderer,r=t._stencilCounter;r===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),t._stencilCounter++;const n=t._colorMask;n!==0&&(t._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,r,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,n!==0&&(t._colorMask=n,i.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}pop(t){const e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,r=i?i._colorMask:15;r!==0&&(i._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,r!==0&&(i._colorMask=r,e.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}$f.extension={type:L.RendererSystem,name:"stencil"};$.add($f);class Gf{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return et("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return et("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return et("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(t){for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}Gf.extension={type:[L.RendererSystem,L.CanvasRendererSystem],name:"_plugin"};$.add(Gf);class Vf{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new ue,this.transform=null}update(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);const n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(t,e,i,r){const n=this.projectionMatrix,o=r?-1:1;n.identity(),n.a=1/e.width*2,n.d=o*(1/e.height*2),n.tx=-1-e.x*n.a,n.ty=-o-e.y*n.d}setTransform(t){}destroy(){this.renderer=null}}Vf.extension={type:L.RendererSystem,name:"projection"};$.add(Vf);const Hw=new wf;class Wf{constructor(t){this.renderer=t,this._tempMatrix=new ue}generateTexture(t,e){const{region:i,...r}=e||{},n=i||t.getLocalBounds(null,!0);n.width===0&&(n.width=1),n.height===0&&(n.height=1);const o=Fo.create({width:n.width,height:n.height,...r});this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;const a=t.transform;return t.transform=Hw,this.renderer.render(t,{renderTexture:o,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=a,o}destroy(){}}Wf.extension={type:[L.RendererSystem,L.CanvasRendererSystem],name:"textureGenerator"};$.add(Wf);const Fs=new Bt,pr=new Bt;class zf{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Bt,this.destinationFrame=new Bt,this.viewportFrame=new Bt}bind(t=null,e,i){const r=this.renderer;this.current=t;let n,o,a;t?(n=t.baseTexture,a=n.resolution,e||(Fs.width=t.frame.width,Fs.height=t.frame.height,e=Fs),i||(pr.x=t.frame.x,pr.y=t.frame.y,pr.width=e.width,pr.height=e.height,i=pr),o=n.framebuffer):(a=r.resolution,e||(Fs.width=r._view.screen.width,Fs.height=r._view.screen.height,e=Fs),i||(i=Fs,i.width=e.width,i.height=e.height));const h=this.viewportFrame;h.x=i.x*a,h.y=i.y*a,h.width=i.width*a,h.height=i.height*a,t||(h.y=r.view.height-(h.y+h.height)),h.ceil(),this.renderer.framebuffer.bind(o,h),this.renderer.projection.update(i,e,a,!o),t?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(i)}clear(t,e){this.current?t=t||this.current.baseTexture.clearColor:t=t||this.renderer.background.colorRgba;const i=this.destinationFrame,r=this.current?this.current.baseTexture:this.renderer._view.screen,n=i.width!==r.width||i.height!==r.height;if(n){let{x:o,y:a,width:h,height:l}=this.viewportFrame;o=Math.round(o),a=Math.round(a),h=Math.round(h),l=Math.round(l),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(o,a,h,l)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),n&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}zf.extension={type:L.RendererSystem,name:"renderTexture"};$.add(zf);class Xw{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function jw(s,t){const e={},i=t.getProgramParameter(s,t.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const n=t.getActiveAttrib(s,r);if(n.name.startsWith("gl_"))continue;const o=Sf(t,n.type),a={type:o,name:n.name,size:Cf(o),location:t.getAttribLocation(s,n.name)};e[n.name]=a}return e}function Yw(s,t){const e={},i=t.getProgramParameter(s,t.ACTIVE_UNIFORMS);for(let r=0;r<i;r++){const n=t.getActiveUniform(s,r),o=n.name.replace(/\[.*?\]$/,""),a=!!n.name.match(/\[.*?\]$/),h=Sf(t,n.type);e[o]={name:o,index:r,type:h,size:n.size,isArray:a,value:vf(h,n.size)}}return e}function qw(s,t){var h;const e=Vc(s,s.VERTEX_SHADER,t.vertexSrc),i=Vc(s,s.FRAGMENT_SHADER,t.fragmentSrc),r=s.createProgram();s.attachShader(r,e),s.attachShader(r,i);const n=(h=t.extra)==null?void 0:h.transformFeedbackVaryings;if(n&&(typeof s.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):s.transformFeedbackVaryings(r,n.names,n.bufferMode==="separate"?s.SEPARATE_ATTRIBS:s.INTERLEAVED_ATTRIBS)),s.linkProgram(r),s.getProgramParameter(r,s.LINK_STATUS)||ww(s,r,e,i),t.attributeData=jw(r,s),t.uniformData=Yw(r,s),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const l=Object.keys(t.attributeData);l.sort((c,u)=>c>u?1:-1);for(let c=0;c<l.length;c++)t.attributeData[l[c]].location=c,s.bindAttribLocation(r,c,l[c]);s.linkProgram(r)}s.deleteShader(e),s.deleteShader(i);const o={};for(const l in t.uniformData){const c=t.uniformData[l];o[l]={location:s.getUniformLocation(r,l),value:vf(c.type,c.size)}}return new Xw(r,o)}function Kw(s,t,e,i,r){e.buffer.update(r)}const Zw={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Hf={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function Jw(s){const t=s.map(n=>({data:n,offset:0,dataLen:0,dirty:0}));let e=0,i=0,r=0;for(let n=0;n<t.length;n++){const o=t[n];if(e=Hf[o.data.type],o.data.size>1&&(e=Math.max(e,16)*o.data.size),o.dataLen=e,i%e!==0&&i<16){const a=i%e%16;i+=a,r+=a}i+e>16?(r=Math.ceil(r/16)*16,o.offset=r,r+=e,i=e):(o.offset=r,i+=e,r+=e)}return r=Math.ceil(r/16)*16,{uboElements:t,size:r}}function Qw(s,t){const e=[];for(const i in s)t[i]&&e.push(t[i]);return e.sort((i,r)=>i.index-r.index),e}function tv(s,t){if(!s.autoManage)return{size:0,syncFunc:Kw};const e=Qw(s.uniforms,t),{uboElements:i,size:r}=Jw(e),n=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<i.length;o++){const a=i[o],h=s.uniforms[a.data.name],l=a.data.name;let c=!1;for(let u=0;u<Vi.length;u++){const d=Vi[u];if(d.codeUbo&&d.test(a.data,h)){n.push(`offset = ${a.offset/4};`,Vi[u].codeUbo(a.data.name,h)),c=!0;break}}if(!c)if(a.data.size>1){const u=Cf(a.data.type),d=Math.max(Hf[a.data.type]/16,1),f=u/d,p=(4-f%4)%4;n.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*d}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${p};
                }

                `)}else{const u=Zw[a.data.type];n.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${a.offset/4};
                ${u};
                `)}}return n.push(`
       renderer.buffer.update(buffer);
    `),{size:r,syncFunc:new Function("ud","uv","renderer","syncData","buffer",n.join(`
`))}}let ev=0;const In={textureCount:0,uboCount:0};class Xf{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=ev++}systemCheck(){if(!Tw())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),e||(In.textureCount=0,In.uboCount=0,this.syncUniformGroup(t.uniformGroup,In)),r}setUniforms(t){const e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)}syncUniformGroup(t,e){const i=this.getGlProgram();(!t.static||t.dirtyId!==i.uniformDirtyGroups[t.id])&&(i.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,e))}syncUniforms(t,e,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,i)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=yw(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const i=this.getGlProgram();if(!t.static||t.dirtyId!==0||!i.uniformGroups[t.id]){t.dirtyId=0;const r=i.uniformGroups[t.id]||this.createSyncBufferGroup(t,i,e);t.buffer.update(),r(i.uniformData,t.uniforms,this.renderer,In,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,i.uniformBufferBindings[e])}createSyncBufferGroup(t,e,i){const{gl:r}=this.renderer;this.renderer.buffer.bind(t.buffer);const n=this.gl.getUniformBlockIndex(e.program,i);e.uniformBufferBindings[i]=this.shader.uniformBindCount,r.uniformBlockBinding(e.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(t,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=tv(t,this.shader.program.uniformData)),t.autoManage){const h=new Float32Array(a.size/4);t.buffer.update(h)}return e.uniformGroups[t.id]=a.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,i){const r=t.uniforms,n=[`${i}-`];for(const o in r)n.push(o),e[o]&&n.push(e[o].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,i=t.program,r=qw(e,i);return i.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}Xf.extension={type:L.RendererSystem,name:"shader"};$.add(Xf);class jf{constructor(t){this.renderer=t}run(t){const e=this.renderer;e.emitWithCustomOptions(e.runners.init,t),t.hello&&console.log(`PixiJS 7.1.2 - ${e.rendererLogId} - https://pixijs.com`),e.resize(this.renderer.screen.width,this.renderer.screen.height)}destroy(){}}jf.extension={type:[L.RendererSystem,L.CanvasRendererSystem],name:"startup"};$.add(jf);function sv(s,t=[]){return t[N.NORMAL]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[N.ADD]=[s.ONE,s.ONE],t[N.MULTIPLY]=[s.DST_COLOR,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[N.SCREEN]=[s.ONE,s.ONE_MINUS_SRC_COLOR,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[N.OVERLAY]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[N.DARKEN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[N.LIGHTEN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[N.COLOR_DODGE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[N.COLOR_BURN]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[N.HARD_LIGHT]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[N.SOFT_LIGHT]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[N.DIFFERENCE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[N.EXCLUSION]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[N.HUE]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[N.SATURATION]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[N.COLOR]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[N.LUMINOSITY]=[s.ONE,s.ONE_MINUS_SRC_ALPHA],t[N.NONE]=[0,0],t[N.NORMAL_NPM]=[s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[N.ADD_NPM]=[s.SRC_ALPHA,s.ONE,s.ONE,s.ONE],t[N.SCREEN_NPM]=[s.SRC_ALPHA,s.ONE_MINUS_SRC_COLOR,s.ONE,s.ONE_MINUS_SRC_ALPHA],t[N.SRC_IN]=[s.DST_ALPHA,s.ZERO],t[N.SRC_OUT]=[s.ONE_MINUS_DST_ALPHA,s.ZERO],t[N.SRC_ATOP]=[s.DST_ALPHA,s.ONE_MINUS_SRC_ALPHA],t[N.DST_OVER]=[s.ONE_MINUS_DST_ALPHA,s.ONE],t[N.DST_IN]=[s.ZERO,s.SRC_ALPHA],t[N.DST_OUT]=[s.ZERO,s.ONE_MINUS_SRC_ALPHA],t[N.DST_ATOP]=[s.ONE_MINUS_DST_ALPHA,s.SRC_ALPHA],t[N.XOR]=[s.ONE_MINUS_DST_ALPHA,s.ONE_MINUS_SRC_ALPHA],t[N.SUBTRACT]=[s.ONE,s.ONE,s.ONE,s.ONE,s.FUNC_REVERSE_SUBTRACT,s.FUNC_ADD],t}const iv=0,rv=1,nv=2,ov=3,av=4,hv=5,kh=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=N.NONE,this._blendEq=!1,this.map=[],this.map[iv]=this.setBlend,this.map[rv]=this.setOffset,this.map[nv]=this.setCullFace,this.map[ov]=this.setDepthTest,this.map[av]=this.setFrontFace,this.map[hv]=this.setDepthMask,this.checks=[],this.defaultState=new ln,this.defaultState.blend=!0}contextChange(s){this.gl=s,this.blendModes=sv(s),this.set(this.defaultState),this.reset()}set(s){if(s=s||this.defaultState,this.stateId!==s.data){let t=this.stateId^s.data,e=0;for(;t;)t&1&&this.map[e].call(this,!!(s.data&1<<e)),t=t>>1,e++;this.stateId=s.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,s)}forceState(s){s=s||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(s.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,s);this.stateId=s.data}setBlend(s){this.updateCheck(kh.checkBlendMode,s),this.gl[s?"enable":"disable"](this.gl.BLEND)}setOffset(s){this.updateCheck(kh.checkPolygonOffset,s),this.gl[s?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(s){this.gl[s?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(s){this.gl.depthMask(s)}setCullFace(s){this.gl[s?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(s){this.gl.frontFace(this.gl[s?"CW":"CCW"])}setBlendMode(s){if(s===this.blendMode)return;this.blendMode=s;const t=this.blendModes[s],e=this.gl;t.length===2?e.blendFunc(t[0],t[1]):e.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,e.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD))}setPolygonOffset(s,t){this.gl.polygonOffset(s,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(s,t){const e=this.checks.indexOf(s);t&&e===-1?this.checks.push(s):!t&&e!==-1&&this.checks.splice(e,1)}static checkBlendMode(s,t){s.setBlendMode(t.blendMode)}static checkPolygonOffset(s,t){s.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};let Yf=kh;Yf.extension={type:L.RendererSystem,name:"state"};$.add(Yf);class lv extends Ze{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(r=>t.systems[r]),i=[...e,...Object.keys(t.systems).filter(r=>!e.includes(r))];for(const r of i)this.addSystem(t.systems[r],r)}addRunners(...t){t.forEach(e=>{this.runners[e]=new Ue(e)})}addSystem(t,e){const i=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=i,this._systemsHash[e]=i;for(const r in this.runners)this.runners[r].add(i);return this}emitWithCustomOptions(t,e){const i=Object.keys(this._systemsHash);t.items.forEach(r=>{const n=i.find(o=>this._systemsHash[o]===r);r[t.name](e[n])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const Hn=class{constructor(s){this.renderer=s,this.count=0,this.checkCount=0,this.maxIdle=Hn.defaultMaxIdle,this.checkCountMax=Hn.defaultCheckCountMax,this.mode=Hn.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==xl.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const s=this.renderer.texture,t=s.managedTextures;let e=!1;for(let i=0;i<t.length;i++){const r=t[i];!r.framebuffer&&this.count-r.touched>this.maxIdle&&(s.destroyTexture(r,!0),t[i]=null,e=!0)}if(e){let i=0;for(let r=0;r<t.length;r++)t[r]!==null&&(t[i++]=t[r]);t.length=i}}unload(s){const t=this.renderer.texture,e=s._texture;e&&!e.framebuffer&&t.destroyTexture(e);for(let i=s.children.length-1;i>=0;i--)this.unload(s.children[i])}destroy(){this.renderer=null}};let Be=Hn;Be.defaultMode=xl.AUTO;Be.defaultMaxIdle=60*60;Be.defaultCheckCountMax=60*10;Be.extension={type:L.RendererSystem,name:"textureGC"};$.add(Be);class Fa{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=K.UNSIGNED_BYTE,this.internalFormat=E.RGBA,this.samplerType=0}}function cv(s){let t;return"WebGL2RenderingContext"in globalThis&&s instanceof globalThis.WebGL2RenderingContext?t={[K.UNSIGNED_BYTE]:{[E.RGBA]:s.RGBA8,[E.RGB]:s.RGB8,[E.RG]:s.RG8,[E.RED]:s.R8,[E.RGBA_INTEGER]:s.RGBA8UI,[E.RGB_INTEGER]:s.RGB8UI,[E.RG_INTEGER]:s.RG8UI,[E.RED_INTEGER]:s.R8UI,[E.ALPHA]:s.ALPHA,[E.LUMINANCE]:s.LUMINANCE,[E.LUMINANCE_ALPHA]:s.LUMINANCE_ALPHA},[K.BYTE]:{[E.RGBA]:s.RGBA8_SNORM,[E.RGB]:s.RGB8_SNORM,[E.RG]:s.RG8_SNORM,[E.RED]:s.R8_SNORM,[E.RGBA_INTEGER]:s.RGBA8I,[E.RGB_INTEGER]:s.RGB8I,[E.RG_INTEGER]:s.RG8I,[E.RED_INTEGER]:s.R8I},[K.UNSIGNED_SHORT]:{[E.RGBA_INTEGER]:s.RGBA16UI,[E.RGB_INTEGER]:s.RGB16UI,[E.RG_INTEGER]:s.RG16UI,[E.RED_INTEGER]:s.R16UI,[E.DEPTH_COMPONENT]:s.DEPTH_COMPONENT16},[K.SHORT]:{[E.RGBA_INTEGER]:s.RGBA16I,[E.RGB_INTEGER]:s.RGB16I,[E.RG_INTEGER]:s.RG16I,[E.RED_INTEGER]:s.R16I},[K.UNSIGNED_INT]:{[E.RGBA_INTEGER]:s.RGBA32UI,[E.RGB_INTEGER]:s.RGB32UI,[E.RG_INTEGER]:s.RG32UI,[E.RED_INTEGER]:s.R32UI,[E.DEPTH_COMPONENT]:s.DEPTH_COMPONENT24},[K.INT]:{[E.RGBA_INTEGER]:s.RGBA32I,[E.RGB_INTEGER]:s.RGB32I,[E.RG_INTEGER]:s.RG32I,[E.RED_INTEGER]:s.R32I},[K.FLOAT]:{[E.RGBA]:s.RGBA32F,[E.RGB]:s.RGB32F,[E.RG]:s.RG32F,[E.RED]:s.R32F,[E.DEPTH_COMPONENT]:s.DEPTH_COMPONENT32F},[K.HALF_FLOAT]:{[E.RGBA]:s.RGBA16F,[E.RGB]:s.RGB16F,[E.RG]:s.RG16F,[E.RED]:s.R16F},[K.UNSIGNED_SHORT_5_6_5]:{[E.RGB]:s.RGB565},[K.UNSIGNED_SHORT_4_4_4_4]:{[E.RGBA]:s.RGBA4},[K.UNSIGNED_SHORT_5_5_5_1]:{[E.RGBA]:s.RGB5_A1},[K.UNSIGNED_INT_2_10_10_10_REV]:{[E.RGBA]:s.RGB10_A2,[E.RGBA_INTEGER]:s.RGB10_A2UI},[K.UNSIGNED_INT_10F_11F_11F_REV]:{[E.RGB]:s.R11F_G11F_B10F},[K.UNSIGNED_INT_5_9_9_9_REV]:{[E.RGB]:s.RGB9_E5},[K.UNSIGNED_INT_24_8]:{[E.DEPTH_STENCIL]:s.DEPTH24_STENCIL8},[K.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[E.DEPTH_STENCIL]:s.DEPTH32F_STENCIL8}}:t={[K.UNSIGNED_BYTE]:{[E.RGBA]:s.RGBA,[E.RGB]:s.RGB,[E.ALPHA]:s.ALPHA,[E.LUMINANCE]:s.LUMINANCE,[E.LUMINANCE_ALPHA]:s.LUMINANCE_ALPHA},[K.UNSIGNED_SHORT_5_6_5]:{[E.RGB]:s.RGB},[K.UNSIGNED_SHORT_4_4_4_4]:{[E.RGBA]:s.RGBA},[K.UNSIGNED_SHORT_5_5_5_1]:{[E.RGBA]:s.RGBA}},t}class qf{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Y,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=cv(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};const i=new Fa(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Fa(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let r=0;r<6;r++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let r=0;r<this.boundTextures.length;r++)this.bind(null,r)}bind(t,e=0){const{gl:i}=this;if(t=t==null?void 0:t.castToBaseTexture(),t!=null&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.updateTexture(t)):r.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(let r=0;r<i.length;r++)i[r]===t&&(this.currentLocation!==r&&(e.activeTexture(e.TEXTURE0+r),this.currentLocation=r),e.bindTexture(t.target,this.emptyTextures[t.target].texture),i[r]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:i,CONTEXT_UID:r}=this;if(i)for(let n=t-1;n>=0;--n){const o=e[n];o&&o._glTextures[r].samplerType!==Th.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(t){const e=new Fa(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var i;e.internalFormat=((i=this.internalFormats[t.type])==null?void 0:i[t.format])??t.format,this.webGLVersion===2&&t.type===K.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var r;const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const i=this.renderer;if(this.initTextureType(t,e),(r=t.resource)!=null&&r.upload(i,t,e))e.samplerType!==Th.FLOAT&&(this.hasIntegerTextures=!0);else{const n=t.realWidth,o=t.realHeight,a=i.gl;(e.width!==n||e.height!==o||e.dirtyId<0)&&(e.width=n,e.height=o,a.texImage2D(t.target,0,e.internalFormat,n,o,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:i}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const r=this.managedTextures.indexOf(t);r!==-1&&Zb(this.managedTextures,r,1)}}updateTextureStyle(t){var i;const e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===di.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=yl.CLAMP:e.wrapMode=t.wrapMode,(i=t.resource)!=null&&i.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const i=this.gl;if(e.mipmap&&t.mipmap!==di.ON_MANUAL&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===os.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);const r=this.renderer.context.extensions.anisotropicFiltering;if(r&&t.anisotropicLevel>0&&t.scaleMode===os.LINEAR){const n=Math.min(t.anisotropicLevel,i.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===os.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===os.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}}qf.extension={type:L.RendererSystem,name:"texture"};$.add(qf);class Kf{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:i}=this,r=t._glTransformFeedbacks[i]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,r)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:i,renderer:r}=this;e&&r.shader.bind(e),i.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:i,CONTEXT_UID:r}=this,n=e.createTransformFeedback();t._glTransformFeedbacks[r]=n,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,n);for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];a&&(i.buffer.update(a),a._glBuffers[r].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[r].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),n}disposeTransformFeedback(t,e){const i=t._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this);const n=this.renderer.buffer;if(n)for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];if(!a)continue;const h=a._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!e&&n.dispose(a,e))}i&&(e||r.deleteTransformFeedback(i),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}Kf.extension={type:L.RendererSystem,name:"transformFeedback"};$.add(Kf);class Zf{constructor(t){this.renderer=t}init(t){this.screen=new Bt(0,0,t.width,t.height),this.element=t.view||V.ADAPTER.createCanvas(),this.resolution=t.resolution||V.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const i=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=i,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${r}px`),this.renderer.emit("resize",i,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&((e=this.element.parentNode)==null||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}Zf.extension={type:[L.RendererSystem,L.CanvasRendererSystem],name:"_view"};$.add(Zf);V.PREFER_ENV=mi.WEBGL2;V.STRICT_TEXTURE_CACHE=!1;Object.defineProperties(V,{WRAP_MODE:{get(){return Y.defaultOptions.wrapMode},set(s){et("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),Y.defaultOptions.wrapMode=s}},SCALE_MODE:{get(){return Y.defaultOptions.scaleMode},set(s){et("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),Y.defaultOptions.scaleMode=s}},MIPMAP_TEXTURES:{get(){return Y.defaultOptions.mipmap},set(s){et("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),Y.defaultOptions.mipmap=s}},ANISOTROPIC_LEVEL:{get(){return Y.defaultOptions.anisotropicLevel},set(s){et("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),Y.defaultOptions.anisotropicLevel=s}},FILTER_RESOLUTION:{get(){return et("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),ys.defaultResolution},set(s){ys.defaultResolution=s}},FILTER_MULTISAMPLE:{get(){return et("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),ys.defaultMultisample},set(s){ys.defaultMultisample=s}},SPRITE_MAX_TEXTURES:{get(){return ke.defaultMaxTextures},set(s){et("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),ke.defaultMaxTextures=s}},SPRITE_BATCH_SIZE:{get(){return ke.defaultBatchSize},set(s){et("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),ke.defaultBatchSize=s}},CAN_UPLOAD_SAME_BUFFER:{get(){return ke.canUploadSameBuffer},set(s){et("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),ke.canUploadSameBuffer=s}},GC_MODE:{get(){return Be.defaultMode},set(s){et("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),Be.defaultMode=s}},GC_MAX_IDLE:{get(){return Be.defaultMaxIdle},set(s){et("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),Be.defaultMaxIdle=s}},GC_MAX_CHECK_COUNT:{get(){return Be.defaultCheckCountMax},set(s){et("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),Be.defaultCheckCountMax=s}},PRECISION_VERTEX:{get(){return as.defaultVertexPrecision},set(s){et("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),as.defaultVertexPrecision=s}},PRECISION_FRAGMENT:{get(){return as.defaultFragmentPrecision},set(s){et("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),as.defaultFragmentPrecision=s}}});var co=(s=>(s[s.HIGH=25]="HIGH",s[s.NORMAL=0]="NORMAL",s[s.LOW=-25]="LOW",s[s.UTILITY=-50]="UTILITY",s))(co||{});let Oa=class{constructor(t,e=null,i=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=i,this.once=r}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}};const te=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Oa(null,null,1/0),this.deltaMS=1/te.targetFPMS,this.elapsedMS=1/te.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,i=co.NORMAL){return this._addListener(new Oa(t,e,i))}addOnce(t,e,i=co.NORMAL){return this._addListener(new Oa(t,e,i,!0))}_addListener(t){let e=this._head.next,i=this._head;if(!e)t.connect(i);else{for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}return this._startIfPossible(),this}remove(t,e){let i=this._head.next;for(;i;)i.match(t,e)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*te.targetFPMS;const i=this._head;let r=i.next;for(;r;)r=r.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,te.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!te._shared){const t=te._shared=new te;t.autoStart=!0,t._protected=!0}return te._shared}static get system(){if(!te._system){const t=te._system=new te;t.autoStart=!0,t._protected=!0}return te._system}};let Ft=te;Ft.targetFPMS=.06;Object.defineProperties(V,{TARGET_FPMS:{get(){return Ft.targetFPMS},set(s){et("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),Ft.targetFPMS=s}}});class Jf{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,co.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?Ft.shared:new Ft,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}Jf.extension=L.Application;$.add(Jf);const uv=[];$.handleByList(L.Renderer,uv);class Qf{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){const i=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,i)}else{const i=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,i)}e>=bt.HIGH?this.multisample=bt.HIGH:e>=bt.MEDIUM?this.multisample=bt.MEDIUM:e>=bt.LOW?this.multisample=bt.LOW:this.multisample=bt.NONE}destroy(){}}Qf.extension={type:L.RendererSystem,name:"_multisample"};$.add(Qf);class dv{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class tp{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:i}=this,r=t._glBuffers[i]||this.createGLBuffer(t);e.bindBuffer(t.type,r.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:i,CONTEXT_UID:r}=this;if(this.boundBufferBases[e]!==t){const n=t._glBuffers[r]||this.createGLBuffer(t);this.boundBufferBases[e]=t,i.bindBufferBase(i.UNIFORM_BUFFER,e,n.buffer)}}bindBufferRange(t,e,i){const{gl:r,CONTEXT_UID:n}=this;i=i||0;const o=t._glBuffers[n]||this.createGLBuffer(t);r.bindBufferRange(r.UNIFORM_BUFFER,e||0,o.buffer,i*256,256)}update(t){const{gl:e,CONTEXT_UID:i}=this,r=t._glBuffers[i]||this.createGLBuffer(t);if(t._updateID!==r.updateID)if(r.updateID=t._updateID,e.bindBuffer(t.type,r.buffer),r.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const n=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;r.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,n)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let i=0;i<e.length;i++)this.dispose(this.managedBuffers[e[i]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:i}=this;return t._glBuffers[e]=new dv(i.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}tp.extension={type:L.RendererSystem,name:"buffer"};$.add(tp);class ep{constructor(t){this.renderer=t}render(t,e){const i=this.renderer;let r,n,o,a;if(e&&(r=e.renderTexture,n=e.clear,o=e.transform,a=e.skipUpdateTransform),this.renderingToScreen=!r,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=o,!i.context.isLost){if(r||(this.lastObjectRendered=t),!a){const h=t.enableTempParent();t.updateTransform(),t.disableTempParent(h)}i.renderTexture.bind(r),i.batch.currentRenderer.start(),(n??i.background.clearBeforeRender)&&i.renderTexture.clear(),t.render(i),i.batch.currentRenderer.flush(),r&&(e.blit&&i.framebuffer.blit(),r.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}ep.extension={type:L.RendererSystem,name:"objectRenderer"};$.add(ep);const Bh=class extends lv{constructor(s){super(),s=Object.assign({},V.RENDER_OPTIONS,s),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new qe({projectionMatrix:new ue},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Bh.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in s&&(et("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),s.premultipliedAlpha=s.useContextAlpha&&s.useContextAlpha!=="notMultiplied",s.backgroundAlpha=s.useContextAlpha===!1?1:s.backgroundAlpha);const e={hello:s.hello,_plugin:Bh.__plugins,background:{alpha:s.backgroundAlpha,color:s.background??s.backgroundColor,clearBeforeRender:s.clearBeforeRender},_view:{height:s.height,width:s.width,autoDensity:s.autoDensity,resolution:s.resolution,view:s.view},context:{antialias:s.antialias,context:s.context,powerPreference:s.powerPreference,premultipliedAlpha:s.premultipliedAlpha,preserveDrawingBuffer:s.preserveDrawingBuffer}};this.options=s,this.startup.run(e)}static test(s){return s!=null&&s.forceCanvas?!1:i0()}render(s,t){this.objectRenderer.render(s,t)}resize(s,t){this._view.resizeView(s,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(s=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:s}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(s){this._view.resolution=s,this.runners.resolutionChange.emit(s)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return et("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return et("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return et("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return et("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(s){et("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=s}get backgroundAlpha(){return et("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.color}set backgroundAlpha(s){et("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=s}get powerPreference(){return et("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(s,t){return this.textureGenerator.generateTexture(s,t)}};let hr=Bh;hr.extension={type:L.Renderer,priority:1};hr.__plugins={};hr.__systems={};$.handleByMap(L.RendererPlugin,hr.__plugins);$.handleByMap(L.RendererSystem,hr.__systems);$.add(hr);class sp extends Wr{constructor(t,e){const{width:i,height:r}=e||{};super(i,r),this.items=[],this.itemDirtyIds=[];for(let n=0;n<t;n++){const o=new Y;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let i=0;i<this.length;i++)t[i]&&(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof Wr?this.addResourceAt(t[i],i):this.addResourceAt(_f(t[i],e),i))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const e=this.items.map(i=>i.resource).filter(i=>i).map(i=>i.load());return this._load=Promise.all(e).then(()=>{const{realWidth:i,realHeight:r}=this.items[0];return this.resize(i,r),Promise.resolve(this)}),this._load}}class fv extends sp{constructor(t,e){const{width:i,height:r}=e||{};let n,o;Array.isArray(t)?(n=t,o=t.length):o=t,super(o,{width:i,height:r}),n&&this.initFromArray(n,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=$i.TEXTURE_2D_ARRAY}upload(t,e,i){const{length:r,itemDirtyIds:n,items:o}=this,{gl:a}=t;i.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,r,0,e.format,i.type,null);for(let h=0;h<r;h++){const l=o[h];n[h]<l.dirtyId&&(n[h]=l.dirtyId,l.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,h,l.resource.width,l.resource.height,1,e.format,i.type,l.resource.source))}return!0}}class pv extends Ss{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const vr=class extends sp{constructor(s,t){const{width:e,height:i,autoLoad:r,linkBaseTexture:n}=t||{};if(s&&s.length!==vr.SIDES)throw new Error(`Invalid length. Got ${s.length}, expected 6`);super(6,{width:e,height:i});for(let o=0;o<vr.SIDES;o++)this.items[o].target=$i.TEXTURE_CUBE_MAP_POSITIVE_X+o;this.linkBaseTexture=n!==!1,s&&this.initFromArray(s,t),r!==!1&&this.load()}bind(s){super.bind(s),s.target=$i.TEXTURE_CUBE_MAP}addBaseTextureAt(s,t,e){if(e===void 0&&(e=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||s.parentTextureArray||Object.keys(s._glTextures).length>0)if(s.resource)this.addResourceAt(s.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else s.target=$i.TEXTURE_CUBE_MAP_POSITIVE_X+t,s.parentTextureArray=this.baseTexture,this.items[t]=s;return s.valid&&!this.valid&&this.resize(s.realWidth,s.realHeight),this.items[t]=s,this}upload(s,t,e){const i=this.itemDirtyIds;for(let r=0;r<vr.SIDES;r++){const n=this.items[r];(i[r]<n.dirtyId||e.dirtyId<t.dirtyId)&&(n.valid&&n.resource?(n.resource.upload(s,n,e),i[r]=n.dirtyId):i[r]<-1&&(s.gl.texImage2D(n.target,0,e.internalFormat,t.realWidth,t.realHeight,0,t.format,e.type,null),i[r]=-1))}return!0}static test(s){return Array.isArray(s)&&s.length===vr.SIDES}};let ip=vr;ip.SIDES=6;class Ui extends Ss{constructor(t,e){e=e||{};let i,r;typeof t=="string"?(i=Ui.EMPTY,r=t):(i=t,r=null),super(i),this.url=r,this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{const i=await V.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const r=await i.blob();if(this.destroyed)return;const n=await createImageBitmap(r,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===Is.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=n,this.update(),t(this)}catch(i){if(this.destroyed)return;e(i),this.onError.emit(i)}}),this._load)}upload(t,e,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,i)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return Ui._EMPTY=Ui._EMPTY??V.ADAPTER.createCanvas(0,0),Ui._EMPTY}}const Xn=class extends Ss{constructor(s,t){t=t||{},super(V.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=s,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(s=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),s(this)},Xn.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const s=new Image;Ss.crossOrigin(s,this.svg,this._crossorigin),s.src=this.svg,s.onerror=t=>{this._resolve&&(s.onerror=null,this.onError.emit(t))},s.onload=()=>{if(!this._resolve)return;const t=s.width,e=s.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=t*this.scale,r=e*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/e*t,r=this._overrideHeight||this._overrideWidth/t*e),i=Math.round(i),r=Math.round(r);const n=this.source;n.width=i,n.height=r,n._pixiId=`canvas_${Vr()}`,n.getContext("2d").drawImage(s,0,0,t,e,0,0,i,r),this._resolve(),this._resolve=null}}static getSize(s){const t=Xn.SVG_SIZE.exec(s),e={};return t&&(e[t[1]]=Math.round(parseFloat(t[3])),e[t[5]]=Math.round(parseFloat(t[7]))),e}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(s,t){return t==="svg"||typeof s=="string"&&s.startsWith("data:image/svg+xml")||typeof s=="string"&&Xn.SVG_XML.test(s)}};let zr=Xn;zr.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;zr.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const Lh=class extends Ss{constructor(s,t){if(t=t||{},!(s instanceof HTMLVideoElement)){const e=document.createElement("video");e.setAttribute("preload","auto"),e.setAttribute("webkit-playsinline",""),e.setAttribute("playsinline",""),typeof s=="string"&&(s=[s]);const i=s[0].src||s[0];Ss.crossOrigin(e,i,t.crossorigin);for(let r=0;r<s.length;++r){const n=document.createElement("source");let{src:o,mime:a}=s[r];o=o||s[r];const h=o.split("?").shift().toLowerCase(),l=h.slice(h.lastIndexOf(".")+1);a=a||Lh.MIME_TYPES[l]||`video/${l}`,n.src=o,n.type=a,e.appendChild(n)}s=e}super(s),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(s=0){if(!this.destroyed){const t=Ft.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const s=this.source;return(s.readyState===s.HAVE_ENOUGH_DATA||s.readyState===s.HAVE_FUTURE_DATA)&&s.width&&s.height&&(s.complete=!0),s.addEventListener("play",this._onPlayStart.bind(this)),s.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(s.addEventListener("canplay",this._onCanPlay),s.addEventListener("canplaythrough",this._onCanPlay),s.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,s.load())}),this._load}_onError(s){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(s)}_isSourcePlaying(){const s=this.source;return!s.paused&&!s.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Ft.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(Ft.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const s=this.source;s.removeEventListener("canplay",this._onCanPlay),s.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this.resize(s.videoWidth,s.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&s.play()}dispose(){this._isConnectedToTicker&&(Ft.shared.remove(this.update,this),this._isConnectedToTicker=!1);const s=this.source;s&&(s.removeEventListener("error",this._onError,!0),s.pause(),s.src="",s.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(s){s!==this._autoUpdate&&(this._autoUpdate=s,!this._autoUpdate&&this._isConnectedToTicker?(Ft.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Ft.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(s){s!==this._updateFPS&&(this._updateFPS=s)}static test(s,t){return globalThis.HTMLVideoElement&&s instanceof HTMLVideoElement||Lh.TYPES.includes(t)}};let wl=Lh;wl.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];wl.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};Eh.push(Ui,Rf,pv,wl,zr,bl,ip,fv);const Zc={loader:L.LoadParser,resolver:L.ResolveParser,cache:L.CacheParser,detection:L.DetectionParser};$.handle(L.Asset,s=>{const t=s.ref;Object.entries(Zc).filter(([e])=>!!t[e]).forEach(([e,i])=>$.add(Object.assign(t[e],{extension:t[e].extension??i})))},s=>{const t=s.ref;Object.keys(Zc).filter(e=>!!t[e]).forEach(e=>$.remove(t[e]))});class _v{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<e;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function rp(s,t){if(Array.isArray(t)){for(const e of t)if(s.startsWith(`data:${e}`))return!0;return!1}return s.startsWith(`data:${t}`)}function np(s,t){const e=s.split("?")[0],i=Jt.extname(e).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}const cs=(s,t)=>(Array.isArray(s)||(s=[s]),t?s.map(e=>typeof e=="string"?t(e):e):s);function op(s,t,e,i,r){const n=t[e];for(let o=0;o<n.length;o++){const a=n[o];e<t.length-1?op(s.replace(i[e],a),t,e+1,i,r):r.push(s.replace(i[e],a))}}function mv(s){const t=/\{(.*?)\}/g,e=s.match(t),i=[];if(e){const r=[];e.forEach(n=>{const o=n.substring(1,n.length-1).split(",");r.push(o)}),op(s,r,0,e,i)}else i.push(s);return i}const uo=s=>!Array.isArray(s);let gv=class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const i=cs(t);let r;for(let a=0;a<this.parsers.length;a++){const h=this.parsers[a];if(h.test(e)){r=h.getCacheableAssets(i,e);break}}r||(r={},i.forEach(a=>{r[a]=e}));const n=Object.keys(r),o={cacheKeys:n,keys:i};if(i.forEach(a=>{this._cacheMap.set(a,o)}),n.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==e&&console.warn("[Cache] already has key:",a),this._cache.set(a,r[a])}),e instanceof Wi){const a=e;i.forEach(h=>{a.baseTexture!==Wi.EMPTY.baseTexture&&Y.addToCache(a.baseTexture,h),Wi.addToCache(a,h)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(r=>{this._cache.delete(r)}),e.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}};const _r=new gv;class yv{constructor(){this._parsers=[],this.promiseCache={}}reset(){this.promiseCache={}}_getLoadPromiseAndParser(t,e){const i={promise:null,parser:null};return i.promise=(async()=>{var n,o;let r=null;for(let a=0;a<this.parsers.length;a++){const h=this.parsers[a];if(h.load&&((n=h.test)!=null&&n.call(h,t,e,this))){r=await h.load(t,e,this),i.parser=h;break}}if(!i.parser)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has being added`),null;for(let a=0;a<this.parsers.length;a++){const h=this.parsers[a];h.parse&&h.parse&&await((o=h.testParse)==null?void 0:o.call(h,r,e,this))&&(r=await h.parse(r,e,this)||r,i.parser=h)}return r})(),i}async load(t,e){let i=0;const r={},n=uo(t),o=cs(t,l=>({src:l})),a=o.length,h=o.map(async l=>{const c=Jt.toAbsolute(l.src);if(!r[l.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,l)),r[l.src]=await this.promiseCache[c].promise,e&&e(++i/a)}catch(u){throw delete this.promiseCache[c],delete r[l.src],new Error(`[Loader.load] Failed to load ${c}.
${u}`)}});return await Promise.all(h),n?r[o[0].src]:r}async unload(t){const i=cs(t,r=>({src:r})).map(async r=>{var a,h;const n=Jt.toAbsolute(r.src),o=this.promiseCache[n];if(o){const l=await o.promise;(h=(a=o.parser)==null?void 0:a.unload)==null||h.call(a,l,r,this),delete this.promiseCache[n]}});await Promise.all(i)}get parsers(){return this._parsers}}var gi=(s=>(s[s.Low=0]="Low",s[s.Normal=1]="Normal",s[s.High=2]="High",s))(gi||{});const xv={extension:{type:L.LoadParser,priority:gi.Low},test(s){return Jt.extname(s).toLowerCase()===".json"},async load(s){return await(await V.ADAPTER.fetch(s)).json()}};$.add(xv);const bv={extension:{type:L.LoadParser,priority:gi.Low},test(s){return Jt.extname(s).toLowerCase()===".txt"},async load(s){return await(await V.ADAPTER.fetch(s)).text()}};$.add(bv);const wv=["normal","bold","100","200","300","400","500","600","700","800","900"],vv=[".ttf",".otf",".woff",".woff2"],Tv=["font/ttf","font/otf","font/woff","font/woff2"];function Cv(s){const t=Jt.extname(s);return Jt.basename(s,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")}const Sv={extension:{type:L.LoadParser,priority:gi.Low},test(s){return rp(s,Tv)||np(s,vv)},async load(s,t){var i,r,n;const e=V.ADAPTER.getFontFaceSet();if(e){const o=[],a=((i=t.data)==null?void 0:i.family)??Cv(s),h=((n=(r=t.data)==null?void 0:r.weights)==null?void 0:n.filter(c=>wv.includes(c)))??["normal"],l=t.data??{};for(let c=0;c<h.length;c++){const u=h[c],d=new FontFace(a,`url(${encodeURI(s)})`,{...l,weight:u});await d.load(),e.add(d),o.push(d)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(s){(Array.isArray(s)?s:[s]).forEach(t=>V.ADAPTER.getFontFaceSet().delete(t))}};$.add(Sv);let Jc=0,Ua;const Av="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",Pv={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${Av}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},Ev={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let Na;class Mv{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const e=URL.createObjectURL(new Blob([Pv.code],{type:"application/javascript"})),i=new Worker(e);i.addEventListener("message",r=>{i.terminate(),URL.revokeObjectURL(e),t(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Ua===void 0&&(Ua=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<Ua&&(Na||(Na=URL.createObjectURL(new Blob([Ev.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(Na),t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const i=new Promise((r,n)=>{this.queue.push({id:t,arguments:e,resolve:r,reject:n})});return this.next(),i}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),i=e.id;this.resolveHash[Jc]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:Jc++,id:i})}}const Qc=new Mv;function ap(s,t,e){const i=new Wi(s);return i.baseTexture.on("dispose",()=>{delete t.promiseCache[e]}),i}const Iv=[".jpeg",".jpg",".png",".webp",".avif"],Rv=["image/jpeg","image/png","image/webp","image/avif"];async function kv(s){const t=await V.ADAPTER.fetch(s);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${s}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const Hr={extension:{type:L.LoadParser,priority:gi.High},config:{preferWorkers:!0},test(s){return rp(s,Rv)||np(s,Iv)},async load(s,t,e){let i=null;globalThis.createImageBitmap?this.config.preferWorkers&&await Qc.isImageBitmapSupported()?i=await Qc.loadImageBitmap(s):i=await kv(s):i=await new Promise(n=>{i=new Image,i.crossOrigin="anonymous",i.src=s,i.complete?n(i):i.onload=()=>{n(i)}});const r=new Y(i,{resolution:ho(s),...t.data});return r.resource.src=s,ap(r,e,s)},unload(s){s.destroy(!0)}};$.add(Hr);const Bv={extension:{type:L.LoadParser,priority:gi.High},test(s){return Jt.extname(s).toLowerCase()===".svg"},async testParse(s){return zr.test(s)},async parse(s,t,e){var o,a,h;const i=new zr(s,(o=t==null?void 0:t.data)==null?void 0:o.resourceOptions),r=new Y(i,{resolution:ho(s),...t==null?void 0:t.data});r.resource.src=s;const n=ap(r,e,s);return(h=(a=t==null?void 0:t.data)==null?void 0:a.resourceOptions)!=null&&h.autoLoad||await i.load(),n},async load(s,t){return(await V.ADAPTER.fetch(s)).text()},unload:Hr.unload};$.add(Bv);class Lv{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const i=[];Array.isArray(e)?e.forEach(r=>{if(typeof r.name=="string"){const n=this._createBundleAssetId(t,r.name);i.push(n),this.add([r.name,n],r.srcs,r.data)}else{const n=r.name.map(o=>this._createBundleAssetId(t,o));n.forEach(o=>{i.push(o)}),this.add([...r.name,...n],r.srcs)}}):Object.keys(e).forEach(r=>{i.push(this._createBundleAssetId(t,r)),this.add([r,this._createBundleAssetId(t,r)],e[r])}),this._bundles[t]=i}add(t,e,i){const r=cs(t);r.forEach(o=>{this.hasKey(o)&&console.warn(`[Resolver] already has key: ${o} overwriting`)}),Array.isArray(e)||(typeof e=="string"?e=mv(e):e=[e]);const n=e.map(o=>{let a=o;if(typeof o=="string"){let h=!1;for(let l=0;l<this._parsers.length;l++){const c=this._parsers[l];if(c.test(o)){a=c.parse(o),h=!0;break}}h||(a={src:o})}return a.format||(a.format=a.src.split(".").pop()),a.alias||(a.alias=r),(this._basePath||this._rootPath)&&(a.src=Jt.toAbsolute(a.src,this._basePath,this._rootPath)),a.src=this._appendDefaultSearchParams(a.src),a.data=a.data??i,a});r.forEach(o=>{this._assetMap[o]=n})}resolveBundle(t){const e=uo(t);t=cs(t);const i={};return t.forEach(r=>{const n=this._bundles[r];if(n){const o=this.resolve(n),a={};for(const h in o){const l=o[h];a[this._extractAssetIdFromBundle(r,h)]=l}i[r]=a}}),e?i[t[0]]:i}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const i={};for(const r in e)i[r]=e[r].src;return i}return e.src}resolve(t){const e=uo(t);t=cs(t);const i={};return t.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let n=this._assetMap[r];const o=this._getPreferredOrder(n),a=n[0];o==null||o.priority.forEach(h=>{o.params[h].forEach(l=>{const c=n.filter(u=>u[h]?u[h]===l:!1);c.length&&(n=c)})}),this._resolverHash[r]=n[0]??a}else{let n=r;(this._basePath||this._rootPath)&&(n=Jt.toAbsolute(n,this._basePath,this._rootPath)),n=this._appendDefaultSearchParams(n),this._resolverHash[r]={src:n}}i[r]=this._resolverHash[r]}),e?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const i=t[0],r=this._preferredOrder.find(n=>n.params.format.includes(i.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}}class Fv{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Lv,this.loader=new yv,this.cache=_r,this._backgroundLoader=new _v(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var n,o,a;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let h=t.manifest;typeof h=="string"&&(h=await this.load(h)),this.resolver.addManifest(h)}const e=((n=t.texturePreference)==null?void 0:n.resolution)??1,i=typeof e=="number"?[e]:e;let r=[];if((o=t.texturePreference)!=null&&o.format){const h=(a=t.texturePreference)==null?void 0:a.format;r=typeof h=="string"?[h]:h;for(const l of this._detections)await l.test()||(r=await l.remove(r))}else for(const h of this._detections)await h.test()&&(r=await h.add(r));this.resolver.prefer({params:{format:r,resolution:i}})}add(t,e,i){this.resolver.add(t,e,i)}async load(t,e){this._initialized||await this.init();const i=uo(t),r=cs(t).map(a=>typeof a!="string"?(this.resolver.add(a.src,a),a.src):(this.resolver.hasKey(a)||this.resolver.add(a,a),a)),n=this.resolver.resolve(r),o=await this._mapLoadToResolve(n,e);return i?o[r[0]]:o}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let i=!1;typeof t=="string"&&(i=!0,t=[t]);const r=this.resolver.resolveBundle(t),n={},o=Object.keys(r);let a=0,h=0;const l=()=>{e==null||e(++a/h)},c=o.map(u=>{const d=r[u];return h+=Object.keys(d).length,this._mapLoadToResolve(d,l).then(f=>{n[u]=f})});return await Promise.all(c),i?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return _r.get(t);const e={};for(let i=0;i<t.length;i++)e[i]=_r.get(t[i]);return e}async _mapLoadToResolve(t,e){const i=Object.values(t),r=Object.keys(t);this._backgroundLoader.active=!1;const n=await this.loader.load(i,e);this._backgroundLoader.active=!0;const o={};return i.forEach((a,h)=>{const l=n[a.src],c=[a.src];a.alias&&c.push(...a.alias),o[r[h]]=l,_r.set(c,l)}),o}async unload(t){this._initialized||await this.init();const e=cs(t).map(r=>typeof r!="string"?r.src:r),i=this.resolver.resolve(e);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=cs(t);const e=this.resolver.resolveBundle(t),i=Object.keys(e).map(r=>this._unloadFromResolved(e[r]));await Promise.all(i)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(i=>{_r.remove(i.src)}),await this.loader.unload(e)}get detections(){return this._detections}get preferWorkers(){return Hr.config.preferWorkers}set preferWorkers(t){Hr.config.preferWorkers=t}}const Rn=new Fv;$.handleByList(L.LoadParser,Rn.loader.parsers).handleByList(L.ResolveParser,Rn.resolver.parsers).handleByList(L.CacheParser,Rn.cache.parsers).handleByList(L.DetectionParser,Rn.detections);const Ov={extension:L.CacheParser,test:s=>Array.isArray(s)&&s.every(t=>t instanceof Wi),getCacheableAssets:(s,t)=>{const e={};return s.forEach(i=>{t.forEach((r,n)=>{e[i+(n===0?"":n+1)]=r})}),e}};$.add(Ov);const Uv={extension:{type:L.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const s="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",t=await V.ADAPTER.fetch(s).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async s=>[...s,"avif"],remove:async s=>s.filter(t=>t!=="avif")};$.add(Uv);const Nv={extension:{type:L.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const s="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t=await V.ADAPTER.fetch(s).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async s=>[...s,"webp"],remove:async s=>s.filter(t=>t!=="webp")};$.add(Nv);const tu=["png","jpg","jpeg"],Dv={extension:{type:L.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async s=>[...s,...tu],remove:async s=>s.filter(t=>!tu.includes(t))};$.add(Dv);const $v={extension:L.ResolveParser,test:Hr.test,parse:s=>{var t;return{resolution:parseFloat(((t=V.RETINA_PREFIX.exec(s))==null?void 0:t[1])??"1"),format:s.split(".").pop(),src:s}}};$.add($v);let hp;function Gv(s){return hp=s,s}function Xr(){return hp}let Vv=0;const Fh=class extends Ze{constructor(s){super(),this.id=Vv++,this.init(s)}set(s,t){if(this[s]===void 0)throw new Error(`Property with name ${s} does not exist.`);switch(s){case"speed":this.speed=t;break;case"volume":this.volume=t;break;case"paused":this.paused=t;break;case"loop":this.loop=t;break;case"muted":this.muted=t;break}return this}get progress(){const{currentTime:s}=this._source;return s/this._duration}get paused(){return this._paused}set paused(s){this._paused=s,this.refreshPaused()}_onPlay(){this._playing=!0}_onPause(){this._playing=!1}init(s){this._playing=!1,this._duration=s.source.duration;const t=this._source=s.source.cloneNode(!1);t.src=s.parent.url,t.onplay=this._onPlay.bind(this),t.onpause=this._onPause.bind(this),s.context.on("refresh",this.refresh,this),s.context.on("refreshPaused",this.refreshPaused,this),this._media=s}_internalStop(){this._source&&this._playing&&(this._source.onended=null,this._source.pause())}stop(){this._internalStop(),this._source&&this.emit("stop")}get speed(){return this._speed}set speed(s){this._speed=s,this.refresh()}get volume(){return this._volume}set volume(s){this._volume=s,this.refresh()}get loop(){return this._loop}set loop(s){this._loop=s,this.refresh()}get muted(){return this._muted}set muted(s){this._muted=s,this.refresh()}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(s){console.warn("HTML Audio does not support filters")}refresh(){const s=this._media.context,t=this._media.parent;this._source.loop=this._loop||t.loop;const e=s.volume*(s.muted?0:1),i=t.volume*(t.muted?0:1),r=this._volume*(this._muted?0:1);this._source.volume=r*e*i,this._source.playbackRate=this._speed*s.speed*t.speed}refreshPaused(){const s=this._media.context,t=this._media.parent,e=this._paused||t.paused||s.paused;e!==this._pausedReal&&(this._pausedReal=e,e?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._source.currentTime,end:this._end,volume:this._volume,speed:this._speed,loop:this._loop})),this.emit("pause",e))}play(s){const{start:t,end:e,speed:i,loop:r,volume:n,muted:o}=s;e&&console.assert(e>t,"End time is before start time"),this._speed=i,this._volume=n,this._loop=!!r,this._muted=o,this.refresh(),this.loop&&e!==null&&(console.warn('Looping not support when specifying an "end" time'),this.loop=!1),this._start=t,this._end=e||this._duration,this._start=Math.max(0,this._start-Fh.PADDING),this._end=Math.min(this._end+Fh.PADDING,this._duration),this._source.onloadedmetadata=()=>{this._source&&(this._source.currentTime=t,this._source.onloadedmetadata=null,this.emit("progress",t,this._duration),Ft.shared.add(this._onUpdate,this))},this._source.onended=this._onComplete.bind(this),this._source.play(),this.emit("start")}_onUpdate(){this.emit("progress",this.progress,this._duration),this._source.currentTime>=this._end&&!this._source.loop&&this._onComplete()}_onComplete(){Ft.shared.remove(this._onUpdate,this),this._internalStop(),this.emit("progress",1,this._duration),this.emit("end",this)}destroy(){Ft.shared.remove(this._onUpdate,this),this.removeAllListeners();const s=this._source;s&&(s.onended=null,s.onplay=null,s.onpause=null,this._internalStop()),this._source=null,this._speed=1,this._volume=1,this._loop=!1,this._end=null,this._start=0,this._duration=0,this._playing=!1,this._pausedReal=!1,this._paused=!1,this._muted=!1,this._media&&(this._media.context.off("refresh",this.refresh,this),this._media.context.off("refreshPaused",this.refreshPaused,this),this._media=null)}toString(){return`[HTMLAudioInstance id=${this.id}]`}};let lp=Fh;lp.PADDING=.1;class Wv extends Ze{init(t){this.parent=t,this._source=t.options.source||new Audio,t.url&&(this._source.src=t.url)}create(){return new lp(this)}get isPlayable(){return!!this._source&&this._source.readyState===4}get duration(){return this._source.duration}get context(){return this.parent.context}get filters(){return null}set filters(t){console.warn("HTML Audio does not support filters")}destroy(){this.removeAllListeners(),this.parent=null,this._source&&(this._source.src="",this._source.load(),this._source=null)}get source(){return this._source}load(t){const e=this._source,i=this.parent;if(e.readyState===4){i.isLoaded=!0;const h=i.autoPlayStart();t&&setTimeout(()=>{t(null,i,h)},0);return}if(!i.url){t(new Error("sound.url or sound.source must be set"));return}e.src=i.url;const r=()=>{a(),i.isLoaded=!0;const h=i.autoPlayStart();t&&t(null,i,h)},n=()=>{a(),t&&t(new Error("Sound loading has been aborted"))},o=()=>{a();const h=`Failed to load audio element (code: ${e.error.code})`;t?t(new Error(h)):console.error(h)},a=()=>{e.removeEventListener("canplaythrough",r),e.removeEventListener("load",r),e.removeEventListener("abort",n),e.removeEventListener("error",o)};e.addEventListener("canplaythrough",r,!1),e.addEventListener("load",r,!1),e.addEventListener("abort",n,!1),e.addEventListener("error",o,!1),e.load()}}class zv{constructor(t,e){this.parent=t,Object.assign(this,e),this.duration=this.end-this.start,console.assert(this.duration>0,"End time must be after start time")}play(t){return this.parent.play({complete:t,speed:this.speed||this.parent.speed,end:this.end,start:this.start,loop:this.loop})}destroy(){this.parent=null}}class Oh{static setParamValue(t,e){if(t.setValueAtTime){const i=Xr().context;t.setValueAtTime(e,i.audioContext.currentTime)}else t.value=e;return e}}let Hv=0;class Xv extends Ze{constructor(t){super(),this.id=Hv++,this._media=null,this._paused=!1,this._muted=!1,this._elapsed=0,this.init(t)}set(t,e){if(this[t]===void 0)throw new Error(`Property with name ${t} does not exist.`);switch(t){case"speed":this.speed=e;break;case"volume":this.volume=e;break;case"muted":this.muted=e;break;case"loop":this.loop=e;break;case"paused":this.paused=e;break}return this}stop(){this._source&&(this._internalStop(),this.emit("stop"))}get speed(){return this._speed}set speed(t){this._speed=t,this.refresh(),this._update(!0)}get volume(){return this._volume}set volume(t){this._volume=t,this.refresh()}get muted(){return this._muted}set muted(t){this._muted=t,this.refresh()}get loop(){return this._loop}set loop(t){this._loop=t,this.refresh()}get filters(){return this._filters}set filters(t){var e;this._filters&&((e=this._filters)==null||e.filter(i=>i).forEach(i=>i.disconnect()),this._filters=null,this._source.connect(this._gain)),this._filters=t!=null&&t.length?t.slice(0):null,this.refresh()}refresh(){if(!this._source)return;const t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;const i=t.volume*(t.muted?0:1),r=e.volume*(e.muted?0:1),n=this._volume*(this._muted?0:1);Oh.setParamValue(this._gain.gain,n*r*i),Oh.setParamValue(this._source.playbackRate,this._speed*e.speed*t.speed),this.applyFilters()}applyFilters(){var t;if((t=this._filters)!=null&&t.length){this._source.disconnect();let e=this._source;this._filters.forEach(i=>{e.connect(i.destination),e=i}),e.connect(this._gain)}}refreshPaused(){const t=this._media.context,e=this._media.parent,i=this._paused||e.paused||t.paused;i!==this._pausedReal&&(this._pausedReal=i,i?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._elapsed%this._duration,end:this._end,speed:this._speed,loop:this._loop,volume:this._volume})),this.emit("pause",i))}play(t){const{start:e,end:i,speed:r,loop:n,volume:o,muted:a,filters:h}=t;i&&console.assert(i>e,"End time is before start time"),this._paused=!1;const{source:l,gain:c}=this._media.nodes.cloneBufferSource();this._source=l,this._gain=c,this._speed=r,this._volume=o,this._loop=!!n,this._muted=a,this._filters=h,this.refresh();const u=this._source.buffer.duration;this._duration=u,this._end=i,this._lastUpdate=this._now(),this._elapsed=e,this._source.onended=this._onComplete.bind(this),this._loop?(this._source.loopEnd=i,this._source.loopStart=e,this._source.start(0,e)):i?this._source.start(0,e,i-e):this._source.start(0,e),this.emit("start"),this._update(!0),this.enableTicker(!0)}enableTicker(t){Ft.shared.remove(this._updateListener,this),t&&Ft.shared.add(this._updateListener,this)}get progress(){return this._progress}get paused(){return this._paused}set paused(t){this._paused=t,this.refreshPaused()}destroy(){var t;this.removeAllListeners(),this._internalStop(),this._gain&&(this._gain.disconnect(),this._gain=null),this._media&&(this._media.context.events.off("refresh",this.refresh,this),this._media.context.events.off("refreshPaused",this.refreshPaused,this),this._media=null),(t=this._filters)==null||t.forEach(e=>e.disconnect()),this._filters=null,this._end=null,this._speed=1,this._volume=1,this._loop=!1,this._elapsed=0,this._duration=0,this._paused=!1,this._muted=!1,this._pausedReal=!1}toString(){return`[WebAudioInstance id=${this.id}]`}_now(){return this._media.context.audioContext.currentTime}_updateListener(){this._update()}_update(t=!1){if(this._source){const e=this._now(),i=e-this._lastUpdate;if(i>0||t){const r=this._source.playbackRate.value;this._elapsed+=i*r,this._lastUpdate=e;const n=this._duration;let o;if(this._source.loopStart){const a=this._source.loopEnd-this._source.loopStart;o=(this._source.loopStart+this._elapsed%a)/n}else o=this._elapsed%n/n;this._progress=o,this.emit("progress",this._progress,n)}}}init(t){this._media=t,t.context.events.on("refresh",this.refresh,this),t.context.events.on("refreshPaused",this.refreshPaused,this)}_internalStop(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.stop(0),this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null}}_onComplete(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}}this._source=null,this._progress=1,this.emit("progress",1,this._duration),this.emit("end",this)}}class cp{constructor(t,e){this._output=e,this._input=t}get destination(){return this._input}get filters(){return this._filters}set filters(t){if(this._filters&&(this._filters.forEach(e=>{e&&e.disconnect()}),this._filters=null,this._input.connect(this._output)),t&&t.length){this._filters=t.slice(0),this._input.disconnect();let e=null;t.forEach(i=>{e===null?this._input.connect(i.destination):e.connect(i.destination),e=i}),e.connect(this._output)}}destroy(){this.filters=null,this._input=null,this._output=null}}const up=class extends cp{constructor(s){const t=s.audioContext,e=t.createBufferSource(),i=t.createGain(),r=t.createAnalyser();e.connect(r),r.connect(i),i.connect(s.destination),super(r,i),this.context=s,this.bufferSource=e,this.gain=i,this.analyser=r}get script(){return this._script||(this._script=this.context.audioContext.createScriptProcessor(up.BUFFER_SIZE),this._script.connect(this.context.destination)),this._script}destroy(){super.destroy(),this.bufferSource.disconnect(),this._script&&this._script.disconnect(),this.gain.disconnect(),this.analyser.disconnect(),this.bufferSource=null,this._script=null,this.gain=null,this.analyser=null,this.context=null}cloneBufferSource(){const s=this.bufferSource,t=this.context.audioContext.createBufferSource();t.buffer=s.buffer,Oh.setParamValue(t.playbackRate,s.playbackRate.value),t.loop=s.loop;const e=this.context.audioContext.createGain();return t.connect(e),e.connect(this.destination),{source:t,gain:e}}get bufferSize(){return this.script.bufferSize}};let dp=up;dp.BUFFER_SIZE=0;class jv{init(t){this.parent=t,this._nodes=new dp(this.context),this._source=this._nodes.bufferSource,this.source=t.options.source}destroy(){this.parent=null,this._nodes.destroy(),this._nodes=null;try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null,this.source=null}create(){return new Xv(this)}get context(){return this.parent.context}get isPlayable(){return!!this._source&&!!this._source.buffer}get filters(){return this._nodes.filters}set filters(t){this._nodes.filters=t}get duration(){return console.assert(this.isPlayable,"Sound not yet playable, no duration"),this._source.buffer.duration}get buffer(){return this._source.buffer}set buffer(t){this._source.buffer=t}get nodes(){return this._nodes}load(t){this.source?this._decode(this.source,t):this.parent.url?this._loadUrl(t):t?t(new Error("sound.url or sound.source must be set")):console.error("sound.url or sound.source must be set")}async _loadUrl(t){const e=this.parent.url,i=await V.ADAPTER.fetch(e);this._decode(await i.arrayBuffer(),t)}_decode(t,e){const i=(r,n)=>{if(r)e&&e(r);else{this.parent.isLoaded=!0,this.buffer=n;const o=this.parent.autoPlayStart();e&&e(null,this.parent,o)}};t instanceof AudioBuffer?i(null,t):this.parent.context.decode(t,i)}}var Yv=Object.defineProperty,eu=Object.getOwnPropertySymbols,qv=Object.prototype.hasOwnProperty,Kv=Object.prototype.propertyIsEnumerable,su=(s,t,e)=>t in s?Yv(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,iu=(s,t)=>{for(var e in t||(t={}))qv.call(t,e)&&su(s,e,t[e]);if(eu)for(var e of eu(t))Kv.call(t,e)&&su(s,e,t[e]);return s};const Ri=class{static from(s){let t={};typeof s=="string"?t.url=s:s instanceof ArrayBuffer||s instanceof AudioBuffer||s instanceof HTMLAudioElement?t.source=s:t=s,t=iu({autoPlay:!1,singleInstance:!1,url:null,source:null,preload:!1,volume:1,speed:1,complete:null,loaded:null,loop:!1},t),Object.freeze(t);const e=Xr().useLegacy?new Wv:new jv;return new Ri(e,t)}constructor(s,t){this.media=s,this.options=t,this._instances=[],this._sprites={},this.media.init(this);const e=t.complete;this._autoPlayOptions=e?{complete:e}:null,this.isLoaded=!1,this.isPlaying=!1,this.autoPlay=t.autoPlay,this.singleInstance=t.singleInstance,this.preload=t.preload||this.autoPlay,this.url=t.url,this.speed=t.speed,this.volume=t.volume,this.loop=t.loop,t.sprites&&this.addSprites(t.sprites),this.preload&&this._preload(t.loaded)}get context(){return Xr().context}pause(){return this.isPlaying=!1,this.paused=!0,this}resume(){return this.isPlaying=this._instances.length>0,this.paused=!1,this}get paused(){return this._paused}set paused(s){this._paused=s,this.refreshPaused()}get speed(){return this._speed}set speed(s){this._speed=s,this.refresh()}get filters(){return this.media.filters}set filters(s){this.media.filters=s}addSprites(s,t){if(typeof s=="object"){const i={};for(const r in s)i[r]=this.addSprites(r,s[r]);return i}console.assert(!this._sprites[s],`Alias ${s} is already taken`);const e=new zv(this,t);return this._sprites[s]=e,e}destroy(){this._removeInstances(),this.removeSprites(),this.media.destroy(),this.media=null,this._sprites=null,this._instances=null}removeSprites(s){if(s){const t=this._sprites[s];t!==void 0&&(t.destroy(),delete this._sprites[s])}else for(const t in this._sprites)this.removeSprites(t);return this}get isPlayable(){return this.isLoaded&&this.media&&this.media.isPlayable}stop(){if(!this.isPlayable)return this.autoPlay=!1,this._autoPlayOptions=null,this;this.isPlaying=!1;for(let s=this._instances.length-1;s>=0;s--)this._instances[s].stop();return this}play(s,t){let e;if(typeof s=="string"?e={sprite:s,loop:this.loop,complete:t}:typeof s=="function"?(e={},e.complete=s):e=s,e=iu({complete:null,loaded:null,sprite:null,end:null,start:0,volume:1,speed:1,muted:!1,loop:!1},e||{}),e.sprite){const r=e.sprite;console.assert(!!this._sprites[r],`Alias ${r} is not available`);const n=this._sprites[r];e.start=n.start+(e.start||0),e.end=n.end,e.speed=n.speed||1,e.loop=n.loop||e.loop,delete e.sprite}if(e.offset&&(e.start=e.offset),!this.isLoaded)return new Promise((r,n)=>{this.autoPlay=!0,this._autoPlayOptions=e,this._preload((o,a,h)=>{o?n(o):(e.loaded&&e.loaded(o,a,h),r(h))})});(this.singleInstance||e.singleInstance)&&this._removeInstances();const i=this._createInstance();return this._instances.push(i),this.isPlaying=!0,i.once("end",()=>{e.complete&&e.complete(this),this._onComplete(i)}),i.once("stop",()=>{this._onComplete(i)}),i.play(e),i}refresh(){const s=this._instances.length;for(let t=0;t<s;t++)this._instances[t].refresh()}refreshPaused(){const s=this._instances.length;for(let t=0;t<s;t++)this._instances[t].refreshPaused()}get volume(){return this._volume}set volume(s){this._volume=s,this.refresh()}get muted(){return this._muted}set muted(s){this._muted=s,this.refresh()}get loop(){return this._loop}set loop(s){this._loop=s,this.refresh()}_preload(s){this.media.load(s)}get instances(){return this._instances}get sprites(){return this._sprites}get duration(){return this.media.duration}autoPlayStart(){let s;return this.autoPlay&&(s=this.play(this._autoPlayOptions)),s}_removeInstances(){for(let s=this._instances.length-1;s>=0;s--)this._poolInstance(this._instances[s]);this._instances.length=0}_onComplete(s){if(this._instances){const t=this._instances.indexOf(s);t>-1&&this._instances.splice(t,1),this.isPlaying=this._instances.length>0}this._poolInstance(s)}_createInstance(){if(Ri._pool.length>0){const s=Ri._pool.pop();return s.init(this.media),s}return this.media.create()}_poolInstance(s){s.destroy(),Ri._pool.indexOf(s)<0&&Ri._pool.push(s)}};let fo=Ri;fo._pool=[];class Zv extends Ze{constructor(){super(...arguments),this.speed=1,this.muted=!1,this.volume=1,this.paused=!1}refresh(){this.emit("refresh")}refreshPaused(){this.emit("refreshPaused")}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(t){console.warn("HTML Audio does not support filters")}get audioContext(){return console.warn("HTML Audio does not support audioContext"),null}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this.paused}destroy(){this.removeAllListeners()}}class jr extends cp{constructor(){const t=window,e=new jr.AudioContext,i=e.createDynamicsCompressor(),r=e.createAnalyser();r.connect(i),i.connect(e.destination),super(r,i),this._ctx=e,this._offlineCtx=new jr.OfflineAudioContext(1,2,t.OfflineAudioContext?Math.max(8e3,Math.min(96e3,e.sampleRate)):44100),this._unlocked=!1,this.compressor=i,this.analyser=r,this.events=new Ze,this.volume=1,this.speed=1,this.muted=!1,this.paused=!1,e.state!=="running"&&(this._unlock(),this._unlock=this._unlock.bind(this),document.addEventListener("mousedown",this._unlock,!0),document.addEventListener("touchstart",this._unlock,!0),document.addEventListener("touchend",this._unlock,!0))}_unlock(){this._unlocked||(this.playEmptySound(),this._ctx.state==="running"&&(document.removeEventListener("mousedown",this._unlock,!0),document.removeEventListener("touchend",this._unlock,!0),document.removeEventListener("touchstart",this._unlock,!0),this._unlocked=!0))}playEmptySound(){const t=this._ctx.createBufferSource();t.buffer=this._ctx.createBuffer(1,1,22050),t.connect(this._ctx.destination),t.start(0,0,0),t.context.state==="suspended"&&t.context.resume()}static get AudioContext(){const t=window;return t.AudioContext||t.webkitAudioContext||null}static get OfflineAudioContext(){const t=window;return t.OfflineAudioContext||t.webkitOfflineAudioContext||null}destroy(){super.destroy();const t=this._ctx;typeof t.close<"u"&&t.close(),this.events.removeAllListeners(),this.analyser.disconnect(),this.compressor.disconnect(),this.analyser=null,this.compressor=null,this.events=null,this._offlineCtx=null,this._ctx=null}get audioContext(){return this._ctx}get offlineContext(){return this._offlineCtx}set paused(t){t&&this._ctx.state==="running"?this._ctx.suspend():!t&&this._ctx.state==="suspended"&&this._ctx.resume(),this._paused=t}get paused(){return this._paused}refresh(){this.events.emit("refresh")}refreshPaused(){this.events.emit("refreshPaused")}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this._paused}decode(t,e){const i=n=>{e(new Error((n==null?void 0:n.message)||"Unable to decode file"))},r=this._offlineCtx.decodeAudioData(t,n=>{e(null,n)},i);r&&r.catch(i)}}var Jv=Object.defineProperty,ru=Object.getOwnPropertySymbols,Qv=Object.prototype.hasOwnProperty,t1=Object.prototype.propertyIsEnumerable,nu=(s,t,e)=>t in s?Jv(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,ou=(s,t)=>{for(var e in t||(t={}))Qv.call(t,e)&&nu(s,e,t[e]);if(ru)for(var e of ru(t))t1.call(t,e)&&nu(s,e,t[e]);return s};class e1{constructor(){this.init()}init(){return this.supported&&(this._webAudioContext=new jr),this._htmlAudioContext=new Zv,this._sounds={},this.useLegacy=!this.supported,this}get context(){return this._context}get filtersAll(){return this.useLegacy?[]:this._context.filters}set filtersAll(t){this.useLegacy||(this._context.filters=t)}get supported(){return jr.AudioContext!==null}add(t,e){if(typeof t=="object"){const n={};for(const o in t){const a=this._getOptions(t[o],e);n[o]=this.add(o,a)}return n}if(console.assert(!this._sounds[t],`Sound with alias ${t} already exists.`),e instanceof fo)return this._sounds[t]=e,e;const i=this._getOptions(e),r=fo.from(i);return this._sounds[t]=r,r}_getOptions(t,e){let i;return typeof t=="string"?i={url:t}:t instanceof ArrayBuffer||t instanceof AudioBuffer||t instanceof HTMLAudioElement?i={source:t}:i=t,i=ou(ou({},i),e||{}),i}get useLegacy(){return this._useLegacy}set useLegacy(t){this._useLegacy=t,this._context=!t&&this.supported?this._webAudioContext:this._htmlAudioContext}remove(t){return this.exists(t,!0),this._sounds[t].destroy(),delete this._sounds[t],this}get volumeAll(){return this._context.volume}set volumeAll(t){this._context.volume=t,this._context.refresh()}get speedAll(){return this._context.speed}set speedAll(t){this._context.speed=t,this._context.refresh()}togglePauseAll(){return this._context.togglePause()}pauseAll(){return this._context.paused=!0,this._context.refreshPaused(),this}resumeAll(){return this._context.paused=!1,this._context.refreshPaused(),this}toggleMuteAll(){return this._context.toggleMute()}muteAll(){return this._context.muted=!0,this._context.refresh(),this}unmuteAll(){return this._context.muted=!1,this._context.refresh(),this}removeAll(){for(const t in this._sounds)this._sounds[t].destroy(),delete this._sounds[t];return this}stopAll(){for(const t in this._sounds)this._sounds[t].stop();return this}exists(t,e=!1){const i=!!this._sounds[t];return e&&console.assert(i,`No sound matching alias '${t}'.`),i}find(t){return this.exists(t,!0),this._sounds[t]}play(t,e){return this.find(t).play(e)}stop(t){return this.find(t).stop()}pause(t){return this.find(t).pause()}resume(t){return this.find(t).resume()}volume(t,e){const i=this.find(t);return e!==void 0&&(i.volume=e),i.volume}speed(t,e){const i=this.find(t);return e!==void 0&&(i.speed=e),i.speed}duration(t){return this.find(t).duration}close(){return this.removeAll(),this._sounds=null,this._webAudioContext&&(this._webAudioContext.destroy(),this._webAudioContext=null),this._htmlAudioContext&&(this._htmlAudioContext.destroy(),this._htmlAudioContext=null),this._context=null,this}}var s1=Object.defineProperty,au=Object.getOwnPropertySymbols,i1=Object.prototype.hasOwnProperty,r1=Object.prototype.propertyIsEnumerable,hu=(s,t,e)=>t in s?s1(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,n1=(s,t)=>{for(var e in t||(t={}))i1.call(t,e)&&hu(s,e,t[e]);if(au)for(var e of au(t))r1.call(t,e)&&hu(s,e,t[e]);return s};const fp=["mp3","ogg","oga","opus","mpeg","wav","m4a","aiff","wma","mid","caf"],Uh={};function o1(s){const t=n1({m4a:"audio/mp4",oga:"audio/ogg",opus:'audio/ogg; codecs="opus"',caf:'audio/x-caf; codecs="opus"'},s||{}),e=document.createElement("audio"),i={},r=/^no$/;fp.forEach(n=>{const o=e.canPlayType(`audio/${n}`).replace(r,""),a=t[n]?e.canPlayType(t[n]).replace(r,""):"";i[n]=!!o||!!a}),Object.assign(Uh,i)}o1();var a1=Object.defineProperty,h1=Object.defineProperties,l1=Object.getOwnPropertyDescriptors,lu=Object.getOwnPropertySymbols,c1=Object.prototype.hasOwnProperty,u1=Object.prototype.propertyIsEnumerable,cu=(s,t,e)=>t in s?a1(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,d1=(s,t)=>{for(var e in t||(t={}))c1.call(t,e)&&cu(s,e,t[e]);if(lu)for(var e of lu(t))u1.call(t,e)&&cu(s,e,t[e]);return s},f1=(s,t)=>h1(s,l1(t));const uu=s=>{var t,e;const i=s.src;return(e=(t=s==null?void 0:s.alias)==null?void 0:t[0])!=null?e:Jt.basename(i,Jt.extname(i))},p1={extension:L.Asset,detection:{test:async()=>!0,add:async s=>[...s,...fp.filter(t=>Uh[t])],remove:async s=>s.filter(t=>s.includes(t))},loader:{extension:{type:[L.LoadParser],priority:gi.High},test(s){const t=Jt.extname(s).slice(1);return!!Uh[t]},async load(s,t){const e=await new Promise((i,r)=>fo.from(f1(d1({},t.data),{url:s,preload:!0,loaded(n,o){var a,h;n?r(n):i(o),(h=(a=t.data)==null?void 0:a.loaded)==null||h.call(a,n,o)}})));return Xr().add(uu(t),e),e},async unload(s,t){Xr().remove(uu(t))}}};$.add(p1);const Ti=Gv(new e1);function is(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function pp(s,t){s.prototype=Object.create(t.prototype),s.prototype.constructor=s,s.__proto__=t}/*!
 * GSAP 3.11.4
 * https://greensock.com
 *
 * @license Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var ae={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Ji={duration:.5,overwrite:!1,delay:0},vl,Nt,wt,we=1e8,rt=1/we,Nh=Math.PI*2,_1=Nh/4,m1=0,_p=Math.sqrt,g1=Math.cos,y1=Math.sin,Mt=function(t){return typeof t=="string"},mt=function(t){return typeof t=="function"},us=function(t){return typeof t=="number"},Tl=function(t){return typeof t>"u"},Je=function(t){return typeof t=="object"},jt=function(t){return t!==!1},mp=function(){return typeof window<"u"},kn=function(t){return mt(t)||Mt(t)},gp=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Dt=Array.isArray,Dh=/(?:-?\.?\d|\.)+/gi,yp=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Ni=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Da=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,xp=/[+-]=-?[.\d]+/,bp=/[^,'"\[\]\s]+/gi,x1=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,ft,ge,$h,Cl,de={},po={},wp,vp=function(t){return(po=fi(t,de))&&fe},Sl=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},_o=function(t,e){return!e&&console.warn(t)},Tp=function(t,e){return t&&(de[t]=e)&&po&&(po[t]=e)||de},Yr=function(){return 0},b1={suppressEvents:!0,isStart:!0,kill:!1},jn={suppressEvents:!0,kill:!1},w1={suppressEvents:!0},Al={},vs=[],Gh={},Cp,se={},$a={},du=30,Yn=[],Pl="",El=function(t){var e=t[0],i,r;if(Je(e)||mt(e)||(t=[t]),!(i=(e._gsap||{}).harness)){for(r=Yn.length;r--&&!Yn[r].targetTest(e););i=Yn[r]}for(r=t.length;r--;)t[r]&&(t[r]._gsap||(t[r]._gsap=new Xp(t[r],i)))||t.splice(r,1);return t},ii=function(t){return t._gsap||El(ve(t))[0]._gsap},Sp=function(t,e,i){return(i=t[e])&&mt(i)?t[e]():Tl(i)&&t.getAttribute&&t.getAttribute(e)||i},Yt=function(t,e){return(t=t.split(",")).forEach(e)||t},yt=function(t){return Math.round(t*1e5)/1e5||0},kt=function(t){return Math.round(t*1e7)/1e7||0},zi=function(t,e){var i=e.charAt(0),r=parseFloat(e.substr(2));return t=parseFloat(t),i==="+"?t+r:i==="-"?t-r:i==="*"?t*r:t/r},v1=function(t,e){for(var i=e.length,r=0;t.indexOf(e[r])<0&&++r<i;);return r<i},mo=function(){var t=vs.length,e=vs.slice(0),i,r;for(Gh={},vs.length=0,i=0;i<t;i++)r=e[i],r&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},Ap=function(t,e,i,r){vs.length&&!Nt&&mo(),t.render(e,i,r||Nt&&e<0&&(t._initted||t._startAt)),vs.length&&!Nt&&mo()},Pp=function(t){var e=parseFloat(t);return(e||e===0)&&(t+"").match(bp).length<2?e:Mt(t)?t.trim():t},Ep=function(t){return t},Se=function(t,e){for(var i in e)i in t||(t[i]=e[i]);return t},T1=function(t){return function(e,i){for(var r in i)r in e||r==="duration"&&t||r==="ease"||(e[r]=i[r])}},fi=function(t,e){for(var i in e)t[i]=e[i];return t},fu=function s(t,e){for(var i in e)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(t[i]=Je(e[i])?s(t[i]||(t[i]={}),e[i]):e[i]);return t},go=function(t,e){var i={},r;for(r in t)r in e||(i[r]=t[r]);return i},Er=function(t){var e=t.parent||ft,i=t.keyframes?T1(Dt(t.keyframes)):Se;if(jt(t.inherit))for(;e;)i(t,e.vars.defaults),e=e.parent||e._dp;return t},C1=function(t,e){for(var i=t.length,r=i===e.length;r&&i--&&t[i]===e[i];);return i<0},Mp=function(t,e,i,r,n){i===void 0&&(i="_first"),r===void 0&&(r="_last");var o=t[r],a;if(n)for(a=e[n];o&&o[n]>a;)o=o._prev;return o?(e._next=o._next,o._next=e):(e._next=t[i],t[i]=e),e._next?e._next._prev=e:t[r]=e,e._prev=o,e.parent=e._dp=t,e},Oo=function(t,e,i,r){i===void 0&&(i="_first"),r===void 0&&(r="_last");var n=e._prev,o=e._next;n?n._next=o:t[i]===e&&(t[i]=o),o?o._prev=n:t[r]===e&&(t[r]=n),e._next=e._prev=e.parent=null},As=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove(t),t._act=0},ri=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var i=t;i;)i._dirty=1,i=i.parent;return t},S1=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},Vh=function(t,e,i,r){return t._startAt&&(Nt?t._startAt.revert(jn):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,r))},A1=function s(t){return!t||t._ts&&s(t.parent)},pu=function(t){return t._repeat?Qi(t._tTime,t=t.duration()+t._rDelay)*t:0},Qi=function(t,e){var i=Math.floor(t/=e);return t&&i===t?i-1:i},yo=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},Uo=function(t){return t._end=kt(t._start+(t._tDur/Math.abs(t._ts||t._rts||rt)||0))},No=function(t,e){var i=t._dp;return i&&i.smoothChildTiming&&t._ts&&(t._start=kt(i._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),Uo(t),i._dirty||ri(i,t)),t},Ip=function(t,e){var i;if((e._time||e._initted&&!e._dur)&&(i=yo(t.rawTime(),e),(!e._dur||cn(0,e.totalDuration(),i)-e._tTime>rt)&&e.render(i,!0)),ri(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(i=t;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;t._zTime=-rt}},He=function(t,e,i,r){return e.parent&&As(e),e._start=kt((us(i)?i:i||t!==ft?me(t,i,e):t._time)+e._delay),e._end=kt(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),Mp(t,e,"_first","_last",t._sort?"_start":0),Wh(e)||(t._recent=e),r||Ip(t,e),t._ts<0&&No(t,t._tTime),t},Rp=function(t,e){return(de.ScrollTrigger||Sl("scrollTrigger",e))&&de.ScrollTrigger.create(e,t)},kp=function(t,e,i,r,n){if(Il(t,e,n),!t._initted)return 1;if(!i&&t._pt&&!Nt&&(t._dur&&t.vars.lazy!==!1||!t._dur&&t.vars.lazy)&&Cp!==re.frame)return vs.push(t),t._lazy=[n,r],1},P1=function s(t){var e=t.parent;return e&&e._ts&&e._initted&&!e._lock&&(e.rawTime()<0||s(e))},Wh=function(t){var e=t.data;return e==="isFromStart"||e==="isStart"},E1=function(t,e,i,r){var n=t.ratio,o=e<0||!e&&(!t._start&&P1(t)&&!(!t._initted&&Wh(t))||(t._ts<0||t._dp._ts<0)&&!Wh(t))?0:1,a=t._rDelay,h=0,l,c,u;if(a&&t._repeat&&(h=cn(0,t._tDur,e),c=Qi(h,a),t._yoyo&&c&1&&(o=1-o),c!==Qi(t._tTime,a)&&(n=1-o,t.vars.repeatRefresh&&t._initted&&t.invalidate())),o!==n||Nt||r||t._zTime===rt||!e&&t._zTime){if(!t._initted&&kp(t,e,r,i,h))return;for(u=t._zTime,t._zTime=e||(i?rt:0),i||(i=e&&!u),t.ratio=o,t._from&&(o=1-o),t._time=0,t._tTime=h,l=t._pt;l;)l.r(o,l.d),l=l._next;e<0&&Vh(t,e,i,!0),t._onUpdate&&!i&&Te(t,"onUpdate"),h&&t._repeat&&!i&&t.parent&&Te(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===o&&(o&&As(t,1),!i&&!Nt&&(Te(t,o?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)},M1=function(t,e,i){var r;if(i>e)for(r=t._first;r&&r._start<=i;){if(r.data==="isPause"&&r._start>e)return r;r=r._next}else for(r=t._last;r&&r._start>=i;){if(r.data==="isPause"&&r._start<e)return r;r=r._prev}},tr=function(t,e,i,r){var n=t._repeat,o=kt(e)||0,a=t._tTime/t._tDur;return a&&!r&&(t._time*=o/t._dur),t._dur=o,t._tDur=n?n<0?1e10:kt(o*(n+1)+t._rDelay*n):o,a>0&&!r&&No(t,t._tTime=t._tDur*a),t.parent&&Uo(t),i||ri(t.parent,t),t},_u=function(t){return t instanceof Ht?ri(t):tr(t,t._dur)},I1={_start:0,endTime:Yr,totalDuration:Yr},me=function s(t,e,i){var r=t.labels,n=t._recent||I1,o=t.duration()>=we?n.endTime(!1):t._dur,a,h,l;return Mt(e)&&(isNaN(e)||e in r)?(h=e.charAt(0),l=e.substr(-1)==="%",a=e.indexOf("="),h==="<"||h===">"?(a>=0&&(e=e.replace(/=/,"")),(h==="<"?n._start:n.endTime(n._repeat>=0))+(parseFloat(e.substr(1))||0)*(l?(a<0?n:i).totalDuration()/100:1)):a<0?(e in r||(r[e]=o),r[e]):(h=parseFloat(e.charAt(a-1)+e.substr(a+1)),l&&i&&(h=h/100*(Dt(i)?i[0]:i).totalDuration()),a>1?s(t,e.substr(0,a-1),i)+h:o+h)):e==null?o:+e},Mr=function(t,e,i){var r=us(e[1]),n=(r?2:1)+(t<2?0:1),o=e[n],a,h;if(r&&(o.duration=e[1]),o.parent=i,t){for(a=o,h=i;h&&!("immediateRender"in a);)a=h.vars.defaults||{},h=jt(h.vars.inherit)&&h.parent;o.immediateRender=jt(a.immediateRender),t<2?o.runBackwards=1:o.startAt=e[n-1]}return new vt(e[0],o,e[n+1])},Rs=function(t,e){return t||t===0?e(t):e},cn=function(t,e,i){return i<t?t:i>e?e:i},Ot=function(t,e){return!Mt(t)||!(e=x1.exec(t))?"":e[1]},R1=function(t,e,i){return Rs(i,function(r){return cn(t,e,r)})},zh=[].slice,Bp=function(t,e){return t&&Je(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&Je(t[0]))&&!t.nodeType&&t!==ge},k1=function(t,e,i){return i===void 0&&(i=[]),t.forEach(function(r){var n;return Mt(r)&&!e||Bp(r,1)?(n=i).push.apply(n,ve(r)):i.push(r)})||i},ve=function(t,e,i){return wt&&!e&&wt.selector?wt.selector(t):Mt(t)&&!i&&($h||!er())?zh.call((e||Cl).querySelectorAll(t),0):Dt(t)?k1(t,i):Bp(t)?zh.call(t,0):t?[t]:[]},Hh=function(t){return t=ve(t)[0]||_o("Invalid scope")||{},function(e){var i=t.current||t.nativeElement||t;return ve(e,i.querySelectorAll?i:i===t?_o("Invalid scope")||Cl.createElement("div"):t)}},Lp=function(t){return t.sort(function(){return .5-Math.random()})},Fp=function(t){if(mt(t))return t;var e=Je(t)?t:{each:t},i=ni(e.ease),r=e.from||0,n=parseFloat(e.base)||0,o={},a=r>0&&r<1,h=isNaN(r)||a,l=e.axis,c=r,u=r;return Mt(r)?c=u={center:.5,edges:.5,end:1}[r]||0:!a&&h&&(c=r[0],u=r[1]),function(d,f,p){var m=(p||e).length,_=o[m],x,g,y,w,v,S,C,T,A;if(!_){if(A=e.grid==="auto"?0:(e.grid||[1,we])[1],!A){for(C=-we;C<(C=p[A++].getBoundingClientRect().left)&&A<m;);A--}for(_=o[m]=[],x=h?Math.min(A,m)*c-.5:r%A,g=A===we?0:h?m*u/A-.5:r/A|0,C=0,T=we,S=0;S<m;S++)y=S%A-x,w=g-(S/A|0),_[S]=v=l?Math.abs(l==="y"?w:y):_p(y*y+w*w),v>C&&(C=v),v<T&&(T=v);r==="random"&&Lp(_),_.max=C-T,_.min=T,_.v=m=(parseFloat(e.amount)||parseFloat(e.each)*(A>m?m-1:l?l==="y"?m/A:A:Math.max(A,m/A))||0)*(r==="edges"?-1:1),_.b=m<0?n-m:n,_.u=Ot(e.amount||e.each)||0,i=i&&m<0?Wp(i):i}return m=(_[d]-_.min)/_.max||0,kt(_.b+(i?i(m):m)*_.v)+_.u}},Xh=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(i){var r=kt(Math.round(parseFloat(i)/t)*t*e);return(r-r%1)/e+(us(i)?0:Ot(i))}},Op=function(t,e){var i=Dt(t),r,n;return!i&&Je(t)&&(r=i=t.radius||we,t.values?(t=ve(t.values),(n=!us(t[0]))&&(r*=r)):t=Xh(t.increment)),Rs(e,i?mt(t)?function(o){return n=t(o),Math.abs(n-o)<=r?n:o}:function(o){for(var a=parseFloat(n?o.x:o),h=parseFloat(n?o.y:0),l=we,c=0,u=t.length,d,f;u--;)n?(d=t[u].x-a,f=t[u].y-h,d=d*d+f*f):d=Math.abs(t[u]-a),d<l&&(l=d,c=u);return c=!r||l<=r?t[c]:o,n||c===o||us(o)?c:c+Ot(o)}:Xh(t))},Up=function(t,e,i,r){return Rs(Dt(t)?!e:i===!0?!!(i=0):!r,function(){return Dt(t)?t[~~(Math.random()*t.length)]:(i=i||1e-5)&&(r=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((t-i/2+Math.random()*(e-t+i*.99))/i)*i*r)/r})},B1=function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return function(r){return e.reduce(function(n,o){return o(n)},r)}},L1=function(t,e){return function(i){return t(parseFloat(i))+(e||Ot(i))}},F1=function(t,e,i){return Dp(t,e,0,1,i)},Np=function(t,e,i){return Rs(i,function(r){return t[~~e(r)]})},O1=function s(t,e,i){var r=e-t;return Dt(t)?Np(t,s(0,t.length),e):Rs(i,function(n){return(r+(n-t)%r)%r+t})},U1=function s(t,e,i){var r=e-t,n=r*2;return Dt(t)?Np(t,s(0,t.length-1),e):Rs(i,function(o){return o=(n+(o-t)%n)%n||0,t+(o>r?n-o:o)})},qr=function(t){for(var e=0,i="",r,n,o,a;~(r=t.indexOf("random(",e));)o=t.indexOf(")",r),a=t.charAt(r+7)==="[",n=t.substr(r+7,o-r-7).match(a?bp:Dh),i+=t.substr(e,r-e)+Up(a?n:+n[0],a?0:+n[1],+n[2]||1e-5),e=o+1;return i+t.substr(e,t.length-e)},Dp=function(t,e,i,r,n){var o=e-t,a=r-i;return Rs(n,function(h){return i+((h-t)/o*a||0)})},N1=function s(t,e,i,r){var n=isNaN(t+e)?0:function(f){return(1-f)*t+f*e};if(!n){var o=Mt(t),a={},h,l,c,u,d;if(i===!0&&(r=1)&&(i=null),o)t={p:t},e={p:e};else if(Dt(t)&&!Dt(e)){for(c=[],u=t.length,d=u-2,l=1;l<u;l++)c.push(s(t[l-1],t[l]));u--,n=function(p){p*=u;var m=Math.min(d,~~p);return c[m](p-m)},i=e}else r||(t=fi(Dt(t)?[]:{},t));if(!c){for(h in e)Ml.call(a,t,h,"get",e[h]);n=function(p){return Bl(p,a)||(o?t.p:t)}}}return Rs(i,n)},mu=function(t,e,i){var r=t.labels,n=we,o,a,h;for(o in r)a=r[o]-e,a<0==!!i&&a&&n>(a=Math.abs(a))&&(h=o,n=a);return h},Te=function(t,e,i){var r=t.vars,n=r[e],o=wt,a=t._ctx,h,l,c;if(n)return h=r[e+"Params"],l=r.callbackScope||t,i&&vs.length&&mo(),a&&(wt=a),c=h?n.apply(l,h):n.call(l),wt=o,c},Tr=function(t){return As(t),t.scrollTrigger&&t.scrollTrigger.kill(!!Nt),t.progress()<1&&Te(t,"onInterrupt"),t},Di,D1=function(t){t=!t.name&&t.default||t;var e=t.name,i=mt(t),r=e&&!i&&t.init?function(){this._props=[]}:t,n={init:Yr,render:Bl,add:Ml,kill:eT,modifier:tT,rawVars:0},o={targetTest:0,get:0,getSetter:kl,aliases:{},register:0};if(er(),t!==r){if(se[e])return;Se(r,Se(go(t,n),o)),fi(r.prototype,fi(n,go(t,o))),se[r.prop=e]=r,t.targetTest&&(Yn.push(r),Al[e]=1),e=(e==="css"?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}Tp(e,r),t.register&&t.register(fe,r,qt)},it=255,Cr={aqua:[0,it,it],lime:[0,it,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,it],navy:[0,0,128],white:[it,it,it],olive:[128,128,0],yellow:[it,it,0],orange:[it,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[it,0,0],pink:[it,192,203],cyan:[0,it,it],transparent:[it,it,it,0]},Ga=function(t,e,i){return t+=t<0?1:t>1?-1:0,(t*6<1?e+(i-e)*t*6:t<.5?i:t*3<2?e+(i-e)*(2/3-t)*6:e)*it+.5|0},$p=function(t,e,i){var r=t?us(t)?[t>>16,t>>8&it,t&it]:0:Cr.black,n,o,a,h,l,c,u,d,f,p;if(!r){if(t.substr(-1)===","&&(t=t.substr(0,t.length-1)),Cr[t])r=Cr[t];else if(t.charAt(0)==="#"){if(t.length<6&&(n=t.charAt(1),o=t.charAt(2),a=t.charAt(3),t="#"+n+n+o+o+a+a+(t.length===5?t.charAt(4)+t.charAt(4):"")),t.length===9)return r=parseInt(t.substr(1,6),16),[r>>16,r>>8&it,r&it,parseInt(t.substr(7),16)/255];t=parseInt(t.substr(1),16),r=[t>>16,t>>8&it,t&it]}else if(t.substr(0,3)==="hsl"){if(r=p=t.match(Dh),!e)h=+r[0]%360/360,l=+r[1]/100,c=+r[2]/100,o=c<=.5?c*(l+1):c+l-c*l,n=c*2-o,r.length>3&&(r[3]*=1),r[0]=Ga(h+1/3,n,o),r[1]=Ga(h,n,o),r[2]=Ga(h-1/3,n,o);else if(~t.indexOf("="))return r=t.match(yp),i&&r.length<4&&(r[3]=1),r}else r=t.match(Dh)||Cr.transparent;r=r.map(Number)}return e&&!p&&(n=r[0]/it,o=r[1]/it,a=r[2]/it,u=Math.max(n,o,a),d=Math.min(n,o,a),c=(u+d)/2,u===d?h=l=0:(f=u-d,l=c>.5?f/(2-u-d):f/(u+d),h=u===n?(o-a)/f+(o<a?6:0):u===o?(a-n)/f+2:(n-o)/f+4,h*=60),r[0]=~~(h+.5),r[1]=~~(l*100+.5),r[2]=~~(c*100+.5)),i&&r.length<4&&(r[3]=1),r},Gp=function(t){var e=[],i=[],r=-1;return t.split(Ts).forEach(function(n){var o=n.match(Ni)||[];e.push.apply(e,o),i.push(r+=o.length+1)}),e.c=i,e},gu=function(t,e,i){var r="",n=(t+r).match(Ts),o=e?"hsla(":"rgba(",a=0,h,l,c,u;if(!n)return t;if(n=n.map(function(d){return(d=$p(d,e,1))&&o+(e?d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:d.join(","))+")"}),i&&(c=Gp(t),h=i.c,h.join(r)!==c.c.join(r)))for(l=t.replace(Ts,"1").split(Ni),u=l.length-1;a<u;a++)r+=l[a]+(~h.indexOf(a)?n.shift()||o+"0,0,0,0)":(c.length?c:n.length?n:i).shift());if(!l)for(l=t.split(Ts),u=l.length-1;a<u;a++)r+=l[a]+n[a];return r+l[u]},Ts=function(){var s="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in Cr)s+="|"+t+"\\b";return new RegExp(s+")","gi")}(),$1=/hsl[a]?\(/,Vp=function(t){var e=t.join(" "),i;if(Ts.lastIndex=0,Ts.test(e))return i=$1.test(e),t[1]=gu(t[1],i),t[0]=gu(t[0],i,Gp(t[1])),!0},Kr,re=function(){var s=Date.now,t=500,e=33,i=s(),r=i,n=1e3/240,o=n,a=[],h,l,c,u,d,f,p=function m(_){var x=s()-r,g=_===!0,y,w,v,S;if(x>t&&(i+=x-e),r+=x,v=r-i,y=v-o,(y>0||g)&&(S=++u.frame,d=v-u.time*1e3,u.time=v=v/1e3,o+=y+(y>=n?4:n-y),w=1),g||(h=l(m)),w)for(f=0;f<a.length;f++)a[f](v,d,S,_)};return u={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(_){return d/(1e3/(_||60))},wake:function(){wp&&(!$h&&mp()&&(ge=$h=window,Cl=ge.document||{},de.gsap=fe,(ge.gsapVersions||(ge.gsapVersions=[])).push(fe.version),vp(po||ge.GreenSockGlobals||!ge.gsap&&ge||{}),c=ge.requestAnimationFrame),h&&u.sleep(),l=c||function(_){return setTimeout(_,o-u.time*1e3+1|0)},Kr=1,p(2))},sleep:function(){(c?ge.cancelAnimationFrame:clearTimeout)(h),Kr=0,l=Yr},lagSmoothing:function(_,x){t=_||1/0,e=Math.min(x||33,t)},fps:function(_){n=1e3/(_||240),o=u.time*1e3+n},add:function(_,x,g){var y=x?function(w,v,S,C){_(w,v,S,C),u.remove(y)}:_;return u.remove(_),a[g?"unshift":"push"](y),er(),y},remove:function(_,x){~(x=a.indexOf(_))&&a.splice(x,1)&&f>=x&&f--},_listeners:a},u}(),er=function(){return!Kr&&re.wake()},X={},G1=/^[\d.\-M][\d.\-,\s]/,V1=/["']/g,W1=function(t){for(var e={},i=t.substr(1,t.length-3).split(":"),r=i[0],n=1,o=i.length,a,h,l;n<o;n++)h=i[n],a=n!==o-1?h.lastIndexOf(","):h.length,l=h.substr(0,a),e[r]=isNaN(l)?l.replace(V1,"").trim():+l,r=h.substr(a+1).trim();return e},z1=function(t){var e=t.indexOf("(")+1,i=t.indexOf(")"),r=t.indexOf("(",e);return t.substring(e,~r&&r<i?t.indexOf(")",i+1):i)},H1=function(t){var e=(t+"").split("("),i=X[e[0]];return i&&e.length>1&&i.config?i.config.apply(null,~t.indexOf("{")?[W1(e[1])]:z1(t).split(",").map(Pp)):X._CE&&G1.test(t)?X._CE("",t):i},Wp=function(t){return function(e){return 1-t(1-e)}},zp=function s(t,e){for(var i=t._first,r;i;)i instanceof Ht?s(i,e):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==e&&(i.timeline?s(i.timeline,e):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=e)),i=i._next},ni=function(t,e){return t&&(mt(t)?t:X[t]||H1(t))||e},yi=function(t,e,i,r){i===void 0&&(i=function(h){return 1-e(1-h)}),r===void 0&&(r=function(h){return h<.5?e(h*2)/2:1-e((1-h)*2)/2});var n={easeIn:e,easeOut:i,easeInOut:r},o;return Yt(t,function(a){X[a]=de[a]=n,X[o=a.toLowerCase()]=i;for(var h in n)X[o+(h==="easeIn"?".in":h==="easeOut"?".out":".inOut")]=X[a+"."+h]=n[h]}),n},Hp=function(t){return function(e){return e<.5?(1-t(1-e*2))/2:.5+t((e-.5)*2)/2}},Va=function s(t,e,i){var r=e>=1?e:1,n=(i||(t?.3:.45))/(e<1?e:1),o=n/Nh*(Math.asin(1/r)||0),a=function(c){return c===1?1:r*Math.pow(2,-10*c)*y1((c-o)*n)+1},h=t==="out"?a:t==="in"?function(l){return 1-a(1-l)}:Hp(a);return n=Nh/n,h.config=function(l,c){return s(t,l,c)},h},Wa=function s(t,e){e===void 0&&(e=1.70158);var i=function(o){return o?--o*o*((e+1)*o+e)+1:0},r=t==="out"?i:t==="in"?function(n){return 1-i(1-n)}:Hp(i);return r.config=function(n){return s(t,n)},r};Yt("Linear,Quad,Cubic,Quart,Quint,Strong",function(s,t){var e=t<5?t+1:t;yi(s+",Power"+(e-1),t?function(i){return Math.pow(i,e)}:function(i){return i},function(i){return 1-Math.pow(1-i,e)},function(i){return i<.5?Math.pow(i*2,e)/2:1-Math.pow((1-i)*2,e)/2})});X.Linear.easeNone=X.none=X.Linear.easeIn;yi("Elastic",Va("in"),Va("out"),Va());(function(s,t){var e=1/t,i=2*e,r=2.5*e,n=function(a){return a<e?s*a*a:a<i?s*Math.pow(a-1.5/t,2)+.75:a<r?s*(a-=2.25/t)*a+.9375:s*Math.pow(a-2.625/t,2)+.984375};yi("Bounce",function(o){return 1-n(1-o)},n)})(7.5625,2.75);yi("Expo",function(s){return s?Math.pow(2,10*(s-1)):0});yi("Circ",function(s){return-(_p(1-s*s)-1)});yi("Sine",function(s){return s===1?1:-g1(s*_1)+1});yi("Back",Wa("in"),Wa("out"),Wa());X.SteppedEase=X.steps=de.SteppedEase={config:function(t,e){t===void 0&&(t=1);var i=1/t,r=t+(e?0:1),n=e?1:0,o=1-rt;return function(a){return((r*cn(0,o,a)|0)+n)*i}}};Ji.ease=X["quad.out"];Yt("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(s){return Pl+=s+","+s+"Params,"});var Xp=function(t,e){this.id=m1++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:Sp,this.set=e?e.getSetter:kl},sr=function(){function s(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,tr(this,+e.duration,1,1),this.data=e.data,wt&&(this._ctx=wt,wt.data.push(this)),Kr||re.wake()}var t=s.prototype;return t.delay=function(i){return i||i===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},t.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},t.totalDuration=function(i){return arguments.length?(this._dirty=0,tr(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(i,r){if(er(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(No(this,i),!n._dp||n.parent||Ip(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&He(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===rt||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),Ap(this,i,r)),this},t.time=function(i,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+pu(this))%(this._dur+this._rDelay)||(i?this._dur:0),r):this._time},t.totalProgress=function(i,r){return arguments.length?this.totalTime(this.totalDuration()*i,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(i,r){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-i:i)+pu(this),r):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(i,r){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*n,r):this._repeat?Qi(this._tTime,n)+1:1},t.timeScale=function(i){if(!arguments.length)return this._rts===-rt?0:this._rts;if(this._rts===i)return this;var r=this.parent&&this._ts?yo(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-rt?0:this._rts,this.totalTime(cn(-this._delay,this._tDur,r),!0),Uo(this),S1(this)},t.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(er(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==rt&&(this._tTime-=rt)))),this):this._ps},t.startTime=function(i){if(arguments.length){this._start=i;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&He(r,this,i-this._delay),this}return this._start},t.endTime=function(i){return this._start+(jt(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(i){var r=this.parent||this._dp;return r?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?yo(r.rawTime(i),this):this._tTime:this._tTime},t.revert=function(i){i===void 0&&(i=w1);var r=Nt;return Nt=i,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),this.data!=="nested"&&i.kill!==!1&&this.kill(),Nt=r,this},t.globalTime=function(i){for(var r=this,n=arguments.length?i:r.rawTime();r;)n=r._start+n/(r._ts||1),r=r._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1:this._sat.globalTime(i):n},t.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,_u(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(i){if(arguments.length){var r=this._time;return this._rDelay=i,_u(this),r?this.time(r):this}return this._rDelay},t.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},t.seek=function(i,r){return this.totalTime(me(this,i),jt(r))},t.restart=function(i,r){return this.play().totalTime(i?-this._delay:0,jt(r))},t.play=function(i,r){return i!=null&&this.seek(i,r),this.reversed(!1).paused(!1)},t.reverse=function(i,r){return i!=null&&this.seek(i||this.totalDuration(),r),this.reversed(!0).paused(!1)},t.pause=function(i,r){return i!=null&&this.seek(i,r),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-rt:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-rt,this},t.isActive=function(){var i=this.parent||this._dp,r=this._start,n;return!!(!i||this._ts&&this._initted&&i.isActive()&&(n=i.rawTime(!0))>=r&&n<this.endTime(!0)-rt)},t.eventCallback=function(i,r,n){var o=this.vars;return arguments.length>1?(r?(o[i]=r,n&&(o[i+"Params"]=n),i==="onUpdate"&&(this._onUpdate=r)):delete o[i],this):o[i]},t.then=function(i){var r=this;return new Promise(function(n){var o=mt(i)?i:Ep,a=function(){var l=r.then;r.then=null,mt(o)&&(o=o(r))&&(o.then||o===r)&&(r.then=l),n(o),r.then=l};r._initted&&r.totalProgress()===1&&r._ts>=0||!r._tTime&&r._ts<0?a():r._prom=a})},t.kill=function(){Tr(this)},s}();Se(sr.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-rt,_prom:0,_ps:!1,_rts:1});var Ht=function(s){pp(t,s);function t(i,r){var n;return i===void 0&&(i={}),n=s.call(this,i)||this,n.labels={},n.smoothChildTiming=!!i.smoothChildTiming,n.autoRemoveChildren=!!i.autoRemoveChildren,n._sort=jt(i.sortChildren),ft&&He(i.parent||ft,is(n),r),i.reversed&&n.reverse(),i.paused&&n.paused(!0),i.scrollTrigger&&Rp(is(n),i.scrollTrigger),n}var e=t.prototype;return e.to=function(r,n,o){return Mr(0,arguments,this),this},e.from=function(r,n,o){return Mr(1,arguments,this),this},e.fromTo=function(r,n,o,a){return Mr(2,arguments,this),this},e.set=function(r,n,o){return n.duration=0,n.parent=this,Er(n).repeatDelay||(n.repeat=0),n.immediateRender=!!n.immediateRender,new vt(r,n,me(this,o),1),this},e.call=function(r,n,o){return He(this,vt.delayedCall(0,r,n),o)},e.staggerTo=function(r,n,o,a,h,l,c){return o.duration=n,o.stagger=o.stagger||a,o.onComplete=l,o.onCompleteParams=c,o.parent=this,new vt(r,o,me(this,h)),this},e.staggerFrom=function(r,n,o,a,h,l,c){return o.runBackwards=1,Er(o).immediateRender=jt(o.immediateRender),this.staggerTo(r,n,o,a,h,l,c)},e.staggerFromTo=function(r,n,o,a,h,l,c,u){return a.startAt=o,Er(a).immediateRender=jt(a.immediateRender),this.staggerTo(r,n,a,h,l,c,u)},e.render=function(r,n,o){var a=this._time,h=this._dirty?this.totalDuration():this._tDur,l=this._dur,c=r<=0?0:kt(r),u=this._zTime<0!=r<0&&(this._initted||!l),d,f,p,m,_,x,g,y,w,v,S,C;if(this!==ft&&c>h&&r>=0&&(c=h),c!==this._tTime||o||u){if(a!==this._time&&l&&(c+=this._time-a,r+=this._time-a),d=c,w=this._start,y=this._ts,x=!y,u&&(l||(a=this._zTime),(r||!n)&&(this._zTime=r)),this._repeat){if(S=this._yoyo,_=l+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(_*100+r,n,o);if(d=kt(c%_),c===h?(m=this._repeat,d=l):(m=~~(c/_),m&&m===c/_&&(d=l,m--),d>l&&(d=l)),v=Qi(this._tTime,_),!a&&this._tTime&&v!==m&&(v=m),S&&m&1&&(d=l-d,C=1),m!==v&&!this._lock){var T=S&&v&1,A=T===(S&&m&1);if(m<v&&(T=!T),a=T?0:l,this._lock=1,this.render(a||(C?0:kt(m*_)),n,!l)._lock=0,this._tTime=c,!n&&this.parent&&Te(this,"onRepeat"),this.vars.repeatRefresh&&!C&&(this.invalidate()._lock=1),a&&a!==this._time||x!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(l=this._dur,h=this._tDur,A&&(this._lock=2,a=T?l:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!C&&this.invalidate()),this._lock=0,!this._ts&&!x)return this;zp(this,C)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(g=M1(this,kt(a),kt(d)),g&&(c-=d-(d=g._start))),this._tTime=c,this._time=d,this._act=!y,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,a=0),!a&&d&&!n&&(Te(this,"onStart"),this._tTime!==c))return this;if(d>=a&&r>=0)for(f=this._first;f;){if(p=f._next,(f._act||d>=f._start)&&f._ts&&g!==f){if(f.parent!==this)return this.render(r,n,o);if(f.render(f._ts>0?(d-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(d-f._start)*f._ts,n,o),d!==this._time||!this._ts&&!x){g=0,p&&(c+=this._zTime=-rt);break}}f=p}else{f=this._last;for(var P=r<0?r:d;f;){if(p=f._prev,(f._act||P<=f._end)&&f._ts&&g!==f){if(f.parent!==this)return this.render(r,n,o);if(f.render(f._ts>0?(P-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(P-f._start)*f._ts,n,o||Nt&&(f._initted||f._startAt)),d!==this._time||!this._ts&&!x){g=0,p&&(c+=this._zTime=P?-rt:rt);break}}f=p}}if(g&&!n&&(this.pause(),g.render(d>=a?0:-rt)._zTime=d>=a?1:-1,this._ts))return this._start=w,Uo(this),this.render(r,n,o);this._onUpdate&&!n&&Te(this,"onUpdate",!0),(c===h&&this._tTime>=this.totalDuration()||!c&&a)&&(w===this._start||Math.abs(y)!==Math.abs(this._ts))&&(this._lock||((r||!l)&&(c===h&&this._ts>0||!c&&this._ts<0)&&As(this,1),!n&&!(r<0&&!a)&&(c||a||!h)&&(Te(this,c===h&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(c<h&&this.timeScale()>0)&&this._prom())))}return this},e.add=function(r,n){var o=this;if(us(n)||(n=me(this,n,r)),!(r instanceof sr)){if(Dt(r))return r.forEach(function(a){return o.add(a,n)}),this;if(Mt(r))return this.addLabel(r,n);if(mt(r))r=vt.delayedCall(0,r);else return this}return this!==r?He(this,r,n):this},e.getChildren=function(r,n,o,a){r===void 0&&(r=!0),n===void 0&&(n=!0),o===void 0&&(o=!0),a===void 0&&(a=-we);for(var h=[],l=this._first;l;)l._start>=a&&(l instanceof vt?n&&h.push(l):(o&&h.push(l),r&&h.push.apply(h,l.getChildren(!0,n,o)))),l=l._next;return h},e.getById=function(r){for(var n=this.getChildren(1,1,1),o=n.length;o--;)if(n[o].vars.id===r)return n[o]},e.remove=function(r){return Mt(r)?this.removeLabel(r):mt(r)?this.killTweensOf(r):(Oo(this,r),r===this._recent&&(this._recent=this._last),ri(this))},e.totalTime=function(r,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=kt(re.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),s.prototype.totalTime.call(this,r,n),this._forcing=0,this):this._tTime},e.addLabel=function(r,n){return this.labels[r]=me(this,n),this},e.removeLabel=function(r){return delete this.labels[r],this},e.addPause=function(r,n,o){var a=vt.delayedCall(0,n||Yr,o);return a.data="isPause",this._hasPause=1,He(this,a,me(this,r))},e.removePause=function(r){var n=this._first;for(r=me(this,r);n;)n._start===r&&n.data==="isPause"&&As(n),n=n._next},e.killTweensOf=function(r,n,o){for(var a=this.getTweensOf(r,o),h=a.length;h--;)xs!==a[h]&&a[h].kill(r,n);return this},e.getTweensOf=function(r,n){for(var o=[],a=ve(r),h=this._first,l=us(n),c;h;)h instanceof vt?v1(h._targets,a)&&(l?(!xs||h._initted&&h._ts)&&h.globalTime(0)<=n&&h.globalTime(h.totalDuration())>n:!n||h.isActive())&&o.push(h):(c=h.getTweensOf(a,n)).length&&o.push.apply(o,c),h=h._next;return o},e.tweenTo=function(r,n){n=n||{};var o=this,a=me(o,r),h=n,l=h.startAt,c=h.onStart,u=h.onStartParams,d=h.immediateRender,f,p=vt.to(o,Se({ease:n.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:n.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale())||rt,onStart:function(){if(o.pause(),!f){var _=n.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale());p._dur!==_&&tr(p,_,0,1).render(p._time,!0,!0),f=1}c&&c.apply(p,u||[])}},n));return d?p.render(0):p},e.tweenFromTo=function(r,n,o){return this.tweenTo(n,Se({startAt:{time:me(this,r)}},o))},e.recent=function(){return this._recent},e.nextLabel=function(r){return r===void 0&&(r=this._time),mu(this,me(this,r))},e.previousLabel=function(r){return r===void 0&&(r=this._time),mu(this,me(this,r),1)},e.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+rt)},e.shiftChildren=function(r,n,o){o===void 0&&(o=0);for(var a=this._first,h=this.labels,l;a;)a._start>=o&&(a._start+=r,a._end+=r),a=a._next;if(n)for(l in h)h[l]>=o&&(h[l]+=r);return ri(this)},e.invalidate=function(r){var n=this._first;for(this._lock=0;n;)n.invalidate(r),n=n._next;return s.prototype.invalidate.call(this,r)},e.clear=function(r){r===void 0&&(r=!0);for(var n=this._first,o;n;)o=n._next,this.remove(n),n=o;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),ri(this)},e.totalDuration=function(r){var n=0,o=this,a=o._last,h=we,l,c,u;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-r:r));if(o._dirty){for(u=o.parent;a;)l=a._prev,a._dirty&&a.totalDuration(),c=a._start,c>h&&o._sort&&a._ts&&!o._lock?(o._lock=1,He(o,a,c-a._delay,1)._lock=0):h=c,c<0&&a._ts&&(n-=c,(!u&&!o._dp||u&&u.smoothChildTiming)&&(o._start+=c/o._ts,o._time-=c,o._tTime-=c),o.shiftChildren(-c,!1,-1/0),h=0),a._end>n&&a._ts&&(n=a._end),a=l;tr(o,o===ft&&o._time>n?o._time:n,1,1),o._dirty=0}return o._tDur},t.updateRoot=function(r){if(ft._ts&&(Ap(ft,yo(r,ft)),Cp=re.frame),re.frame>=du){du+=ae.autoSleep||120;var n=ft._first;if((!n||!n._ts)&&ae.autoSleep&&re._listeners.length<2){for(;n&&!n._ts;)n=n._next;n||re.sleep()}}},t}(sr);Se(Ht.prototype,{_lock:0,_hasPause:0,_forcing:0});var X1=function(t,e,i,r,n,o,a){var h=new qt(this._pt,t,e,0,1,Jp,null,n),l=0,c=0,u,d,f,p,m,_,x,g;for(h.b=i,h.e=r,i+="",r+="",(x=~r.indexOf("random("))&&(r=qr(r)),o&&(g=[i,r],o(g,t,e),i=g[0],r=g[1]),d=i.match(Da)||[];u=Da.exec(r);)p=u[0],m=r.substring(l,u.index),f?f=(f+1)%5:m.substr(-5)==="rgba("&&(f=1),p!==d[c++]&&(_=parseFloat(d[c-1])||0,h._pt={_next:h._pt,p:m||c===1?m:",",s:_,c:p.charAt(1)==="="?zi(_,p)-_:parseFloat(p)-_,m:f&&f<4?Math.round:0},l=Da.lastIndex);return h.c=l<r.length?r.substring(l,r.length):"",h.fp=a,(xp.test(r)||x)&&(h.e=0),this._pt=h,h},Ml=function(t,e,i,r,n,o,a,h,l,c){mt(r)&&(r=r(n||0,t,o));var u=t[e],d=i!=="get"?i:mt(u)?l?t[e.indexOf("set")||!mt(t["get"+e.substr(3)])?e:"get"+e.substr(3)](l):t[e]():u,f=mt(u)?l?Z1:Kp:Rl,p;if(Mt(r)&&(~r.indexOf("random(")&&(r=qr(r)),r.charAt(1)==="="&&(p=zi(d,r)+(Ot(d)||0),(p||p===0)&&(r=p))),!c||d!==r||jh)return!isNaN(d*r)&&r!==""?(p=new qt(this._pt,t,e,+d||0,r-(d||0),typeof u=="boolean"?Q1:Zp,0,f),l&&(p.fp=l),a&&p.modifier(a,this,t),this._pt=p):(!u&&!(e in t)&&Sl(e,r),X1.call(this,t,e,d,r,f,h||ae.stringFilter,l))},j1=function(t,e,i,r,n){if(mt(t)&&(t=Ir(t,n,e,i,r)),!Je(t)||t.style&&t.nodeType||Dt(t)||gp(t))return Mt(t)?Ir(t,n,e,i,r):t;var o={},a;for(a in t)o[a]=Ir(t[a],n,e,i,r);return o},jp=function(t,e,i,r,n,o){var a,h,l,c;if(se[t]&&(a=new se[t]).init(n,a.rawVars?e[t]:j1(e[t],r,n,o,i),i,r,o)!==!1&&(i._pt=h=new qt(i._pt,n,t,0,1,a.render,a,0,a.priority),i!==Di))for(l=i._ptLookup[i._targets.indexOf(n)],c=a._props.length;c--;)l[a._props[c]]=h;return a},xs,jh,Il=function s(t,e,i){var r=t.vars,n=r.ease,o=r.startAt,a=r.immediateRender,h=r.lazy,l=r.onUpdate,c=r.onUpdateParams,u=r.callbackScope,d=r.runBackwards,f=r.yoyoEase,p=r.keyframes,m=r.autoRevert,_=t._dur,x=t._startAt,g=t._targets,y=t.parent,w=y&&y.data==="nested"?y.vars.targets:g,v=t._overwrite==="auto"&&!vl,S=t.timeline,C,T,A,P,I,Z,q,j,H,st,at,It,Qe;if(S&&(!p||!n)&&(n="none"),t._ease=ni(n,Ji.ease),t._yEase=f?Wp(ni(f===!0?n:f,Ji.ease)):0,f&&t._yoyo&&!t._repeat&&(f=t._yEase,t._yEase=t._ease,t._ease=f),t._from=!S&&!!r.runBackwards,!S||p&&!r.stagger){if(j=g[0]?ii(g[0]).harness:0,It=j&&r[j.prop],C=go(r,Al),x&&(x._zTime<0&&x.progress(1),e<0&&d&&a&&!m?x.render(-1,!0):x.revert(d&&_?jn:b1),x._lazy=0),o){if(As(t._startAt=vt.set(g,Se({data:"isStart",overwrite:!1,parent:y,immediateRender:!0,lazy:!x&&jt(h),startAt:null,delay:0,onUpdate:l,onUpdateParams:c,callbackScope:u,stagger:0},o))),t._startAt._dp=0,t._startAt._sat=t,e<0&&(Nt||!a&&!m)&&t._startAt.revert(jn),a&&_&&e<=0&&i<=0){e&&(t._zTime=e);return}}else if(d&&_&&!x){if(e&&(a=!1),A=Se({overwrite:!1,data:"isFromStart",lazy:a&&!x&&jt(h),immediateRender:a,stagger:0,parent:y},C),It&&(A[j.prop]=It),As(t._startAt=vt.set(g,A)),t._startAt._dp=0,t._startAt._sat=t,e<0&&(Nt?t._startAt.revert(jn):t._startAt.render(-1,!0)),t._zTime=e,!a)s(t._startAt,rt,rt);else if(!e)return}for(t._pt=t._ptCache=0,h=_&&jt(h)||h&&!_,T=0;T<g.length;T++){if(I=g[T],q=I._gsap||El(g)[T]._gsap,t._ptLookup[T]=st={},Gh[q.id]&&vs.length&&mo(),at=w===g?T:w.indexOf(I),j&&(H=new j).init(I,It||C,t,at,w)!==!1&&(t._pt=P=new qt(t._pt,I,H.name,0,1,H.render,H,0,H.priority),H._props.forEach(function(R){st[R]=P}),H.priority&&(Z=1)),!j||It)for(A in C)se[A]&&(H=jp(A,C,t,at,I,w))?H.priority&&(Z=1):st[A]=P=Ml.call(t,I,A,"get",C[A],at,w,0,r.stringFilter);t._op&&t._op[T]&&t.kill(I,t._op[T]),v&&t._pt&&(xs=t,ft.killTweensOf(I,st,t.globalTime(e)),Qe=!t.parent,xs=0),t._pt&&h&&(Gh[q.id]=1)}Z&&Qp(t),t._onInit&&t._onInit(t)}t._onUpdate=l,t._initted=(!t._op||t._pt)&&!Qe,p&&e<=0&&S.render(we,!0,!0)},Y1=function(t,e,i,r,n,o,a){var h=(t._pt&&t._ptCache||(t._ptCache={}))[e],l,c,u,d;if(!h)for(h=t._ptCache[e]=[],u=t._ptLookup,d=t._targets.length;d--;){if(l=u[d][e],l&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==e&&l.fp!==e;)l=l._next;if(!l)return jh=1,t.vars[e]="+=0",Il(t,a),jh=0,1;h.push(l)}for(d=h.length;d--;)c=h[d],l=c._pt||c,l.s=(r||r===0)&&!n?r:l.s+(r||0)+o*l.c,l.c=i-l.s,c.e&&(c.e=yt(i)+Ot(c.e)),c.b&&(c.b=l.s+Ot(c.b))},q1=function(t,e){var i=t[0]?ii(t[0]).harness:0,r=i&&i.aliases,n,o,a,h;if(!r)return e;n=fi({},e);for(o in r)if(o in n)for(h=r[o].split(","),a=h.length;a--;)n[h[a]]=n[o];return n},K1=function(t,e,i,r){var n=e.ease||r||"power1.inOut",o,a;if(Dt(e))a=i[t]||(i[t]=[]),e.forEach(function(h,l){return a.push({t:l/(e.length-1)*100,v:h,e:n})});else for(o in e)a=i[o]||(i[o]=[]),o==="ease"||a.push({t:parseFloat(t),v:e[o],e:n})},Ir=function(t,e,i,r,n){return mt(t)?t.call(e,i,r,n):Mt(t)&&~t.indexOf("random(")?qr(t):t},Yp=Pl+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",qp={};Yt(Yp+",id,stagger,delay,duration,paused,scrollTrigger",function(s){return qp[s]=1});var vt=function(s){pp(t,s);function t(i,r,n,o){var a;typeof r=="number"&&(n.duration=r,r=n,n=null),a=s.call(this,o?r:Er(r))||this;var h=a.vars,l=h.duration,c=h.delay,u=h.immediateRender,d=h.stagger,f=h.overwrite,p=h.keyframes,m=h.defaults,_=h.scrollTrigger,x=h.yoyoEase,g=r.parent||ft,y=(Dt(i)||gp(i)?us(i[0]):"length"in r)?[i]:ve(i),w,v,S,C,T,A,P,I;if(a._targets=y.length?El(y):_o("GSAP target "+i+" not found. https://greensock.com",!ae.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=f,p||d||kn(l)||kn(c)){if(r=a.vars,w=a.timeline=new Ht({data:"nested",defaults:m||{},targets:g&&g.data==="nested"?g.vars.targets:y}),w.kill(),w.parent=w._dp=is(a),w._start=0,d||kn(l)||kn(c)){if(C=y.length,P=d&&Fp(d),Je(d))for(T in d)~Yp.indexOf(T)&&(I||(I={}),I[T]=d[T]);for(v=0;v<C;v++)S=go(r,qp),S.stagger=0,x&&(S.yoyoEase=x),I&&fi(S,I),A=y[v],S.duration=+Ir(l,is(a),v,A,y),S.delay=(+Ir(c,is(a),v,A,y)||0)-a._delay,!d&&C===1&&S.delay&&(a._delay=c=S.delay,a._start+=c,S.delay=0),w.to(A,S,P?P(v,A,y):0),w._ease=X.none;w.duration()?l=c=0:a.timeline=0}else if(p){Er(Se(w.vars.defaults,{ease:"none"})),w._ease=ni(p.ease||r.ease||"none");var Z=0,q,j,H;if(Dt(p))p.forEach(function(st){return w.to(y,st,">")}),w.duration();else{S={};for(T in p)T==="ease"||T==="easeEach"||K1(T,p[T],S,p.easeEach);for(T in S)for(q=S[T].sort(function(st,at){return st.t-at.t}),Z=0,v=0;v<q.length;v++)j=q[v],H={ease:j.e,duration:(j.t-(v?q[v-1].t:0))/100*l},H[T]=j.v,w.to(y,H,Z),Z+=H.duration;w.duration()<l&&w.to({},{duration:l-w.duration()})}}l||a.duration(l=w.duration())}else a.timeline=0;return f===!0&&!vl&&(xs=is(a),ft.killTweensOf(y),xs=0),He(g,is(a),n),r.reversed&&a.reverse(),r.paused&&a.paused(!0),(u||!l&&!p&&a._start===kt(g._time)&&jt(u)&&A1(is(a))&&g.data!=="nested")&&(a._tTime=-rt,a.render(Math.max(0,-c)||0)),_&&Rp(is(a),_),a}var e=t.prototype;return e.render=function(r,n,o){var a=this._time,h=this._tDur,l=this._dur,c=r<0,u=r>h-rt&&!c?h:r<rt?0:r,d,f,p,m,_,x,g,y,w;if(!l)E1(this,r,n,o);else if(u!==this._tTime||!r||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==c){if(d=u,y=this.timeline,this._repeat){if(m=l+this._rDelay,this._repeat<-1&&c)return this.totalTime(m*100+r,n,o);if(d=kt(u%m),u===h?(p=this._repeat,d=l):(p=~~(u/m),p&&p===u/m&&(d=l,p--),d>l&&(d=l)),x=this._yoyo&&p&1,x&&(w=this._yEase,d=l-d),_=Qi(this._tTime,m),d===a&&!o&&this._initted)return this._tTime=u,this;p!==_&&(y&&this._yEase&&zp(y,x),this.vars.repeatRefresh&&!x&&!this._lock&&(this._lock=o=1,this.render(kt(m*p),!0).invalidate()._lock=0))}if(!this._initted){if(kp(this,c?r:d,o,n,u))return this._tTime=0,this;if(a!==this._time)return this;if(l!==this._dur)return this.render(r,n,o)}if(this._tTime=u,this._time=d,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=g=(w||this._ease)(d/l),this._from&&(this.ratio=g=1-g),d&&!a&&!n&&(Te(this,"onStart"),this._tTime!==u))return this;for(f=this._pt;f;)f.r(g,f.d),f=f._next;y&&y.render(r<0?r:!d&&x?-rt:y._dur*y._ease(d/this._dur),n,o)||this._startAt&&(this._zTime=r),this._onUpdate&&!n&&(c&&Vh(this,r,n,o),Te(this,"onUpdate")),this._repeat&&p!==_&&this.vars.onRepeat&&!n&&this.parent&&Te(this,"onRepeat"),(u===this._tDur||!u)&&this._tTime===u&&(c&&!this._onUpdate&&Vh(this,r,!0,!0),(r||!l)&&(u===this._tDur&&this._ts>0||!u&&this._ts<0)&&As(this,1),!n&&!(c&&!a)&&(u||a||x)&&(Te(this,u===h?"onComplete":"onReverseComplete",!0),this._prom&&!(u<h&&this.timeScale()>0)&&this._prom()))}return this},e.targets=function(){return this._targets},e.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),s.prototype.invalidate.call(this,r)},e.resetTo=function(r,n,o,a){Kr||re.wake(),this._ts||this.play();var h=Math.min(this._dur,(this._dp._time-this._start)*this._ts),l;return this._initted||Il(this,h),l=this._ease(h/this._dur),Y1(this,r,n,o,a,l,h)?this.resetTo(r,n,o,a):(No(this,0),this.parent||Mp(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},e.kill=function(r,n){if(n===void 0&&(n="all"),!r&&(!n||n==="all"))return this._lazy=this._pt=0,this.parent?Tr(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(r,n,xs&&xs.vars.overwrite!==!0)._first||Tr(this),this.parent&&o!==this.timeline.totalDuration()&&tr(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,h=r?ve(r):a,l=this._ptLookup,c=this._pt,u,d,f,p,m,_,x;if((!n||n==="all")&&C1(a,h))return n==="all"&&(this._pt=0),Tr(this);for(u=this._op=this._op||[],n!=="all"&&(Mt(n)&&(m={},Yt(n,function(g){return m[g]=1}),n=m),n=q1(a,n)),x=a.length;x--;)if(~h.indexOf(a[x])){d=l[x],n==="all"?(u[x]=n,p=d,f={}):(f=u[x]=u[x]||{},p=n);for(m in p)_=d&&d[m],_&&((!("kill"in _.d)||_.d.kill(m)===!0)&&Oo(this,_,"_pt"),delete d[m]),f!=="all"&&(f[m]=1)}return this._initted&&!this._pt&&c&&Tr(this),this},t.to=function(r,n){return new t(r,n,arguments[2])},t.from=function(r,n){return Mr(1,arguments)},t.delayedCall=function(r,n,o,a){return new t(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:n,onReverseComplete:n,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},t.fromTo=function(r,n,o){return Mr(2,arguments)},t.set=function(r,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new t(r,n)},t.killTweensOf=function(r,n,o){return ft.killTweensOf(r,n,o)},t}(sr);Se(vt.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});Yt("staggerTo,staggerFrom,staggerFromTo",function(s){vt[s]=function(){var t=new Ht,e=zh.call(arguments,0);return e.splice(s==="staggerFromTo"?5:4,0,0),t[s].apply(t,e)}});var Rl=function(t,e,i){return t[e]=i},Kp=function(t,e,i){return t[e](i)},Z1=function(t,e,i,r){return t[e](r.fp,i)},J1=function(t,e,i){return t.setAttribute(e,i)},kl=function(t,e){return mt(t[e])?Kp:Tl(t[e])&&t.setAttribute?J1:Rl},Zp=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e6)/1e6,e)},Q1=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},Jp=function(t,e){var i=e._pt,r="";if(!t&&e.b)r=e.b;else if(t===1&&e.e)r=e.e;else{for(;i;)r=i.p+(i.m?i.m(i.s+i.c*t):Math.round((i.s+i.c*t)*1e4)/1e4)+r,i=i._next;r+=e.c}e.set(e.t,e.p,r,e)},Bl=function(t,e){for(var i=e._pt;i;)i.r(t,i.d),i=i._next},tT=function(t,e,i,r){for(var n=this._pt,o;n;)o=n._next,n.p===r&&n.modifier(t,e,i),n=o},eT=function(t){for(var e=this._pt,i,r;e;)r=e._next,e.p===t&&!e.op||e.op===t?Oo(this,e,"_pt"):e.dep||(i=1),e=r;return!i},sT=function(t,e,i,r){r.mSet(t,e,r.m.call(r.tween,i,r.mt),r)},Qp=function(t){for(var e=t._pt,i,r,n,o;e;){for(i=e._next,r=n;r&&r.pr>e.pr;)r=r._next;(e._prev=r?r._prev:o)?e._prev._next=e:n=e,(e._next=r)?r._prev=e:o=e,e=i}t._pt=n},qt=function(){function s(e,i,r,n,o,a,h,l,c){this.t=i,this.s=n,this.c=o,this.p=r,this.r=a||Zp,this.d=h||this,this.set=l||Rl,this.pr=c||0,this._next=e,e&&(e._prev=this)}var t=s.prototype;return t.modifier=function(i,r,n){this.mSet=this.mSet||this.set,this.set=sT,this.m=i,this.mt=n,this.tween=r},s}();Yt(Pl+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(s){return Al[s]=1});de.TweenMax=de.TweenLite=vt;de.TimelineLite=de.TimelineMax=Ht;ft=new Ht({sortChildren:!1,defaults:Ji,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});ae.stringFilter=Vp;var ir=[],qn={},iT=[],yu=0,za=function(t){return(qn[t]||iT).map(function(e){return e()})},Yh=function(){var t=Date.now(),e=[];t-yu>2&&(za("matchMediaInit"),ir.forEach(function(i){var r=i.queries,n=i.conditions,o,a,h,l;for(a in r)o=ge.matchMedia(r[a]).matches,o&&(h=1),o!==n[a]&&(n[a]=o,l=1);l&&(i.revert(),h&&e.push(i))}),za("matchMediaRevert"),e.forEach(function(i){return i.onMatch(i)}),yu=t,za("matchMedia"))},t_=function(){function s(e,i){this.selector=i&&Hh(i),this.data=[],this._r=[],this.isReverted=!1,e&&this.add(e)}var t=s.prototype;return t.add=function(i,r,n){mt(i)&&(n=r,r=i,i=mt);var o=this,a=function(){var l=wt,c=o.selector,u;return l&&l!==o&&l.data.push(o),n&&(o.selector=Hh(n)),wt=o,u=r.apply(o,arguments),mt(u)&&o._r.push(u),wt=l,o.selector=c,o.isReverted=!1,u};return o.last=a,i===mt?a(o):i?o[i]=a:a},t.ignore=function(i){var r=wt;wt=null,i(this),wt=r},t.getTweens=function(){var i=[];return this.data.forEach(function(r){return r instanceof s?i.push.apply(i,r.getTweens()):r instanceof vt&&!(r.parent&&r.parent.data==="nested")&&i.push(r)}),i},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(i,r){var n=this;if(i){var o=this.getTweens();this.data.forEach(function(h){h.data==="isFlip"&&(h.revert(),h.getChildren(!0,!0,!1).forEach(function(l){return o.splice(o.indexOf(l),1)}))}),o.map(function(h){return{g:h.globalTime(0),t:h}}).sort(function(h,l){return l.g-h.g||-1}).forEach(function(h){return h.t.revert(i)}),this.data.forEach(function(h){return!(h instanceof sr)&&h.revert&&h.revert(i)}),this._r.forEach(function(h){return h(i,n)}),this.isReverted=!0}else this.data.forEach(function(h){return h.kill&&h.kill()});if(this.clear(),r){var a=ir.indexOf(this);~a&&ir.splice(a,1)}},t.revert=function(i){this.kill(i||{})},s}(),rT=function(){function s(e){this.contexts=[],this.scope=e}var t=s.prototype;return t.add=function(i,r,n){Je(i)||(i={matches:i});var o=new t_(0,n||this.scope),a=o.conditions={},h,l,c;this.contexts.push(o),r=o.add("onMatch",r),o.queries=i;for(l in i)l==="all"?c=1:(h=ge.matchMedia(i[l]),h&&(ir.indexOf(o)<0&&ir.push(o),(a[l]=h.matches)&&(c=1),h.addListener?h.addListener(Yh):h.addEventListener("change",Yh)));return c&&r(o),this},t.revert=function(i){this.kill(i||{})},t.kill=function(i){this.contexts.forEach(function(r){return r.kill(i,!0)})},s}(),xo={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];e.forEach(function(r){return D1(r)})},timeline:function(t){return new Ht(t)},getTweensOf:function(t,e){return ft.getTweensOf(t,e)},getProperty:function(t,e,i,r){Mt(t)&&(t=ve(t)[0]);var n=ii(t||{}).get,o=i?Ep:Pp;return i==="native"&&(i=""),t&&(e?o((se[e]&&se[e].get||n)(t,e,i,r)):function(a,h,l){return o((se[a]&&se[a].get||n)(t,a,h,l))})},quickSetter:function(t,e,i){if(t=ve(t),t.length>1){var r=t.map(function(c){return fe.quickSetter(c,e,i)}),n=r.length;return function(c){for(var u=n;u--;)r[u](c)}}t=t[0]||{};var o=se[e],a=ii(t),h=a.harness&&(a.harness.aliases||{})[e]||e,l=o?function(c){var u=new o;Di._pt=0,u.init(t,i?c+i:c,Di,0,[t]),u.render(1,u),Di._pt&&Bl(1,Di)}:a.set(t,h);return o?l:function(c){return l(t,h,i?c+i:c,a,1)}},quickTo:function(t,e,i){var r,n=fe.to(t,fi((r={},r[e]="+=0.1",r.paused=!0,r),i||{})),o=function(h,l,c){return n.resetTo(e,h,l,c)};return o.tween=n,o},isTweening:function(t){return ft.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=ni(t.ease,Ji.ease)),fu(Ji,t||{})},config:function(t){return fu(ae,t||{})},registerEffect:function(t){var e=t.name,i=t.effect,r=t.plugins,n=t.defaults,o=t.extendTimeline;(r||"").split(",").forEach(function(a){return a&&!se[a]&&!de[a]&&_o(e+" effect requires "+a+" plugin.")}),$a[e]=function(a,h,l){return i(ve(a),Se(h||{},n),l)},o&&(Ht.prototype[e]=function(a,h,l){return this.add($a[e](a,Je(h)?h:(l=h)&&{},this),l)})},registerEase:function(t,e){X[t]=ni(e)},parseEase:function(t,e){return arguments.length?ni(t,e):X},getById:function(t){return ft.getById(t)},exportRoot:function(t,e){t===void 0&&(t={});var i=new Ht(t),r,n;for(i.smoothChildTiming=jt(t.smoothChildTiming),ft.remove(i),i._dp=0,i._time=i._tTime=ft._time,r=ft._first;r;)n=r._next,(e||!(!r._dur&&r instanceof vt&&r.vars.onComplete===r._targets[0]))&&He(i,r,r._start-r._delay),r=n;return He(ft,i,0),i},context:function(t,e){return t?new t_(t,e):wt},matchMedia:function(t){return new rT(t)},matchMediaRefresh:function(){return ir.forEach(function(t){var e=t.conditions,i,r;for(r in e)e[r]&&(e[r]=!1,i=1);i&&t.revert()})||Yh()},addEventListener:function(t,e){var i=qn[t]||(qn[t]=[]);~i.indexOf(e)||i.push(e)},removeEventListener:function(t,e){var i=qn[t],r=i&&i.indexOf(e);r>=0&&i.splice(r,1)},utils:{wrap:O1,wrapYoyo:U1,distribute:Fp,random:Up,snap:Op,normalize:F1,getUnit:Ot,clamp:R1,splitColor:$p,toArray:ve,selector:Hh,mapRange:Dp,pipe:B1,unitize:L1,interpolate:N1,shuffle:Lp},install:vp,effects:$a,ticker:re,updateRoot:Ht.updateRoot,plugins:se,globalTimeline:ft,core:{PropTween:qt,globals:Tp,Tween:vt,Timeline:Ht,Animation:sr,getCache:ii,_removeLinkedListItem:Oo,reverting:function(){return Nt},context:function(t){return t&&wt&&(wt.data.push(t),t._ctx=wt),wt},suppressOverwrites:function(t){return vl=t}}};Yt("to,from,fromTo,delayedCall,set,killTweensOf",function(s){return xo[s]=vt[s]});re.add(Ht.updateRoot);Di=xo.to({},{duration:0});var nT=function(t,e){for(var i=t._pt;i&&i.p!==e&&i.op!==e&&i.fp!==e;)i=i._next;return i},oT=function(t,e){var i=t._targets,r,n,o;for(r in e)for(n=i.length;n--;)o=t._ptLookup[n][r],o&&(o=o.d)&&(o._pt&&(o=nT(o,r)),o&&o.modifier&&o.modifier(e[r],t,i[n],r))},Ha=function(t,e){return{name:t,rawVars:1,init:function(r,n,o){o._onInit=function(a){var h,l;if(Mt(n)&&(h={},Yt(n,function(c){return h[c]=1}),n=h),e){h={};for(l in n)h[l]=e(n[l]);n=h}oT(a,n)}}}},fe=xo.registerPlugin({name:"attr",init:function(t,e,i,r,n){var o,a,h;this.tween=i;for(o in e)h=t.getAttribute(o)||"",a=this.add(t,"setAttribute",(h||0)+"",e[o],r,n,0,0,o),a.op=o,a.b=h,this._props.push(o)},render:function(t,e){for(var i=e._pt;i;)Nt?i.set(i.t,i.p,i.b,i):i.r(t,i.d),i=i._next}},{name:"endArray",init:function(t,e){for(var i=e.length;i--;)this.add(t,i,t[i]||0,e[i],0,0,0,0,0,1)}},Ha("roundProps",Xh),Ha("modifiers"),Ha("snap",Op))||xo;vt.version=Ht.version=fe.version="3.11.4";wp=1;mp()&&er();X.Power0;X.Power1;X.Power2;X.Power3;X.Power4;X.Linear;X.Quad;X.Cubic;X.Quart;X.Quint;X.Strong;X.Elastic;X.Back;X.SteppedEase;X.Bounce;X.Sine;X.Expo;X.Circ;/*!
 * CSSPlugin 3.11.4
 * https://greensock.com
 *
 * Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var xu,bs,Hi,Ll,ei,bu,Fl,aT=function(){return typeof window<"u"},ds={},Ys=180/Math.PI,Xi=Math.PI/180,Ci=Math.atan2,wu=1e8,Ol=/([A-Z])/g,hT=/(left|right|width|margin|padding|x)/i,lT=/[\s,\(]\S/,hs={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},qh=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},cT=function(t,e){return e.set(e.t,e.p,t===1?e.e:Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},uT=function(t,e){return e.set(e.t,e.p,t?Math.round((e.s+e.c*t)*1e4)/1e4+e.u:e.b,e)},dT=function(t,e){var i=e.s+e.c*t;e.set(e.t,e.p,~~(i+(i<0?-.5:.5))+e.u,e)},e_=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},s_=function(t,e){return e.set(e.t,e.p,t!==1?e.b:e.e,e)},fT=function(t,e,i){return t.style[e]=i},pT=function(t,e,i){return t.style.setProperty(e,i)},_T=function(t,e,i){return t._gsap[e]=i},mT=function(t,e,i){return t._gsap.scaleX=t._gsap.scaleY=i},gT=function(t,e,i,r,n){var o=t._gsap;o.scaleX=o.scaleY=i,o.renderTransform(n,o)},yT=function(t,e,i,r,n){var o=t._gsap;o[e]=i,o.renderTransform(n,o)},_t="transform",Ne=_t+"Origin",xT=function(t,e){var i=this,r=this.target,n=r.style;if(t in ds){if(this.tfm=this.tfm||{},t!=="transform"&&(t=hs[t]||t,~t.indexOf(",")?t.split(",").forEach(function(o){return i.tfm[o]=rs(r,o)}):this.tfm[t]=r._gsap.x?r._gsap[t]:rs(r,t)),this.props.indexOf(_t)>=0)return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(Ne,e,"")),t=_t}(n||e)&&this.props.push(t,e,n[t])},i_=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},bT=function(){var t=this.props,e=this.target,i=e.style,r=e._gsap,n,o;for(n=0;n<t.length;n+=3)t[n+1]?e[t[n]]=t[n+2]:t[n+2]?i[t[n]]=t[n+2]:i.removeProperty(t[n].replace(Ol,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)r[o]=this.tfm[o];r.svg&&(r.renderTransform(),e.setAttribute("data-svg-origin",this.svgo||"")),n=Fl(),n&&!n.isStart&&!i[_t]&&(i_(i),r.uncache=1)}},r_=function(t,e){var i={target:t,props:[],revert:bT,save:xT};return e&&e.split(",").forEach(function(r){return i.save(r)}),i},n_,Kh=function(t,e){var i=bs.createElementNS?bs.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):bs.createElement(t);return i.style?i:bs.createElement(t)},Ke=function s(t,e,i){var r=getComputedStyle(t);return r[e]||r.getPropertyValue(e.replace(Ol,"-$1").toLowerCase())||r.getPropertyValue(e)||!i&&s(t,rr(e)||e,1)||""},vu="O,Moz,ms,Ms,Webkit".split(","),rr=function(t,e,i){var r=e||ei,n=r.style,o=5;if(t in n&&!i)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);o--&&!(vu[o]+t in n););return o<0?null:(o===3?"ms":o>=0?vu[o]:"")+t},Zh=function(){aT()&&window.document&&(xu=window,bs=xu.document,Hi=bs.documentElement,ei=Kh("div")||{style:{}},Kh("div"),_t=rr(_t),Ne=_t+"Origin",ei.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",n_=!!rr("perspective"),Fl=fe.core.reverting,Ll=1)},Xa=function s(t){var e=Kh("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,r=this.nextSibling,n=this.style.cssText,o;if(Hi.appendChild(e),e.appendChild(this),this.style.display="block",t)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=s}catch{}else this._gsapBBox&&(o=this._gsapBBox());return i&&(r?i.insertBefore(this,r):i.appendChild(this)),Hi.removeChild(e),this.style.cssText=n,o},Tu=function(t,e){for(var i=e.length;i--;)if(t.hasAttribute(e[i]))return t.getAttribute(e[i])},o_=function(t){var e;try{e=t.getBBox()}catch{e=Xa.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===Xa||(e=Xa.call(t,!0)),e&&!e.width&&!e.x&&!e.y?{x:+Tu(t,["x","cx","x1"])||0,y:+Tu(t,["y","cy","y1"])||0,width:0,height:0}:e},a_=function(t){return!!(t.getCTM&&(!t.parentNode||t.ownerSVGElement)&&o_(t))},Zr=function(t,e){if(e){var i=t.style;e in ds&&e!==Ne&&(e=_t),i.removeProperty?((e.substr(0,2)==="ms"||e.substr(0,6)==="webkit")&&(e="-"+e),i.removeProperty(e.replace(Ol,"-$1").toLowerCase())):i.removeAttribute(e)}},ws=function(t,e,i,r,n,o){var a=new qt(t._pt,e,i,0,1,o?s_:e_);return t._pt=a,a.b=r,a.e=n,t._props.push(i),a},Cu={deg:1,rad:1,turn:1},wT={grid:1,flex:1},Ps=function s(t,e,i,r){var n=parseFloat(i)||0,o=(i+"").trim().substr((n+"").length)||"px",a=ei.style,h=hT.test(e),l=t.tagName.toLowerCase()==="svg",c=(l?"client":"offset")+(h?"Width":"Height"),u=100,d=r==="px",f=r==="%",p,m,_,x;return r===o||!n||Cu[r]||Cu[o]?n:(o!=="px"&&!d&&(n=s(t,e,i,"px")),x=t.getCTM&&a_(t),(f||o==="%")&&(ds[e]||~e.indexOf("adius"))?(p=x?t.getBBox()[h?"width":"height"]:t[c],yt(f?n/p*u:n/100*p)):(a[h?"width":"height"]=u+(d?o:r),m=~e.indexOf("adius")||r==="em"&&t.appendChild&&!l?t:t.parentNode,x&&(m=(t.ownerSVGElement||{}).parentNode),(!m||m===bs||!m.appendChild)&&(m=bs.body),_=m._gsap,_&&f&&_.width&&h&&_.time===re.time&&!_.uncache?yt(n/_.width*u):((f||o==="%")&&!wT[Ke(m,"display")]&&(a.position=Ke(t,"position")),m===t&&(a.position="static"),m.appendChild(ei),p=ei[c],m.removeChild(ei),a.position="absolute",h&&f&&(_=ii(m),_.time=re.time,_.width=m[c]),yt(d?p*n/u:p&&n?u/p*n:0))))},rs=function(t,e,i,r){var n;return Ll||Zh(),e in hs&&e!=="transform"&&(e=hs[e],~e.indexOf(",")&&(e=e.split(",")[0])),ds[e]&&e!=="transform"?(n=Qr(t,r),n=e!=="transformOrigin"?n[e]:n.svg?n.origin:wo(Ke(t,Ne))+" "+n.zOrigin+"px"):(n=t.style[e],(!n||n==="auto"||r||~(n+"").indexOf("calc("))&&(n=bo[e]&&bo[e](t,e,i)||Ke(t,e)||Sp(t,e)||(e==="opacity"?1:0))),i&&!~(n+"").trim().indexOf(" ")?Ps(t,e,n,i)+i:n},vT=function(t,e,i,r){if(!i||i==="none"){var n=rr(e,t,1),o=n&&Ke(t,n,1);o&&o!==i?(e=n,i=o):e==="borderColor"&&(i=Ke(t,"borderTopColor"))}var a=new qt(this._pt,t.style,e,0,1,Jp),h=0,l=0,c,u,d,f,p,m,_,x,g,y,w,v;if(a.b=i,a.e=r,i+="",r+="",r==="auto"&&(t.style[e]=r,r=Ke(t,e)||r,t.style[e]=i),c=[i,r],Vp(c),i=c[0],r=c[1],d=i.match(Ni)||[],v=r.match(Ni)||[],v.length){for(;u=Ni.exec(r);)_=u[0],g=r.substring(h,u.index),p?p=(p+1)%5:(g.substr(-5)==="rgba("||g.substr(-5)==="hsla(")&&(p=1),_!==(m=d[l++]||"")&&(f=parseFloat(m)||0,w=m.substr((f+"").length),_.charAt(1)==="="&&(_=zi(f,_)+w),x=parseFloat(_),y=_.substr((x+"").length),h=Ni.lastIndex-y.length,y||(y=y||ae.units[e]||w,h===r.length&&(r+=y,a.e+=y)),w!==y&&(f=Ps(t,e,m,y)||0),a._pt={_next:a._pt,p:g||l===1?g:",",s:f,c:x-f,m:p&&p<4||e==="zIndex"?Math.round:0});a.c=h<r.length?r.substring(h,r.length):""}else a.r=e==="display"&&r==="none"?s_:e_;return xp.test(r)&&(a.e=0),this._pt=a,a},Su={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},TT=function(t){var e=t.split(" "),i=e[0],r=e[1]||"50%";return(i==="top"||i==="bottom"||r==="left"||r==="right")&&(t=i,i=r,r=t),e[0]=Su[i]||i,e[1]=Su[r]||r,e.join(" ")},CT=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var i=e.t,r=i.style,n=e.u,o=i._gsap,a,h,l;if(n==="all"||n===!0)r.cssText="",h=1;else for(n=n.split(","),l=n.length;--l>-1;)a=n[l],ds[a]&&(h=1,a=a==="transformOrigin"?Ne:_t),Zr(i,a);h&&(Zr(i,_t),o&&(o.svg&&i.removeAttribute("transform"),Qr(i,1),o.uncache=1,i_(r)))}},bo={clearProps:function(t,e,i,r,n){if(n.data!=="isFromStart"){var o=t._pt=new qt(t._pt,e,i,0,0,CT);return o.u=r,o.pr=-10,o.tween=n,t._props.push(i),1}}},Jr=[1,0,0,1,0,0],h_={},l_=function(t){return t==="matrix(1, 0, 0, 1, 0, 0)"||t==="none"||!t},Au=function(t){var e=Ke(t,_t);return l_(e)?Jr:e.substr(7).match(yp).map(yt)},Ul=function(t,e){var i=t._gsap||ii(t),r=t.style,n=Au(t),o,a,h,l;return i.svg&&t.getAttribute("transform")?(h=t.transform.baseVal.consolidate().matrix,n=[h.a,h.b,h.c,h.d,h.e,h.f],n.join(",")==="1,0,0,1,0,0"?Jr:n):(n===Jr&&!t.offsetParent&&t!==Hi&&!i.svg&&(h=r.display,r.display="block",o=t.parentNode,(!o||!t.offsetParent)&&(l=1,a=t.nextElementSibling,Hi.appendChild(t)),n=Au(t),h?r.display=h:Zr(t,"display"),l&&(a?o.insertBefore(t,a):o?o.appendChild(t):Hi.removeChild(t))),e&&n.length>6?[n[0],n[1],n[4],n[5],n[12],n[13]]:n)},Jh=function(t,e,i,r,n,o){var a=t._gsap,h=n||Ul(t,!0),l=a.xOrigin||0,c=a.yOrigin||0,u=a.xOffset||0,d=a.yOffset||0,f=h[0],p=h[1],m=h[2],_=h[3],x=h[4],g=h[5],y=e.split(" "),w=parseFloat(y[0])||0,v=parseFloat(y[1])||0,S,C,T,A;i?h!==Jr&&(C=f*_-p*m)&&(T=w*(_/C)+v*(-m/C)+(m*g-_*x)/C,A=w*(-p/C)+v*(f/C)-(f*g-p*x)/C,w=T,v=A):(S=o_(t),w=S.x+(~y[0].indexOf("%")?w/100*S.width:w),v=S.y+(~(y[1]||y[0]).indexOf("%")?v/100*S.height:v)),r||r!==!1&&a.smooth?(x=w-l,g=v-c,a.xOffset=u+(x*f+g*m)-x,a.yOffset=d+(x*p+g*_)-g):a.xOffset=a.yOffset=0,a.xOrigin=w,a.yOrigin=v,a.smooth=!!r,a.origin=e,a.originIsAbsolute=!!i,t.style[Ne]="0px 0px",o&&(ws(o,a,"xOrigin",l,w),ws(o,a,"yOrigin",c,v),ws(o,a,"xOffset",u,a.xOffset),ws(o,a,"yOffset",d,a.yOffset)),t.setAttribute("data-svg-origin",w+" "+v)},Qr=function(t,e){var i=t._gsap||new Xp(t);if("x"in i&&!e&&!i.uncache)return i;var r=t.style,n=i.scaleX<0,o="px",a="deg",h=getComputedStyle(t),l=Ke(t,Ne)||"0",c,u,d,f,p,m,_,x,g,y,w,v,S,C,T,A,P,I,Z,q,j,H,st,at,It,Qe,R,U,W,nt,J,lt;return c=u=d=m=_=x=g=y=w=0,f=p=1,i.svg=!!(t.getCTM&&a_(t)),h.translate&&((h.translate!=="none"||h.scale!=="none"||h.rotate!=="none")&&(r[_t]=(h.translate!=="none"?"translate3d("+(h.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(h.rotate!=="none"?"rotate("+h.rotate+") ":"")+(h.scale!=="none"?"scale("+h.scale.split(" ").join(",")+") ":"")+(h[_t]!=="none"?h[_t]:"")),r.scale=r.rotate=r.translate="none"),C=Ul(t,i.svg),i.svg&&(i.uncache?(It=t.getBBox(),l=i.xOrigin-It.x+"px "+(i.yOrigin-It.y)+"px",at=""):at=!e&&t.getAttribute("data-svg-origin"),Jh(t,at||l,!!at||i.originIsAbsolute,i.smooth!==!1,C)),v=i.xOrigin||0,S=i.yOrigin||0,C!==Jr&&(I=C[0],Z=C[1],q=C[2],j=C[3],c=H=C[4],u=st=C[5],C.length===6?(f=Math.sqrt(I*I+Z*Z),p=Math.sqrt(j*j+q*q),m=I||Z?Ci(Z,I)*Ys:0,g=q||j?Ci(q,j)*Ys+m:0,g&&(p*=Math.abs(Math.cos(g*Xi))),i.svg&&(c-=v-(v*I+S*q),u-=S-(v*Z+S*j))):(lt=C[6],nt=C[7],R=C[8],U=C[9],W=C[10],J=C[11],c=C[12],u=C[13],d=C[14],T=Ci(lt,W),_=T*Ys,T&&(A=Math.cos(-T),P=Math.sin(-T),at=H*A+R*P,It=st*A+U*P,Qe=lt*A+W*P,R=H*-P+R*A,U=st*-P+U*A,W=lt*-P+W*A,J=nt*-P+J*A,H=at,st=It,lt=Qe),T=Ci(-q,W),x=T*Ys,T&&(A=Math.cos(-T),P=Math.sin(-T),at=I*A-R*P,It=Z*A-U*P,Qe=q*A-W*P,J=j*P+J*A,I=at,Z=It,q=Qe),T=Ci(Z,I),m=T*Ys,T&&(A=Math.cos(T),P=Math.sin(T),at=I*A+Z*P,It=H*A+st*P,Z=Z*A-I*P,st=st*A-H*P,I=at,H=It),_&&Math.abs(_)+Math.abs(m)>359.9&&(_=m=0,x=180-x),f=yt(Math.sqrt(I*I+Z*Z+q*q)),p=yt(Math.sqrt(st*st+lt*lt)),T=Ci(H,st),g=Math.abs(T)>2e-4?T*Ys:0,w=J?1/(J<0?-J:J):0),i.svg&&(at=t.getAttribute("transform"),i.forceCSS=t.setAttribute("transform","")||!l_(Ke(t,_t)),at&&t.setAttribute("transform",at))),Math.abs(g)>90&&Math.abs(g)<270&&(n?(f*=-1,g+=m<=0?180:-180,m+=m<=0?180:-180):(p*=-1,g+=g<=0?180:-180)),e=e||i.uncache,i.x=c-((i.xPercent=c&&(!e&&i.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-c)?-50:0)))?t.offsetWidth*i.xPercent/100:0)+o,i.y=u-((i.yPercent=u&&(!e&&i.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-u)?-50:0)))?t.offsetHeight*i.yPercent/100:0)+o,i.z=d+o,i.scaleX=yt(f),i.scaleY=yt(p),i.rotation=yt(m)+a,i.rotationX=yt(_)+a,i.rotationY=yt(x)+a,i.skewX=g+a,i.skewY=y+a,i.transformPerspective=w+o,(i.zOrigin=parseFloat(l.split(" ")[2])||0)&&(r[Ne]=wo(l)),i.xOffset=i.yOffset=0,i.force3D=ae.force3D,i.renderTransform=i.svg?AT:n_?c_:ST,i.uncache=0,i},wo=function(t){return(t=t.split(" "))[0]+" "+t[1]},ja=function(t,e,i){var r=Ot(e);return yt(parseFloat(e)+parseFloat(Ps(t,"x",i+"px",r)))+r},ST=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,c_(t,e)},Os="0deg",mr="0px",Us=") ",c_=function(t,e){var i=e||this,r=i.xPercent,n=i.yPercent,o=i.x,a=i.y,h=i.z,l=i.rotation,c=i.rotationY,u=i.rotationX,d=i.skewX,f=i.skewY,p=i.scaleX,m=i.scaleY,_=i.transformPerspective,x=i.force3D,g=i.target,y=i.zOrigin,w="",v=x==="auto"&&t&&t!==1||x===!0;if(y&&(u!==Os||c!==Os)){var S=parseFloat(c)*Xi,C=Math.sin(S),T=Math.cos(S),A;S=parseFloat(u)*Xi,A=Math.cos(S),o=ja(g,o,C*A*-y),a=ja(g,a,-Math.sin(S)*-y),h=ja(g,h,T*A*-y+y)}_!==mr&&(w+="perspective("+_+Us),(r||n)&&(w+="translate("+r+"%, "+n+"%) "),(v||o!==mr||a!==mr||h!==mr)&&(w+=h!==mr||v?"translate3d("+o+", "+a+", "+h+") ":"translate("+o+", "+a+Us),l!==Os&&(w+="rotate("+l+Us),c!==Os&&(w+="rotateY("+c+Us),u!==Os&&(w+="rotateX("+u+Us),(d!==Os||f!==Os)&&(w+="skew("+d+", "+f+Us),(p!==1||m!==1)&&(w+="scale("+p+", "+m+Us),g.style[_t]=w||"translate(0, 0)"},AT=function(t,e){var i=e||this,r=i.xPercent,n=i.yPercent,o=i.x,a=i.y,h=i.rotation,l=i.skewX,c=i.skewY,u=i.scaleX,d=i.scaleY,f=i.target,p=i.xOrigin,m=i.yOrigin,_=i.xOffset,x=i.yOffset,g=i.forceCSS,y=parseFloat(o),w=parseFloat(a),v,S,C,T,A;h=parseFloat(h),l=parseFloat(l),c=parseFloat(c),c&&(c=parseFloat(c),l+=c,h+=c),h||l?(h*=Xi,l*=Xi,v=Math.cos(h)*u,S=Math.sin(h)*u,C=Math.sin(h-l)*-d,T=Math.cos(h-l)*d,l&&(c*=Xi,A=Math.tan(l-c),A=Math.sqrt(1+A*A),C*=A,T*=A,c&&(A=Math.tan(c),A=Math.sqrt(1+A*A),v*=A,S*=A)),v=yt(v),S=yt(S),C=yt(C),T=yt(T)):(v=u,T=d,S=C=0),(y&&!~(o+"").indexOf("px")||w&&!~(a+"").indexOf("px"))&&(y=Ps(f,"x",o,"px"),w=Ps(f,"y",a,"px")),(p||m||_||x)&&(y=yt(y+p-(p*v+m*C)+_),w=yt(w+m-(p*S+m*T)+x)),(r||n)&&(A=f.getBBox(),y=yt(y+r/100*A.width),w=yt(w+n/100*A.height)),A="matrix("+v+","+S+","+C+","+T+","+y+","+w+")",f.setAttribute("transform",A),g&&(f.style[_t]=A)},PT=function(t,e,i,r,n){var o=360,a=Mt(n),h=parseFloat(n)*(a&&~n.indexOf("rad")?Ys:1),l=h-r,c=r+l+"deg",u,d;return a&&(u=n.split("_")[1],u==="short"&&(l%=o,l!==l%(o/2)&&(l+=l<0?o:-o)),u==="cw"&&l<0?l=(l+o*wu)%o-~~(l/o)*o:u==="ccw"&&l>0&&(l=(l-o*wu)%o-~~(l/o)*o)),t._pt=d=new qt(t._pt,e,i,r,l,cT),d.e=c,d.u="deg",t._props.push(i),d},Pu=function(t,e){for(var i in e)t[i]=e[i];return t},ET=function(t,e,i){var r=Pu({},i._gsap),n="perspective,force3D,transformOrigin,svgOrigin",o=i.style,a,h,l,c,u,d,f,p;r.svg?(l=i.getAttribute("transform"),i.setAttribute("transform",""),o[_t]=e,a=Qr(i,1),Zr(i,_t),i.setAttribute("transform",l)):(l=getComputedStyle(i)[_t],o[_t]=e,a=Qr(i,1),o[_t]=l);for(h in ds)l=r[h],c=a[h],l!==c&&n.indexOf(h)<0&&(f=Ot(l),p=Ot(c),u=f!==p?Ps(i,h,l,p):parseFloat(l),d=parseFloat(c),t._pt=new qt(t._pt,a,h,u,d-u,qh),t._pt.u=p||0,t._props.push(h));Pu(a,r)};Yt("padding,margin,Width,Radius",function(s,t){var e="Top",i="Right",r="Bottom",n="Left",o=(t<3?[e,i,r,n]:[e+n,e+i,r+i,r+n]).map(function(a){return t<2?s+a:"border"+a+s});bo[t>1?"border"+s:s]=function(a,h,l,c,u){var d,f;if(arguments.length<4)return d=o.map(function(p){return rs(a,p,l)}),f=d.join(" "),f.split(d[0]).length===5?d[0]:f;d=(c+"").split(" "),f={},o.forEach(function(p,m){return f[p]=d[m]=d[m]||d[(m-1)/2|0]}),a.init(h,f,u)}});var u_={name:"css",register:Zh,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,i,r,n){var o=this._props,a=t.style,h=i.vars.startAt,l,c,u,d,f,p,m,_,x,g,y,w,v,S,C,T;Ll||Zh(),this.styles=this.styles||r_(t),T=this.styles.props,this.tween=i;for(m in e)if(m!=="autoRound"&&(c=e[m],!(se[m]&&jp(m,e,i,r,t,n)))){if(f=typeof c,p=bo[m],f==="function"&&(c=c.call(i,r,t,n),f=typeof c),f==="string"&&~c.indexOf("random(")&&(c=qr(c)),p)p(this,t,m,c,i)&&(C=1);else if(m.substr(0,2)==="--")l=(getComputedStyle(t).getPropertyValue(m)+"").trim(),c+="",Ts.lastIndex=0,Ts.test(l)||(_=Ot(l),x=Ot(c)),x?_!==x&&(l=Ps(t,m,l,x)+x):_&&(c+=_),this.add(a,"setProperty",l,c,r,n,0,0,m),o.push(m),T.push(m,0,a[m]);else if(f!=="undefined"){if(h&&m in h?(l=typeof h[m]=="function"?h[m].call(i,r,t,n):h[m],Mt(l)&&~l.indexOf("random(")&&(l=qr(l)),Ot(l+"")||(l+=ae.units[m]||Ot(rs(t,m))||""),(l+"").charAt(1)==="="&&(l=rs(t,m))):l=rs(t,m),d=parseFloat(l),g=f==="string"&&c.charAt(1)==="="&&c.substr(0,2),g&&(c=c.substr(2)),u=parseFloat(c),m in hs&&(m==="autoAlpha"&&(d===1&&rs(t,"visibility")==="hidden"&&u&&(d=0),T.push("visibility",0,a.visibility),ws(this,a,"visibility",d?"inherit":"hidden",u?"inherit":"hidden",!u)),m!=="scale"&&m!=="transform"&&(m=hs[m],~m.indexOf(",")&&(m=m.split(",")[0]))),y=m in ds,y){if(this.styles.save(m),w||(v=t._gsap,v.renderTransform&&!e.parseTransform||Qr(t,e.parseTransform),S=e.smoothOrigin!==!1&&v.smooth,w=this._pt=new qt(this._pt,a,_t,0,1,v.renderTransform,v,0,-1),w.dep=1),m==="scale")this._pt=new qt(this._pt,v,"scaleY",v.scaleY,(g?zi(v.scaleY,g+u):u)-v.scaleY||0,qh),this._pt.u=0,o.push("scaleY",m),m+="X";else if(m==="transformOrigin"){T.push(Ne,0,a[Ne]),c=TT(c),v.svg?Jh(t,c,0,S,0,this):(x=parseFloat(c.split(" ")[2])||0,x!==v.zOrigin&&ws(this,v,"zOrigin",v.zOrigin,x),ws(this,a,m,wo(l),wo(c)));continue}else if(m==="svgOrigin"){Jh(t,c,1,S,0,this);continue}else if(m in h_){PT(this,v,m,d,g?zi(d,g+c):c);continue}else if(m==="smoothOrigin"){ws(this,v,"smooth",v.smooth,c);continue}else if(m==="force3D"){v[m]=c;continue}else if(m==="transform"){ET(this,c,t);continue}}else m in a||(m=rr(m)||m);if(y||(u||u===0)&&(d||d===0)&&!lT.test(c)&&m in a)_=(l+"").substr((d+"").length),u||(u=0),x=Ot(c)||(m in ae.units?ae.units[m]:_),_!==x&&(d=Ps(t,m,l,x)),this._pt=new qt(this._pt,y?v:a,m,d,(g?zi(d,g+u):u)-d,!y&&(x==="px"||m==="zIndex")&&e.autoRound!==!1?dT:qh),this._pt.u=x||0,_!==x&&x!=="%"&&(this._pt.b=l,this._pt.r=uT);else if(m in a)vT.call(this,t,m,l,g?g+c:c);else if(m in t)this.add(t,m,l||t[m],g?g+c:c,r,n);else if(m!=="parseTransform"){Sl(m,c);continue}y||(m in a?T.push(m,0,a[m]):T.push(m,1,l||t[m])),o.push(m)}}C&&Qp(this)},render:function(t,e){if(e.tween._time||!Fl())for(var i=e._pt;i;)i.r(t,i.d),i=i._next;else e.styles.revert()},get:rs,aliases:hs,getSetter:function(t,e,i){var r=hs[e];return r&&r.indexOf(",")<0&&(e=r),e in ds&&e!==Ne&&(t._gsap.x||rs(t,"x"))?i&&bu===i?e==="scale"?mT:_T:(bu=i||{})&&(e==="scale"?gT:yT):t.style&&!Tl(t.style[e])?fT:~e.indexOf("-")?pT:kl(t,e)},core:{_removeProperty:Zr,_getMatrix:Ul}};fe.utils.checkPrefix=rr;fe.core.getStyleSaver=r_;(function(s,t,e,i){var r=Yt(s+","+t+","+e,function(n){ds[n]=1});Yt(t,function(n){ae.units[n]="deg",h_[n]=1}),hs[r[13]]=s+","+t,Yt(i,function(n){var o=n.split(":");hs[o[1]]=r[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");Yt("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(s){ae.units[s]="px"});fe.registerPlugin(u_);var O=fe.registerPlugin(u_)||fe;O.core.Tween;class MT{constructor(){b(this,"currentAlias");b(this,"current");b(this,"_globalVolume",.15);b(this,"_instanceVolume",.15)}async play(t,e){}setVolume(t){this._globalVolume=t,this.current&&(this.current.volume=this._globalVolume*this._instanceVolume)}getVolume(){return this._globalVolume}}class IT{constructor(){b(this,"_volume",.5)}play(t,e){}setVolume(t){this._volume=t}getVolume(){return this._volume}}const Rr={muted(s){s?Ti.muteAll():Ti.unmuteAll()},getMasterVolume(){return Ti.volumeAll},setMasterVolume(s){Ti.volumeAll=s,s?Ti.unmuteAll():Ti.muteAll()}},RT=new MT,he=new IT,kT=428,BT=925,D={content:{width:kT,height:BT},debugBody:!1,backgroundTileScale:2,decorEdgePadding:100,decorMinDistance:150,decorCountDesktop:6,decorCountMobile:3,forkMeURL:"https://github.com/pixijs/open-games"};class LT{constructor(){b(this,"screenView",new F);b(this,"overlayView",new F);b(this,"currentScreen");b(this,"currentScreenResize");b(this,"loadScreen");b(this,"currentOverlay");b(this,"currentOverlayResize");b(this,"_w");b(this,"_h");b(this,"_screenMap",new Map)}init(){Cs.stage.addChild(this.screenView,this.overlayView)}setLoadScreen(t){this.loadScreen=this._getScreen(t)}async showOverlay(t,e){this._showScreen(t,!0,e)}async goToScreen(t,e){this._showScreen(t,!1,e)}async hideOverlay(){this.currentOverlay&&this._removeScreen(this.currentOverlay,!0)}_getScreen(t){let e=this._screenMap.get(t.SCREEN_ID);return e||(e=new t,this._screenMap.set(t.SCREEN_ID,e)),e}async _addScreen(t,e=!1){(e?this.overlayView:this.screenView).addChild(t),t.resize&&(e?this.currentOverlayResize=()=>t.resize:this.currentScreenResize=()=>t.resize,t.resize(this._w,this._h)),t.update&&Cs.ticker.add(t.update,t),t.show&&await t.show()}async _removeScreen(t,e=!1){t.hide&&await t.hide(),e?this.currentOverlayResize&&window.removeEventListener("resize",this.currentOverlayResize):this.currentScreenResize&&window.removeEventListener("resize",this.currentScreenResize),t.update&&Cs.ticker.remove(t.update,t),t.parent&&t.parent.removeChild(t)}async _showScreen(t,e,i){var n,o,a,h;const r=e?this.currentOverlay:this.currentScreen;r&&await this._removeScreen(r),t.assetBundles&&!My(t.assetBundles)&&(this.loadScreen&&this._addScreen(this.loadScreen,e),await je.loadBundle(t.assetBundles),this.loadScreen&&this._removeScreen(this.loadScreen,e)),e?(this.currentOverlay=this._getScreen(t),(o=(n=this.currentOverlay).prepare)==null||o.call(n,i),await this._addScreen(this.currentOverlay,e)):(this.currentScreen=this._getScreen(t),(h=(a=this.currentScreen).prepare)==null||h.call(a,i),await this._addScreen(this.currentScreen,e))}resize(t,e){var i,r,n,o;this._w=t,this._h=e,(r=(i=this.currentScreen)==null?void 0:i.resize)==null||r.call(i,t,e),(o=(n=this.currentOverlay)==null?void 0:n.resize)==null||o.call(n,t,e)}}const ne=new LT;function xt(s,t,e=!0){const i=Math.random()*(t-s)+s;return e?Math.floor(i):i}function Ya(s,t=Math.random){return s[Math.floor(t()*s.length)]}const FT=["yellow","green","red","blue"],OT=["bomb","super","timer"],UT=["red","green","blue"],d_=13,NT=.5,DT=D.content.width/d_,$T={yellow:16763458,green:5832494,red:16736095,blue:6583295},M={screenTop:-D.content.height,minHeterogeneity:.5,heterogeneityIncrement:.01,startingLines:10,specialBubbleEvery:3,specialBubbleChance:.01,startingBubbleTypes:UT,bubbleTypes:FT,specialBubbleTypes:OT,bubbleTypeToColor:$T,bubblesPerLine:d_,bubbleSize:DT,bubbleOverflow:NT,bounceLine:145,maxAimLinesLength:600,maxAimLines:2,newLine:{animInTime:3,urgentAnimInTime:.15,urgentMinLines:8,animInDecrement:.05,maxDecrement:1.5,decrementIn:5},scoreIncrement:10,power:{blastRadius:2,timerFreezeTime:5}};function fs(s){switch(s){case"all":return Ya([...M.specialBubbleTypes,...M.bubbleTypes]);case"special":return Ya(M.specialBubbleTypes);default:return Ya(M.bubbleTypes)}}function Kn(s){return M.specialBubbleTypes.includes(s)}var f_=(s=>(s.Renderer="renderer",s.Application="application",s.WebGLRendererPipes="renderer-webgl-pipes",s.WebGLRendererPipesAdaptor="renderer-webgl-pipes-adaptor",s.WebGLRendererSystem="renderer-webgl-system",s.WebGPURendererPipes="renderer-webgpu-pipes",s.WebGPURendererPipesAdaptor="renderer-webgpu-pipes-adaptor",s.WebGPURendererSystem="renderer-webgpu-system",s.CanvasRendererSystem="renderer-canvas-system",s.CanvasRendererPipesAdaptor="renderer-canvas-pipes-adaptor",s.CanvasRendererPipes="renderer-canvas-pipes",s.Asset="asset",s.LoadParser="load-parser",s.ResolveParser="resolve-parser",s.CacheParser="cache-parser",s.DetectionParser="detection-parser",s.MaskEffect="mask-effect",s))(f_||{});const Qh=s=>{if(typeof s=="function"||typeof s=="object"&&s.extension){if(!s.extension)throw new Error("Extension class must have an extension object");s={...typeof s.extension!="object"?{type:s.extension}:s.extension,ref:s}}if(typeof s=="object")s={...s};else throw new Error("Invalid extension type");return typeof s.type=="string"&&(s.type=[s.type]),s},Bn=(s,t)=>Qh(s).priority??t,GT={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...s){return s.map(Qh).forEach(t=>{t.type.forEach(e=>{var i,r;return(r=(i=this._removeHandlers)[e])==null?void 0:r.call(i,t)})}),this},add(...s){return s.map(Qh).forEach(t=>{t.type.forEach(e=>{const i=this._addHandlers,r=this._queue;i[e]?i[e](t):(r[e]=r[e]||[],r[e].push(t))})}),this},handle(s,t,e){const i=this._addHandlers,r=this._removeHandlers;if(i[s]||r[s])throw new Error(`Extension type ${s} already has a handler`);i[s]=t,r[s]=e;const n=this._queue;return n[s]&&(n[s].forEach(o=>t(o)),delete n[s]),this},handleByMap(s,t){return this.handle(s,e=>{t[e.name]=e.ref},e=>{delete t[e.name]})},handleByNamedList(s,t,e=-1){return this.handle(s,i=>{t.findIndex(n=>n.name===i.name)>=0||(t.push({name:i.name,value:i.ref}),t.sort((n,o)=>Bn(o.value,e)-Bn(n.value,e)))},i=>{const r=t.findIndex(n=>n.name===i.name);r!==-1&&t.splice(r,1)})},handleByList(s,t,e=-1){return this.handle(s,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((r,n)=>Bn(n,e)-Bn(r,e)))},i=>{const r=t.indexOf(i.ref);r!==-1&&t.splice(r,1)})}};var tl=(s=>(s[s.INTERACTION=50]="INTERACTION",s[s.HIGH=25]="HIGH",s[s.NORMAL=0]="NORMAL",s[s.LOW=-25]="LOW",s[s.UTILITY=-50]="UTILITY",s))(tl||{});class qa{constructor(t,e=null,i=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=i,this.once=r}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const ee=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new qa(null,null,1/0),this.deltaMS=1/ee.targetFPMS,this.elapsedMS=1/ee.targetFPMS,this._tick=s=>{this._requestId=null,this.started&&(this.update(s),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(s,t,e=tl.NORMAL){return this._addListener(new qa(s,t,e))}addOnce(s,t,e=tl.NORMAL){return this._addListener(new qa(s,t,e,!0))}_addListener(s){let t=this._head.next,e=this._head;if(!t)s.connect(e);else{for(;t;){if(s.priority>t.priority){s.connect(e);break}e=t,t=t.next}s.previous||s.connect(e)}return this._startIfPossible(),this}remove(s,t){let e=this._head.next;for(;e;)e.match(s,t)?e=e.destroy():e=e.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let s=0,t=this._head;for(;t=t.next;)s++;return s}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let s=this._head.next;for(;s;)s=s.destroy(!0);this._head.destroy(),this._head=null}}update(s=performance.now()){let t;if(s>this.lastTime){if(t=this.elapsedMS=s-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const r=s-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=s-r%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*ee.targetFPMS;const e=this._head;let i=e.next;for(;i;)i=i.emit(this);e.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=s}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(s){const t=Math.min(this.maxFPS,s),e=Math.min(Math.max(0,t)/1e3,ee.targetFPMS);this._maxElapsedMS=1/e}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(s){if(s===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,s);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!ee._shared){const s=ee._shared=new ee;s.autoStart=!0,s._protected=!0}return ee._shared}static get system(){if(!ee._system){const s=ee._system=new ee;s.autoStart=!0,s._protected=!0}return ee._system}};let p_=ee;p_.targetFPMS=.06;const VT={createCanvas:(s,t)=>{const e=document.createElement("canvas");return e.width=s,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(s,t)=>fetch(s,t),parseXML:s=>new DOMParser().parseFromString(s,"text/xml")},ji={ADAPTER:VT,RETINA_PREFIX:/@([0-9\.]+)x/,FAIL_IF_MAJOR_PERFORMANCE_CAVEAT:!1,RESOLUTION:2};var $e={},WT={get exports(){return $e},set exports(s){$e=s}};(function(s){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function r(h,l,c){this.fn=h,this.context=l,this.once=c||!1}function n(h,l,c,u,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new r(c,u||h,d),p=e?e+l:l;return h._events[p]?h._events[p].fn?h._events[p]=[h._events[p],f]:h._events[p].push(f):(h._events[p]=f,h._eventsCount++),h}function o(h,l){--h._eventsCount===0?h._events=new i:delete h._events[l]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],c,u;if(this._eventsCount===0)return l;for(u in c=this._events)t.call(c,u)&&l.push(e?u.slice(1):u);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},a.prototype.listeners=function(l){var c=e?e+l:l,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,f=u.length,p=new Array(f);d<f;d++)p[d]=u[d].fn;return p},a.prototype.listenerCount=function(l){var c=e?e+l:l,u=this._events[c];return u?u.fn?1:u.length:0},a.prototype.emit=function(l,c,u,d,f,p){var m=e?e+l:l;if(!this._events[m])return!1;var _=this._events[m],x=arguments.length,g,y;if(_.fn){switch(_.once&&this.removeListener(l,_.fn,void 0,!0),x){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,c),!0;case 3:return _.fn.call(_.context,c,u),!0;case 4:return _.fn.call(_.context,c,u,d),!0;case 5:return _.fn.call(_.context,c,u,d,f),!0;case 6:return _.fn.call(_.context,c,u,d,f,p),!0}for(y=1,g=new Array(x-1);y<x;y++)g[y-1]=arguments[y];_.fn.apply(_.context,g)}else{var w=_.length,v;for(y=0;y<w;y++)switch(_[y].once&&this.removeListener(l,_[y].fn,void 0,!0),x){case 1:_[y].fn.call(_[y].context);break;case 2:_[y].fn.call(_[y].context,c);break;case 3:_[y].fn.call(_[y].context,c,u);break;case 4:_[y].fn.call(_[y].context,c,u,d);break;default:if(!g)for(v=1,g=new Array(x-1);v<x;v++)g[v-1]=arguments[v];_[y].fn.apply(_[y].context,g)}}return!0},a.prototype.on=function(l,c,u){return n(this,l,c,u,!1)},a.prototype.once=function(l,c,u){return n(this,l,c,u,!0)},a.prototype.removeListener=function(l,c,u,d){var f=e?e+l:l;if(!this._events[f])return this;if(!c)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===c&&(!d||p.once)&&(!u||p.context===u)&&o(this,f);else{for(var m=0,_=[],x=p.length;m<x;m++)(p[m].fn!==c||d&&!p[m].once||u&&p[m].context!==u)&&_.push(p[m]);_.length?this._events[f]=_.length===1?_[0]:_:o(this,f)}return this},a.prototype.removeAllListeners=function(l){var c;return l?(c=e?e+l:l,this._events[c]&&o(this,c)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,s.exports=a})(WT);class oe{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new oe(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}static get shared(){return Ka.x=0,Ka.y=0,Ka}}const Ka=new oe,Ln=[new oe,new oe,new oe,new oe];class Kt{constructor(t=0,e=0,i=0,r=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new Kt(0,0,0,0)}clone(){return new Kt(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const T=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=T)return!1;const P=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>P}const i=this.left,r=this.right,n=this.top,o=this.bottom;if(r<=i||o<=n)return!1;const a=Ln[0].set(t.left,t.top),h=Ln[1].set(t.left,t.bottom),l=Ln[2].set(t.right,t.top),c=Ln[3].set(t.right,t.bottom);if(l.x<=a.x||h.y<=a.y)return!1;const u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(a,a),e.apply(h,h),e.apply(l,l),e.apply(c,c),Math.max(a.x,h.x,l.x,c.x)<=i||Math.min(a.x,h.x,l.x,c.x)>=r||Math.max(a.y,h.y,l.y,c.y)<=n||Math.min(a.y,h.y,l.y,c.y)>=o))return!1;const d=u*(h.y-a.y),f=u*(a.x-h.x),p=d*i+f*n,m=d*r+f*n,_=d*i+f*o,x=d*r+f*o;if(Math.max(p,m,_,x)<=d*a.x+f*a.y||Math.min(p,m,_,x)>=d*c.x+f*c.y)return!1;const g=u*(a.y-l.y),y=u*(l.x-a.x),w=g*i+y*n,v=g*r+y*n,S=g*i+y*o,C=g*r+y*o;return!(Math.max(w,v,S,C)<=g*a.x+y*a.y||Math.min(w,v,S,C)>=g*c.x+y*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(n-r,0),this}ceil(t=1,e=.001){const i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=n-r,this}getBounds(t){return t=t||new Kt,t.copyFrom(this),t}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const zT=(s,t)=>(Array.isArray(s)||(s=[s]),t?s.map(e=>typeof e=="string"?t(e):e):s);class HT{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const i=zT(t);let r;for(let a=0;a<this.parsers.length;a++){const h=this.parsers[a];if(h.test(e)){r=h.getCacheableAssets(i,e);break}}r||(r={},i.forEach(a=>{r[a]=e}));const n=Object.keys(r),o={cacheKeys:n,keys:i};i.forEach(a=>{this._cacheMap.set(a,o)}),n.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==e&&console.warn("[Cache] already has key:",a),this._cache.set(a,r[a])})}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(r=>{this._cache.delete(r)}),e.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const Yi=new HT,__=()=>{},Za={},Eu={};function XT(s,t){let e=Eu[s];return e===void 0&&(Za[t]===void 0&&(Za[t]=1),Eu[s]=e=Za[t]++),e}let jT=0;const m_=class extends $e{constructor(s={}){super(),this.resourceType="textureSampler",this.uid=jT++,this._maxAnisotropy=1,s={...m_.DEFAULT,...s},this.addressMode=s.addressMode,this.addressModeU=s.addressModeU??this.addressModeU,this.addressModeV=s.addressModeV??this.addressModeV,this.addressModeW=s.addressModeW??this.addressModeW,this.scaleMode=s.scaleMode,this.magFilter=s.magFilter??this.magFilter,this.minFilter=s.minFilter??this.minFilter,this.mipmapFilter=s.mipmapFilter??this.mipmapFilter,this.lodMinClamp=s.lodMinClamp,this.lodMaxClamp=s.lodMaxClamp,this.compare=s.compare,this.maxAnisotropy=s.maxAnisotropy??1}set addressMode(s){this.addressModeU=s,this.addressModeV=s,this.addressModeW=s}get addressMode(){return this.addressModeU}set scaleMode(s){this.magFilter=s,this.minFilter=s,this.mipmapFilter=s}get scaleMode(){return this.magFilter}set maxAnisotropy(s){this._maxAnisotropy=Math.min(s,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get resourceId(){return this._resourceId||this.generateResourceId()}update(){this.emit("change",this),this._resourceId=null}generateResourceId(){const s=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._resourceId=XT(s,"sampler"),this._resourceId}destroy(){this.emit("destroy",this),this.removeAllListeners()}};let tn=m_;tn.DEFAULT={addressMode:"clamp-to-edge",scaleMode:"nearest"};let YT=0,qT=0;class g_ extends $e{constructor(t={}){var i,r;super(),this.uid=YT++,this.resourceType="textureSource",this.resourceId=qT++,this.type="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm-srgb",this.viewDimensions="2d",this.dimension="2d",this.antialias=!1,this.depthStencil=!0,this.resource=t.resource,this._resolution=t.resolution??1,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=((i=t.resource)==null?void 0:i.width)??1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=((r=t.resource)==null?void 0:r.height)??1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format??"bgra8unorm",this.viewDimensions=t.view??"2d",this.dimension=t.dimensions??"2d",this.mipLevelCount=t.mipLevelCount??1,this.autoGenerateMipmaps=t.autoGenerateMipmaps??!1,this.sampleCount=t.sampleCount??1,this.antialias=t.antialias??!1;const e=t.style??{};this.style=e instanceof tn?e:new tn(e),this.style.on("change",this.onStyleUpdate,this),this.styleSourceKey=(this.style.resourceId<<24)+this.uid}get source(){return this}update(){this.emit("update",this)}onStyleUpdate(){this.styleSourceKey=(this.style.resourceId<<24)+this.uid}destroy(){this.emit("destroy",this),this.style&&(this.style.destroy(),this.style=null),this.type=null,this.resource=null,this.removeAllListeners()}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,i){i=i||this._resolution,t=t||this.width,e=e||this.height;const r=Math.round(t*i),n=Math.round(e*i);this.width=r/i,this.height=n/i,this._resolution=i,!(this.pixelWidth===r&&this.pixelHeight===n)&&(this.pixelWidth=r,this.pixelHeight=n,this.emit("resize",this),this.resourceId++,this.emit("change",this))}}const KT=Math.PI*2,ZT=180/Math.PI,JT=Math.PI/180;class Q{constructor(t=1,e=0,i=0,r=1,n=0,o=0){this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,i,r,n,o){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=n,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,e){e=e||new oe;const i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e}applyInverse(t,e){e=e||new oe;const i=this.a,r=this.b,n=this.c,o=this.d,a=this.tx,h=this.ty,l=1/(i*o+n*-r),c=t.x,u=t.y;return e.x=o*l*c+-n*l*u+(h*n-a*o)*l,e.y=i*l*u+-r*l*c+(-h*i+a*r)*l,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),r=this.a,n=this.c,o=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=o*e-this.ty*i,this.ty=o*i+this.ty*e,this}append(t){const e=this.a,i=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this}appendFrom(t,e){const i=t.a,r=t.b,n=t.c,o=t.d,a=t.tx,h=t.ty,l=e.a,c=e.b,u=e.c,d=e.d;return this.a=i*l+r*u,this.b=i*c+r*d,this.c=n*l+o*u,this.d=n*c+o*d,this.tx=a*l+h*u+e.tx,this.ty=a*c+h*d+e.ty,this}setTransform(t,e,i,r,n,o,a,h,l){return this.a=Math.cos(a+l)*n,this.b=Math.sin(a+l)*n,this.c=-Math.sin(a-h)*o,this.d=Math.cos(a-h)*o,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,i=this.b,r=this.c,n=this.d,o=t.pivot,a=-Math.atan2(-r,n),h=Math.atan2(i,e),l=Math.abs(a+h);return l<1e-5||Math.abs(KT-l)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=h),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx+(o.x*e+o.y*r),t.position.y=this.ty+(o.x*i+o.y*n),t}invert(){const t=this.a,e=this.b,i=this.c,r=this.d,n=this.tx,o=t*r-e*i;return this.a=r/o,this.b=-e/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-r*n)/o,this.ty=-(t*this.ty-e*n)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Q;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return tC.identity()}static get shared(){return QT.identity()}}const QT=new Q,tC=new Q,qs=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Ks=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Zs=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Js=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],el=[],y_=[],Fn=Math.sign;function eC(){for(let s=0;s<16;s++){const t=[];el.push(t);for(let e=0;e<16;e++){const i=Fn(qs[s]*qs[e]+Zs[s]*Ks[e]),r=Fn(Ks[s]*qs[e]+Js[s]*Ks[e]),n=Fn(qs[s]*Zs[e]+Zs[s]*Js[e]),o=Fn(Ks[s]*Zs[e]+Js[s]*Js[e]);for(let a=0;a<16;a++)if(qs[a]===i&&Ks[a]===r&&Zs[a]===n&&Js[a]===o){t.push(a);break}}}for(let s=0;s<16;s++){const t=new Q;t.set(qs[s],Ks[s],Zs[s],Js[s],0,0),y_.push(t)}}eC();const dt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:s=>qs[s],uY:s=>Ks[s],vX:s=>Zs[s],vY:s=>Js[s],inv:s=>s&8?s&15:-s&7,add:(s,t)=>el[s][t],sub:(s,t)=>el[s][dt.inv(t)],rotate180:s=>s^4,isVertical:s=>(s&3)===2,byDirection:(s,t)=>Math.abs(s)*2<=Math.abs(t)?t>=0?dt.S:dt.N:Math.abs(t)*2<=Math.abs(s)?s>0?dt.E:dt.W:t>0?s>0?dt.SE:dt.SW:s>0?dt.NE:dt.NW,matrixAppendRotationInv:(s,t,e=0,i=0)=>{const r=y_[dt.inv(t)];r.tx=e,r.ty=i,s.append(r)}};class Mu extends $e{constructor(t={}){super(),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=t.frame||new Kt(0,0,1,1),this.orig=t.orig||this.frame,this.rotate=t.rotate??0,this.trim=t.trim,this.defaultAnchor=t.defaultAnchor,this.updateUvs()}updateUvs(){const t=this.uvs,e=this.frame;let i=this.rotate;if(i){const r=e.width/2,n=e.height/2,o=e.x+r,a=e.y+n;i=dt.add(i,dt.NW),t.x0=o+r*dt.uX(i),t.y0=a+n*dt.uY(i),i=dt.add(i,2),t.x1=o+r*dt.uX(i),t.y1=a+n*dt.uY(i),i=dt.add(i,2),t.x2=o+r*dt.uX(i),t.y2=a+n*dt.uY(i),i=dt.add(i,2),t.x3=o+r*dt.uX(i),t.y3=a+n*dt.uY(i)}else t.x0=e.x,t.y0=e.y,t.x1=e.x+e.width,t.y1=e.y,t.x2=e.x+e.width,t.y2=e.y+e.height,t.x3=e.x,t.y3=e.y+e.height}update(){this.updateUvs(),this.emit("update",this)}destroy(){this.emit("destroy",this),this.removeAllListeners(),this.frame=null,this.orig=null,this.trim=null,this.defaultAnchor=null,this.uvs=null}}const Iu=new Q;class sC{constructor(t,e){this.mapCoord=new Q,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){var e;this.texture!==t&&((e=this._texture)==null||e.removeListener("update",this.onTextureUpdate,this),this._texture=t,this._texture.addListener("update",this.onTextureUpdate,this),this.update())}onTextureUpdate(){this.update()}multiplyUvs(t,e){e===void 0&&(e=t);const i=this.mapCoord;for(let r=0;r<t.length;r+=2){const n=t[r],o=t[r+1];e[r]=n*i.a+o*i.c+i.tx,e[r+1]=n*i.b+o*i.d+i.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.layout.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const i=t.layout.orig,r=t.layout.trim;r&&(Iu.set(i.width/r.width,0,0,i.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(Iu));const n=t.source,o=this.uClampFrame,a=this.clampMargin/n._resolution,h=this.clampOffset;return o[0]=(t.frameX+a+h)/n.width,o[1]=(t.frameY+a+h)/n.height,o[2]=(t.frameX+t.frameWidth-a+h)/n.width,o[3]=(t.frameY+t.frameHeight-a+h)/n.height,this.uClampOffset[0]=h/n.pixelWidth,this.uClampOffset[1]=h/n.pixelHeight,this.isSimple=t.frameWidth===n.width&&t.frameHeight===n.height&&t.layout.rotate===0,!0}}let iC=0;class gt extends $e{constructor({source:t,style:e,layout:i,label:r}={}){super(),this.id=iC++,this.styleSourceKey=0,this.label=r,this.source=(t==null?void 0:t.source)??new g_,this.layout=i instanceof Mu?i:new Mu(i),e&&(this._style=e instanceof tn?e:new tn(e)),this.styleSourceKey=(this.style.resourceId<<24)+this._source.uid}static from(t){return Yi.get(t)}set source(t){this._source&&(this._source.off("update",this.onStyleSourceUpdate,this),this._source.off("resize",this.onUpdate,this)),this._source=t,t.on("update",this.onStyleSourceUpdate,this),t.on("resize",this.onUpdate,this),this.styleSourceKey=(this.style.resourceId<<24)+this._source.uid,this.emit("update",this)}get source(){return this._source}get style(){return this._style||this.source.style}set style(t){var e,i;(e=this._style)==null||e.off("change",this.onStyleSourceUpdate,this),this._style=t,(i=this._style)==null||i.on("change",this.onStyleSourceUpdate,this)}get layout(){return this._layout}set layout(t){var e;(e=this._layout)==null||e.off("update",this.onUpdate,this),this._layout=t,t.on("update",this.onUpdate,this),this.emit("update",this)}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new sC(this)),this._textureMatrix}set frameWidth(t){this._layout.frame.width=t/this._source.width}get frameWidth(){return this._source.pixelWidth/this._source._resolution*this._layout.frame.width}set frameHeight(t){this._layout.frame.height=t/this._source.height}get frameHeight(){return this._source.pixelHeight/this._source._resolution*this._layout.frame.height}set frameX(t){if(t===0){this._layout.frame.x=0;return}this._layout.frame.x=this._source.width/t}get frameX(){return this._source.width*this._layout.frame.x}set frameY(t){if(t===0){this._layout.frame.y=0;return}this._layout.frame.y=this._source.height/t}get frameY(){return this._source.height*this._layout.frame.y}get width(){return this._source.width*this._layout.orig.width}get height(){return this._source.height*this._layout.orig.height}destroy(t=!1){this._style&&(this._style.destroy(),this._style=null),this._layout&&(this._layout.destroy(),this._layout=null),this._source&&t&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.removeAllListeners()}onStyleSourceUpdate(){this.styleSourceKey=(this.style.resourceId<<24)+this._source.uid,this.emit("update",this)}onUpdate(){this.emit("update",this)}}gt.EMPTY=new gt({});gt.EMPTY.label="EMPTY";gt.EMPTY.destroy=__;const Ru={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ls(s){if(typeof s=="number")return s;if(typeof s=="string"){if(Ru[s]!==void 0)return Ru[s];if(s[0]==="#"){if(s.length===4){const t=parseInt(s[1]+s[1],16),e=parseInt(s[2]+s[2],16),i=parseInt(s[3]+s[3],16);return(t<<16)+(e<<8)+i}return parseInt(s.substring(1),16)}console.warn(`[pixi.js] Invalid color: ${s}`)}return 0}class un{constructor(t=1/0,e=1/0,i=-1/0,r=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrixStack=[],this.matrix=new Q,this.minX=t,this.minY=e,this.maxX=i,this.maxY=r}get rectangle(){this._rectangle||(this._rectangle=new Kt);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):(t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY),t}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrixStack.length=0,this.matrix.identity()}pushMatrix(t){this.matrixStack.push(t),this.matrixStack.length>1?(this.matrix.copyFrom(this.matrixStack[this.matrixStack.length-2]),this.matrix.append(t)):this.matrix.copyFrom(t)}popMatrix(){this.matrixStack.pop(),this.matrixStack.length>1?(this.matrix.copyFrom(this.matrixStack[this.matrixStack.length-2]),this.matrix.append(this.matrixStack[this.matrixStack.length-1])):this.matrixStack.length===1?this.matrix.copyFrom(this.matrixStack[0]):this.matrix.identity()}setMatrix(t){this.matrix.copyFrom(t)}set(t,e,i,r){this.minX=t,this.minY=e,this.maxX=i,this.maxY=r}addFrame(t,e,i,r){const n=this.matrix,o=n.a,a=n.b,h=n.c,l=n.d,c=n.tx,u=n.ty;let d=this.minX,f=this.minY,p=this.maxX,m=this.maxY,_=o*t+h*e+c,x=a*t+l*e+u;d=_<d?_:d,f=x<f?x:f,p=_>p?_:p,m=x>m?x:m,_=o*i+h*e+c,x=a*i+l*e+u,d=_<d?_:d,f=x<f?x:f,p=_>p?_:p,m=x>m?x:m,_=o*t+h*r+c,x=a*t+l*r+u,d=_<d?_:d,f=x<f?x:f,p=_>p?_:p,m=x>m?x:m,_=o*i+h*r+c,x=a*i+l*r+u,d=_<d?_:d,f=x<f?x:f,p=_>p?_:p,m=x>m?x:m,this.minX=d,this.minY=f,this.maxX=p,this.maxY=m}addRect(t){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height)}addBounds(t){this.addFrame(t.minX,t.minY,t.maxX,t.maxY)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,i=this.minY,r=this.maxX,n=this.maxY,{a:o,b:a,c:h,d:l,tx:c,ty:u}=t;let d=o*e+h*i+c,f=a*e+l*i+u;this.minX=d,this.minY=f,this.maxX=d,this.maxY=f,d=o*r+h*i+c,f=a*r+l*i+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*e+h*n+c,f=a*e+l*n+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*r+h*n+c,f=a*r+l*n+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new un(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}get y(){return this.minY}get width(){return this.maxX-this.minX}get height(){return this.maxY-this.minY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,i){let r=this.minX,n=this.minY,o=this.maxX,a=this.maxY;const h=this.matrix,l=h.a,c=h.b,u=h.c,d=h.d,f=h.tx,p=h.ty;for(let m=e;m<i;m+=2){const _=t[m],x=t[m+1],g=l*_+u*x+f,y=c*_+d*x+p;r=g<r?g:r,n=y<n?y:n,o=g>o?g:o,a=y>a?y:a}this.minX=r,this.minY=n,this.maxX=o,this.maxY=a}toString(){return`[@pixi:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}}function sl(s){if(typeof s=="string")return s;let t=(s|0).toString(16);return t="000000".substring(0,6-t.length)+t,`#${t}`}class Nl extends g_{constructor(t){super(t),this.type="image",this.alphaMode=t.alphaMode??0}}const Do=ji.ADAPTER.createCanvas(),pi=1;Do.width=pi;Do.height=pi;const _s=Do.getContext("2d");_s.fillStyle="#ffffff";_s.fillRect(0,0,pi,pi);_s.beginPath();_s.moveTo(0,0);_s.lineTo(pi,0);_s.lineTo(pi,pi);_s.closePath();_s.fillStyle="#ffffff";_s.fill();gt.WHITE=new gt({source:new Nl({resource:Do})});gt.WHITE.label="WHITE";gt.WHITE.destroy=__;let rC=0;const il=class{constructor(s,t,e,i){this.uid=rC++,this.type="linear",this.gradientStops=[],this.x0=s,this.y0=t,this.x1=e,this.y1=i}addColorStop(s,t){return t=sl(t),this.gradientStops.push({offset:s,color:t}),this}buildLinearGradient(){const s=il.defaultTextureSize,{gradientStops:t}=this,e=ji.ADAPTER.createCanvas();e.width=s,e.height=s;const i=e.getContext("2d"),r=i.createLinearGradient(0,0,il.defaultTextureSize,1);for(let p=0;p<t.length;p++){const m=t[p];r.addColorStop(m.offset,m.color)}i.fillStyle=r,i.fillRect(0,0,s,s),this.texture=new gt({source:new Nl({resource:e}),style:{addressModeU:"clamp-to-edge",addressModeV:"repeat"}});const{x0:n,y0:o,x1:a,y1:h}=this,l=new Q,c=a-n,u=h-o,d=Math.sqrt(c*c+u*u),f=Math.atan2(u,c);l.translate(-n,-o),l.scale(1/s,1/s),l.rotate(-f),l.scale(256/d,1),this.transform=l}};let en=il;en.defaultTextureSize=256;const ku={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};let nC=0;class Dl{constructor(t,e){this.uid=nC++,this.transform=new Q,this.texture=t,this.repetition=e,this.transform.scale(1/t.frameWidth,1/t.frameHeight),e&&(t.style.addressModeU=ku[e].addressModeU,t.style.addressModeV=ku[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frameWidth,1/e.frameHeight)}}const oC={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0};function aC(s,t){var h;const e=s.match(/[a-df-z][^a-df-z]*/gi),i=(h=s.match(/[+-]?\d*\.?\d+(?:[eE][+-]?\d+)?/g))==null?void 0:h.map(parseFloat),r=[];e.forEach(l=>{var f;const c=(f=l.match(/[+-]?\d*\.?\d+(?:[eE][+-]?\d+)?/g))==null?void 0:f.map(parseFloat),u=l[0];let d=1;c&&(d=c.length/oC[u.toLowerCase()]);for(let p=0;p<d;p++)r.push(u)});let n=0,o=0,a=0;for(let l=0;l<r.length;l++){const c=r[l];switch(c){case"M":o=i[n++],a=i[n++],t.moveTo(o,a);break;case"m":o+=i[n++],a+=i[n++],t.moveTo(o,a);break;case"H":o=i[n++],t.lineTo(o,a);break;case"h":o+=i[n++],t.lineTo(o,a);break;case"V":a=i[n++],t.lineTo(o,a);break;case"v":a+=i[n++],t.lineTo(o,a);break;case"L":o=i[n++],a=i[n++],t.lineTo(o,a);break;case"l":o+=i[n++],a+=i[n++],t.lineTo(o,a);break;case"C":o=i[n+4],a=i[n+5],t.bezierCurveTo(i[n],i[n+1],i[n+2],i[n+3],o,a),n+=6;break;case"c":t.bezierCurveTo(o+i[n],a+i[n+1],o+i[n+2],a+i[n+3],o+i[n+4],a+i[n+5]),o+=i[n+4],a+=i[n+5],n+=6;break;case"S":o=i[n+2],a=i[n+3],t.bezierCurveToShort(i[n],i[n+1],o,a),n+=4;break;case"s":t.bezierCurveToShort(o+i[n],a+i[n+1],o+i[n+2],a+i[n+3]),o+=i[n+2],a+=i[n+3],n+=4;break;case"Q":o=i[n+2],a=i[n+3],t.quadraticCurveTo(i[n],i[n+1],o,a),n+=4;break;case"q":t.quadraticCurveTo(o+i[n],a+i[n+1],o+i[n+2],a+i[n+3]),o+=i[n+2],a+=i[n+3],n+=4;break;case"T":o=i[n++],a=i[n++],t.quadraticCurveToShort(o,a);break;case"t":o+=i[n++],a+=i[n++],t.quadraticCurveToShort(o,a);break;case"A":o=i[n+5],a=i[n+6],t.arcToSvg(i[n],i[n+1],i[n+2],i[n+3],i[n+4],o,a),n+=7;break;case"a":o+=i[n+5],a+=i[n+6],t.arcToSvg(i[n],i[n+1],i[n+2],i[n+3],i[n+4],o,a),n+=7;break;case"Z":case"z":t.closePath();break;default:console.warn(`Unknown SVG path command: ${c}`)}}return t}class $l{constructor(t=0,e=0,i=0){this.type="circle",this.x=t,this.y=e,this.radius=i}clone(){return new $l(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const i=this.radius*this.radius;let r=this.x-t,n=this.y-e;return r*=r,n*=n,r+n<=i}getBounds(t){return t=t||new Kt,t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Gl{constructor(t=0,e=0,i=0,r=0){this.type="ellipse",this.x=t,this.y=e,this.width=i,this.height=r}clone(){return new Gl(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let i=(t-this.x)/this.width,r=(e-this.y)/this.height;return i*=i,r*=r,i+r<=1}getBounds(){return new Kt(this.x-this.width,this.y-this.height,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class kr{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const i=[];for(let r=0,n=e.length;r<n;r++)i.push(e[r].x,e[r].y);e=i}this.points=e,this.closePath=!0}clone(){const t=this.points.slice(),e=new kr(t);return e.closePath=this.closePath,e}contains(t,e){let i=!1;const r=this.points.length/2;for(let n=0,o=r-1;n<r;o=n++){const a=this.points[n*2],h=this.points[n*2+1],l=this.points[o*2],c=this.points[o*2+1];h>e!=c>e&&t<(l-a)*((e-h)/(c-h))+a&&(i=!i)}return i}getBounds(t){t=t||new Kt;const e=this.points;let i=1/0,r=-1/0,n=1/0,o=-1/0;for(let a=0,h=e.length;a<h;a+=2){const l=e[a],c=e[a+1];i=l<i?l:i,r=l>r?l:r,n=c<n?c:n,o=c>o?c:o}return t.x=i,t.width=r-i,t.y=n,t.height=o-n,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}class Vl{constructor(t=0,e=0,i=0,r=0,n=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=i,this.height=r,this.radius=n}getBounds(t){return t=t||new Kt,t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new Vl(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+i&&e<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let r=t-(this.x+i),n=e-(this.y+i);const o=i*i;if(r*r+n*n<=o||(r=t-(this.x+this.width-i),r*r+n*n<=o)||(n=e-(this.y+this.height-i),r*r+n*n<=o)||(r=t-(this.x+i),r*r+n*n<=o))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const hC=8,On=11920929e-14,lC=1;function x_(s,t,e,i,r,n,o,a,h){let c=lC/1;return c*=c,cC(t,e,i,r,n,o,a,h,s,c),s}function cC(s,t,e,i,r,n,o,a,h,l){rl(s,t,e,i,r,n,o,a,h,l,0),h.push(o,a)}function rl(s,t,e,i,r,n,o,a,h,l,c){if(c>hC)return;const u=(s+e)/2,d=(t+i)/2,f=(e+r)/2,p=(i+n)/2,m=(r+o)/2,_=(n+a)/2,x=(u+f)/2,g=(d+p)/2,y=(f+m)/2,w=(p+_)/2,v=(x+y)/2,S=(g+w)/2;if(c>0){let C=o-s,T=a-t;const A=Math.abs((e-o)*T-(i-a)*C),P=Math.abs((r-o)*T-(n-a)*C);if(A>On&&P>On){if((A+P)*(A+P)<=l*(C*C+T*T)){h.push(v,S);return}}else if(A>On){if(A*A<=l*(C*C+T*T)){h.push(v,S);return}}else if(P>On){if(P*P<=l*(C*C+T*T)){h.push(v,S);return}}else if(C=v-(s+o)/2,T=S-(t+a)/2,C*C+T*T<=l){h.push(v,S);return}}rl(s,t,u,d,x,g,v,S,h,l,c+1),rl(v,S,y,w,m,_,o,a,h,l,c+1)}const uC=8,dC=11920929e-14,fC=1;function pC(s,t,e,i,r,n,o){let h=fC/1;return h*=h,_C(t,e,i,r,n,o,s,h),s}function _C(s,t,e,i,r,n,o,a){nl(o,s,t,e,i,r,n,a,0),o.push(r,n)}function nl(s,t,e,i,r,n,o,a,h){if(h>uC)return;const l=(t+i)/2,c=(e+r)/2,u=(i+n)/2,d=(r+o)/2,f=(l+u)/2,p=(c+d)/2;let m=n-t,_=o-e;const x=Math.abs((i-n)*_-(r-o)*m);if(x>dC){if(x*x<=a*(m*m+_*_)){s.push(f,p);return}}else if(m=f-(t+n)/2,_=p-(e+o)/2,m*m+_*_<=a){s.push(f,p);return}nl(s,t,e,l,c,f,p,a,h+1),nl(s,f,p,u,d,n,o,a,h+1)}function b_(s,t,e,i,r,n,o,a){let h=Math.abs(r-n);(!o&&r>n||o&&n>r)&&(h=2*Math.PI-h),a=a||Math.max(6,Math.floor(6*Math.pow(i,1/3)*(h/Math.PI))),a=Math.max(a,3);let l=h/a,c=r;l*=o?-1:1;for(let u=0;u<a+1;u++){const d=Math.cos(c),f=Math.sin(c),p=t+d*i,m=e+f*i;s.push(p,m),c+=l}}function mC(s,t,e,i,r,n){const o=s[s.length-2],h=s[s.length-1]-e,l=o-t,c=r-e,u=i-t,d=Math.abs(h*u-l*c);if(d<1e-8||n===0){(s[s.length-2]!==t||s[s.length-1]!==e)&&s.push(t,e);return}const f=h*h+l*l,p=c*c+u*u,m=h*c+l*u,_=n*Math.sqrt(f)/d,x=n*Math.sqrt(p)/d,g=_*m/f,y=x*m/p,w=_*u+x*l,v=_*c+x*h,S=l*(x+g),C=h*(x+g),T=u*(_+y),A=c*(_+y),P=Math.atan2(C-v,S-w),I=Math.atan2(A-v,T-w);b_(s,w+t,v+e,n,P,I,l*c>u*h)}const Br=Math.PI*2,Ja={centerX:0,centerY:0,ang1:0,ang2:0},Qa=({x:s,y:t},e,i,r,n,o,a,h)=>{s*=e,t*=i;const l=r*s-n*t,c=n*s+r*t;return h.x=l+o,h.y=c+a,h};function gC(s,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),i=t===1.5707963267948966?.551915024494:e,r=Math.cos(s),n=Math.sin(s),o=Math.cos(s+t),a=Math.sin(s+t);return[{x:r-n*i,y:n+r*i},{x:o+a*i,y:a-o*i},{x:o,y:a}]}const Bu=(s,t,e,i)=>{const r=s*i-t*e<0?-1:1;let n=s*e+t*i;return n>1&&(n=1),n<-1&&(n=-1),r*Math.acos(n)},yC=(s,t,e,i,r,n,o,a,h,l,c,u,d)=>{const f=Math.pow(r,2),p=Math.pow(n,2),m=Math.pow(c,2),_=Math.pow(u,2);let x=f*p-f*_-p*m;x<0&&(x=0),x/=f*_+p*m,x=Math.sqrt(x)*(o===a?-1:1);const g=x*r/n*u,y=x*-n/r*c,w=l*g-h*y+(s+e)/2,v=h*g+l*y+(t+i)/2,S=(c-g)/r,C=(u-y)/n,T=(-c-g)/r,A=(-u-y)/n,P=Bu(1,0,S,C);let I=Bu(S,C,T,A);a===0&&I>0&&(I-=Br),a===1&&I<0&&(I+=Br),d.centerX=w,d.centerY=v,d.ang1=P,d.ang2=I};function xC(s,t,e,i,r,n,o,a=0,h=0,l=0){if(n===0||o===0)return;const c=Math.sin(a*Br/360),u=Math.cos(a*Br/360),d=u*(t-i)/2+c*(e-r)/2,f=-c*(t-i)/2+u*(e-r)/2;if(d===0&&f===0)return;n=Math.abs(n),o=Math.abs(o);const p=Math.pow(d,2)/Math.pow(n,2)+Math.pow(f,2)/Math.pow(o,2);p>1&&(n*=Math.sqrt(p),o*=Math.sqrt(p)),yC(t,e,i,r,n,o,h,l,c,u,d,f,Ja);let{ang1:m,ang2:_}=Ja;const{centerX:x,centerY:g}=Ja;let y=Math.abs(_)/(Br/4);Math.abs(1-y)<1e-7&&(y=1);const w=Math.max(Math.ceil(y),1);_/=w;let v=s[s.length-2],S=s[s.length-1];const C={x:0,y:0};for(let T=0;T<w;T++){const A=gC(m,_),{x:P,y:I}=Qa(A[0],n,o,u,c,x,g,C),{x:Z,y:q}=Qa(A[1],n,o,u,c,x,g,C),{x:j,y:H}=Qa(A[2],n,o,u,c,x,g,C);x_(s,v,S,P,I,Z,q,j,H),v=j,S=H,m+=_}}const bC=new Kt;class wC{constructor(t){this.shapePrimitives=[],this.currentPoly=null,this._bounds=new un,this.graphicsPath2D=t}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const i=this.currentPoly.points,r=i[i.length-2],n=i[i.length-1];return(r!==t||n!==e)&&i.push(t,e),this}arc(t,e,i,r,n,o){this._ensurePoly(!1);const a=this.currentPoly.points;return b_(a,t,e,i,r,n,o),this}arcTo(t,e,i,r,n){this._ensurePoly();const o=this.currentPoly.points;return mC(o,t,e,i,r,n),this}arcToSvg(t,e,i,r,n,o,a){const h=this.currentPoly.points;return xC(h,this.currentPoly.lastX,this.currentPoly.lastY,o,a,t,e,i,r,n),this}bezierCurveTo(t,e,i,r,n,o){this._ensurePoly();const a=this.currentPoly;return x_(this.currentPoly.points,a.lastX,a.lastY,t,e,i,r,n,o),this}quadraticCurveTo(t,e,i,r){this._ensurePoly();const n=this.currentPoly;return pC(this.currentPoly.points,n.lastX,n.lastY,t,e,i,r),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));for(let i=0;i<t.instructions.length;i++){const r=t.instructions[i];this[r.action](...r.data)}return this}finish(t=!1){this.endPoly(t)}rect(t,e,i,r,n){return this.drawShape(new Kt(t,e,i,r),n),this}circle(t,e,i,r){return this.drawShape(new $l(t,e,i),r),this}poly(t,e,i){const r=new kr(t);r.closePath=e,this.drawShape(r,i)}ellipse(t,e,i,r,n){return this.drawShape(new Gl(t,e,i,r),n),this}roundRect(t,e,i,r,n,o){return this.drawShape(new Vl(t,e,i,r,n),o),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let i=this.currentPoly;return i&&this.endPoly(),i=new kr,i.points.push(t,e),this.currentPoly=i,this}endPoly(t=!1){const e=this.currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this.currentPoly=null,this}_ensurePoly(t=!0){if(!this.currentPoly&&(this.currentPoly=new kr,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let i=e.shape.x,r=e.shape.y;if(e.transform.isIdentity()){const n=e.transform,o=i;i=n.a*i+n.c*r+n.tx,r=n.b*o+n.d*r+n.ty}this.currentPoly.points.push(i,i)}else this.currentPoly.points.push(0,0)}}buildPath(){const t=this.graphicsPath2D;this.shapePrimitives.length=0,this.currentPoly=null;for(let e=0;e<t.instructions.length;e++){const i=t.instructions[e];this[i.action](...i.data)}this.finish()}isPointInPath(t,e){const i=this.shapePrimitives;for(let r=0;r<i.length;r++)if(i[r].shape.contains(t,e))return!0;return!1}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let i=0;i<e.length;i++){const r=e[i],n=r.shape.getBounds(bC);r.transform?(t.pushMatrix(r.transform),t.addRect(n),t.popMatrix()):t.addRect(n)}return t}}let vC=0;class nr{constructor(t){this.instructions=[],this.uid=vC++,this.dirty=!0,typeof t=="string"?aC(t,this):this.instructions=(t==null?void 0:t.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new wC(this)),this.dirty&&(this.dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this.dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this.dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this.dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this.dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this.dirty=!0,this}bezierCurveToShort(t,e,i,r){const n=this.instructions[this.instructions.length-1],o=this.getLastPoint(oe.shared);let a=0,h=0;if(!n||n.action!=="bezierCurveTo")a=o.x,h=o.y;else{a=n.data[2],h=n.data[3];const l=o.x,c=o.y;a=l+(l-a),h=c+(c-h)}return this.instructions.push({action:"bezierCurveTo",data:[a,h,t,e,i,r]}),this.dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this.dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this.dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this.dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this.dirty=!0,this}quadraticCurveToShort(t,e){const i=this.instructions[this.instructions.length-1],r=this.getLastPoint(oe.shared);let n=0,o=0;if(!i||i.action!=="quadraticCurveTo")n=r.x,o=r.y;else{n=i.data[0],o=i.data[1];const a=r.x,h=r.y;n=a+(a-n),o=h+(h-o)}return this.instructions.push({action:"quadraticCurveTo",data:[n,o,t,e]}),this.dirty=!0,this}rect(t,e,i,r,n){return this.instructions.push({action:"rect",data:[t,e,i,r,n]}),this.dirty=!0,this}circle(t,e,i,r){return this.instructions.push({action:"circle",data:[t,e,i,r]}),this.dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this.dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this.dirty=!0,this}star(t,e,i,r,n,o=0,a){n=n||r/2;const h=-1*Math.PI/2+o,l=i*2,c=Math.PI*2/l,u=[];for(let d=0;d<l;d++){const f=d%2?n:r,p=d*c+h;u.push(t+f*Math.cos(p),e+f*Math.sin(p))}return this.poly(u,!0,a),this}clone(t=!1){const e=new nr;if(!t)e.instructions=this.instructions.slice();else for(let i=0;i<this.instructions.length;i++){const r=this.instructions[i];e.instructions.push({action:r.action,data:r.data.slice()})}return e}getLastPoint(t){let e=this.instructions.length-1,i=this.instructions[e];if(!i)return t.x=0,t.y=0,t;for(;i.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;i=this.instructions[e]}let r,n,o;switch(i.action){case"moveTo":case"lineTo":t.x=i.data[0],t.y=i.data[1];break;case"quadraticCurveTo":t.x=i.data[2],t.y=i.data[3];break;case"bezierCurveTo":t.x=i.data[4],t.y=i.data[5];break;case"arc":case"arcToSvg":t.x=i.data[5],t.y=i.data[6];break;case"addPath":t.x=i.data[0].lastX,t.y=i.data[2].lastY;break;case"rect":if(o=i.data[4],r=i.data[0],n=i.data[1],o){const{a,b:h,c:l,d:c,tx:u,ty:d}=o;t.x=a*r+l*n+u,t.y=h*r+c*n+d}else t.x=r,t.y=n;break;default:console.warn(`${i.action} is not supported yet`);break}return t}clear(){return this.instructions.length=0,this.dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,i=t.b,r=t.c,n=t.d,o=t.tx,a=t.ty;let h=0,l=0,c=0,u=0,d=0,f=0,p=0,m=0;for(let _=0;_<this.instructions.length;_++){const x=this.instructions[_],g=x.data;switch(x.action){case"moveTo":case"lineTo":h=g[0],l=g[1],g[0]=e*h+r*l+o,g[1]=i*h+n*l+a;break;case"bezierCurveTo":c=g[0],u=g[1],d=g[2],f=g[3],h=g[4],l=g[5],g[0]=e*c+r*u+o,g[1]=i*c+n*u+a,g[2]=e*d+r*f+o,g[3]=i*d+n*f+a,g[4]=e*h+r*l+o,g[5]=i*h+n*l+a;break;case"quadraticCurveTo":c=g[0],u=g[1],h=g[2],l=g[3],g[0]=e*c+r*u+o,g[1]=i*c+n*u+a,g[2]=e*h+r*l+o,g[3]=i*h+n*l+a;break;case"arcToSvg":h=g[5],l=g[6],p=g[0],m=g[1],g[0]=e*p+r*m,g[1]=i*p+n*m,g[5]=e*h+r*l+o,g[6]=i*h+n*l+a;break;case"rect":g[4]=th(g[4],t);break;case"ellipse":g[8]=th(g[8],t);break;case"roundRect":g[5]=th(g[5],t);break;case"addPath":g[0].transform(t);break;default:console.warn("unknown transform action",x.action);break}}return this.dirty=!0,this}get bounds(){return this.shapePath.bounds}}function th(s,t){return s?s.prepend(t):t.clone()}function TC(s,t){if(typeof s=="string"){const i=document.createElement("div");i.innerHTML=s.trim(),s=i.querySelector("svg")}const e={context:t,path:new nr};return w_(s,e,null,null),t}function w_(s,t,e,i){const r=s.children,{fillStyle:n,strokeStyle:o}=CC(s);n&&e?e={...e,...n}:n&&(e=n),o&&i?i={...i,...o}:o&&(i=o),t.context.fillStyle=e,t.context.strokeStyle=i;let a,h,l,c,u,d,f,p,m,_,x,g,y,w,v,S,C;switch(s.nodeName.toLowerCase()){case"path":w=s.getAttribute("d"),v=new nr(w),t.context.path(v),e&&t.context.fill(),i&&t.context.stroke();break;case"circle":f=At(s,"cx",0),p=At(s,"cy",0),m=At(s,"r",0),t.context.ellipse(f,p,m,m),e&&t.context.fill(),i&&t.context.stroke();break;case"rect":a=At(s,"x",0),h=At(s,"y",0),S=At(s,"width",0),C=At(s,"height",0),_=At(s,"rx",0),x=At(s,"ry",0),_||x?t.context.roundRect(a,h,S,C,_||x):t.context.rect(a,h,S,C),e&&t.context.fill(),i&&t.context.stroke();break;case"ellipse":f=At(s,"cx",0),p=At(s,"cy",0),_=At(s,"rx",0),x=At(s,"ry",0),t.context.beginPath(),t.context.ellipse(f,p,_,x),e&&t.context.fill(),i&&t.context.stroke();break;case"line":l=At(s,"x1",0),c=At(s,"y1",0),u=At(s,"x2",0),d=At(s,"y2",0),t.context.beginPath(),t.context.moveTo(l,c),t.context.lineTo(u,d),i&&t.context.stroke();break;case"polygon":y=s.getAttribute("points"),g=y.match(/\d+/g).map(T=>parseInt(T,10)),t.context.poly(g,!0),e&&t.context.fill(),i&&t.context.stroke();break;case"polyline":y=s.getAttribute("points"),g=y.match(/\d+/g).map(T=>parseInt(T,10)),t.context.poly(g,!1),i&&t.context.stroke();break;case"g":case"svg":break;default:{console.info(`[SVG parser] <${s.nodeName}> elements unsupported`);break}}for(let T=0;T<r.length;T++)w_(r[T],t,e,i)}function At(s,t,e){const i=s.getAttribute(t);return i?Number(i):e}function CC(s){const t=s.getAttribute("style"),e={},i={};let r=!1,n=!1;if(t){const o=t.split(";");for(let a=0;a<o.length;a++){const h=o[a],[l,c]=h.split(":");switch(l){case"stroke":c!=="none"&&(e.color=ls(c),n=!0);break;case"stroke-width":e.width=Number(c);break;case"fill":c!=="none"&&(r=!0,i.color=ls(c));break;case"fill-opacity":i.alpha=Number(c);break;case"stroke-opacity":e.alpha=Number(c);break;case"opacity":i.alpha=Number(c),e.alpha=Number(c);break}}}else{const o=s.getAttribute("stroke");o&&o!=="none"&&(n=!0,e.color=ls(o),e.width=At(s,"stroke-width",1));const a=s.getAttribute("fill");a&&a!=="none"&&(r=!0,i.color=ls(a))}return{strokeStyle:n?e:null,fillStyle:r?i:null}}function vo(s,t){if(!s)return null;let e,i;if(s!=null&&s.fill?(i=s.fill,e={...t,...s}):(i=s,e=t),typeof i=="number"||typeof i=="string")return{...e,color:ls(i),texture:gt.WHITE};if(i instanceof Dl){const n=i;return{...e,color:16777215,texture:n.texture,matrix:n.transform}}else if(i instanceof en){const n=i;return n.buildLinearGradient(),{...e,color:16777215,texture:n.texture,matrix:n.transform}}const r={...t,...s};if(r.texture!==gt.WHITE){const n=r.matrix||new Q;n.scale(1/r.texture.frameWidth,1/r.texture.frameHeight),r.matrix=n,r.color=16777215}return r.color=ls(r.color),r}let SC=0;const Si=new oe,Lu=new Q,Qs=class extends $e{constructor(){super(...arguments),this.uid=SC++,this.usage=0,this.dirty=!0,this.batchMode="auto",this.instructions=[],this.activePath=new nr,this._transform=new Q,this._fillStyle={...Qs.defaultFillStyle},this._fillStyleOriginal=16777215,this._strokeStyle={...Qs.defaultStrokeStyle},this._strokeStyleOriginal=16777215,this._stateStack=[],this._tick=0,this._bounds=new un,this.boundsDirty=!0}set fillStyle(s){if(this._fillStyleOriginal!==s)if(this._fillStyleOriginal=s,typeof s=="number"||typeof s=="string")this._fillStyle.color=ls(s),this._fillStyle.texture=gt.WHITE;else if(s instanceof Dl){const t=s;this._fillStyle.color=16777215,this._fillStyle.texture=t.texture,this._fillStyle.matrix=t.transform}else if(s instanceof en){const t=s;t.buildLinearGradient(),this._fillStyle.color=16777215,this._fillStyle.texture=t.texture,this._fillStyle.matrix=t.transform}else this._fillStyle={...Qs.defaultFillStyle,...s}}get fillStyle(){return this._fillStyleOriginal}set strokeStyle(s){if(this._strokeStyleOriginal!==s)if(this._strokeStyleOriginal=s,typeof s=="number"||typeof s=="string")this._strokeStyle.color=ls(s),this._strokeStyle.texture=gt.WHITE;else if(s instanceof en){const t=s;t.buildLinearGradient(),this._strokeStyle.color=16777215,this._strokeStyle.texture=t.texture,this._strokeStyle.matrix=t.transform}else this._strokeStyle={...Qs.defaultStrokeStyle,...s}}get strokeStyle(){return this._strokeStyleOriginal}setFillStyle(s){return this.fillStyle=s,this}setStrokeStyle(s){return this.strokeStyle=s,this}texture(s,t,e,i,r,n){return this.instructions.push({action:"texture",data:{image:s,dx:e||0,dy:i||0,dw:r||s.frameWidth,dh:n||s.frameHeight,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:t||16777215}}),this.onUpdate(),this}beginPath(){return this.activePath=new nr,this}fill(s){let t;const e=this.instructions[this.instructions.length-1];if(this._tick===0&&e&&e.action==="stroke"?t=e.data.path:t=this.activePath.clone(),!t)return this;let i=this._fillStyle;return s&&(i=vo(s,Qs.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:i,path:t}}),this.onUpdate(),this.activePath.instructions.length=0,this._tick=0,this}stroke(s){let t;const e=this.instructions[this.instructions.length-1];if(this._tick===0&&e&&e.action==="fill"?t=e.data.path:t=this.activePath.clone(),!t)return this;let i=this._strokeStyle;return s&&(i=vo(s,Qs.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:i,path:t}}),this.onUpdate(),this.activePath.instructions.length=0,this._tick=0,this}cut(){for(let s=0;s<2;s++){const t=this.instructions[this.instructions.length-1-s],e=this.activePath.clone();t&&(t.action==="stroke"||t.action==="fill")&&(t.data.hole=e)}return this.activePath.instructions.length=0,this}arc(s,t,e,i,r,n){this._tick++;const o=this._transform;return this.activePath.arc(o.a*s+o.c*t+o.tx,o.b*s+o.d*t+o.ty,e,i,r,n),this}arcTo(s,t,e,i,r){this._tick++;const n=this._transform;return this.activePath.arcTo(n.a*s+n.c*t+n.tx,n.b*s+n.d*t+n.ty,n.a*e+n.c*i+n.tx,n.b*e+n.d*i+n.ty,r),this}arcToSvg(s,t,e,i,r,n,o){this._tick++;const a=this._transform;return this.activePath.arcToSvg(s,t,e,i,r,a.a*n+a.c*o+a.tx,a.b*n+a.d*o+a.ty),this}bezierCurveTo(s,t,e,i,r,n){this._tick++;const o=this._transform;return this.activePath.bezierCurveTo(o.a*s+o.c*t+o.tx,o.b*s+o.d*t+o.ty,o.a*e+o.c*i+o.tx,o.b*e+o.d*i+o.ty,o.a*r+o.c*n+o.tx,o.b*r+o.d*n+o.ty),this}closePath(){var s;return this._tick++,(s=this.activePath)==null||s.closePath(),this}ellipse(s,t,e,i){return this._tick++,this.activePath.ellipse(s,t,e,i,this._transform.clone()),this}circle(s,t,e){return this._tick++,this.activePath.circle(s,t,e,this._transform.clone()),this}path(s){return this._tick++,this.activePath.addPath(s,this._transform.clone()),this}lineTo(s,t){this._tick++;const e=this._transform;return this.activePath.lineTo(e.a*s+e.c*t+e.tx,e.b*s+e.d*t+e.ty),this}moveTo(s,t){this._tick++;const e=this._transform;return this.activePath.moveTo(e.a*s+e.c*t+e.tx,e.b*s+e.d*t+e.ty),this}quadraticCurveTo(s,t,e,i){this._tick++;const r=this._transform;this.activePath.quadraticCurveTo(r.a*s+r.c*t+r.tx,r.b*s+r.d*t+r.ty,r.a*e+r.c*i+r.tx,r.b*e+r.d*i+r.ty)}rect(s,t,e,i){return this._tick++,this.activePath.rect(s,t,e,i,this._transform.clone()),this}roundRect(s,t,e,i,r){return this._tick++,this.activePath.roundRect(s,t,e,i,r,this._transform.clone()),this}poly(s,t){return this._tick++,this.activePath.poly(s,t,this._transform.clone()),this}star(s,t,e,i,r,n){return this._tick++,this.activePath.star(s,t,e,i,r,n,this._transform.clone()),this}svg(s){this._tick++,TC(s,this)}restore(){const s=this._stateStack.pop();s&&(this._transform=s.transform,this._fillStyle=s.fillStyle,this._strokeStyle=s.strokeStyle)}save(){this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}})}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(s){return this._transform.rotate(s),this}scale(s,t=s){return this._transform.scale(s,t),this}setTransform(s,t,e,i,r,n){return s instanceof Q?(this._transform.set(s.a,s.b,s.c,s.d,s.tx,s.ty),this):(this._transform.set(s,t,e,i,r,n),this)}transform(s,t,e,i,r,n){return s instanceof Q?(this._transform.append(s),this):(Lu.set(s,t,e,i,r,n),this._transform.append(Lu),this)}translate(s,t){return this._transform.translate(s,t),this}clear(){return this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this.boundsDirty=!0)}get bounds(){if(!this.boundsDirty)return this._bounds;const s=this._bounds;s.clear();for(let t=0;t<this.instructions.length;t++){const e=this.instructions[t],i=e.action;if(i==="fill"){const r=e.data;s.addBounds(r.path.bounds)}else if(i==="texture"){const r=e.data;s.pushMatrix(r.transform),s.addFrame(r.dx,r.dy,r.dx+r.dw,r.dy+r.dh),s.popMatrix()}}return s}containsPoint(s){const t=this.instructions;let e=!1;return t.forEach(i=>{var h;const r=i.data,n=r.path;if(!i.action||!n)return;const o=r.style,a=(h=n.shapePath)==null?void 0:h.shapePrimitives;this._forEachShape(a,l=>{var d;if(!o||!l)return;typeof o!="number"&&o.matrix?o.matrix.applyInverse(s,Si):Si.copyFrom(s),e=l.contains(Si.x,Si.y);const c=r.hole;if(!c)return;const u=(d=c.shapePath)==null?void 0:d.shapePrimitives;u&&this._forEachShape(u,f=>{f.contains(Si.x,Si.y)&&(e=!1)})})}),e}_forEachShape(s,t){s==null||s.forEach(e=>{const i=e==null?void 0:e.shape;i&&t(i)})}destroy(s=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof s=="boolean"?s:s==null?void 0:s.texture){const e=typeof s=="boolean"?s:s==null?void 0:s.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(e),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(e)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this.activePath=null,this._bounds=null,this._stateStack=null,this.transformMatrix=null,this.customShader=null,this._transform=null}};let To=Qs;To.defaultFillStyle={color:0,alpha:1,texture:gt.WHITE};To.defaultStrokeStyle={width:1,color:0,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:gt.WHITE};class Ce{constructor(t,e,i){this._x=e||0,this._y=i||0,this.observer=t}clone(t){return new Ce(t,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.observer.onUpdate()),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.observer.onUpdate()),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=${0} y=${0} scope=${this.observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.observer.onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.observer.onUpdate(this))}}function AC(s,t,e){const i=s.length;let r;if(t>=i||e===0)return;e=t+e>i?i-t:e;const n=i-e;for(r=t;r<n;++r)s[r]=s[r+e];s.length=n}const PC={removeChildren(s=0,t){const e=t??this.children.length,i=e-s,r=[];if(i>0&&i<=e){for(let n=e-1;n>=s;n--){const o=this.children[n];o&&(this.layerGroup&&this.layerGroup.removeChild(o),r.push(o),o.parent=null)}AC(this.children,s,e);for(let n=0;n<r.length;++n)this.emit("childRemoved",r[n],this,n),r[n].emit("removed",this);return r}else if(i===0&&this.children.length===0)return r;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(s){const t=this.getChildAt(s);return this.removeChild(t)},getChildAt(s){if(s<0||s>=this.children.length)throw new Error(`getChildAt: Index (${s}) does not exist.`);return this.children[s]},setChildIndex(s,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(s),this.addChildAt(s,t)},getChildIndex(s){const t=this.children.indexOf(s);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(s,t){const{children:e}=this;if(t<0||t>e.length)throw new Error(`${s}addChildAt: The index ${t} supplied is out of bounds ${e.length}`);if(s.parent){const i=s.parent.children.indexOf(s);if(s.parent===this&&i===t)return s;i!==-1&&s.parent.children.splice(i,1)}return t===e.length?e.push(s):e.splice(t,0,s),s.parent=this,s.didChange=!0,s.didViewUpdate=!1,s.updateFlags=15,this.layerGroup&&this.layerGroup.addChild(s),this.emit("childAdded",s,this,t),s.emit("added",this),s},swapChildren(s,t){if(s===t)return;const e=this.getChildIndex(s),i=this.getChildIndex(t);this.children[e]=t,this.children[i]=s},removeFromParent(){var s;(s=this.parent)==null||s.removeChild(this)}};class EC{constructor(t){this.pipe="filter",this.priority=1,this.filters=t==null?void 0:t.filters}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null}}const v_=[];function MC(s){const t=v_.pop()||new EC;return t.filters=s,t}function IC(s){s.filters=null,v_.push(s)}class RC{constructor(t,e){this._pool=[],this._count=0,this._debug=!1,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool.push(new this._classType);this._count+=t}get(t){var i;let e=this._pool.pop();return e||(e=new this._classType),(i=e.init)==null||i.call(e,t),e}return(t){var e;if(this._pool.indexOf(t)!==-1){this._debug&&console.warn("Object already in pool",t);return}(e=t.reset)==null||e.call(t),this._pool.push(t)}get totalSize(){return this._count}get totalFree(){return this._pool.length}get totalUsed(){return this._count-this._pool.length}}class kC{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new RC(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const i=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[i]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}}const Fu=new kC;class BC{constructor(){this._effectClasses=[],this.tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this.tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this.tests.length;e++){const i=this.tests[e];if(i.test(t))return Fu.get(i.maskClass,t)}return t}returnMaskEffect(t){Fu.return(t)}}const ol=new BC;GT.handleByList(f_.MaskEffect,ol._effectClasses);const LC={_mask:null,_filters:null,set mask(s){if(this._mask||(this._mask={mask:null,effect:null}),this._mask.mask===s||(this._mask.effect&&(this.removeEffect(this._mask.effect),ol.returnMaskEffect(this._mask.effect),this._mask.effect=null),this._mask.mask=s,s==null))return;const t=ol.getMaskEffect(s);this._mask.effect=t,this.addEffect(t)},get mask(){var s;return(s=this._mask)==null?void 0:s.mask},set filters(s){if(Array.isArray(s)||(s=[s]),this._filters||(this._filters={filters:null,effect:null}),this._filters.filters===s||(this._filters.effect&&(this.removeEffect(this._filters.effect),IC(this._filters.effect),this._filters.effect=null),this._filters.filters=s,!s))return;const t=MC(s);this._filters.effect=t,this.addEffect(t)},get filters(){var s;return(s=this._filters)==null?void 0:s.filters}},FC={getChildByLabel(s,t=!1){const e=this.children;for(let i=0;i<e.length;i++){const r=e[i];if(r.label===s||s instanceof RegExp&&s.test(r.label))return r}if(t)for(let i=0;i<e.length;i++){const n=e[i].getChildByLabel(s,!0);if(n)return n}return null},getChildrenByLabel(s,t=!1,e=[]){const i=this.children;for(let r=0;r<i.length;r++){const n=i[r];(n.label===s||s instanceof RegExp&&s.test(n.label))&&e.push(n)}if(t)for(let r=0;r<i.length;r++)i[r].getChildrenByLabel(s,!0,e);return e}};function sn(s,t){const e=t._scale,i=t._pivot,r=t.position,n=e._x,o=e._y,a=i._x,h=i._y;s.a=t._cx*n,s.b=t._sx*n,s.c=t._cy*o,s.d=t._sy*o,s.tx=r._x-(a*s.a+h*s.c),s.ty=r._y-(a*s.b+h*s.d)}function OC(s,t,e){e.clear();let i;return s.parent?t?i=s.parent.worldTransform:i=Co(s,new Q):i=Q.IDENTITY,T_(s,e,i,t),e.isValid||e.set(0,0,0,0),e}function T_(s,t,e,i){var n,o;if(!s.visible||!s.measurable)return;let r;i?r=s.worldTransform:(s.didChange&&sn(s.localTransform,s),r=Q.shared.appendFrom(s.localTransform,e).clone()),s.view&&(t.setMatrix(r),s.view.addBounds(t));for(let a=0;a<s.children.length;a++)T_(s.children[a],t,r,i);for(let a=0;a<s.effects.length;a++)(o=(n=s.effects[a]).addBounds)==null||o.call(n,t)}function Co(s,t){const e=s.parent;return e&&(Co(e,t),e.didChange&&sn(e.localTransform,e),t.append(e.localTransform)),t}function gr(s,t,e){t.clear(),e||(e=new Q),s.view&&(t.setMatrix(e),s.view.addBounds(t));for(let i=0;i<s.children.length;i++)C_(s.children[i],t,e||new Q,s);return t.isValid||t.set(0,0,0,0),t}function C_(s,t,e,i){var o,a;if(!s.visible||!s.measurable)return;s.didChange&&sn(s.localTransform,s);const r=s.localTransform,n=Q.shared.appendFrom(r,e).clone();s.view&&(t.setMatrix(n),s.view.addBounds(t));for(let h=0;h<s.children.length;h++)C_(s.children[h],t,n,i);for(let h=0;h<s.effects.length;h++)(a=(o=s.effects[h]).addLocalBounds)==null||a.call(o,t,i)}const Ai=new un,Un=new Q,UC={get width(){return this.scale.x*gr(this,Ai,Un).width},set width(s){this.scale.x=s/gr(this,Ai,Un).width},get height(){return this.scale.y*gr(this,Ai,Un).height},set height(s){this.scale.y=s/gr(this,Ai,Un).height},getLocalBounds(){return gr(this,Ai,this.localTransform).rectangle},getBounds(s){return OC(this,s,Ai).rectangle}},NC={_onRender:null,set onRender(s){const t=this.layerGroup;if(!s){this._onRender&&(t==null||t.removeOnRender(this)),this._onRender=null;return}this._onRender||t==null||t.addOnRender(this),this._onRender=s},get onRender(){return this._onRender}},DC={getGlobalPosition(s=new oe,t=!1){return this.parent?this.parent.toGlobal(this.position,s,t):(s.x=this.position.x,s.y=this.position.y),s},toGlobal(s,t,e=!1){if(!e){this.didChange&&sn(this.localTransform,this);const i=Co(this,new Q);return i.append(this.localTransform),i.apply(s,t)}return this.worldTransform.apply(s,t)},toLocal(s,t,e,i){if(t&&(s=t.toGlobal(s,e,i)),!i){this.didChange&&sn(this.localTransform,this);const r=Co(this,new Q);return r.append(this.localTransform),r.applyInverse(s,e)}return this.worldTransform.applyInverse(s,e)}};let $C=0;class GC{constructor(){this.uid=$C++,this.instructions=[],this.instructionSize=0}reset(){this.instructionSize=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}lastInstruction(){return this.instructions[this.instructionSize-1]}}class VC extends $e{constructor({original:t,view:e}){super(),this.uid=zC(),this.view=e,this.original=t,this.layerTransform=new Q,this.layerColor=4294967295,this.layerVisibleRenderable=3,this.view.owner=this}get layerBlendMode(){return this.original.layerBlendMode}onViewUpdate(){this.didViewUpdate=!0,this.original.layerGroup.onChildViewUpdate(this)}get isRenderable(){return this.original.isRenderable}}class WC{constructor(t){this.type="layer",this.root=null,this.rootRenderable=null,this.canBundle=!1,this.layerGroupParent=null,this.layerGroupChildren=[],this.children=[],this.worldTransform=new Q,this.worldColor=4294967295,this.childrenToUpdate={},this.updateTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new GC,this.onRenderContainers=[],this.root=t;const e=t.view;e&&(this.proxyRenderable=new VC({original:t,view:e})),this.addChild(t)}get localTransform(){return this.root.localTransform}get layerTransform(){return this.root.layerTransform}addLayerGroupChild(t){t.layerGroupParent&&t.layerGroupParent.removeLayerGroupChild(t),t.layerGroupParent=this,this.onChildUpdate(t.root),this.layerGroupChildren.push(t)}removeLayerGroupChild(t){t.root.didChange&&this.removeChildFromUpdate(t.root);const e=this.layerGroupChildren.indexOf(t);e>-1&&this.layerGroupChildren.splice(e,1),t.layerGroupParent=null}addChild(t){if(this.structureDidChange=!0,t!==this.root&&(this.children.push(t),t.updateTick=-1,t.parent===this.root?t.relativeLayerDepth=1:t.relativeLayerDepth=t.parent.relativeLayerDepth+1,t._onRender&&this.addOnRender(t)),t.layerGroup){if(t.layerGroup.root===t){this.addLayerGroupChild(t.layerGroup);return}}else t.layerGroup=this;const e=t.children;t.isLayerRoot||this.onChildUpdate(t);for(let i=0;i<e.length;i++)this.addChild(e[i])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&this.removeOnRender(t),t.layerGroup.root!==t){const i=t.children;for(let r=0;r<i.length;r++)this.removeChild(i[r]);t.didChange&&t.layerGroup.removeChildFromUpdate(t),t.layerGroup=null}else this.removeLayerGroupChild(t.layerGroup);const e=this.children.indexOf(t);e>-1&&this.children.splice(e,1)}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeLayerDepth];e||(e=this.childrenToUpdate[t.relativeLayerDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.layerVisibleRenderable<3||(t.didViewUpdate=!1,this.instructionSet.renderPipes[t.view.type].updateRenderable(t))}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}removeChildFromUpdate(t){const e=this.childrenToUpdate[t.relativeLayerDepth];if(!e)return;const i=e.list.indexOf(t);i>-1&&e.list.splice(i,1),e.index--}get isRenderable(){const t=this.worldColor>>24&255;return this.root.localVisibleRenderable===3&&t>0}addOnRender(t){this.onRenderContainers.push(t)}removeOnRender(t){this.onRenderContainers.splice(this.onRenderContainers.indexOf(t),1)}runOnRender(){this.onRenderContainers.forEach(t=>{t._onRender()})}}let S_=0;function zC(){return S_++}const Ou=new Ce(null),Uu=new Ce(null),Nu=new Ce(null,1,1),Du=1,HC=2,$u=4;class Wt extends $e{constructor({label:t,layer:e,view:i}={}){super(),this.uid=S_++,this.label=null,this.updateFlags=15,this.isLayerRoot=!1,this.layerGroup=null,this.didChange=!1,this.didViewUpdate=!1,this.relativeLayerDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new Q,this.layerTransform=new Q,this.position=new Ce(this,0,0),this._scale=Nu,this._pivot=Uu,this._skew=Ou,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=4294967295,this.layerColor=4294967295,this.localBlendMode="inherit",this.layerBlendMode="normal",this.localVisibleRenderable=3,this.layerVisibleRenderable=3,this.effects=[],t&&(this.label=t),e&&this.enableLayer(),i&&(this.view=i,this.view.owner=this)}static mixin(t){Object.defineProperties(Wt.prototype,Object.getOwnPropertyDescriptors(t))}addEffect(t){this.effects.indexOf(t)===-1&&(this.effects.push(t),this.effects.sort((i,r)=>i.priority-r.priority),!this.isLayerRoot&&this.layerGroup&&(this.layerGroup.structureDidChange=!0),this.updateIsSimple())}removeEffect(t){const e=this.effects.indexOf(t);e!==-1&&(this.effects.splice(e,1),!this.isLayerRoot&&this.layerGroup&&(this.layerGroup.structureDidChange=!0),this.updateIsSimple())}addChild(...t){if(t.length>1){for(let i=0;i<t.length;i++)this.addChild(t[i]);return t[0]}const e=t[0];return e.parent===this?(this.children.splice(this.children.indexOf(e),1),this.children.push(e),this.layerGroup&&!this.isLayerRoot&&(this.layerGroup.structureDidChange=!0),e):(e.parent&&e.parent.removeChild(e),this.children.push(e),e.parent=this,e.didChange=!0,e.didViewUpdate=!1,e.updateFlags=15,this.layerGroup&&this.layerGroup.addChild(e),e)}removeChild(...t){if(t.length>1){for(let r=0;r<t.length;r++)this.removeChild(t[r]);return t[0]}const e=t[0],i=this.children.indexOf(e);return i>-1&&(this.children.splice(i,1),this.layerGroup&&this.layerGroup.removeChild(e)),e.parent=null,e}onUpdate(t){if(t&&t===this._skew&&this.updateSkew(),!this.didChange)if(this.didChange=!0,this.isLayerRoot){const e=this.layerGroup.layerGroupParent;e&&e.onChildUpdate(this)}else this.layerGroup&&this.layerGroup.onChildUpdate(this)}onViewUpdate(){this.didViewUpdate||(this.didViewUpdate=!0,this.layerGroup&&this.layerGroup.onChildViewUpdate(this))}set layer(t){if(this.isLayerRoot&&t===!1)throw new Error("[Pixi] cannot undo a layer just yet");t&&this.enableLayer()}get layer(){return this.isLayerRoot}enableLayer(){if(this.layerGroup&&this.layerGroup.root===this)return;this.isLayerRoot=!0;const t=this.layerGroup;if(t&&t.removeChild(this),this.layerGroup=new WC(this),t){for(let e=0;e<t.layerGroupChildren.length;e++){const i=t.layerGroupChildren[e];let r=i.root;for(;r;){if(r===this){this.layerGroup.addLayerGroupChild(i);break}r=r.parent}}t.addLayerGroupChild(this.layerGroup)}this.updateIsSimple()}get worldTransform(){return this._worldTransform||(this._worldTransform=new Q),this.layerGroup&&(this.isLayerRoot?this._worldTransform.copyFrom(this.layerGroup.worldTransform):this._worldTransform.appendFrom(this.layerTransform,this.layerGroup.worldTransform)),this._worldTransform}get x(){return this.position.x}set x(t){this.position.x=t}get y(){return this.position.y}set y(t){this.position.y=t}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.onUpdate(this._skew))}get angle(){return this.rotation*ZT}set angle(t){this.rotation=t*JT}get pivot(){return this._pivot===Uu&&(this._pivot=new Ce(this,0,0)),this._pivot}get skew(){return this._skew===Ou&&(this._skew=new Ce(this,0,0)),this._skew}get scale(){return this._scale===Nu&&(this._scale=new Ce(this,1,1)),this._scale}updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}set alpha(t){t=t*255|0,t!==(this.localColor>>24&255)&&(this.localColor=this.localColor&16777215|t<<24,this.updateFlags|=Du,this.onUpdate())}get alpha(){return(this.localColor>>24&255)/255}set tint(t){t=((t&255)<<16)+(t&65280)+(t>>16&255),t!==(this.localColor&16777215)&&(this.localColor=this.localColor&4278190080|t&16777215,this.updateFlags|=Du,this.onUpdate())}get tint(){const t=this.localColor&16777215;return((t&255)<<16)+(t&65280)+(t>>16&255)}set blendMode(t){this.localBlendMode!==t&&(this.layerGroup&&!this.isLayerRoot&&(this.layerGroup.structureDidChange=!0),this.updateFlags|=HC,this.localBlendMode=t,this.onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localVisibleRenderable&2)}set visible(t){const e=t?1:0;(this.localVisibleRenderable&2)>>1!==e&&(this.layerGroup&&!this.isLayerRoot&&(this.layerGroup.structureDidChange=!0),this.updateFlags|=$u,this.localVisibleRenderable=this.localVisibleRenderable&1|e<<1,this.onUpdate())}get renderable(){return!!(this.localVisibleRenderable&1)}set renderable(t){const e=t?1:0;(this.localVisibleRenderable&1)!==e&&(this.localVisibleRenderable=this.localVisibleRenderable&2|e,this.updateFlags|=$u,this.layerGroup&&!this.isLayerRoot&&(this.layerGroup.structureDidChange=!0),this.onUpdate())}get isRenderable(){const t=this.layerColor>>24&255;return this.localVisibleRenderable===3&&t>0}updateIsSimple(){this.isSimple=!this.isLayerRoot&&this.effects.length===0}destroy(t=!1){this.removeFromParent(),this.parent=null,this._mask=null,this._filters=null,this.effects=null,this.position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed"),this.removeAllListeners();const e=typeof t=="boolean"?t:t==null?void 0:t.children,i=this.removeChildren(0,this.children.length);if(e)for(let r=0;r<i.length;++r)i[r].destroy(t);this.view&&(this.view.destroy(t),this.view.owner=null)}}Wt.mixin(PC);Wt.mixin(DC);Wt.mixin(NC);Wt.mixin(UC);Wt.mixin(LC);Wt.mixin(FC);const A_={onViewUpdate:()=>{}};let XC=0;class jC{constructor(t){var e,i;this.owner=A_,this.batched=!0,this.buildId=0,this.uid=XC++,this.type="sprite",this._bounds=[0,1,0,0],this._sourceBounds=[0,1,0,0],this.boundsDirty=!0,this.sourceBoundsDirty=!0,this.anchor=new Ce(this,((e=t.layout.defaultAnchor)==null?void 0:e.x)||0,((i=t.layout.defaultAnchor)==null?void 0:i.y)||0),this.texture=t}set texture(t){this._texture!==t&&(t.on("update",this.onUpdate,this),this._texture=t,t.off("update",this.onUpdate,this),this.onUpdate())}get texture(){return this._texture}get bounds(){return this.boundsDirty&&(this.updateBounds(),this.boundsDirty=!1),this._bounds}get sourceBounds(){return this.sourceBoundsDirty&&(this._updateSourceBounds(),this.sourceBoundsDirty=!1),this._sourceBounds}updateBounds(){const t=this._texture,e=t._source,i=t.layout,r=i.orig,n=i.trim,o=e.width,a=e.height,h=o*r.width,l=a*r.height,c=this.anchor,u=this._bounds;if(n){const d=o*n.width,f=a*n.height;u[1]=n.x*o-c._x*h,u[0]=u[1]+d,u[3]=n.y*a-c._y*l,u[2]=u[3]+f}else u[1]=-c._x*h,u[0]=u[1]+h,u[3]=-c._y*l,u[2]=u[3]+l}_updateSourceBounds(){const t=this.anchor,e=this._texture,i=e._source,n=e.layout.orig,o=this._sourceBounds,a=i.width*n.width,h=i.height*n.height;o[1]=-t._x*a,o[0]=o[1]+a,o[3]=-t._y*h,o[2]=o[3]+h}addBounds(t){if(this._texture._layout.trim){const i=this.sourceBounds;t.addFrame(i[0],i[2],i[1],i[3])}else{const i=this.bounds;t.addFrame(i[0],i[2],i[1],i[3])}}onUpdate(){this.didUpdate=!0,this.boundsDirty=!0,this.owner.onViewUpdate()}containsPoint(t){const e=this._texture.frameWidth,i=this._texture.frameHeight,r=-e*this.anchor.x;let n=0;return t.x>=r&&t.x<r+e&&(n=-i*this.anchor.y,t.y>=n&&t.y<n+i)}destroy(t=!1){if(this.anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const i=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(i)}this._texture=null,this._bounds=null,this._sourceBounds=null}}class So extends Wt{static from(t){return typeof t=="string"?new So(Yi.get(t)):new So(t)}constructor(t=gt.EMPTY){t instanceof gt&&(t={texture:t}),t.texture??(t.texture=gt.EMPTY),super({view:new jC(t.texture),label:"Sprite",...t})}get anchor(){return this.view.anchor}get texture(){return this.view.texture}set texture(t){this.view.texture=t}}function Gu(s){return s+=s===0?1:0,--s,s|=s>>>1,s|=s>>>2,s|=s>>>4,s|=s>>>8,s|=s>>>16,s+1}function YC(s,t=[]){return t[0]=(s>>16&255)/255,t[1]=(s>>8&255)/255,t[2]=(s&255)/255,t}class qC{constructor(t){this.poolKeyHash={},this.canvasPool={},this.canvasOptions=t||{},this.enableFullScreen=!1}createCanvasAndContext(t,e){const i=ji.ADAPTER.createCanvas();i.width=t,i.height=e;const r=i.getContext("2d");return{canvas:i,context:r}}getOptimalCanvasAndContext(t,e,i=1){t=Math.ceil(t*i-1e-6),e=Math.ceil(e*i-1e-6),t=Gu(t),e=Gu(e);const r=(t<<17)+(e<<1);this.canvasPool[r]||(this.canvasPool[r]=[]);let n=this.canvasPool[r].pop();return n||(n=this.createCanvasAndContext(t,e)),n}returnCanvasAndContext(t){const{width:e,height:i}=t.canvas,r=(e<<17)+(i<<1);this.canvasPool[r].push(t)}clear(){this.canvasPool={}}}const Vu=new qC;var P_=(s=>(s[s.NPM=0]="NPM",s[s.UNPACK=1]="UNPACK",s[s.PMA=2]="PMA",s[s.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",s[s.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",s[s.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",s))(P_||{});const KC=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function al(s){const t=typeof s.fontSize=="number"?`${s.fontSize}px`:s.fontSize;let e=s.fontFamily;Array.isArray(s.fontFamily)||(e=s.fontFamily.split(","));for(let i=e.length-1;i>=0;i--){let r=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!KC.includes(r)&&(r=`"${r}"`),e[i]=r}return`${s.fontStyle} ${s.fontVariant} ${s.fontWeight} ${t} ${e.join(",")}`}const eh={willReadFrequently:!0},B=class{static get experimentalLetterSpacingSupported(){let s=B._experimentalLetterSpacingSupported;if(s!==void 0){const t=ji.ADAPTER.getCanvasRenderingContext2D().prototype;s=B._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return s}constructor(s,t,e,i,r,n,o,a,h){this.text=s,this.style=t,this.width=e,this.height=i,this.lines=r,this.lineWidths=n,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=h}static measureText(s=" ",t,e=B._canvas,i=t.wordWrap){var x;const r=`${s}:${t.styleKey}`;if(B._measurementCache[r])return B._measurementCache[r];const n=al(t),o=B.measureFont(n);o.fontSize===0&&(o.fontSize=t.fontSize,o.ascent=t.fontSize);const a=B.__context;a.font=n;const l=(i?B.wordWrap(s,t,e):s).split(/(?:\r\n|\r|\n)/),c=new Array(l.length);let u=0;for(let g=0;g<l.length;g++){const y=B._measureText(l[g],t.letterSpacing,a);c[g]=y,u=Math.max(u,y)}const d=((x=t.stroke)==null?void 0:x.width)||0;let f=u+d;t.dropShadow&&(f+=t.dropShadow.distance);const p=t.lineHeight||o.fontSize+d;let m=Math.max(p,o.fontSize+d*2)+(l.length-1)*(p+t.leading);return t.dropShadow&&(m+=t.dropShadow.distance),new B(s,t,f,m,l,c,p+t.leading,u,o)}static _measureText(s,t,e){let i=!1;B.experimentalLetterSpacingSupported&&(B.experimentalLetterSpacing?(e.letterSpacing=`${t}px`,e.textLetterSpacing=`${t}px`,i=!0):(e.letterSpacing="0px",e.textLetterSpacing="0px"));let r=e.measureText(s).width;return r>0&&(i?r-=t:r+=(B.graphemeSegmenter(s).length-1)*t),r}static wordWrap(s,t,e=B._canvas){const i=e.getContext("2d",eh);let r=0,n="",o="";const a=Object.create(null),{letterSpacing:h,whiteSpace:l}=t,c=B.collapseSpaces(l),u=B.collapseNewlines(l);let d=!c;const f=t.wordWrapWidth+h,p=B.tokenize(s);for(let m=0;m<p.length;m++){let _=p[m];if(B.isNewline(_)){if(!u){o+=B.addLine(n),d=!c,n="",r=0;continue}_=" "}if(c){const g=B.isBreakingSpace(_),y=B.isBreakingSpace(n[n.length-1]);if(g&&y)continue}const x=B.getFromCache(_,h,a,i);if(x>f)if(n!==""&&(o+=B.addLine(n),n="",r=0),B.canBreakWords(_,t.breakWords)){const g=B.wordWrapSplit(_);for(let y=0;y<g.length;y++){let w=g[y],v=w,S=1;for(;g[y+S];){const T=g[y+S];if(!B.canBreakChars(v,T,_,y,t.breakWords))w+=T;else break;v=T,S++}y+=S-1;const C=B.getFromCache(w,h,a,i);C+r>f&&(o+=B.addLine(n),d=!1,n="",r=0),n+=w,r+=C}}else{n.length>0&&(o+=B.addLine(n),n="",r=0);const g=m===p.length-1;o+=B.addLine(_,!g),d=!1,n="",r=0}else x+r>f&&(d=!1,o+=B.addLine(n),n="",r=0),(n.length>0||!B.isBreakingSpace(_)||d)&&(n+=_,r+=x)}return o+=B.addLine(n,!1),o}static addLine(s,t=!0){return s=B.trimRight(s),s=t?`${s}
`:s,s}static getFromCache(s,t,e,i){let r=e[s];return typeof r!="number"&&(r=B._measureText(s,t,i)+t,e[s]=r),r}static collapseSpaces(s){return s==="normal"||s==="pre-line"}static collapseNewlines(s){return s==="normal"}static trimRight(s){if(typeof s!="string")return"";for(let t=s.length-1;t>=0;t--){const e=s[t];if(!B.isBreakingSpace(e))break;s=s.slice(0,-1)}return s}static isNewline(s){return typeof s!="string"?!1:B._newlines.includes(s.charCodeAt(0))}static isBreakingSpace(s,t){return typeof s!="string"?!1:B._breakingSpaces.includes(s.charCodeAt(0))}static tokenize(s){const t=[];let e="";if(typeof s!="string")return t;for(let i=0;i<s.length;i++){const r=s[i],n=s[i+1];if(B.isBreakingSpace(r,n)||B.isNewline(r)){e!==""&&(t.push(e),e=""),t.push(r);continue}e+=r}return e!==""&&t.push(e),t}static canBreakWords(s,t){return t}static canBreakChars(s,t,e,i,r){return!0}static wordWrapSplit(s){return B.graphemeSegmenter(s)}static measureFont(s){if(B._fonts[s])return B._fonts[s];const t=B._context;t.font=s;const e=t.measureText(B.METRICS_STRING+B.BASELINE_SYMBOL),i={ascent:e.actualBoundingBoxAscent,descent:e.actualBoundingBoxDescent,fontSize:e.actualBoundingBoxAscent+e.actualBoundingBoxDescent};return B._fonts[s]=i,i}static clearMetrics(s=""){s?delete B._fonts[s]:B._fonts={}}static get _canvas(){if(!B.__canvas){let s;try{const t=new OffscreenCanvas(0,0),e=t.getContext("2d",eh);if(e!=null&&e.measureText)return B.__canvas=t,t;s=ji.ADAPTER.createCanvas()}catch{s=ji.ADAPTER.createCanvas()}s.width=s.height=10,B.__canvas=s}return B.__canvas}static get _context(){return B.__context||(B.__context=B._canvas.getContext("2d",eh)),B.__context}};let pe=B;pe.METRICS_STRING="|q";pe.BASELINE_SYMBOL="M";pe.BASELINE_MULTIPLIER=1.4;pe.HEIGHT_MULTIPLIER=2;pe.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const s=new Intl.Segmenter;return t=>[...s.segment(t)].map(e=>e.segment)}return s=>[...s]})();pe.experimentalLetterSpacing=!1;pe._fonts={};pe._newlines=[10,13];pe._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];pe._measurementCache={};function Wu(s,t){if(s.texture===gt.WHITE&&!s.fill)return sl(s.color);if(s.fill){if(s.fill instanceof Dl){const e=s.fill,i=t.createPattern(e.texture.source.resource,"repeat"),r=e.transform.copyTo(Q.shared);return r.scale(e.texture.frameWidth,e.texture.frameHeight),i.setTransform(r),i}else if(s.fill instanceof en){const e=s.fill;if(e.type==="linear"){const i=t.createLinearGradient(e.x0,e.y0,e.x1,e.y1);return e.gradientStops.forEach(r=>{i.addColorStop(r.offset,sl(r.color))}),i}}}else{const e=t.createPattern(s.texture.source.resource,"repeat"),i=s.matrix.copyTo(Q.shared);return i.scale(s.texture.frameWidth,s.texture.frameHeight),e.setTransform(i),e}return console.warn("[PixiJS] FillStyle not recognised",s),"red"}const zu=["fontFamily","fontStyle","fontVariant","fontWeight","breakWords","align","leading","letterSpacing","lineHeight","textBaseline","whiteSpace","wordWrap","wordWrapWidth","padding"],ki=class extends $e{constructor(s={}){super();const t={...ki.defaultTextStyle,...s};for(const e in ki.defaultTextStyle){const i=e;this[i]=t[e]}this.dropShadow=null,typeof s.fill=="string"?this.fontSize=parseInt(s.fontSize,10):this.fontSize=s.fontSize,s.dropShadow&&(s.dropShadow instanceof Boolean?s.dropShadow===!0&&(this.dropShadow={...ki.defaultTextStyle.dropShadow}):this.dropShadow={...ki.defaultTextStyle.dropShadow,...s.dropShadow}),this.update()}generateKey(){const s=[];let t=0;for(let e=0;e<zu.length;e++){const i=zu[e];s[t++]=this[i]}return t=E_(this._fill,s,t),t=ZC(this._stroke,s,t),this._styleKey=s.join("-"),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}get fill(){return this._originalFill}set fill(s){s!==this._fill&&(this._originalFill=s,this._fill=vo(s,To.defaultFillStyle))}get stroke(){return this._originalStroke}set stroke(s){s!==this._fill&&(this._originalFill=s,this._stroke=vo(s,To.defaultStrokeStyle))}get styleKey(){return this._styleKey||this.generateKey()}clone(){return new ki({align:this.align,breakWords:this.breakWords,dropShadow:this.dropShadow,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(s=!1){var e,i,r,n;if(this.removeAllListeners(),typeof s=="boolean"?s:s==null?void 0:s.texture){const o=typeof s=="boolean"?s:s==null?void 0:s.textureSource;(e=this._fill)!=null&&e.texture&&this._fill.texture.destroy(o),(i=this._originalFill)!=null&&i.texture&&this._originalFill.texture.destroy(o),(r=this._stroke)!=null&&r.texture&&this._stroke.texture.destroy(o),(n=this._originalStroke)!=null&&n.texture&&this._originalStroke.texture.destroy(o)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}};let si=ki;si.defaultTextStyle={align:"left",breakWords:!1,dropShadow:{alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5},fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function E_(s,t,e){var i;return s&&(t[e++]=s.color,t[e++]=s.alpha,t[e++]=(i=s.fill)==null?void 0:i.uid),e}function ZC(s,t,e){return s&&(e=E_(s,t,e),t[e++]=s.width,t[e++]=s.alignment,t[e++]=s.cap,t[e++]=s.join,t[e++]=s.miterLimit),e}function JC(s){typeof s=="string"&&(s=[s]);const t=[];for(let e=0,i=s.length;e<i;e++){const r=s[e];if(Array.isArray(r)){if(r.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);const n=r[0].charCodeAt(0),o=r[1].charCodeAt(0);if(o<n)throw new Error("[BitmapFont]: Invalid character range.");for(let a=n,h=o;a<=h;a++)t.push(String.fromCharCode(a))}else t.push(...Array.from(r))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}class QC extends $e{constructor(t){super(),this.baseRenderedFontSize=100,this.baseMeasurementFontSize=100,this.padding=4,this.baseLineOffset=0,this.pages=[],this.chars={},this.lineHeight=0,this.measureCache={},this.currentChars=[],this.dynamic=!0,this.currentX=0,this.currentY=0,this.currentPageIndex=-1,this.resolution=1,this.distanceField={fieldType:"none",distanceRange:0},this.pages=[];const e=t;this.dynamic=!0;let i;e.style instanceof si?i=e.style.clone():i=new si(e.style),i.fontSize=this.baseMeasurementFontSize,e.overrideFill&&(i._fill.color=16777215,i._fill.alpha=1,i._fill.texture=gt.WHITE,i._fill.fill=null),this.style=i;const r=al(i);this.fontMetrics=pe.measureFont(r),this.lineHeight=i.lineHeight||this.fontMetrics.fontSize||i.fontSize}ensureCharacters(t){var m,_;const e=JC(t).filter(x=>!this.currentChars.includes(x)).filter((x,g,y)=>y.indexOf(x)===g);if(!e.length)return;this.currentChars=[...this.currentChars,...e];let i;this.currentPageIndex===-1?i=this.nextPage():i=this.pages[this.currentPageIndex];let{canvas:r,context:n}=i.canvasAndContext,o=i.texture.source;const a=this.style;let h=this.currentX,l=this.currentY;const c=this.baseRenderedFontSize/this.baseMeasurementFontSize,u=this.padding*c,d=a.fontStyle==="italic"?2:1;let f=0,p=!1;for(let x=0;x<e.length;x++){const g=e[x],y=pe.measureText(g,a,r,!1),w=d*y.width*c,v=y.height*c,S=w+u*2,C=v+u*2;if(p=!1,g!==`
`&&g!=="\r"&&g!=="	"&&g!==" "&&(p=!0,f=Math.ceil(Math.max(C,f))),h+S>512&&(l+=f,f=C,h=0,l+f>512)){o.update();const A=this.nextPage();r=A.canvasAndContext.canvas,n=A.canvasAndContext.context,o=A.texture.source,l=0}const T=w/c-(((m=a.dropShadow)==null?void 0:m.distance)??0)-(((_=a._stroke)==null?void 0:_.width)??0);if(this.chars[g]={id:g.codePointAt(0),xOffset:-this.padding,yOffset:-this.padding,xAdvance:T,kerning:{}},p){this.drawGlyph(n,y,h+u,l+u,c,a);const A=o.width*c,P=o.height*c,I=new Kt(h/A,l/P,S/A,C/P);this.chars[g].texture=new gt({source:o,layout:{frame:I}}),h+=Math.ceil(S)}}o.update(),this.currentX=h,this.currentY=l,this.applyKerning(e,n)}applyKerning(t,e){const i=this.measureCache;for(let r=0;r<t.length;r++){const n=t[r];for(let o=0;o<this.currentChars.length;o++){const a=this.currentChars[o];let h=i[n];h||(h=i[n]=e.measureText(n).width);let l=i[a];l||(l=i[a]=e.measureText(a).width);let c=e.measureText(n+a).width,u=c-(h+l);u&&(this.chars[n].kerning[a]=u),c=e.measureText(n+a).width,u=c-(h+l),u&&(this.chars[a].kerning[n]=u)}}}nextPage(){this.currentPageIndex++;const t=this.resolution,e=Vu.getOptimalCanvasAndContext(512,512,t);this.setupContext(e.context,this.style,t);const i=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),r=new gt({source:new Nl({resource:e.canvas,resolution:i,alphaMode:P_.PMA})}),n={canvasAndContext:e,texture:r};return this.pages[this.currentPageIndex]=n,n}setupContext(t,e,i){e.fontSize=this.baseRenderedFontSize,t.scale(i,i),t.font=al(e),e.fontSize=this.baseMeasurementFontSize,t.textBaseline=e.textBaseline;const r=e._stroke,n=(r==null?void 0:r.width)??0;if(r&&(t.lineWidth=n,t.lineJoin=r.join,t.miterLimit=r.miterLimit,t.strokeStyle=Wu(r,t)),e._fill&&(t.fillStyle=Wu(e._fill,t)),e.dropShadow){const o=e.dropShadow,a=ls(o.color),h=YC(a),l=o.blur*i,c=o.distance*i;t.shadowColor=`rgba(${h[0]*255},${h[1]*255},${h[2]*255},${o.alpha})`,t.shadowBlur=l,t.shadowOffsetX=Math.cos(o.angle)*c,t.shadowOffsetY=Math.sin(o.angle)*c}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}drawGlyph(t,e,i,r,n,o){const a=e.text,h=e.fontProperties,l=o._stroke,c=((l==null?void 0:l.width)??0)*n,u=i+c/2,d=r-c/2,f=h.descent*n,p=e.lineHeight*n;o.stroke&&c&&t.strokeText(a,u,d+p-f),o._fill&&t.fillText(a,u,d+p-f)}destroy(){this.emit("destroy",this),this.removeAllListeners();for(const t in this.chars)this.chars[t].texture.destroy();this.chars=null;for(let t=0;t<this.pages.length;t++){const{canvasAndContext:e,texture:i}=this.pages[t];Vu.returnCanvasAndContext(e),i.destroy(!0)}this.pages=null}}function tS(s,t,e){const i={width:0,height:0,offsetY:0,scale:t.fontSize/e.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};i.offsetY=e.baseLineOffset;let r=i.lines[0],n=null,o=!0;const a={spaceWord:!1,width:0,start:0,index:0,positions:[],chars:[]},h=f=>{const p=r.width;for(let m=0;m<a.index;m++){const _=f.positions[m];r.chars.push(f.chars[m]),r.charPositions.push(_+p)}r.width+=f.width,o=!1,a.width=0,a.index=0,a.chars.length=0},l=()=>{let f=r.chars.length-1,p=r.chars[f];for(;p===" ";)r.width-=e.chars[p].xAdvance,p=r.chars[--f];i.width=Math.max(i.width,r.width),r={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},o=!0,i.lines.push(r),i.height+=e.lineHeight},c=e.baseMeasurementFontSize/t.fontSize,u=t.letterSpacing*c,d=t.wordWrapWidth*c;for(let f=0;f<s.length+1;f++){let p;const m=f===s.length;m||(p=s[f]);const _=e.chars[p];if(/(?:\s)/.test(p)||p==="\r"||p===`
`||m){if(!o&&t.wordWrap&&r.width+a.width-u>d?(l(),h(a),m||r.charPositions.push(0)):(a.start=r.width,h(a),m||r.charPositions.push(0)),p==="\r"||p===`
`)r.width!==0&&l();else if(!m){const w=_.xAdvance+(_.kerning[n]||0)+u;r.width+=w,r.spaceWidth=w,r.spacesIndex.push(r.charPositions.length),r.chars.push(p)}}else{const y=_.kerning[n]||0,w=_.xAdvance+y+u;a.positions[a.index++]=a.width+y,a.chars.push(p),a.width+=w}n=p}return l(),t.align==="center"?eS(i):t.align==="right"?sS(i):t.align==="justify"&&iS(i),i}function eS(s){for(let t=0;t<s.lines.length;t++){const e=s.lines[t],i=s.width/2-e.width/2;for(let r=0;r<e.charPositions.length;r++)e.charPositions[r]+=i}}function sS(s){for(let t=0;t<s.lines.length;t++){const e=s.lines[t],i=s.width-e.width;for(let r=0;r<e.charPositions.length;r++)e.charPositions[r]+=i}}function iS(s){const t=s.width;for(let e=0;e<s.lines.length;e++){const i=s.lines[e];let r=0,n=i.spacesIndex[r++],o=0;const a=i.spacesIndex.length,l=(t-i.width)/a;for(let c=0;c<i.charPositions.length;c++)c===n&&(n=i.spacesIndex[r++],o+=l),i.charPositions[c]+=o}}class rS{getFont(t,e){var o;let i=e.fontFamily,r=!0;e._fill.fill&&(i+=e._fill.fill.uid,r=!1),Yi.has(i)||Yi.set(i,new QC({style:e,overrideFill:r}));const n=Yi.get(i);return(o=n.ensureCharacters)==null||o.call(n,t),n}getLayout(t,e){const i=this.getFont(t,e);return tS(t.split(""),e,i)}measureText(t,e){return this.getLayout(t,e)}}const nS=new rS;let oS=0;const aS={canvas:"text",html:"text",bitmap:"bitmapText"},Zn=class{constructor(s){this.uid=oS++,this.batched=!0,this.type="text",this.owner=A_,this._bounds=[0,1,0,0],this.boundsDirty=!0,this._autoResolution=Zn.defaultAutoResolution,this._resolution=Zn.defaultResolution,this.didUpdate=!0,this._text=s.text,this._style=s.style instanceof si?s.style:new si(s.style);const t=s.renderMode??this.detectRenderType(this._style);this.type=aS[t],this.anchor=new Ce(this,0,0),this._resolution=s.resolution??Zn.defaultResolution}set text(s){s=s.toString(),this._text!==s&&(this._text=s,this.onUpdate())}get text(){return this._text}get style(){return this._style}set style(s){var t;s=s||{},(t=this._style)==null||t.off("update",this.onUpdate,this),s instanceof si?this._style=s:this._style=new si(s),this._style.on("update",this.onUpdate,this),this.onUpdate()}set resolution(s){this._resolution=s}get resolution(){return this._resolution}get bounds(){return this.boundsDirty&&(this.updateBounds(),this.boundsDirty=!1),this._bounds}updateBounds(){const s=this._bounds;if(this.type==="bitmapText"){const t=nS.measureText(this.text,this._style),e=t.scale,i=t.offsetY*e;s[0]=0,s[1]=i,s[2]=t.width*e,s[3]=t.height*e+i}else{const t=pe.measureText(this.text,this._style);s[0]=0,s[1]=0,s[2]=t.width,s[3]=t.height}}addBounds(s){const t=this.bounds;s.addFrame(t[0],t[1],t[2],t[3])}onUpdate(){this.didUpdate=!0,this.boundsDirty=!0,this.owner.onViewUpdate()}_getKey(){return`${this.text}:${this._style.styleKey}`}containsPoint(s){const t=this.bounds[2],e=this.bounds[3],i=-t*this.anchor.x;let r=0;return s.x>=i&&s.x<i+t&&(r=-e*this.anchor.y,s.y>=r&&s.y<r+e)}detectRenderType(s){return Yi.has(s.fontFamily)?"bitmap":"canvas"}destroy(s=!1){this.owner=null,this._bounds=null,this.anchor=null,this._style.destroy(s),this._style=null,this._text=null}};let Wl=Zn;Wl.defaultResolution=1;Wl.defaultAutoResolution=!0;class Hu extends Wt{constructor(t){super({view:new Wl(t),label:"Text",...t})}get anchor(){return this.view.anchor}set text(t){this.view.text=t}get text(){return this.view.text}set style(t){this.view.style=t}get style(){return this.view.style}}var sh=/iPhone/i,Xu=/iPod/i,ju=/iPad/i,Yu=/\biOS-universal(?:.+)Mac\b/i,ih=/\bAndroid(?:.+)Mobile\b/i,qu=/Android/i,Pi=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Nn=/Silk/i,ss=/Windows Phone/i,Ku=/\bWindows(?:.+)ARM\b/i,Zu=/BlackBerry/i,Ju=/BB10/i,Qu=/Opera Mini/i,td=/\b(CriOS|Chrome)(?:.+)Mobile/i,ed=/Mobile(?:.+)Firefox\b/i,sd=function(s){return typeof s<"u"&&s.platform==="MacIntel"&&typeof s.maxTouchPoints=="number"&&s.maxTouchPoints>1&&typeof MSStream>"u"};function hS(s){return function(t){return t.test(s)}}function id(s){var t={userAgent:"",platform:"",maxTouchPoints:0};!s&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof s=="string"?t.userAgent=s:s&&s.userAgent&&(t={userAgent:s.userAgent,platform:s.platform,maxTouchPoints:s.maxTouchPoints||0});var e=t.userAgent,i=e.split("[FBAN");typeof i[1]<"u"&&(e=i[0]),i=e.split("Twitter"),typeof i[1]<"u"&&(e=i[0]);var r=hS(e),n={apple:{phone:r(sh)&&!r(ss),ipod:r(Xu),tablet:!r(sh)&&(r(ju)||sd(t))&&!r(ss),universal:r(Yu),device:(r(sh)||r(Xu)||r(ju)||r(Yu)||sd(t))&&!r(ss)},amazon:{phone:r(Pi),tablet:!r(Pi)&&r(Nn),device:r(Pi)||r(Nn)},android:{phone:!r(ss)&&r(Pi)||!r(ss)&&r(ih),tablet:!r(ss)&&!r(Pi)&&!r(ih)&&(r(Nn)||r(qu)),device:!r(ss)&&(r(Pi)||r(Nn)||r(ih)||r(qu))||r(/\bokhttp\b/i)},windows:{phone:r(ss),tablet:r(Ku),device:r(ss)||r(Ku)},other:{blackberry:r(Zu),blackberry10:r(Ju),opera:r(Qu),firefox:r(ed),chrome:r(td),device:r(Zu)||r(Ju)||r(Qu)||r(ed)||r(td)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}const lS=id.default??id,Jn=lS(globalThis.navigator);var zt={},ks={};Object.defineProperty(ks,"__esModule",{value:!0});ks.Collector=void 0;let cS=class{constructor(t){this.emit=(...e)=>{t.emitCollecting(this,e)}}};ks.Collector=cS;var $o={};Object.defineProperty($o,"__esModule",{value:!0});$o.CollectorArray=void 0;const uS=ks;let dS=class extends uS.Collector{constructor(){super(...arguments),this.result=[]}handleResult(t){return this.result.push(t),!0}getResult(){return this.result}reset(){this.result.length=0}};$o.CollectorArray=dS;var Go={};Object.defineProperty(Go,"__esModule",{value:!0});Go.CollectorLast=void 0;const fS=ks;let pS=class extends fS.Collector{handleResult(t){return this.result=t,!0}getResult(){return this.result}reset(){delete this.result}};Go.CollectorLast=pS;var Vo={};Object.defineProperty(Vo,"__esModule",{value:!0});Vo.CollectorUntil0=void 0;const _S=ks;let mS=class extends _S.Collector{constructor(){super(...arguments),this.result=!1}handleResult(t){return this.result=t,this.result}getResult(){return this.result}reset(){this.result=!1}};Vo.CollectorUntil0=mS;var Wo={};Object.defineProperty(Wo,"__esModule",{value:!0});Wo.CollectorWhile0=void 0;const gS=ks;let yS=class extends gS.Collector{constructor(){super(...arguments),this.result=!1}handleResult(t){return this.result=t,!this.result}getResult(){return this.result}reset(){this.result=!1}};Wo.CollectorWhile0=yS;var zo={},Ho={};Object.defineProperty(Ho,"__esModule",{value:!0});Ho.SignalConnectionImpl=void 0;let xS=class{constructor(t,e){this.link=t,this.parentCleanup=e}disconnect(){return this.link!==null?(this.link.unlink(),this.link=null,this.parentCleanup(),this.parentCleanup=null,!0):!1}set enabled(t){this.link&&this.link.setEnabled(t)}get enabled(){return this.link!==null&&this.link.isEnabled()}};Ho.SignalConnectionImpl=xS;var Xo={};Object.defineProperty(Xo,"__esModule",{value:!0});Xo.SignalLink=void 0;let bS=class M_{constructor(t=null,e=null,i=0){this.enabled=!0,this.newLink=!1,this.callback=null,this.prev=t??this,this.next=e??this,this.order=i}isEnabled(){return this.enabled&&!this.newLink}setEnabled(t){this.enabled=t}unlink(){this.callback=null,this.next.prev=this.prev,this.prev.next=this.next}insert(t,e){let i=this.prev;for(;i!==this&&!(i.order<=e);)i=i.prev;const r=new M_(i,i.next,e);return r.callback=t,i.next=r,r.next.prev=r,r}};Xo.SignalLink=bS;Object.defineProperty(zo,"__esModule",{value:!0});zo.Signal=void 0;const wS=Ho,vS=Xo;let TS=class{constructor(){this.head=new vS.SignalLink,this.hasNewLinks=!1,this.emitDepth=0,this.connectionsCount=0}getConnectionsCount(){return this.connectionsCount}hasConnections(){return this.connectionsCount>0}connect(t,e=0){this.connectionsCount++;const i=this.head.insert(t,e);return this.emitDepth>0&&(this.hasNewLinks=!0,i.newLink=!0),new wS.SignalConnectionImpl(i,()=>this.decrementConnectionCount())}decrementConnectionCount(){this.connectionsCount--}disconnect(t){for(let e=this.head.next;e!==this.head;e=e.next)if(e.callback===t)return this.decrementConnectionCount(),e.unlink(),!0;return!1}disconnectAll(){for(;this.head.next!==this.head;)this.head.next.unlink();this.connectionsCount=0}emit(...t){this.emitDepth++;for(let e=this.head.next;e!==this.head;e=e.next)e.isEnabled()&&e.callback&&e.callback.apply(null,t);this.emitDepth--,this.unsetNewLink()}emitCollecting(t,e){this.emitDepth++;for(let i=this.head.next;i!==this.head;i=i.next)if(i.isEnabled()&&i.callback){const r=i.callback.apply(null,e);if(!t.handleResult(r))break}this.emitDepth--,this.unsetNewLink()}unsetNewLink(){if(this.hasNewLinks&&this.emitDepth===0){for(let t=this.head.next;t!==this.head;t=t.next)t.newLink=!1;this.hasNewLinks=!1}}};zo.Signal=TS;var jo={};Object.defineProperty(jo,"__esModule",{value:!0});jo.SignalConnections=void 0;let CS=class{constructor(){this.list=[]}add(t){this.list.push(t)}disconnectAll(){for(const t of this.list)t.disconnect();this.list=[]}getCount(){return this.list.length}isEmpty(){return this.list.length===0}};jo.SignalConnections=CS;(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.SignalConnections=s.Signal=s.CollectorWhile0=s.CollectorUntil0=s.CollectorLast=s.CollectorArray=s.Collector=void 0;var t=ks;Object.defineProperty(s,"Collector",{enumerable:!0,get:function(){return t.Collector}});var e=$o;Object.defineProperty(s,"CollectorArray",{enumerable:!0,get:function(){return e.CollectorArray}});var i=Go;Object.defineProperty(s,"CollectorLast",{enumerable:!0,get:function(){return i.CollectorLast}});var r=Vo;Object.defineProperty(s,"CollectorUntil0",{enumerable:!0,get:function(){return r.CollectorUntil0}});var n=Wo;Object.defineProperty(s,"CollectorWhile0",{enumerable:!0,get:function(){return n.CollectorWhile0}});var o=zo;Object.defineProperty(s,"Signal",{enumerable:!0,get:function(){return o.Signal}});var a=jo;Object.defineProperty(s,"SignalConnections",{enumerable:!0,get:function(){return a.SignalConnections}})})(zt);class SS{constructor(){this.onPress=new zt.Signal,this.onDown=new zt.Signal,this.onUp=new zt.Signal,this.onHover=new zt.Signal,this.onOut=new zt.Signal,this.onUpOut=new zt.Signal}connectEvents(t){t.on("pointerdown",this.processDown,this),t.on("pointerup",this.processUp,this),t.on("pointerupoutside",this.processUpOut,this),t.on("pointerout",this.processOut,this),t.on("pointertap",this.processPress,this),t.on("pointerover",this.processOver,this)}disconnectEvents(t){t.off("pointerdown",this.processDown,this),t.off("pointerup",this.processUp,this),t.off("pointerupoutside",this.processUpOut,this),t.off("pointerout",this.processOut,this),t.off("pointertap",this.processPress,this),t.off("pointerover",this.processOver,this)}processDown(t){this._isDown=!0,console.log("processDown"),this.onDown.emit(this,t),this.down(t)}processUp(t){this._isDown&&(this.onUp.emit(this,t),this.up(t)),this._isDown=!1}processUpOut(t){this._isDown&&(this.onUp.emit(this,t),this.onUpOut.emit(this,t),this.up(t),this.upOut(t)),this._isDown=!1}processOut(t){this._isMouseIn&&(this._isMouseIn=!1,this.onOut.emit(this,t),this.out(t))}processPress(t){this._isDown=!1,this.onPress.emit(this,t),this.press(t)}processOver(t){Jn.any||(this._isMouseIn=!0,this.onHover.emit(this,t),this.hover(t))}down(t){}up(t){}upOut(t){}out(t){}press(t){}hover(t){}get isDown(){return this._isDown}}const I_=(s,t,e=[])=>{const i=Object.getOwnPropertyDescriptors(t);for(let r of e)delete i[r];Object.defineProperties(s,i)},rn=(s,t=[s])=>{const e=Object.getPrototypeOf(s);return e===null?t:rn(e,[...t,e])},AS=(...s)=>{if(s.length===0)return;let t;const e=s.map(i=>rn(i));for(;e.every(i=>i.length>0);){const i=e.map(n=>n.pop()),r=i[0];if(i.every(n=>n===r))t=r;else break}return t},rd=(s,t,e=[])=>{var i;const r=(i=AS(...s))!==null&&i!==void 0?i:Object.prototype,n=Object.create(r),o=rn(r);for(let a of s){let h=rn(a);for(let l=h.length-1;l>=0;l--){let c=h[l];o.indexOf(c)===-1&&(I_(n,c,["constructor",...e]),o.push(c))}}return n.constructor=t,n},hl=s=>s.filter((t,e)=>s.indexOf(t)==e),R_=new Map,PS=s=>R_.get(s),ES=(s,t)=>R_.set(s,t),nd=(s,t)=>{var e,i;const r=hl([...Object.getOwnPropertyNames(s),...Object.getOwnPropertyNames(t)]),n={};for(let o of r)n[o]=hl([...(e=s==null?void 0:s[o])!==null&&e!==void 0?e:[],...(i=t==null?void 0:t[o])!==null&&i!==void 0?i:[]]);return n},od=(s,t)=>{var e,i,r,n;return{property:nd((e=s==null?void 0:s.property)!==null&&e!==void 0?e:{},(i=t==null?void 0:t.property)!==null&&i!==void 0?i:{}),method:nd((r=s==null?void 0:s.method)!==null&&r!==void 0?r:{},(n=t==null?void 0:t.method)!==null&&n!==void 0?n:{})}},MS=(s,t)=>{var e,i,r,n,o,a;return{class:hl([...(e=s==null?void 0:s.class)!==null&&e!==void 0?e:[],...(i=t==null?void 0:t.class)!==null&&i!==void 0?i:[]]),static:od((r=s==null?void 0:s.static)!==null&&r!==void 0?r:{},(n=t==null?void 0:t.static)!==null&&n!==void 0?n:{}),instance:od((o=s==null?void 0:s.instance)!==null&&o!==void 0?o:{},(a=t==null?void 0:t.instance)!==null&&a!==void 0?a:{})}},IS=new Map,RS=(...s)=>{var t;const e=new Set,i=new Set([...s]);for(;i.size>0;)for(let r of i){const n=rn(r.prototype).map(l=>l.constructor),o=(t=PS(r))!==null&&t!==void 0?t:[],h=[...n,...o].filter(l=>!e.has(l));for(let l of h)i.add(l);e.add(r),i.delete(r)}return[...e]},kS=(...s)=>{const t=RS(...s).map(e=>IS.get(e)).filter(e=>!!e);return t.length==0?{}:t.length==1?t[0]:t.reduce((e,i)=>MS(e,i))};function BS(...s){var t,e,i;const r=s.map(a=>a.prototype);function n(...a){for(const h of s)I_(this,new h(...a))}n.prototype=rd(r,n),Object.setPrototypeOf(n,rd(s,null,["prototype"]));let o=n;{const a=kS(...s);for(let h of(t=a==null?void 0:a.class)!==null&&t!==void 0?t:[]){const l=h(o);l&&(o=l)}ad((e=a==null?void 0:a.static)!==null&&e!==void 0?e:{},o),ad((i=a==null?void 0:a.instance)!==null&&i!==void 0?i:{},o.prototype)}return ES(o,s),o}const ad=(s,t)=>{const e=s.property,i=s.method;if(e)for(let r in e)for(let n of e[r])n(t,r);if(i)for(let r in i)for(let n of i[r])n(t,r,Object.getOwnPropertyDescriptor(t,r))};class k_ extends SS{constructor(t){super(),t&&this.init(t)}init(t){this.view=t,this.enabled=!0}set view(t){const e=!!this._view;e&&this.disconnectEvents(t),this._view=t,this.connectEvents(t),e||(this.enabled=!0)}get view(){return this._view}set enabled(t){if(!this.view){console.error("Button view is not set. Please set it before enabling the button.");return}this.view.eventMode=t?"static":"auto",this.view.cursor=t?"pointer":"default",!t&&this.isDown&&this.processUp()}get enabled(){return this.view.eventMode==="static"}}class bP extends BS(Wt,k_){constructor(t){super(),t&&this.init(t)}init(t){this.addChild(t),this.view=t,this.enabled=!0}}function Bi(s){return typeof s=="string"?So.from(s):s}class B_ extends Wt{constructor(t,e,i){super(),this._triggerEvents=new Set(["onPress"]),this.innerView=new Wt,this.addChild(this.innerView),this.onChange=new zt.Signal,t&&(this.views=t),e&&(this.triggerEvents=e),i&&this.views.length>0&&(this.active=i),this.setInteractionEvents()}setInteractionEvents(){this.innerView.eventMode="static",this.innerView.on("pointerdown",()=>this.handleEvents("onDown")),this.innerView.on("pointerup",()=>this.handleEvents("onUp")),this.innerView.on("pointerupoutside",()=>this.handleEvents("onUpOut")),this.innerView.on("pointerout",()=>this.handleEvents("onOut")),this.innerView.on("pointertap",()=>this.handleEvents("onPress")),this.innerView.on("pointerover",()=>this.handleEvents("onHover"))}handleEvents(t){this._triggerEvents.has(t)&&this.switch()}get activeView(){if(this.views&&this.views[this.active])return this.views[this.active]}set views(t){this.innerView.removeChildren(),t.forEach(e=>this.add(e))}get views(){return this.innerView.children}add(t){const e=Bi(t);this.innerView.addChild(e),e.visible=!1,this.views.length===1&&(this.active=0)}remove(t){this.views[t]&&this.innerView.removeChild(this.views[t])}set triggerEvents(t){this._triggerEvents=new Set(Array.isArray(t)?t:[t])}get triggerEvents(){return Array.from(this._triggerEvents)}switch(t){if(t!==void 0&&t===this.active)return;const e=this.active;if(this.forceSwitch(t),e!==this.active){const i=this.views.length>2?this.active:this.active===1;this.onChange.emit(i)}}forceSwitch(t){if(!(t!==void 0&&t===this.active)){if(this.activeView&&(this.activeView.visible=!1),t!==void 0&&!this.views[t])throw new Error(`View with id ${t} does not exist.`);this._active=t!==void 0?t:this.nextActive,this._active!==void 0&&(this.views[this.active].visible=!0)}}get nextActive(){if(this.views.length!==0)return this.active<this.views.length-1?this.active+1:0}set active(t){this.switch(t)}get active(){return this._active}}function LS(s){return s instanceof Hu?s:new Hu({text:String(s)})}function hd(s,t,e=0){let i=t.scale.x,r=t.scale.y;const n=s.width-e*2,o=s.height-e*2,a=n-Math.round(t.width),h=o-Math.round(t.height);a<0&&(i=n/(t.width*i)),h<0&&(r=o/(t.height*r)),(i<=0||r<=0)&&(t.visible=!1),t.scale.set(Math.min(i,r))}/*!
 * tweedle.js - v2.0.1
 * Compiled Tue, 20 Dec 2022 14:21:53 UTC
 *
 * tweedle.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 * 
 * Copyright 2019-2021, Milton Candelero <miltoncandelero@gmail.com>, All Rights Reserved
 */let Sr;typeof self>"u"&&typeof process<"u"&&process.hrtime?Sr=function(){const s=process.hrtime();return s[0]*1e3+s[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?Sr=self.performance.now.bind(self.performance):Date.now!==void 0?Sr=Date.now:Sr=function(){return new Date().getTime()};class Re{constructor(){Re.prototype.__init.call(this),Re.prototype.__init2.call(this),Re.prototype.__init3.call(this),Re.prototype.__init4.call(this)}__init(){this._tweens={}}static get shared(){return Re._shared||(Re._shared=new Re),Re._shared}__init2(){this._paused=!1}isPaused(){return this._paused}pause(){this._paused=!0}resume(){this._paused=!1}__init3(){this._lastUpdateTime=void 0}__init4(){this.now=Sr}getAll(){return Object.keys(this._tweens).map(t=>this._tweens[t])}removeAll(){this._tweens={}}add(t){this._tweens[t.getId()]=t}remove(t){delete this._tweens[t.getId()]}update(t,e=!1){if(t==null&&(this._lastUpdateTime==null?(this._lastUpdateTime=this.now(),t=0):t=this.now()-this._lastUpdateTime),this._lastUpdateTime=this.now(),this._paused)return!1;const i=Object.keys(this._tweens);if(i.length==0)return!1;for(let r=0;r<i.length;r++){const n=this._tweens[i[r]];n&&n.update(t,!0)==!1&&!e&&delete this._tweens[i[r]]}return!0}}const Qn={Step:{None(s){return s<.5?0:1}},Linear:{None(s){return s}},Quadratic:{In(s){return s*s},Out(s){return s*(2-s)},InOut(s){return(s*=2)<1?.5*s*s:-.5*(--s*(s-2)-1)}},Cubic:{In(s){return s*s*s},Out(s){return--s*s*s+1},InOut(s){return(s*=2)<1?.5*s*s*s:.5*((s-=2)*s*s+2)}},Quartic:{In(s){return s*s*s*s},Out(s){return 1- --s*s*s*s},InOut(s){return(s*=2)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2)}},Quintic:{In(s){return s*s*s*s*s},Out(s){return--s*s*s*s*s+1},InOut(s){return(s*=2)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2)}},Sinusoidal:{In(s){return 1-Math.cos(s*Math.PI/2)},Out(s){return Math.sin(s*Math.PI/2)},InOut(s){return .5*(1-Math.cos(Math.PI*s))}},Exponential:{In(s){return s==0?0:Math.pow(1024,s-1)},Out(s){return s==1?1:1-Math.pow(2,-10*s)},InOut(s){return s==0?0:s==1?1:(s*=2)<1?.5*Math.pow(1024,s-1):.5*(-Math.pow(2,-10*(s-1))+2)}},Circular:{In(s){return 1-Math.sqrt(1-s*s)},Out(s){return Math.sqrt(1- --s*s)},InOut(s){return(s*=2)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1)}},Elastic:{In(s){return s==0?0:s==1?1:-Math.pow(2,10*(s-1))*Math.sin((s-1.1)*5*Math.PI)},Out(s){return s==0?0:s==1?1:Math.pow(2,-10*s)*Math.sin((s-.1)*5*Math.PI)+1},InOut(s){return s==0?0:s==1?1:(s*=2,s<1?-.5*Math.pow(2,10*(s-1))*Math.sin((s-1.1)*5*Math.PI):.5*Math.pow(2,-10*(s-1))*Math.sin((s-1.1)*5*Math.PI)+1)}},Back:{In(s){return s*s*((1.70158+1)*s-1.70158)},Out(s){return--s*s*((1.70158+1)*s+1.70158)+1},InOut(s){const t=2.5949095;return(s*=2)<1?.5*(s*s*((t+1)*s-t)):.5*((s-=2)*s*((t+1)*s+t)+2)}},Bounce:{In(s){return 1-Qn.Bounce.Out(1-s)},Out(s){return s<1/2.75?7.5625*s*s:s<2/2.75?7.5625*(s-=1.5/2.75)*s+.75:s<2.5/2.75?7.5625*(s-=2.25/2.75)*s+.9375:7.5625*(s-=2.625/2.75)*s+.984375},InOut(s){return s<.5?Qn.Bounce.In(s*2)*.5:Qn.Bounce.Out(s*2-1)*.5+.5}}},G={Geom:{Linear(s,t){const e=s.length-1,i=e*t,r=Math.floor(i),n=G.Utils.Linear;return t<0?n(s[0],s[1],i):t>1?n(s[e],s[e-1],e-i):n(s[r],s[r+1>e?e:r+1],i-r)},Bezier(s,t){let e=0;const i=s.length-1,r=Math.pow,n=G.Utils.Bernstein;for(let o=0;o<=i;o++)e+=n(i,o)*r(1-t,i-o)*r(t,o)*s[o];return e},QuadraticBezier(s,t){let e=0;const i=s.length-1;if(t==1)return s[i];const r=Math.pow,n=G.Utils.Bernstein,o=i*t,a=Math.floor(o),h=(o-a)*.5+.5*(a%2),l=a-a%2,c=l+1,u=l+2;return e+=n(2,0)*r(1-h,2-0)*r(h,0)*s[l],e+=n(2,1)*r(1-h,2-1)*r(h,1)*s[c],e+=n(2,2)*r(1-h,2-2)*r(h,2)*s[u],e},CubicBezier(s,t){let e=0;const i=s.length-1;if(t==1)return s[i];const r=Math.pow,n=G.Utils.Bernstein,o=i*t,a=Math.floor(o),h=(o-a)*(1/3)+1/3*(a%3),l=a-a%3,c=l+1,u=l+2,d=l+3;return e+=n(3,0)*r(1-h,3-0)*r(h,0)*s[l],e+=n(3,1)*r(1-h,3-1)*r(h,1)*s[c],e+=n(3,2)*r(1-h,3-2)*r(h,2)*s[u],e+=n(3,3)*r(1-h,3-3)*r(h,3)*s[d],e},CatmullRom(s,t){const e=s.length-1;let i=e*t,r=Math.floor(i);const n=G.Utils.CatmullRom;return s[0]==s[e]?(t<0&&(r=Math.floor(i=e*(1+t))),n(s[(r-1+e)%e],s[r],s[(r+1)%e],s[(r+2)%e],i-r)):t<0?s[0]-(n(s[0],s[0],s[1],s[1],-i)-s[0]):t>1?s[e]-(n(s[e],s[e],s[e-1],s[e-1],i-e)-s[e]):n(s[r?r-1:0],s[r],s[e<r+1?e:r+1],s[e<r+2?e:r+2],i-r)}},Angle:{Radians(s,t){const e=s.length-1,i=e*t,r=Math.floor(i),n=G.Utils.WrapLinear;return t<0?n(s[0],s[1],i,2*Math.PI):t>1?n(s[e],s[e-1],e-i,2*Math.PI):n(s[r],s[r+1>e?e:r+1],i-r,2*Math.PI)},Degrees(s,t){const e=s.length-1,i=e*t,r=Math.floor(i),n=G.Utils.WrapLinear;return t<0?n(s[0],s[1],i,360):t>1?n(s[e],s[e-1],e-i,360):n(s[r],s[r+1>e?e:r+1],i-r,360)}},Color:{RGB(s,t){const e=s.length-1,i=e*t,r=Math.floor(i),n=G.Utils.RGBLinear;return t<0?n(s[0],s[1],i):t>1?n(s[e],s[e-1],e-i):n(s[r],s[r+1>e?e:r+1],i-r)},HSV(s,t){const e=s.length-1,i=e*t,r=Math.floor(i),n=G.Utils.HSVLinear;return t<0?n(s[0],s[1],i):t>1?n(s[e],s[e-1],e-i):n(s[r],s[r+1>e?e:r+1],i-r)},HCL(s,t){const e=s.length-1,i=e*t,r=Math.floor(i),n=G.Utils.HCLLinear;return t<0?n(s[0],s[1],i):t>1?n(s[e],s[e-1],e-i):n(s[r],s[r+1>e?e:r+1],i-r)}},Utils:{RGBsplit(s){const t=s>>24&255,e=s>>16&255,i=s>>8&255,r=s&255;return{a:t,r:e,g:i,b:r}},HSVsplit(s){const t=G.Utils.RGBsplit(s);t.r/=255,t.g/=255,t.b/=255;const e=Math.max(t.r,t.g,t.b),i=Math.min(t.r,t.g,t.b);let r;const n=e,o=e-i,a=e==0?0:o/e;if(e==i)r=0;else{switch(e){case t.r:r=(t.g-t.b)/o+(t.g<t.b?6:0);break;case t.g:r=(t.b-t.r)/o+2;break;case t.b:r=(t.r-t.g)/o+4;break}r/=6}return{a:t.a,h:r,s:a,v:n}},HSVJoin(s){let t,e,i;const r=Math.floor(s.h*6),n=s.h*6-r,o=s.v*(1-s.s),a=s.v*(1-n*s.s),h=s.v*(1-(1-n)*s.s);switch(r%6){case 0:t=s.v,e=h,i=o;break;case 1:t=a,e=s.v,i=o;break;case 2:t=o,e=s.v,i=h;break;case 3:t=o,e=a,i=s.v;break;case 4:t=h,e=o,i=s.v;break;case 5:t=s.v,e=o,i=a;break}return s.a<<24|t<<16|e<<8|i},HCLSplit(s){const i=.530454533953517,r=G.Utils.RGBsplit(s),n={a:r.a,h:0,c:0,l:0};let o=0;const a=Math.min(r.r,Math.min(r.g,r.b)),h=Math.max(r.r,Math.max(r.g,r.b));let l=3/100;return n.c=h-a,n.c!=0&&(o=Math.atan2(r.g-r.b,r.r-r.g)/Math.PI,l*=a/h),l=Math.exp(l),n.h=(o/2-Math.min(o%1,-o%1)/6)%1,n.c*=l,n.l=G.Utils.Linear(-a,h,l)/(i*2),n},HCLJoin(s){const i=.530454533953517,r={a:s.a,r:0,g:0,b:0};if(s.l!=0){let n=s.h;const o=s.c,a=s.l*i,h=Math.exp((1-o/(2*a))*(3/100)),l=(2*a-o)/(2*h-1),c=o/h,u=(n+Math.min(2*n%1/4,-2*n%1/8))*Math.PI*2;let d;n*=6,n<=.999?(d=Math.tan(u),r.r=1,r.g=d/(1+d)):n<=1.001?(r.r=1,r.g=1):n<=2?(d=Math.tan(u),r.r=(1+d)/d,r.g=1):n<=3?(d=Math.tan(u),r.g=1,r.b=1+d):n<=3.999?(d=Math.tan(u),r.g=1/(1+d),r.b=1):n<=4.001?(r.g=0,r.b=1):n<=5?(d=Math.tan(u),r.r=-1/d,r.b=1):(d=Math.tan(u),r.r=1,r.b=-d),r.r=r.r*c+l,r.g=r.g*c+l,r.b=r.b*c+l}return r.a<<24|r.r<<16|r.g<<8|r.b},WrapLinear(s,t,e,i){let r;return s=(s+i*Math.trunc(Math.abs(s/i)))%i,t=(t+i*Math.trunc(Math.abs(t/i)))%i,Math.abs(s-t)<=.5*i?r=G.Utils.Linear(s,t,e):(s<t?r=G.Utils.Linear(s+i,t,e):r=G.Utils.Linear(s,t+i,e),r=r%i),r},RGBLinear(s,t,e){const i=G.Utils.RGBsplit(s),r=G.Utils.RGBsplit(t),n=G.Utils.Linear(i.a,r.a,e),o=G.Utils.Linear(i.r,r.r,e),a=G.Utils.Linear(i.g,r.g,e),h=G.Utils.Linear(i.b,r.b,e);return n<<24|o<<16|a<<8|h},HSVLinear(s,t,e){const i=G.Utils.HSVsplit(s),r=G.Utils.HSVsplit(t);let n;Math.abs(i.h-r.h)<=.5?n=G.Utils.Linear(i.h,r.h,e):(i.h<r.h?n=G.Utils.Linear(i.h+1,r.h,e):n=G.Utils.Linear(i.h,r.h+1,e),n=n%1);const o=G.Utils.Linear(i.s,r.s,e),a=G.Utils.Linear(i.v,r.v,e),h=G.Utils.Linear(i.a,r.a,e);return G.Utils.HSVJoin({a:h,h:n,s:o,v:a})},HCLLinear(s,t,e){const i=G.Utils.HCLSplit(s),r=G.Utils.HCLSplit(t);let n;Math.abs(i.h-r.h)<=.5?n=G.Utils.Linear(i.h,r.h,e):(i.h<r.h?n=G.Utils.Linear(i.h+1,r.h,e):n=G.Utils.Linear(i.h,r.h+1,e),n=n%1);const o=G.Utils.Linear(i.c,r.c,e),a=G.Utils.Linear(i.l,r.l,e),h=G.Utils.Linear(i.a,r.a,e);return G.Utils.HSVJoin({a:h,h:n,s:o,v:a})},Linear(s,t,e){return(t-s)*e+s},Bernstein(s,t){const e=G.Utils.Factorial;return e(s)/e(t)/e(s-t)},Factorial:function(){const s=[1];return function(t){let e=1;if(s[t])return s[t];for(let i=t;i>1;i--)e*=i;return s[t]=e,e}}(),CatmullRom(s,t,e,i,r){const n=(e-s)*.5,o=(i-t)*.5,a=r*r,h=r*a;return(2*t-2*e+n+o)*h+(-3*t+3*e-2*n-o)*a+n*r+t}}};class Yo{static __initStatic(){this._nextId=0}static nextId(){return Yo._nextId++}}Yo.__initStatic();class ht{__init(){this._isPaused=!1}__init2(){this._valuesStart={}}__init3(){this._valuesEnd={}}__init4(){this._valuesStartRepeat={}}__init5(){this._duration=0}__init6(){this._repeatCount=0}__init7(){this._repeat=0}__init8(){this._yoyo=!1}__init9(){this._isPlaying=!1}get _reversed(){return this.yoyo&&this._repeatCount%2!==0}__init10(){this._delayTime=0}__init11(){this._startTime=0}__init12(){this._elapsedTime=0}__init13(){this._timescale=1}__init14(){this._safetyCheckFunction=t=>!0}__init15(){this._easingFunction=Qn.Linear.None}__init16(){this._yoyoEasingFunction=void 0}__init17(){this._interpolationFunction=G.Geom.Linear}__init18(){this._chainedTweens=[]}__init19(){this._onStartCallbackFired=!1}__init20(){this._onAfterDelayCallbackFired=!1}__init21(){this._id=Yo.nextId()}__init22(){this._isChainStopped=!1}get _group(){return this._groupRef?this._groupRef:Re.shared}set _group(t){this._groupRef=t}constructor(t,e){ht.prototype.__init.call(this),ht.prototype.__init2.call(this),ht.prototype.__init3.call(this),ht.prototype.__init4.call(this),ht.prototype.__init5.call(this),ht.prototype.__init6.call(this),ht.prototype.__init7.call(this),ht.prototype.__init8.call(this),ht.prototype.__init9.call(this),ht.prototype.__init10.call(this),ht.prototype.__init11.call(this),ht.prototype.__init12.call(this),ht.prototype.__init13.call(this),ht.prototype.__init14.call(this),ht.prototype.__init15.call(this),ht.prototype.__init16.call(this),ht.prototype.__init17.call(this),ht.prototype.__init18.call(this),ht.prototype.__init19.call(this),ht.prototype.__init20.call(this),ht.prototype.__init21.call(this),ht.prototype.__init22.call(this),this._object=t,this._group=e}getId(){return this._id}getGroup(){return this._group}getTimescale(){return this._timescale}isPlaying(){return this._isPlaying}isPaused(){return this._isPaused}from(t){try{JSON.stringify(t)}catch{throw new Error("The object you provided to the from() method has a circular reference!")}return this._setupProperties(t,this._valuesStart,t,this._valuesStartRepeat,!0),this}to(t,e){try{this._valuesEnd=JSON.parse(JSON.stringify(t))}catch{return console.warn("The object you provided to the to() method has a circular reference!. It can't be cloned. Falling back to dynamic targeting"),this.dynamicTo(t,e)}return e!==void 0&&(this._duration=e),this}dynamicTo(t,e){return this._valuesEnd=t,e!==void 0&&(this._duration=e),this}duration(t){return this._duration=t,this}start(t){return this._isPlaying?this:(t!=null&&(this._delayTime=t),this._group.add(this),this._reversed&&(this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat))),this._repeatCount=0,this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onAfterDelayCallbackFired=!1,this._isChainStopped=!1,this._startTime=-this._delayTime,this._elapsedTime=0,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,!1),this)}restart(t){return this.reset(),this.start(t)}reset(){return this._isPlaying&&this.stop(),this._valuesStart={},this._valuesStartRepeat={},this}rewind(){this._isPlaying&&this.stop(),this._reversed&&this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd);const t=this._easingFunction(0);return this._updateProperties(this._object,this._valuesStart,this._valuesEnd,t),this}_setupProperties(t,e,i,r,n){for(const o in i){const a=t[o],h=Array.isArray(a),l=!Number.isNaN(Number(a)),c=h?"array":typeof a,u=c=="object",d=typeof i[o]=="object",f=!h&&Array.isArray(i[o]);c=="undefined"||c=="function"||i[o]==null||!h&&!l&&!u||((u||h||d)&&a&&!f?(typeof e[o]>"u"&&(e[o]=h?[]:{}),typeof r[o]>"u"&&(r[o]=h?[]:{}),this._setupProperties(a,e[o],i[o],r[o],n)):((typeof e[o]>"u"||n)&&(e[o]=a),(typeof r[o]>"u"||n)&&(f?r[o]=i[o].slice().reverse()[0]:r[o]=e[o]||0)))}}stop(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object,this),this):this}end(t=!1){let e=[];if(t||(e=this._chainedTweens,this._chainedTweens=[]),this.resume(),this.update(1/0),!t){this._chainedTweens=e;for(let i=0,r=this._chainedTweens.length;i<r;i++)this._chainedTweens[i].start()}return this}skip(t,e=!1){return this.resume(),this.update(t*this._duration-(e?this._elapsedTime:0)),this}pause(){return this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._group.remove(this),this)}resume(){return!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._group.add(this),this)}stopChainedTweens(){for(let t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this}startChainedTweens(t=!1){t&&this.stop();for(let e=0,i=this._chainedTweens.length;e<i;e++)this._chainedTweens[e].start();return this}group(t){return this._group=t,this}delay(t){return this._delayTime=t,this}timescale(t){return this._timescale=t,this}repeat(t=1/0){return this._repeat=t,this}repeatDelay(t){return this._repeatDelayTime=t,this}yoyo(t=!0){return this._yoyo=t,this}easing(t){return this._easingFunction=t,this}safetyCheck(t){return this._safetyCheckFunction=t,this}yoyoEasing(t){return this._yoyoEasingFunction=t,this}interpolation(t){return this._interpolationFunction=t,this}chain(...t){return this._chainedTweens=t,this}onStart(t){return this._onStartCallback=t,this}onAfterDelay(t){return this._onAfterDelayCallback=t,this}onUpdate(t){return this._onUpdateCallback=t,this}onRepeat(t){return this._onRepeatCallback=t,this}onComplete(t){return this._onCompleteCallback=t,this}onStop(t){return this._onStopCallback=t,this}update(t,e=!1){const i=this._internalUpdate(t);return!i&&!e&&this._group.remove(this),i}_internalUpdate(t){if(!this._safetyCheckFunction(this._object)||this._isPaused)return!1;t*=this._timescale;let e;this._elapsedTime+=t;const i=this._duration,r=this._startTime+this._elapsedTime;if(r>i&&!this._isPlaying)return!1;this.isPlaying||this.start(),this._onStartCallbackFired==!1&&(this._onStartCallback&&this._onStartCallback(this._object,this),this._onStartCallbackFired=!0),this._onAfterDelayCallbackFired==!1&&r>=0&&(this._onAfterDelayCallback&&this._onAfterDelayCallback(this._object,this),this._onAfterDelayCallbackFired=!0),e=r/this._duration,this._duration==0&&(r>=0?e=1:e=0),e=Math.min(1,e),e=Math.max(0,e);let n=Number.isFinite(r)?r%this._duration:r;Number.isNaN(n)&&(n=0);const o=Math.floor(r/this._duration);let a;if(this._reversed&&this._yoyoEasingFunction?a=this._yoyoEasingFunction(e):a=this._easingFunction(e),this._updateProperties(this._object,this._valuesStart,this._valuesEnd,a),this._onUpdateCallback&&(e!=1||this._repeat-this._repeatCount<=0)&&this._onUpdateCallback(this._object,e,this),e==1){if(this._repeat-this._repeatCount>0){const h=this._repeatCount;if(this._repeatCount=Math.min(this._repeat+1,this._repeatCount+o),this._onUpdateCallback&&(this._repeat-this._repeatCount<0||n<=0)&&this._onUpdateCallback(this._object,e,this),this._yoyo?this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd):this._moveForwardStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat)),this._repeatDelayTime!==void 0?this._startTime=-this._repeatDelayTime:this._startTime=0,this._onRepeatCallback){let l=1;Number.isFinite(o)?l=this._repeatCount-h:Number.isFinite(this._repeat)&&(l=this._repeat-h);for(let c=0;c<l;c++)this._onRepeatCallback(this._object,h+1+c,this)}if(this._elapsedTime=0,this._repeat-this._repeatCount>=0)return n>0&&Number.isFinite(this._repeat)&&this._internalUpdate(n),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object,this);for(let h=0,l=this._chainedTweens.length;h<l;h++)this._chainedTweens[h].start(),n>0&&this._chainedTweens[h].update(n);return this._isPlaying=!1,!1}return!0}_updateProperties(t,e,i,r){for(const n in i){if(e[n]==null)continue;const o=e[n];let a=i[n];const h=Array.isArray(t[n]),l=Array.isArray(a);!h&&l?this._reversed?t[n]=this._interpolationFunction(a.concat([o]),r):t[n]=this._interpolationFunction([o].concat(a),r):typeof a=="object"&&a?this._updateProperties(t[n],o,a,r):(a=this._handleRelativeValue(o,a),typeof a=="number"&&(typeof o=="number"||typeof o=="string")&&(t[n]=Number(o)+(a-Number(o))*r,typeof o=="string"&&(t[n]=String(t[n]))))}}_handleRelativeValue(t,e){return typeof e!="string"?e:e.charAt(0)=="+"||e.charAt(0)=="-"?t+Number(e):Number(e)}_swapEndStartRepeatValues(t,e){for(const i in t){const r=!Array.isArray(t[i])&&Array.isArray(e[i]);if(typeof t[i]=="object")this._swapEndStartRepeatValues(t[i],e[i]);else{const n=t[i];if(typeof e[i]=="string")t[i]=Number(t[i])+Number(e[i]),e[i]=n;else if(r){const o=e[i].slice().reverse();t[i]=o[0],e[i]=o}else t[i]=e[i],e[i]=n}}}_moveForwardStartRepeatValues(t,e){for(const i in t)typeof e[i]=="object"?this._moveForwardStartRepeatValues(t[i],e[i]):typeof e[i]=="string"&&(t[i]=Number(t[i])+Number(e[i]))}}class dn extends Wt{constructor({defaultView:t,hoverView:e,pressedView:i,disabledView:r,text:n,padding:o,offset:a,textOffset:h,iconOffset:l,scale:c,anchor:u,anchorX:d,anchorY:f,icon:p,animations:m}){super(),this.defaultDuration=100,this._views={},this.innerView=new Wt,this.addChild(this.innerView),this.anchor=new Ce({onUpdate:()=>{this.updateAnchor()}}),this.anchor.set(d??u??0,f??u??0),this.padding=o??0,this.offset=a,this.textOffset=h,this.iconOffset=l,this.scale.set(c??1),m&&(this.animations=m,p_.shared.add(()=>Re.shared.update())),this.views={defaultView:t,hoverView:e,pressedView:i,disabledView:r,text:n,icon:p},this.setState("default"),this.addEvents()}set text(t){if(!t||t===0){this.innerView.removeChild(this._views.text),this._views.text=null;return}if(!this._views.text){this.createTextView(t);return}this._views.text.text=t.toString()}get text(){var t;return(t=this._views.text)==null?void 0:t.text}set enabled(t){this.events.enabled=t,this.setState(t?"default":"disabled")}get enabled(){return this.events.enabled}setState(t){if(this.state===t)return;const e=this.getStateView(this.state),i=this.getStateView(t);e&&(e.visible=!1),this.state=t,i&&(this.setOffset(i,t,this.offset),i.visible=!0),this.updateAnchor(),this.playAnimations(t)}createTextView(t){this._views.text||(this._views.text=LS(t),this._views.text.anchor.set(0),this.innerView.addChild(this._views.text)),this.adjustTextView(this.state)}setOffset(t,e,i){const r=i?i[e]:{x:0,y:0},n=i==null?void 0:i.default;r?(t.x+=r.x??0,t.y+=r.y??0):n?(t.x+=n.x??0,t.y+=n.y??0):(i.x||i.y)&&(t.x+=i.x??0,t.y+=i.y??0)}getStateView(t){const{default:e,hover:i,pressed:r,disabled:n}=this._views;switch(t){case"hover":return i??e;case"pressed":return r??i??e;case"disabled":return n??e;case"default":return e;default:return}}adjustTextView(t){if(!this.text)return;const e=this.getStateView(this.state);e&&(hd(e,this._views.text,this.padding),this._views.text.x=e.x+e.width/2,this._views.text.y=e.y+e.height/2),this._views.text.anchor.set(.5),this.setOffset(this._views.text,t,this.textOffset)}adjustIconView(t){var i;if(!this._views.icon)return;const e=this.getStateView(t);hd(e,this._views.icon,this.padding),(i=this._views.icon.anchor)==null||i.set(0),this._views.icon.x=e.x+e.width/2-this._views.icon.width/2,this._views.icon.y=e.y+e.height/2-this._views.icon.height/2,this.setOffset(this._views.icon,t,this.iconOffset)}updateAnchor(){const t=this.anchor.x??0,e=this.anchor.y??0;if([this._views.default,this._views.hover,this._views.pressed,this._views.disabled].forEach(r=>{var n;r&&((n=r.anchor)==null||n.set(0),r.x=-r.width*t,r.y=-r.height*e)}),this._views.default){const{x:r,y:n,width:o,height:a}=this._views.default;this.hitArea=new Kt(r,n,o,a)}this.adjustIconView(this.state),this.adjustTextView(this.state)}set views(t){console.log("_________________________",t);const{defaultView:e,hoverView:i,pressedView:r,disabledView:n,text:o,icon:a}=t;if(e){if(console.log("defaultView",e),this._views.default=Bi(e),console.log("this._views.default",this._views.default),this._views.default===void 0)throw new Error(`View ${e} not found`);this.setOffset(this._views.default,"default",this.offset),this._views.default.parent||this.innerView.addChild(this._views.default)}else e===null&&this._views.default&&(this.innerView.removeChild(this._views.default),this._views.default=null);i?(this._views.hover=Bi(i),this._views.hover.parent||this.innerView.addChild(this._views.hover),this._views.hover.visible=!1):i===null&&this._views.hover&&(this.innerView.removeChild(this._views.hover),this._views.hover=null),r?(this._views.pressed=Bi(r),this._views.pressed.parent||this.innerView.addChild(this._views.pressed),this._views.pressed.visible=!1):r===null&&this._views.pressed&&(this.innerView.removeChild(this._views.pressed),this._views.pressed=null),n?(this._views.disabled=Bi(n),this._views.disabled.parent||this.innerView.addChild(this._views.disabled),this._views.disabled.visible=!1):n===null&&this._views.disabled&&(this.innerView.removeChild(this._views.disabled),this._views.disabled=null),a?(this._views.icon=Bi(a),this._views.icon.parent||this.innerView.addChild(this._views.icon)):a===null&&this._views.icon&&(this.innerView.removeChild(this._views.icon),this._views.icon=null),o?this.createTextView(o):o===null&&this._views.text&&(this.innerView.removeChild(this._views.text),this._views.text=null)}addEvents(){this.events=new k_(this),this.onDown=new zt.Signal,this.onUp=new zt.Signal,this.onUpOut=new zt.Signal,this.onOut=new zt.Signal,this.onPress=new zt.Signal,this.onHover=new zt.Signal,this.events.onDown.connect((t,e)=>{this.onDown.emit(this,e),this.down(),this.setState("pressed")}),this.events.onUp.connect((t,e)=>{this.onUp.emit(this,e),this.up(),Jn.any?this.setState("default"):this.setState("hover")}),this.events.onUpOut.connect((t,e)=>{this.onUpOut.emit(this,e),this.upOut(),this.setState("default")}),this.events.onOut.connect((t,e)=>{this.onOut.emit(this,e),this.out(),this.events.isDown||this.setState("default")}),this.events.onPress.connect((t,e)=>{this.onPress.emit(this,e),this.press(),Jn.any?this.setState("default"):this.setState("hover")}),this.events.onHover.connect((t,e)=>{this.onHover.emit(this,e),this.hover(),this.events.isDown||(Jn.any?this.setState("default"):this.setState("hover"))})}playAnimations(t){var i;if(!this.animations)return;if(t==="default"&&!this.originalInnerViewState){this.originalInnerViewState={x:this.innerView.x,y:this.innerView.y,width:this.innerView.width,height:this.innerView.height,scale:{x:this.innerView.scale.x,y:this.innerView.scale.y}};const r=(i=this.animations)==null?void 0:i.default;if(r){this.innerView.x=r.props.x??this.originalInnerViewState.x,this.innerView.y=r.props.y??this.originalInnerViewState.y,this.innerView.width=r.props.width??this.originalInnerViewState.width,this.innerView.height=r.props.height??this.originalInnerViewState.height,this.innerView.scale.x=r.props.scale.x??this.originalInnerViewState.scale.x,this.innerView.scale.y=r.props.scale.y??this.originalInnerViewState.scale.y;return}}const e=this.animations[t]??this.animations.default;if(e){const r=e;this.defaultDuration=r.duration,new ht(this.innerView).to(r.props,r.duration).start();return}new ht(this.innerView).to(this.originalInnerViewState,this.defaultDuration).start()}down(t){}up(t){}upOut(t){}out(t){}press(t){}hover(t){}}const qo=s=>({default:{props:{scale:{x:s,y:s}},duration:100},hover:{props:{scale:{x:s*1.1,y:s*1.1}},duration:100},pressed:{props:{scale:{x:s*.9,y:s*.9}},duration:100}}),FS=.75;class L_ extends dn{constructor(t,e=FS){super({defaultView:"button-flat-small",icon:t,iconOffset:{y:-4},anchor:.5,animations:qo(e),scale:e})}press(){he.play("audio/secondary-button-press.wav",{speed:1.1})}}const OS=.6;class ll extends dn{constructor(t){const e=new Ct({text:(t==null?void 0:t.text)??"",style:{fill:4835583,fontFamily:"Bungee Regular",fontWeight:"bold",align:"center",fontSize:40,...t==null?void 0:t.textStyle}});super({defaultView:"play-btn-up",pressedView:"play-btn-down",text:e,textOffset:{default:{y:-30},pressed:{y:-15}},anchorX:.5,anchorY:1,scale:OS,...t.buttonOptions})}press(){he.play("audio/primary-button-press.wav")}}class Es{constructor(t){b(this,"view",new F);b(this,"_shadow");b(this,"_sprite");b(this,"_shine");b(this,"_type");b(this,"_shimmerTimeline");this._sprite=Et.from(t?`bubble-${t}`:z.WHITE),this._sprite.anchor.set(.5),this._sprite.width=M.bubbleSize,this._sprite.height=M.bubbleSize,this._shadow=Et.from("bubble-shadow"),this._shadow.anchor.set(.5),this._shadow.tint=16777215,this._shadow.visible=!!t,this._shadow.width=this._sprite.width*1.1,this._shadow.height=this._sprite.height*1.1,this._shadow.y=(this._shadow.height-this._sprite.height)*1.5,this._sprite.visible=!!t,this._shadow.visible=!!t,this._shine=Et.from("bubble-shine"),this._shine.anchor.set(.5),this._shine.alpha=0,this._shine.visible=!1,this._sprite.addChild(this._shine),this.view.addChild(this._shadow,this._sprite);const e=.1;this._shimmerTimeline=O.timeline({paused:!0}).set(this._shine,{rotation:0,alpha:0}).to(this._shine,{rotation:Math.PI,ease:"power3.out",duration:e}).to(this._shine,{alpha:1,yoyo:!0,repeat:1,onComplete:()=>{this._shine.visible=!1},duration:e*.6},"<"),t&&(this.type=t)}get type(){return this._type}set type(t){this._type=t,this._sprite.texture=z.from(`bubble-${this._type}`),this._sprite.width=M.bubbleSize,this._sprite.height=M.bubbleSize,this._shadow.tint=M.bubbleTypeToColor[t]??6316128,this._sprite.visible=!0,this._shadow.visible=t!=="glow"}shimmer(){return this._shine.rotation=0,this._shine.alpha=0,this._shine.visible=!0,this._shimmerTimeline.play(0)}}const ql=class{constructor(t){b(this,"view",new F);b(this,"_frame");b(this,"_background");b(this,"_mask");b(this,"_bubble");b(this,"_radius");b(this,"_isBubbleSet",!1);t={...ql.DEFAULT_OPTIONS,...t},this._frame=new Ki,this._frame.context.circle(0,0,t.size+t.frameWidth).fill(t.frameColor),this.view.addChild(this._frame),this._background=new hn({texture:z.from("background-tile-space"),width:64,height:64}),this._background.anchor.set(.5),this._background.width=this._background.height=t.size*2,this._frame.addChild(this._background),this._mask=new Ki(new ci().circle(0,0,t.size).fill(t.frameColor)),this._background.mask=this._mask,this.view.addChild(this._mask),this._bubble=new Es,this._background.addChild(this._bubble.view),this._radius=this._frame.width*.5}start(){this._setBubble()}stop(){this._setBubble(),O.killTweensOf(this._bubble.view)}_setBubble(){this._isBubbleSet=!0,this._bubble.view.scale.set(xt(.5,1,!1)),this._bubble.type=fs();const t=Math.random()*Math.PI*2,e=this._radius+this._bubble.view.width*.5;this._bubble.view.x=Math.cos(t)*e,this._bubble.view.y=Math.sin(t)*e,O.delayedCall(xt(3,6),this._moveBubble.bind(this))}_moveBubble(){if(!this._isBubbleSet)return;this._isBubbleSet=!1;const t=xt(-Math.PI*.33,Math.PI*.33,!1),e=Math.atan2(this._bubble.view.y,this._bubble.view.x)+t,i=this._radius+this._bubble.view.width*.5,r=-i*Math.cos(e),n=-i*Math.sin(e);O.to(this._bubble.view,{x:r,y:n,duration:xt(2,5),ease:"none",onComplete:this._setBubble.bind(this)})}};let qi=ql;b(qi,"DEFAULT_OPTIONS",{frameColor:7763574,frameWidth:10,size:60});const US={pixiLogoHeader:"Made with",gameTitle:"BUBBO",gameSubtitle:"SPACE MACHINE",titlePlay:"SHOOT BUBBLES!",forkGithub:`Fork me
on Github`,helperMobile:`Hold to aim
Release to shoot!`,helperDesktop:`Move mouse to aim
Left click to shoot!`,paused:"GAME PAUSED",score:"CURRENT SCORE",sound:"Sound",resume:"Resume",quit:"Quit",resultsPlay:"BUB AGAIN",resultsTitle:"YOUR SCORE!",resultsBreakdownTitle:"BUB BREAKDOWN",resultsBreakdownPopped:"Bubbles popped",resultsBreakdownPowerups:"Powerups used",resultsBreakdownCombo:"Best combo",resultsScoreTitle:"FINAL SCORE",resultsHighscoreTitle:"HIGHSCORE"};class NS{constructor(){b(this,"dict",US)}t(t,e){let i=this.dict[t];if(e){if(typeof e.variation=="number"){const r=/\[(.*?)\]/.exec(i);if(r){const o=r[1].split("|")[e.variation];i=i.replace(r[0],o)}}for(const r in e){const n=new RegExp(`{${r}}`,"g");i=i.replace(n,String(e[r]))}}return i}}const Tt=new NS;class zl{constructor(){b(this,"view",new F);b(this,"_bubbleView");b(this,"_defaultBubbleScale",2.5);b(this,"_parts",{});b(this,"_type");b(this,"_rotation",0);this._build(),this._bubbleView=new Es,this._bubbleView.view.scale.set(0),this.view.addChild(this._bubbleView.view)}get rotation(){return this._rotation}set rotation(t){this._rotation=t,this._parts["cannon-barrel"].rotation=this._parts["cannon-arrow"].rotation=t}set type(t){if(this._bubbleView.view.scale.set(0),this._type=t,t==="empty"){this._parts["cannon-arrow"].tint=this._parts["cannon-main"].tint=16777215;return}this._parts["cannon-arrow"].tint=this._parts["cannon-main"].tint=M.bubbleTypeToColor[t],this._bubbleView.type=t,O.to(this._bubbleView.view.scale,{x:this._defaultBubbleScale,y:this._defaultBubbleScale,duration:.4,ease:"back.out"})}get type(){return this._type}_build(){((...e)=>{e.forEach(i=>{const r=Et.from(i);r.anchor.set(.5),this._parts[i]=r,this.view.addChild(r)})})("cannon-barrel","cannon-main","cannon-arrow","cannon-top")}}const DS={muted:!1,highscore:0},rh="bubbo-bubbo",le={readyStorage(){localStorage.getItem(rh)||this.setStorage(DS)},getStorage(){const s=localStorage.getItem(rh);return s?JSON.parse(s):void 0},getStorageItem(s){return this.getStorage()[s]},setStorageItem(s,t){const e=this.getStorage();return e&&s in e&&(e[s]=t,this.setStorage(e)),e[s]},setStorage(s){return localStorage.setItem(rh,JSON.stringify(s,void 0,2))}},ld=.75;class $S extends dn{constructor(){const e=le.getStorageItem("muted"),i=new B_(["icon-sound-on","icon-sound-off"],[],e?1:0);super({defaultView:i,animations:qo(ld),anchor:.5,scale:ld});b(this,"_switcher");this._switcher=i}press(){const e=le.getStorageItem("muted");this.forceSwitch(!e),le.setStorageItem("muted",!e),Rr.muted(!e)}forceSwitch(e){this._switcher.forceSwitch(e?1:0)}}class F_{constructor(t){b(this,"view",new F);const e=Et.from("pixi-logo");if(e.anchor.set(.5),this.view.addChild(e),t){const i=new Ct({text:t,style:{fontSize:20,align:"center"}});i.anchor.set(.5),i.y=-(e.height*.5)-15,this.view.addChild(i)}}}class O_{constructor(){b(this,"view",new F);const t=Tt.t("gameTitle"),e=new Ct({text:t,style:{fontSize:90,fontWeight:"900",fontFamily:"Bungee Regular"}});e.anchor.set(.5),this.view.addChild(e);const i=new Es(fs());i.view.position.set(e.width*.5-33.5,7),i.view.scale.set(1.6),e.addChild(i.view);const r=new Ct({text:t,style:{fontSize:90,fontWeight:"900",fontFamily:"Bungee Regular"}});r.y=e.height-20,r.anchor.set(.5),this.view.addChild(r);const n=new Es(fs());n.view.position.set(r.width*.5-33.5,7),n.view.scale.set(1.6),r.addChild(n.view);const o=new Ct({text:Tt.t("gameSubtitle"),style:{fontSize:32,fontWeight:"900",fontFamily:"Bungee Regular"}});o.anchor.set(.5),o.y=r.y+r.height-30,this.view.addChild(o)}}const nh={};function U_(s,t,e){nh[s]||(e(),nh[s]=setTimeout(()=>delete nh[s],t))}class or extends F{constructor(){super();b(this,"_hitContainer",new F);b(this,"_hitArea");b(this,"_background");b(this,"_title");b(this,"_pixiLogo");b(this,"_cannon");b(this,"_footer");b(this,"_forkBtn");b(this,"_playBtn");b(this,"_audioBtn");b(this,"_portholeOne");b(this,"_portholeTwo");b(this,"_aimAngle");b(this,"_topAnimContainer",new F);b(this,"_midAnimContainer",new F);b(this,"_bottomAnimContainer",new F);this._background=new hn({texture:z.from("background-tile"),width:64,height:64}),this._background.tileScale.set(D.backgroundTileScale),this._background.interactive=!0,this.addChild(this._background),this._hitArea=new Ge,this._hitContainer.interactive=!0,this._hitContainer.hitArea=this._hitArea,this.addChild(this._hitContainer),this._buildDetails(),this._buildButtons(),this.addChild(this._topAnimContainer,this._midAnimContainer,this._bottomAnimContainer)}prepare(){this._portholeOne.stop(),this._portholeTwo.stop(),O.set(this._topAnimContainer,{y:-350}),O.set(this._midAnimContainer,{x:200}),O.set(this._bottomAnimContainer,{y:350})}async show(){this._hitContainer.on("pointermove",this._calculateAngle.bind(this)),this._hitContainer.on("pointertap",this._calculateAngle.bind(this)),O.killTweensOf(this),this.alpha=0,this._portholeOne.start(),this._portholeTwo.start(),this._audioBtn.forceSwitch(le.getStorageItem("muted")),await O.to(this,{alpha:1,duration:.2,ease:"linear"});const e={x:0,y:0,duration:.75,ease:"elastic.out(1, 0.5)"};O.to(this._topAnimContainer,e),O.to(this._midAnimContainer,e),O.to(this._bottomAnimContainer,e)}async hide(){this._hitContainer.removeAllListeners(),O.killTweensOf(this),await O.to(this,{alpha:0,duration:.2,ease:"linear"}),this._portholeOne.stop(),this._portholeTwo.stop()}resize(e,i){this._background.width=e,this._background.height=i,this._title.view.x=e*.5,this._title.view.y=145,this._pixiLogo.view.x=55,this._pixiLogo.view.y=i-40,this._footer.width=e*1.2,this._footer.x=e*.5,this._footer.y=i,this._forkBtn.x=e-this._pixiLogo.view.x,this._forkBtn.y=this._pixiLogo.view.y+this._forkBtn.height*.5-5,this._audioBtn.x=e-40,this._audioBtn.y=40,this._cannon.view.x=e*.5,this._cannon.view.y=i-this._footer.height*.5,this._playBtn.x=e*.5,this._playBtn.y=this._cannon.view.y-this._cannon.view.height/2-this._playBtn.height/2+10,this._portholeOne.view.x=40,this._portholeOne.view.y=40,this._portholeTwo.view.x=e-40,this._portholeTwo.view.y=this._title.view.y+this._title.view.height+10,this._hitArea.width=e,this._hitArea.height=i-M.bounceLine*.75}_calculateAngle(e){const i=this._cannon.view.getGlobalPosition(),r=Math.atan2(e.global.y-i.y,e.global.x-i.x);Math.abs(this._aimAngle-r)>Math.PI*2e-4&&U_("cannon-audio",150,()=>{he.play("audio/cannon-move.wav",{volume:.2})}),this._aimAngle=r,this._cannon.rotation=r+Math.PI*.5}_buildDetails(){this._title=new O_,this._topAnimContainer.addChild(this._title.view);const e=fs();this._footer=new Ki,this._footer.context.ellipse(0,0,300,125).fill(M.bubbleTypeToColor[e]),this._bottomAnimContainer.addChild(this._footer),this._cannon=new zl,this._cannon.view.scale.set(.75),this._cannon.type=e,this._bottomAnimContainer.addChild(this._cannon.view),this._pixiLogo=new F_,this._pixiLogo.view.scale.set(.35),this._bottomAnimContainer.addChild(this._pixiLogo.view),this._portholeOne=new qi,this._topAnimContainer.addChild(this._portholeOne.view),this._portholeTwo=new qi,this._midAnimContainer.addChild(this._portholeTwo.view)}_buildButtons(){this._forkBtn=new ll({text:Tt.t("forkGithub"),textStyle:{fill:15277667,fontFamily:"Opensans Semibold",fontWeight:"bold",align:"center",fontSize:16},buttonOptions:{defaultView:"pixi-btn-up",pressedView:"pixi-btn-down",textOffset:{default:{y:-13},pressed:{y:-8}}}}),this._forkBtn.onPress.connect(()=>{var e;(e=window.open(D.forkMeURL,"_blank"))==null||e.focus()}),this._bottomAnimContainer.addChild(this._forkBtn),this._audioBtn=new $S,this._topAnimContainer.addChild(this._audioBtn),this._playBtn=new ll({text:Tt.t("titlePlay")}),this._playBtn.onPress.connect(()=>{ne.goToScreen(on)}),this._bottomAnimContainer.addChild(this._playBtn)}}b(or,"SCREEN_ID","title"),b(or,"assetBundles",["images/title-screen"]);class oh{constructor(t,e){b(this,"view",new F);b(this,"_statNameText");b(this,"_statValueText");this._statNameText=new Ct({text:t,style:{fontSize:18,fontWeight:"100",fontFamily:"Opensans Semibold",fill:0,align:"left"}}),this._statNameText.anchor.set(0,.5),this._statNameText.x=-e*.5,this._statValueText=new Ct({text:"1000",style:{fontSize:18,fontWeight:"100",fontFamily:"Opensans Semibold",fill:0,align:"right"}}),this._statValueText.x=e*.5,this._statValueText.anchor.set(1,.5),this.view.addChild(this._statNameText,this._statValueText)}updateValue(t){if(t>99999999999){this._statValueText.text="9999999999+";return}this._statValueText.text=t}}class GS{constructor(){b(this,"view",new F);b(this,"_base");b(this,"_bubblesPoppedStat");b(this,"_powerupsUsedStat");b(this,"_comboStat");b(this,"_scoreText");b(this,"_highscoreText");b(this,"_maxScoreWidth",0);this._base=Et.from("panel-end-screen-base"),this._base.anchor.set(.5);const t=new Ct({text:Tt.t("resultsTitle"),style:{fontSize:30,fontWeight:"900",fontFamily:"Bungee Regular",fill:0,align:"center"}});t.anchor.set(.5),t.y=-(this._base.height*.5)+27,this._base.addChild(t),this._buildBreakdownPanel(),this._highscoreText=this._buildSubPanel({yOffset:-175,title:Tt.t("resultsHighscoreTitle"),alpha:.4}),this._scoreText=this._buildSubPanel({yOffset:200,title:Tt.t("resultsScoreTitle")}),this.view.addChild(this._base)}updateData(t){for(this._bubblesPoppedStat.updateValue(t.popped),this._comboStat.updateValue(t.combo),this._powerupsUsedStat.updateValue(t.powerups),this._scoreText.text=t.score,this._scoreText.style.fontSize=60;this._scoreText.width>this._maxScoreWidth;)this._scoreText.style.fontSize--;for(this._highscoreText.text=t.highscore,this._highscoreText.style.fontSize=60;this._highscoreText.width>this._maxScoreWidth;)this._highscoreText.style.fontSize--}_buildBreakdownPanel(){const t=Et.from("panel-end-screen-points-breakdown");t.anchor.set(.5),t.y=15;const e=new Ct({text:Tt.t("resultsBreakdownTitle"),style:{fontSize:16,fontWeight:"900",fontFamily:"Bungee Regular",fill:0,align:"center"}});t.alpha=.4,e.anchor.set(.5),e.y=-(t.height*.5)+e.height*.5+2;const i=new F;i.y=t.y;const r=10,n=30;this._bubblesPoppedStat=new oh(Tt.t("resultsBreakdownPopped"),t.width*.9),this._bubblesPoppedStat.view.y=r-n,this._comboStat=new oh(Tt.t("resultsBreakdownCombo"),t.width*.9),this._comboStat.view.y=r,this._powerupsUsedStat=new oh(Tt.t("resultsBreakdownPowerups"),t.width*.9),this._powerupsUsedStat.view.y=r+n,i.addChild(e,this._bubblesPoppedStat.view,this._powerupsUsedStat.view,this._comboStat.view),this._base.addChild(t,i)}_buildSubPanel(t){const e=Et.from("panel-end-screen-points-total");e.anchor.set(.5),t.alpha&&(e.alpha=t.alpha),e.y=t.yOffset,this._maxScoreWidth=e.width*.8;const i=new F;i.y=t.yOffset;const r=new Ct({text:t.title,style:{fontSize:22,fontWeight:"900",fontFamily:"Bungee Regular",fill:0,align:"center"}});r.anchor.set(.5),r.y=-(e.height*.5)+r.height*.5+3;const n=new Ct({text:"",style:{fontSize:50,fontWeight:"900",fontFamily:"Bungee Regular",fill:0,align:"center"}});return n.anchor.set(.5),n.y=10,i.addChild(r,n),this._base.addChild(e,i),n}}class cl extends F{constructor(){super();b(this,"_background");b(this,"_porthole");b(this,"_resultsPanel");b(this,"_footer");b(this,"_playBtn");b(this,"_backBtn");this._background=new hn({texture:z.from("background-tile"),width:64,height:64}),this._background.tileScale.set(D.backgroundTileScale),this.addChild(this._background),this._buildDetails(),this._buildButtons(),this._resultsPanel=new GS,this._resultsPanel.view.scale.set(.95),this.addChild(this._resultsPanel.view)}prepare(e){this._resultsPanel.updateData(e)}async show(){O.killTweensOf(this),this.alpha=0,this._porthole.start(),await O.to(this,{alpha:1,duration:.2,ease:"linear"})}async hide(){O.killTweensOf(this),await O.to(this,{alpha:0,duration:.2,ease:"linear"}),this._porthole.stop()}resize(e,i){this._background.width=e,this._background.height=i,this._footer.width=e*1.2,this._footer.x=e*.5,this._footer.y=i+25,this._porthole.view.x=40,this._porthole.view.y=80,this._playBtn.x=e*.5,this._playBtn.y=i-this._playBtn.height+5,this._backBtn.x=50,this._backBtn.y=i-50,this._resultsPanel.view.x=e*.5,this._resultsPanel.view.y=i*.5-85}_buildDetails(){this._porthole=new qi,this.addChild(this._porthole.view),this._footer=new Ki,this._footer.context.ellipse(0,0,300,125).fill(M.bubbleTypeToColor[fs()]),this.addChild(this._footer)}_buildButtons(){this._playBtn=new ll({text:Tt.t("resultsPlay")}),this._playBtn.onPress.connect(()=>{ne.goToScreen(on)}),this._backBtn=new L_("icon-back",1),this._backBtn.onPress.connect(()=>{ne.goToScreen(or)}),this.addChild(this._playBtn,this._backBtn)}}b(cl,"SCREEN_ID","result"),b(cl,"assetBundles",["images/results-screen"]);const cd={score:0,highscore:0,bubblesPopped:0,bestCombo:0,powerupsUsed:0};class VS{constructor(){b(this,"_stats",{...cd});this.set("highscore",le.getStorageItem("highscore"))}set(t,e){return this._stats[t]=e,this.get(t)}get(t){return t?this._stats[t]:this._stats}increment(t,e=1){return typeof this._stats[t]=="number"?this._stats[t]+=e:console.warn(`Cannot increment non-number stat: ${t}`),this.get(t)}reset(){this._stats={...cd}}}class WS{constructor(t){b(this,"_game");b(this,"allSystems",new Map);b(this,"_width");b(this,"_height");this._game=t}add(t){var r;const e=t.SYSTEM_ID;if(!e)throw new Error("[SystemManager]: cannot add System without name");if(this.allSystems.has(e))return this.allSystems.get(e);const i=new t;return i.game=this._game,this._width&&this._height&&((r=i.resize)==null||r.call(i,this._width,this._height)),this.allSystems.set(t.SYSTEM_ID,i),i}get(t){return this.allSystems.get(t.SYSTEM_ID)}init(){this.allSystems.forEach(t=>{var e;return(e=t.init)==null?void 0:e.call(t)})}awake(){this.allSystems.forEach(t=>{var e;return(e=t.awake)==null?void 0:e.call(t)})}start(){this.allSystems.forEach(t=>{var e;return(e=t.start)==null?void 0:e.call(t)})}update(t){this.allSystems.forEach(e=>{var i;return(i=e.update)==null?void 0:i.call(e,t)})}end(){this.allSystems.forEach(t=>{var e;return(e=t.end)==null?void 0:e.call(t)})}reset(){this.allSystems.forEach(t=>{var e;return(e=t.reset)==null?void 0:e.call(t)})}resize(t,e){this.allSystems.forEach(i=>{var r;return(r=i.resize)==null?void 0:r.call(i,t,e)})}}class zS{constructor(t){b(this,"Ctor");b(this,"list",[]);this.Ctor=t}get(){return this.list.pop()??new this.Ctor}return(t){this.list.includes(t)||this.list.push(t)}}class HS{constructor(){b(this,"map",new Map)}get(t){let e=this.map.get(t);return e||(e=new zS(t),this.map.set(t,e)),e.get()}return(t){const e=this.map.get(t.constructor);e&&e.return(t)}}const Ut=new HS;var oi={},Bs={};Object.defineProperty(Bs,"__esModule",{value:!0});Bs.Collector=void 0;class XS{constructor(t){this.emit=(...e)=>{t.emitCollecting(this,e)}}}Bs.Collector=XS;var Ko={};Object.defineProperty(Ko,"__esModule",{value:!0});Ko.CollectorArray=void 0;const jS=Bs;class YS extends jS.Collector{constructor(){super(...arguments),this.result=[]}handleResult(t){return this.result.push(t),!0}getResult(){return this.result}reset(){this.result.length=0}}Ko.CollectorArray=YS;var Zo={};Object.defineProperty(Zo,"__esModule",{value:!0});Zo.CollectorLast=void 0;const qS=Bs;class KS extends qS.Collector{handleResult(t){return this.result=t,!0}getResult(){return this.result}reset(){delete this.result}}Zo.CollectorLast=KS;var Jo={};Object.defineProperty(Jo,"__esModule",{value:!0});Jo.CollectorUntil0=void 0;const ZS=Bs;class JS extends ZS.Collector{constructor(){super(...arguments),this.result=!1}handleResult(t){return this.result=t,this.result}getResult(){return this.result}reset(){this.result=!1}}Jo.CollectorUntil0=JS;var Qo={};Object.defineProperty(Qo,"__esModule",{value:!0});Qo.CollectorWhile0=void 0;const QS=Bs;class tA extends QS.Collector{constructor(){super(...arguments),this.result=!1}handleResult(t){return this.result=t,!this.result}getResult(){return this.result}reset(){this.result=!1}}Qo.CollectorWhile0=tA;var ta={},ea={};Object.defineProperty(ea,"__esModule",{value:!0});ea.SignalConnectionImpl=void 0;class eA{constructor(t,e){this.link=t,this.parentCleanup=e}disconnect(){return this.link!==null?(this.link.unlink(),this.link=null,this.parentCleanup(),this.parentCleanup=null,!0):!1}set enabled(t){this.link&&this.link.setEnabled(t)}get enabled(){return this.link!==null&&this.link.isEnabled()}}ea.SignalConnectionImpl=eA;var sa={};Object.defineProperty(sa,"__esModule",{value:!0});sa.SignalLink=void 0;class Hl{constructor(t=null,e=null,i=0){this.enabled=!0,this.newLink=!1,this.callback=null,this.prev=t??this,this.next=e??this,this.order=i}isEnabled(){return this.enabled&&!this.newLink}setEnabled(t){this.enabled=t}unlink(){this.callback=null,this.next.prev=this.prev,this.prev.next=this.next}insert(t,e){let i=this.prev;for(;i!==this&&!(i.order<=e);)i=i.prev;const r=new Hl(i,i.next,e);return r.callback=t,i.next=r,r.next.prev=r,r}}sa.SignalLink=Hl;Object.defineProperty(ta,"__esModule",{value:!0});ta.Signal=void 0;const sA=ea,iA=sa;class rA{constructor(){this.head=new iA.SignalLink,this.hasNewLinks=!1,this.emitDepth=0,this.connectionsCount=0}getConnectionsCount(){return this.connectionsCount}hasConnections(){return this.connectionsCount>0}connect(t,e=0){this.connectionsCount++;const i=this.head.insert(t,e);return this.emitDepth>0&&(this.hasNewLinks=!0,i.newLink=!0),new sA.SignalConnectionImpl(i,()=>this.decrementConnectionCount())}decrementConnectionCount(){this.connectionsCount--}disconnect(t){for(let e=this.head.next;e!==this.head;e=e.next)if(e.callback===t)return this.decrementConnectionCount(),e.unlink(),!0;return!1}disconnectAll(){for(;this.head.next!==this.head;)this.head.next.unlink();this.connectionsCount=0}emit(...t){this.emitDepth++;for(let e=this.head.next;e!==this.head;e=e.next)e.isEnabled()&&e.callback&&e.callback.apply(null,t);this.emitDepth--,this.unsetNewLink()}emitCollecting(t,e){this.emitDepth++;for(let i=this.head.next;i!==this.head;i=i.next)if(i.isEnabled()&&i.callback){const r=i.callback.apply(null,e);if(!t.handleResult(r))break}this.emitDepth--,this.unsetNewLink()}unsetNewLink(){if(this.hasNewLinks&&this.emitDepth===0){for(let t=this.head.next;t!==this.head;t=t.next)t.newLink=!1;this.hasNewLinks=!1}}}ta.Signal=rA;var ia={};Object.defineProperty(ia,"__esModule",{value:!0});ia.SignalConnections=void 0;class nA{constructor(){this.list=[]}add(t){this.list.push(t)}disconnectAll(){for(const t of this.list)t.disconnect();this.list=[]}getCount(){return this.list.length}isEmpty(){return this.list.length===0}}ia.SignalConnections=nA;(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.SignalConnections=s.Signal=s.CollectorWhile0=s.CollectorUntil0=s.CollectorLast=s.CollectorArray=s.Collector=void 0;var t=Bs;Object.defineProperty(s,"Collector",{enumerable:!0,get:function(){return t.Collector}});var e=Ko;Object.defineProperty(s,"CollectorArray",{enumerable:!0,get:function(){return e.CollectorArray}});var i=Zo;Object.defineProperty(s,"CollectorLast",{enumerable:!0,get:function(){return i.CollectorLast}});var r=Jo;Object.defineProperty(s,"CollectorUntil0",{enumerable:!0,get:function(){return r.CollectorUntil0}});var n=Qo;Object.defineProperty(s,"CollectorWhile0",{enumerable:!0,get:function(){return n.CollectorWhile0}});var o=ta;Object.defineProperty(s,"Signal",{enumerable:!0,get:function(){return o.Signal}});var a=ia;Object.defineProperty(s,"SignalConnections",{enumerable:!0,get:function(){return a.SignalConnections}})})(oi);class oA{constructor(){b(this,"view",new F);b(this,"_bubbleView");b(this,"_defaultBubbleScale",2);b(this,"_type");b(this,"_base");this._base=Et.from("bubble-reserve-base"),this._base.anchor.set(.5),this._base.scale.set(.9),this.view.addChild(this._base);const t=Et.from("bubble-reserve-ring");t.anchor.set(.5),t.scale.set(.85),t.y-=2,this._base.addChild(t),this._bubbleView=new Es,this._bubbleView.view.scale.set(0),t.addChild(this._bubbleView.view)}get type(){return this._type}set type(t){if(this._bubbleView.view.scale.set(0),this._type=t,t==="empty"){this._base.tint=16777215;return}this._bubbleView.type=t,this._base.tint=M.bubbleTypeToColor[t],O.to(this._bubbleView.view.scale,{x:this._defaultBubbleScale,y:this._defaultBubbleScale,duration:.4,ease:"back.out"})}}class ai{constructor(t,e){b(this,"x");b(this,"y");this.x=t||0,this.y=e||0}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}clone(){return new ai(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return ud.set(t,t),dd.set(e,e),this.clamp(ud,dd)}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){let t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,i=this.y-t.y;return e*e+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e){return e===void 0&&(e=0),this.x=t[e],this.y=t[e+1],this}toArray(t,e){return t===void 0&&(t=[]),e===void 0&&(e=0),t[e]=this.x,t[e+1]=this.y,t}rotateAround(t,e){const i=Math.cos(e),r=Math.sin(e),n=this.x-t.x,o=this.y-t.y;return this.x=n*i-o*r+t.x,this.y=n*r+o*i+t.y,this}}const ud=new ai,dd=new ai;var hi=(s=>(s[s.STATIC=0]="STATIC",s[s.DYNAMIC=1]="DYNAMIC",s[s.KINEMATIC=2]="KINEMATIC",s))(hi||{});class Xl{constructor(){b(this,"UID",0);b(this,"radius",M.bubbleSize/2);b(this,"mass",20);b(this,"position",new ai);b(this,"velocity",new ai);b(this,"damping",.6);b(this,"bounces",0);b(this,"maxBounces",1);b(this,"_force",new ai);b(this,"_state",0)}applyForce(t,e){this.state!==0&&(this._force.set(t,e),this.velocity.add(this._force.divideScalar(this.mass)))}zeroVelocity(){this._force.setScalar(0),this.velocity.setScalar(0)}reset(){this._force.set(0,0),this.position.set(0,0),this.velocity.set(0,0),this.state=0,this.bounces=0}get state(){return this._state}set state(t){t===0&&this.zeroVelocity(),this._state=t}get x(){return this.position.x}set x(t){this.position.x=t}get y(){return this.position.y}set y(t){this.position.y=t}}b(Xl,"GRAVITY",9.8*(1/60));const N_={isMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Windows Phone|Opera Mini/i.test(navigator.userAgent)}};class aA{constructor(){b(this,"view",new F);const t=Et.from("panel-small-instructions");t.anchor.set(.5),t.scale.set(.75);const e=Tt.t(N_.isMobileDevice()?"helperMobile":"helperDesktop"),i=new Ct({text:e,style:{fontSize:19,fontWeight:"900",fontFamily:"Opensans Semibold",fill:0,align:"center"}});i.anchor.set(.5),i.x=-75,t.addChild(i),this.view.addChild(t)}prepare(){this.view.x=this._offScreenPos}show(){return O.to(this.view,{x:0,duration:1,delay:.5,ease:"back.out(1)"})}hide(){return O.to(this.view,{x:this._offScreenPos})}get _offScreenPos(){return-(D.content.width*.5)-this.view.width*.5}}class hA{constructor(){b(this,"view",new F);b(this,"_line");b(this,"_glow");b(this,"_targetAlpha",1);b(this,"_alphaDirection",1);b(this,"_alphaSpeed",.2);b(this,"_minAlpha",.2);b(this,"_maxAlpha",.5);b(this,"_pulseAlpha",1);b(this,"_isPulsing",!1);this._line=new Li(z.from("laser-line")),this._line.height-=12,this._line.pivot.y=this._line.height*.5-6,this._line.width=D.content.width,this._glow=Et.from("laser-line-glow"),this._glow.anchor.set(.5),this._glow.x=this._line.width*.5,this.view.addChild(this._glow,this._line),this._glow.alpha=.25}update(t){this._isPulsing||(this._targetAlpha+=t/60*(this._alphaDirection*this._alphaSpeed),this._targetAlpha<=this._minAlpha?(this._targetAlpha=this._minAlpha,this._alphaDirection=1):this._targetAlpha>=this._maxAlpha&&(this._targetAlpha=this._maxAlpha,this._alphaDirection=-1),this._glow.alpha=this._targetAlpha)}pulse(){this._isPulsing=!0,this._glow.alpha=this._pulseAlpha,O.killTweensOf(this._glow),O.to(this._glow,{alpha:this._targetAlpha,delay:.2,onComplete:()=>{this._isPulsing=!1}})}}class fd{constructor(){b(this,"view",new F);b(this,"_pointText");b(this,"_tint");this._tint=16777215,this._pointText=new Ct({text:"",style:{fontSize:40,fontWeight:"900",fontFamily:"Bungee Regular",fill:this._tint,stroke:{color:0,width:3},align:"center"}}),this._pointText.anchor.set(.5),this.view.addChild(this._pointText)}popScore(t,e){this.view.alpha=0,this._pointText.text=t;const i=D.content.width*.5-this._pointText.width*.5;return this.view.x=Math.min(Math.max(this.view.x,-i),i),O.to(this.view,{y:this.view.y-xt(15,120),alpha:1,duration:.25,onComplete:()=>{O.to(this.view,{alpha:0,onComplete:()=>e==null?void 0:e(this)})}})}get tint(){return this._tint}set tint(t){this._tint=t,this._pointText.style.fill=t??16777215}}class lA{constructor(){b(this,"view",new F);b(this,"_base");b(this,"_scoreText");this._base=Et.from("info-bg"),this._base.anchor.y=.5,this._base.scale.set(.75),this.view.addChild(this._base),this._scoreText=new Ct({text:"",style:{fontSize:40,fontWeight:"900",fontFamily:"Bungee Regular",fill:0,stroke:{color:16777215,width:5},align:"left"}}),this._scoreText.x=20,this._scoreText.anchor.y=.5,this._base.addChild(this._scoreText),this.setScore(0)}async setScore(t){for(this._scoreText.text=t.toLocaleString(),this._scoreText.style.fontSize=30;this._scoreText.width>this._base.width;)this._scoreText.style.fontSize--}}function pd(s){const t=window.location.search;return new URLSearchParams(t).get(s)}function jl(s,t){return~s.indexOf(t)&&s.splice(s.indexOf(t),1),s}function cA(s,t){for(let e=s.length-1;e>=0;--e){const i=s[e];t==null||t(i),jl(s,i)}return s}const _d=.75;class uA extends dn{constructor(){const e=le.getStorageItem("muted"),i=new B_(["icon-sound-on","icon-sound-off"],[],e?1:0);i.scale.set(.95);const r=new Ct({text:Tt.t("sound"),style:{fill:"black",fontFamily:"Bungee Regular",fontWeight:"bold",align:"center",fontSize:40}});super({defaultView:"button-flat",icon:i,iconOffset:{x:90},anchor:.5,text:r,textOffset:{default:{x:-30}},animations:qo(_d),scale:_d});b(this,"_switcher");this.children[0].tint=options.tint,this._switcher=i}press(){const e=le.setStorageItem("muted",!le.getStorageItem("muted"));this.forceSwitch(e),Rr.muted(e),e||he.play("audio/secondary-button-press.wav")}forceSwitch(e){this._switcher.forceSwitch(e?1:0)}}const md=.75;class gd extends dn{constructor(t){const e=new Ct({text:(t==null?void 0:t.text)??"",style:{fill:0,fontFamily:"Bungee Regular",fontWeight:"bold",align:"center",fontSize:40,...t==null?void 0:t.textStyle}});super({defaultView:"button-flat",anchor:.5,text:e,animations:qo(md),scale:md,...t==null?void 0:t.buttonOptions}),t!=null&&t.tint&&(this.children[0].tint=t.tint)}press(){he.play("audio/secondary-button-press.wav")}}class dA{constructor(){b(this,"view",new F);b(this,"_base");b(this,"_titleText");b(this,"_scoreTitleText");b(this,"_scoreText");this._base=Et.from("images/pause-overlay/pause-panel.png"),this._base.anchor.set(.5),this.view.addChild(this._base),this._titleText=new Ct({text:Tt.t("paused"),style:{fontSize:30,fontWeight:"900",fontFamily:"Bungee Regular",fill:16777215,align:"center"}}),this._titleText.anchor.set(.5),this._titleText.y=-(this._base.height*.5)+50,this._base.addChild(this._titleText),this._scoreTitleText=new Ct({text:Tt.t("score"),style:{fontSize:20,fontWeight:"900",fontFamily:"Bungee Regular",fill:0,align:"center"}}),this._scoreTitleText.anchor.set(.5),this._scoreTitleText.y=-82,this._base.addChild(this._scoreTitleText),this._scoreText=new Ct({text:"",style:{fontSize:60,fontWeight:"900",fontFamily:"Bungee Regular",fill:0,align:"center"}}),this._scoreText.anchor.set(.5),this._scoreText.y=-37,this._base.addChild(this._scoreText)}setScore(t){for(this._scoreText.text=t.toLocaleString(),this._scoreText.style.fontSize=60;this._scoreText.width>this._base.width;)this._scoreText.style.fontSize--}}class ul extends F{constructor(){super();b(this,"_background");b(this,"_panel");b(this,"_audioBtn");b(this,"_resumeBtn");b(this,"_quitBtn");b(this,"_callBack");this._background=new Ki,this._background.context.rect(0,0,50,50).fill({color:0,alpha:.5}),this._background.interactive=!0,this.addChild(this._background),this._panel=new dA,this.addChild(this._panel.view),this._buildButtons()}prepare(e){this._panel.setScore((e==null?void 0:e.score)??0),this._callBack=e.callback,this._audioBtn.forceSwitch(le.getStorageItem("muted"))}async show(){O.killTweensOf(this),this.alpha=0,await O.to(this,{alpha:1,duration:.2,ease:"linear"})}async hide(){O.killTweensOf(this),await O.to(this,{alpha:0,duration:.2,ease:"linear"})}resize(e,i){this._background.width=e,this._background.height=i,this._panel.view.x=e*.5,this._panel.view.y=i*.5}_buildButtons(){this._audioBtn=new uA,this._panel.view.addChild(this._audioBtn),this._audioBtn.y=50,this._resumeBtn=new gd({text:Tt.t("resume"),tint:16761900}),this._resumeBtn.onPress.connect(()=>{var e;(e=this._callBack)==null||e.call(this,"resume")}),this._resumeBtn.y=this._audioBtn.y+60,this._panel.view.addChild(this._resumeBtn),this._quitBtn=new gd({text:Tt.t("quit"),tint:4835583}),this._quitBtn.onPress.connect(()=>{var e;(e=this._callBack)==null||e.call(this,"quit")}),this._panel.view.addChild(this._quitBtn),this._quitBtn.y=this._resumeBtn.y+60}}b(ul,"SCREEN_ID","pause"),b(ul,"assetBundles",["images/pause-overlay"]);class ye{constructor(){b(this,"game");b(this,"isPaused",!1);b(this,"_tweenList",[]);b(this,"_visibilityPauseBound")}start(){this._visibilityPauseBound=this._visibilityPause.bind(this),document.addEventListener("visibilitychange",this._visibilityPauseBound)}update(){this.isPaused&&this._tweenList.forEach(t=>{t.totalProgress()>=1&&this.removeTween(t)})}end(){document.removeEventListener("visibilitychange",this._visibilityPauseBound)}reset(){this.isPaused=!1,this._tweenList.forEach(t=>{t.kill()}),this._tweenList.length=0}addTween(t){return this._tweenList.push(t),t}removeTween(t){return jl(this._tweenList,t),t}pause(){this.isPaused=!0,ne.showOverlay(ul,{score:this.game.stats.get("score"),callback:this._pauseCallback.bind(this)}),this._tweenList.forEach(t=>{t.pause()})}resume(){this.isPaused=!1,this._tweenList.forEach(t=>{t.resume()})}_visibilityPause(){document.visibilityState!=="visible"&&(this.isPaused||this.pause())}async _pauseCallback(t){await ne.hideOverlay(),t==="resume"?this.resume():ne.goToScreen(or)}}b(ye,"SYSTEM_ID","pause");class _i{constructor(){b(this,"game");b(this,"view",new F);b(this,"cannonContainer",new F);b(this,"_decorContainer",new F);b(this,"_gameHudContainer",new F);b(this,"_laserLine");b(this,"_topTray");b(this,"_roundedTray");b(this,"_hiddenTitle");b(this,"_bottomTray");b(this,"_leftBorder");b(this,"_rightBorder");b(this,"_pauseButton");b(this,"_scoreCounter");b(this,"_helperPanel");b(this,"_mask");b(this,"_hasShownHelper",!1);b(this,"_toasterList",[]);b(this,"_height");b(this,"_topTrayOffsetRatio",0)}init(){this.view.addChild(this._gameHudContainer,this._decorContainer),this.game.stage.addChild(this.view),this._laserLine=new hA,this._laserLine.view.y=-M.bounceLine,this._laserLine.view.x=-D.content.width*.5,this._topTray=new Li(z.from("top-tray")),this._topTray.x=-D.content.width*.5,this._topTray.width=D.content.width,this._topTray.interactive=!0,this._roundedTray=Et.from("rounded-tray"),this._roundedTray.anchor.set(.5),this._hiddenTitle=new O_,this._hiddenTitle.view.scale.set(.85),this._hiddenTitle.view.y-=55,this._roundedTray.addChild(this._hiddenTitle.view),this._bottomTray=new Li(z.from("bottom-tray")),this._bottomTray.height=M.bounceLine-30,this._bottomTray.pivot.y=this._bottomTray.height,this._bottomTray.x-=D.content.width*.5,this._bottomTray.width=D.content.width,this._scoreCounter=new lA,this._leftBorder=new Li(z.from("game-side-border")),this._leftBorder.x=-(D.content.width*.5)-this._leftBorder.width,this._rightBorder=new Li(z.from("game-side-border")),this._rightBorder.x=D.content.width*.5;const t=this.game.systems.get(ye);this._pauseButton=new L_("icon-pause"),this._pauseButton.onPress.connect(()=>{t.pause()}),this._pauseButton.x=D.content.width*.5-40,this._pauseButton.y=-D.content.height+37,this._mask=new Ki,this._mask.context.rect(-D.content.width*.5,-D.content.height,D.content.width,D.content.height).fill(197408),this._helperPanel=new aA,this._helperPanel.view.y=-D.content.height+200,this._decorContainer.addChild(this._mask,this._leftBorder,this._rightBorder,this._topTray,this._roundedTray),this._gameHudContainer.addChild(this._bottomTray,this._scoreCounter.view,this._laserLine.view,this._helperPanel.view,this.cannonContainer,this._pauseButton),this._gameHudContainer.mask=this._mask,this.game.systems.get(ar).signals.onCannonFire.connect(e=>{e&&this.game.systems.get(ye).addTween(this._helperPanel.hide())})}awake(){this._helperPanel.prepare(),this._topTrayOffsetRatio=0,this._updateTopTrayHeight(),this._gameHudContainer.visible=!0}start(){this._hasShownHelper||(this.game.systems.get(ye).addTween(this._helperPanel.show()),this._hasShownHelper=!0)}closeHud(){return this.game.systems.get(ye).addTween(O.to(this,{_topTrayOffsetRatio:1,duration:2,ease:"bounce.out",onUpdate:()=>{this._updateTopTrayHeight()},onComplete:()=>{this._gameHudContainer.visible=!1}}))}updateScore(t,e,i){const r=Ut.get(fd);r.view.x=i.x,r.view.y=this._laserLine.view.y,r.tint=M.bubbleTypeToColor[i.type],this._toasterList.push(r),this.game.systems.get(ye).addTween(r.popScore(t,this._killToaster.bind(this))),this.view.addChild(r.view),this._scoreCounter.setScore(e)}lineImpact(){this._laserLine.pulse()}update(t){this._laserLine.update(t)}reset(){this._scoreCounter.setScore(0),cA(this._toasterList,t=>{t.view.removeFromParent()})}resize(t,e){this.view.x=t*.5,this.view.y=e,this._height=e,this._updateTopTrayHeight(),this._leftBorder.y=-e,this._leftBorder.height=e,this._rightBorder.y=-e,this._rightBorder.height=e,this._scoreCounter.view.x=D.content.width*.5-this._scoreCounter.view.width-30,this._scoreCounter.view.y=-70}_updateTopTrayHeight(){const t=this._height-D.content.height;this._topTray.height=t+this._topTrayOffsetRatio*D.content.height,this._topTray.y=-this._height,this._roundedTray.scale.set(1);const e=this._topTray.height/this._roundedTray.height;this._roundedTray.visible=e>.9,this._roundedTray.scale.set(Math.min(e,1)),this._roundedTray.y=this._topTray.y+this._topTray.height-this._topTray.height*.5}_killToaster(t){jl(this._toasterList,t),t.view.removeFromParent(),Ut.return(fd)}}b(_i,"SYSTEM_ID","hud");function D_(s){return Math.sqrt(s.x*s.x+s.y*s.y)}function fA(s,t){return D_({x:s.x-t.x,y:s.y-t.y})}function $_(s,t){return{x:s.x*t,y:s.y*t}}function pA(s){const t=D_(s);return $_(s,1/t)}function _A(s,t){return{x:s.x-t.x,y:s.y-t.y}}class G_{constructor(){b(this,"i");b(this,"j")}get defaultX(){return(this.i+1)*(M.bubbleSize/2)}get defaultY(){return-this.j*M.bubbleSize}}let mA=0;class gA extends G_{constructor(){super();b(this,"UID");b(this,"view",new F);b(this,"bubbleView");b(this,"body",new Xl);b(this,"dropGroupId");b(this,"_type");this.bubbleView=new Es,this.view.addChild(this.bubbleView.view)}reset(){this.UID=this.body.UID=mA++,this.body.reset(),this.i=this.j=-1,this.dropGroupId=0}connect(e,i){this.i=e,this.j=i,this.body.state=hi.STATIC}drop(){O.killTweensOf(this),this.body.state=hi.DYNAMIC,this.body.applyForce(xt(-30,30),xt(-20,0))}bounce(){he.play("audio/bubble-land-sfx.wav",{speed:xt(.8,1.1,!1)}),this.bubbleView.type="glow",this.body.bounces++,this.body.y-=this.body.velocity.y,this.body.velocity.y=-Math.abs(this.body.velocity.y*this.body.damping)}impact(e){return O.to(this.bubbleView.view,{x:e.x,y:e.y,duration:.075,yoyo:!0,repeat:1})}update(){this.view.x=this.body.x,this.view.y=this.body.y}get x(){return this.body.x}set x(e){this.body.x=e}get y(){return this.body.y}set y(e){this.body.y=e}get type(){return this._type}set type(e){this._type=e,this.bubbleView.type=this.type}}class Ms{constructor(){b(this,"game");b(this,"signals",{onShotConnect:new oi.Signal,onBubbleBounce:new oi.Signal,onBubbleCrossLine:new oi.Signal});b(this,"_bodyMap",new Map)}update(){this._bodyMap.forEach(t=>{t.state===hi.DYNAMIC&&t.applyForce(0,Xl.GRAVITY*t.mass),t.position.add(t.velocity),this._checkOutOfBounds(t),this._checkShotConnect()})}addBody(t){this._bodyMap.get(t.UID)||this._bodyMap.set(t.UID,t)}removeBody(t){this._bodyMap.delete(t.UID)}_checkOutOfBounds(t){var a;const e=this.game.systems.get(ar),i=this.game.systems.get(De),r=this.game.systems.get(_i),n=i.getBubbleFromBody(t);if(t.state===hi.STATIC){t.y+t.radius>-M.bounceLine&&this.signals.onBubbleCrossLine.emit(n);return}if(t.x-t.radius<-D.content.width/2?(t.x+=t.velocity.x,t.velocity.x=Math.abs(t.velocity.x)):t.x+t.radius>D.content.width/2&&(t.x-=t.velocity.x,t.velocity.x=-Math.abs(t.velocity.x)),t===((a=e.projectile)==null?void 0:a.body)){t.y<-D.content.height-M.bubbleSize*2&&e.projectile&&n&&i.killBubble(n);return}t.bounces<t.maxBounces&&t.y>-M.bounceLine?n&&(n.bounce(),r.lineImpact(),this.signals.onBubbleBounce.emit(n)):t.bounces>=t.maxBounces&&t.y+t.radius>M.bubbleSize&&n&&i.killBubble(n)}_checkShotConnect(){const t=this.game.systems.get(De),{projectile:e}=this.game.systems.get(ar);if(!e)return;const i=e.body;this._bodyMap.forEach(r=>{if(r===e.body||r.state!==hi.STATIC)return;const n=i.x-r.x,o=i.y-r.y,a=Math.sqrt(n*n+o*o),h=i.radius+r.radius;if(a<h*.9){this.signals.onShotConnect.emit();const l=t.getBubbleFromBody(r);l&&t.handleConnect(e,{i:l.i,j:l.j})}})}reset(){this._bodyMap.clear()}}b(Ms,"SYSTEM_ID","physics");const dl=2*M.bubblesPerLine-2;class yd{constructor(){b(this,"j");b(this,"isEven");b(this,"bubbles",new Array(dl+1));b(this,"bubbleCount");b(this,"game");b(this,"_y")}init(t,e,i){this.j=t,this.isEven=i,this.bubbleCount=0,this.game=e,this.bubbles.length=dl+1}get y(){return this._y}set y(t){this._y=t,this.bubbles.forEach(e=>{e&&(e.y=this.y)})}addBubble(t,e){t.x=e,t.y=this.y,this.bubbles[t.i]===void 0&&(this.bubbleCount+=1),this.bubbles[t.i]=t,this.game.systems.get(Ms).addBody(t.body),this.bubbleCount>M.bubblesPerLine&&console.error("Number of bubble is too high!")}updatePosRatio(t=1){const e=M.screenTop+(this.j-1)*M.bubbleSize,r=(M.screenTop+this.j*M.bubbleSize-e)*t+e;this.y=r}hasBubbleAt(t){return this.bubbles[t]!==void 0}getBubbleAt(t){return this.bubbles[t]}removeBubble(t,e=!0){this.bubbles[t.i]=void 0,this.bubbleCount-=1,this.bubbleCount<0&&console.error("Number of bubble is too low!"),e&&t.drop()}}class Yl{constructor(){b(this,"game");b(this,"shockwaveFilter",new Jd);b(this,"_activeShockwave",!1);b(this,"_shockwaveSpeedMod",1);b(this,"_lastContainerPos",new Gt);b(this,"_shockIntensity")}shockwave(t,e,i=!1){this._lastContainerPos.set(this.game.gameContainer.x,this.game.gameContainer.y);const{shockwaveFilter:r}=this;if(this._activeShockwave=!0,this.game.gameContainer.filters=[r],r.center.x=D.content.width*.5+t,r.center.y=D.content.height+e,this.shockwaveFilter.time=0,this._shockIntensity=i?10:5,he.play("audio/bubbles-falling.wav",{speed:i?.7:xt(1,1.25,!1)}),!i){r.radius=100,r.wavelength=55,this._shockwaveSpeedMod=.75;return}r.radius=300,r.wavelength=140,this._shockwaveSpeedMod=1}stopShockwave(){var t;this._activeShockwave=!1,(t=this.game.gameContainer.filters)!=null&&t.length&&(this.game.gameContainer.filters.length=0),this.game.gameContainer.x=this._lastContainerPos.x,this.game.gameContainer.y=this._lastContainerPos.y}update(t){this._activeShockwave&&(this.game.gameContainer.x=this._lastContainerPos.x+Math.random()*this._shockIntensity,this.game.gameContainer.y=this._lastContainerPos.y+Math.random()*this._shockIntensity,this.shockwaveFilter.time>.4?this.stopShockwave():this.shockwaveFilter.time+=t/60*this._shockwaveSpeedMod)}reset(){this.stopShockwave()}}b(Yl,"SYSTEM_ID","effects");class Ao{constructor(){b(this,"game");b(this,"signals",{onPowerUsed:new oi.Signal})}usePower(t,e,i){switch(t){case"super":this._super(i);break;case"bomb":this._bomb(e,i);break;case"timer":this._timer();break}this.signals.onPowerUsed.emit(t,!1),this.game.stats.increment("powerupsUsed")}_super(t){const e=this.game.systems.get(De),i=e.lines[t];he.play("audio/powerup-super.wav"),i.bubbles.forEach(async r=>{r&&await e.removeBubble(r,!Kn(r.type))})}_bomb(t,e){var r;const i=this.game.systems.get(De);he.play("audio/powerup-bomb.wav"),(r=i.getNeighbours(t,e,M.power.blastRadius))==null||r.forEach(async n=>{await i.removeBubble(n,!0)})}_timer(){he.play("audio/powerup-time"),this.game.systems.get(ye).addTween(O.delayedCall(M.power.timerFreezeTime,()=>{this.signals.onPowerUsed.emit("timer",!0)}))}}b(Ao,"SYSTEM_ID","power");class De{constructor(){b(this,"game");b(this,"countPerType",new Map);b(this,"lines",[]);b(this,"signals",{onGameReady:new oi.Signal});b(this,"_heterogeneity",M.minHeterogeneity);b(this,"startingLines",M.startingLines);b(this,"_gridContainer",new F);b(this,"_bubbleMap",new Map);b(this,"_spoofBubble",new G_);b(this,"_spawnBubbleCount",0);b(this,"_animOffsetRatio",0);b(this,"_dropGroupIndex",0);b(this,"_allowNewLine",!1);b(this,"_newLineTween");b(this,"_newLineSpeedDecrement",0);b(this,"_newLineCount",0)}init(){this.game.addToGame(this._gridContainer),this.game.systems.get(Ms).signals.onBubbleCrossLine.connect(()=>{this._allowNewLine=!1,this.game.isGameOver||this.game.gameOver()}),this.game.systems.get(Ao).signals.onPowerUsed.connect((t,e)=>{t==="timer"&&(e?this._newLineTween.resume():this._newLineTween.pause())})}start(){this.createLevel(),this.game.systems.get(nn).updateRoof(),this._gridContainer.alpha=1,this.game.systems.get(ye).addTween(O.to(this._gridContainer,{y:0,duration:2,ease:"back.out(1)",delay:1,onComplete:()=>{this.signals.onGameReady.emit()}}))}reset(){this._newLineSpeedDecrement=0,this._dropGroupIndex=0,this._newLineCount=0,this._allowNewLine=!1,this.clearLevel()}getAttachedBubbles(){const t=[];return this.lines.forEach(e=>{t.push(...e.bubbles.filter(i=>i!==void 0))}),t}update(){this._bubbleMap.forEach(t=>{t.update()})}clearLevel(){this._bubbleMap.forEach(t=>{this.killBubble(t)}),this._bubbleMap.clear(),this.countPerType.clear();for(let t=0;t<M.startingBubbleTypes.length;t++)this.countPerType.set(M.startingBubbleTypes[t],0);this.lines.length=0,this._spawnBubbleCount=0}createLevel(){const t=this.startingLines;for(let e=0;e<t;e++)this.addLine();this._gridContainer.alpha=0,this._gridContainer.y=-t*M.bubbleSize,this.lines.forEach(e=>{e.updatePosRatio(1)})}getBubbleAt(t,e){const i=this.lines[e];return i==null?void 0:i.getBubbleAt(t)}calculateBubbleX(t){return-D.content.width/2+t.defaultX}calculateBubbleY(t){return M.screenTop+M.bubbleSize*t.j}addLineToGridTop(){this._newLineCount++;const{urgentMinLines:t,animInTime:e,urgentAnimInTime:i,maxDecrement:r,decrementIn:n,animInDecrement:o}=M.newLine,h=this.lines.length<t?i:e-this._newLineSpeedDecrement;this.addLine(!0,h,()=>{this._heterogeneity+=M.heterogeneityIncrement,this._allowNewLine&&this.addLineToGridTop()}),this._newLineCount%n===0&&(this._newLineSpeedDecrement=Math.min(this._newLineSpeedDecrement+o,r))}addLine(t=!0,e=0,i){let r;if(t){this.lines.forEach(h=>{h.j++,h.bubbles.forEach(l=>{l&&(l.j=h.j)})});const o=this.lines.length>0?!this.lines[0].isEven:!0;r=Ut.get(yd),r.init(0,this.game,o),this.lines.unshift(r);const a=o?0:1;for(let h=a;h<=dl;h+=2){this._spawnBubbleCount++;const l=this._selectBubbleType(h,0),c=this._createGridBubble(l,h,0);r.addBubble(c,this.calculateBubbleX(c)),this._gridContainer.addChild(c.view)}r.y=M.screenTop-M.bubbleSize,this.pushLevelDown(e,i)}else{const n=this.getLine("bottom"),o=this.lines.length>0?!n.isEven:!0,a=n.j+1;r=Ut.get(yd),r.init(a,this.game,o),r.y=M.screenTop+M.bubbleSize*r.j,this.lines.push(r)}return r}getLine(t){return t==="top"?this.lines[0]:t==="bottom"?this.lines[this.lines.length-1]:this.lines[t]}pushLevelDown(t,e){const i=this.game.systems.get(ye);this._animOffsetRatio=0,this._newLineTween=i.addTween(O.to(this,{_animOffsetRatio:1,ease:"none",duration:t,onUpdate:()=>{this.lines.forEach(r=>{r.updatePosRatio(this._animOffsetRatio)})},onComplete:e}))}createBubble(){const t=Ut.get(gA);return t.reset(),this._bubbleMap.set(t.UID,t),t}getChanceSelection(t,e){let i=0,r=Math.random()*t-e.get(M.bubbleTypes[0]);for(;i<M.bubbleTypes.length&&r>0;){i+=1;const n=M.bubbleTypes[i];e.has(n)&&(r-=e.get(n))}return i>=M.bubbleTypes.length&&(i=M.bubbleTypes.length-1),i}setBubble(t,e,i){he.play("audio/bubble-land-sfx.wav",{speed:xt(.8,1.1,!1)}),t.view.removeFromParent(),this._gridContainer.addChild(t.view);const r=i===this.getLine("bottom").j+1?this.addLine(!1):this.lines[i];t.connect(e,r.j);const n=e%2===0;n!==r.isEven&&console.error(`Trying to set even = ${n} where line is even = ${r.isEven}`),r.addBubble(t,this.calculateBubbleX(t));const o=this._getClusterAt(e,i===-1?0:i,!0),a=o.filter(d=>Kn(d.type)),h=(a==null?void 0:a.length)>0,l=t.bubbleView.shimmer(),c=o.length>2,u=this.game.systems.get(ye);c?this._dropGroupIndex++:this.getNeighbours(e,r.j).forEach(d=>{const f=$_(pA(_A(d,t.body.position)),M.bubbleSize*.1);u.addTween(d.impact(f))}),l.then(()=>{o.forEach(_=>{h&&_===t||!c&&!h||this.removeBubble(_,!Kn(_.type))}),a.forEach(_=>this.game.systems.get(Ao).usePower(_.type,_.i,_.j));const d=this.removeFloatingBubbles(),{x:f,y:p}=t.view,m=o.length+d;m>this.game.stats.get("bestCombo")&&this.game.stats.set("bestCombo",m),(c||h)&&this.game.systems.get(Yl).shockwave(f,p,h)}),u.addTween(l),this._allowNewLine||(this._allowNewLine=!0,this.addLineToGridTop()),r.updatePosRatio(this._animOffsetRatio)}async removeBubble(t,e=!0){this.game.stats.increment("bubblesPopped"),this.removeBubbleAt(t.i,t.j,e),t.dropGroupId=this._dropGroupIndex}removeBubbleAt(t,e,i=!0){const r=this.lines[e],n=r==null?void 0:r.getBubbleAt(t);if(!n){console.error("Trying to remove a bubble that doesnt exist at ",t,e);return}const o=n.view.parent;i?o.addChild(o.removeChild(n.view)):this.killBubble(n),r.removeBubble(n,i)}removeFloatingBubbles(){const t=new Set,e=new Map;this.getAttachedBubbles().forEach(r=>{if(e.has(r))return;const n=this._getClusterAt(r.i,r.j,!1);n.forEach(o=>{e.set(o,!0)}),n.some(o=>o.j===0)||n.forEach(o=>{t.add(o)})});const i=Array.from(t.values());return i.map(async r=>{this.removeBubble(r)}),this.garbageCollectLines(),i.length}garbageCollectLines(){for(;this.lines.length>0&&this.getLine("bottom").bubbleCount===0;)Ut.return(this.lines.pop());this.game.systems.get(nn).updateRoof()}killBubble(t){Ut.return(t),t.view.removeFromParent(),this._bubbleMap.delete(t.UID),this.game.systems.get(Ms).removeBody(t.body)}handleConnect(t,e,i){const r=this.lines[e.j],n=this._getNeighboursCoord(e.i,r.j);let o=[];const a=t.x-t.body.velocity.x,h=t.y-t.body.velocity.y,l=this._spoofBubble;l.i=e.i;const c=a<this.calculateBubbleX(l)?"left":"right";n.forEach(d=>{l.i=d.i,l.j=d.j;const f=this.calculateBubbleX(l),p=this.calculateBubbleY(l),m=a<f?"left":"right";if(i&&i!==m)return;const _=Math.sqrt(Math.pow(a-f,2)+Math.pow(h-p,2));o.push({i:d.i,j:d.j,distance:_})}),o.sort((d,f)=>d.distance-f.distance);const u=o[0];o=o.splice(0,3).filter(d=>this.isValidGrid(d.i,d.j,!0)&&!this.getBubbleAt(d.i,d.j)),o.length===0&&u?this.handleConnect(t,u,i??c):this.setBubble(t,o[0].i,o[0].j)}getBubbleFromBody(t){return this._bubbleMap.get(t.UID)}getNeighbours(t,e,i=1){const r=[];for(let n=e-i;n<=e+i;n++){const o=n;if(o<0||o>this.lines.length-1)continue;const a=Math.abs(n-e);for(let h=t-i*2+a;h<=t+i*2-a;h++)if(!(h<0||h>this.lines[o].bubbles.length-1)&&(h!==t||n!==e)){const l=this.lines[o].bubbles[h];l&&r.push(l)}}return r}_getNeighboursCoord(t,e){const i=[],r=e,n=(h,l)=>{i.push({i:h,j:l})};n(t-2,r),n(t+2,r);const o=r+1;n(t-1,o),n(t+1,o);const a=r-1;return n(t-1,a),n(t+1,a),i}_getClusterAt(t,e,i){const r=this.getBubbleAt(t,e);if(!r)return[];const n=r.type,o=[],a=[],h=[r],l=c=>Kn(c);for(;h.length;){const c=h.pop();if(a.includes(c)||!this.isValidGrid(c.i,c.j))continue;a.push(c);const u=l(c.type);if(!i||c.type===n||u){if(o.push(c),i&&u)continue;const f=this.getNeighbours(c.i,c.j,1).filter(p=>p&&!a.includes(p)&&(!i||!l(p.type)||r===c));h.push(...f)}}return o}isValidGrid(t,e,i){const r=this.getLine("bottom").j,n=e===r+1;if(n&&!i)return!1;const o=this.lines[n?r:e],a=n?!o.isEven:o.isEven,h=a&&t>-1||!a&&t>0,l=a&&t<M.bubblesPerLine*2-1||!a&&t<M.bubblesPerLine*2-2;return o&&h&&l}_createGridBubble(t,e,i){const r=this.countPerType.get(t)??0;this.countPerType.set(t,1+r);const n=this.createBubble();return n.type=t,n.connect(e,i),n}_selectBubbleType(t,e){const i=this._getSpecialType();if(i)return i;const r=this.getNeighbours(t,e);let n=M.bubbleTypes.length*this._heterogeneity;const o=M.bubbleTypes.reduce((h,l)=>h.set(l,this._heterogeneity),new Map);for(let h=0;h<r.length;h+=1){const c=r[h].type;let u=1;o.has(c)?u+=o.get(c):u+=this._heterogeneity,o.set(c,u),n+=1}const a=this.getChanceSelection(n,o);return M.bubbleTypes[a]}_getSpecialType(){const t=M.specialBubbleEvery,e=M.specialBubbleChance;return this._spawnBubbleCount%t===0&&Math.random()<e?fs("special"):null}}b(De,"SYSTEM_ID","level");class ar{constructor(){b(this,"game");b(this,"view",new F);b(this,"cannon");b(this,"bubbleReserves",[]);b(this,"reserveBubbleTypes",[]);b(this,"currentBubbleType");b(this,"signals",{onCannonFire:new oi.Signal});b(this,"_aimAngle",0);b(this,"_projectile");b(this,"_cannonForward",new Gt);b(this,"_shotProjectiles",0)}init(){this.game.systems.get(_i).cannonContainer.addChild(this.view);const t=()=>{const e=new oA;return this.view.addChild(e.view),e};this.bubbleReserves.push(t()),this.bubbleReserves.push(t()),this.cannon=new zl,this.cannon.view.scale.set(.5),this.view.addChild(this.cannon.view),this.reserveBubbleTypes.length=this.bubbleReserves.length,this.game.systems.get(De).signals.onGameReady.connect(()=>{this.game.hitContainer.on("pointermove",this._calculateAngle.bind(this)),this.game.hitContainer.on("pointertap",this._fire.bind(this)),this._loadNextShot()}),this.game.systems.get(Ms).signals.onShotConnect.connect(()=>{this._projectile=null}),this.cannon.view.y=-M.bounceLine+75,this.bubbleReserves.forEach((e,i)=>{var r,n;e.view.x=(((n=(r=this.bubbleReserves[i-1])==null?void 0:r.view)==null?void 0:n.x)??-5)-75,e.view.y=this.cannon.view.y})}awake(){this._emptyShots()}reset(){this.cannon.rotation=0,this._shotProjectiles=0}get cannonX(){return this.cannon.view.x}get cannonY(){return this.cannon.view.y}get projectile(){return this._projectile}get forward(){return this._cannonForward}get angle(){return this._aimAngle}_fire(t){if(this._projectile)return;he.play("audio/bubble-land-sfx.wav",{speed:.25}),this._calculateAngle(t),this.signals.onCannonFire.emit(this._shotProjectiles===0),this._shotProjectiles++;const e=this.game.systems.get(De).createBubble();e.type=this.currentBubbleType,this.game.addToGame(e.view);const{x:i,y:r}=this.forward;e.x=i,e.y=r,e.body.state=hi.KINEMATIC;const n=3;e.body.applyForce((i-this.cannonX)*n,(r-this.cannonY)*n),this.game.systems.get(Ms).addBody(e.body),this._projectile=e,this._loadNextShot()}_emptyShots(){for(let t=0;t<this.reserveBubbleTypes.length;t++)this.bubbleReserves[t].type="empty";this.currentBubbleType="empty",this.cannon.type=this.currentBubbleType}_loadNextShot(){this.currentBubbleType=this.reserveBubbleTypes[0]??this._newBubble();const t=this.reserveBubbleTypes;for(let e=0;e<t.length;e++)t[e]=t[e+1]??this._newBubble(),this.bubbleReserves[e].type=t[e];this.cannon.type=this.currentBubbleType}_calculateAngle(t){const e=this.cannon.view.getGlobalPosition(),i=Math.atan2(t.global.y-e.y,t.global.x-e.x);Math.abs(this._aimAngle-i)>Math.PI*2e-4&&U_("cannon-audio",150,()=>{he.play("audio/cannon-move.wav",{volume:.2})}),this._aimAngle=i,this.cannon.rotation=i+Math.PI*.5,this._cannonForward.set(80*Math.cos(this._aimAngle)+this.cannonX,80*Math.sin(this._aimAngle)+this.cannonY)}_newBubble(){const t=this.game.systems.get(De),e=new Map(t.countPerType);this.currentBubbleType!==void 0&&e.set(this.currentBubbleType,0);let i=0;e.forEach(o=>{i+=o});const r=t.getChanceSelection(i,e);return M.bubbleTypes[r]}}b(ar,"SYSTEM_ID","cannon");class Dn{constructor(){b(this,"startNode",new Gt);b(this,"endNode",new Gt)}}class yA{constructor(){b(this,"view");b(this,"type");this.view=Et.from("shot-visualiser"),this.view.anchor.set(.5),this.view.scale.set(.25)}}class nn{constructor(){b(this,"game");b(this,"view",new F);b(this,"nodeContainer",new F);b(this,"_aimLines",[]);b(this,"_leftWall");b(this,"_rightWall");b(this,"_roof");b(this,"_activeNodes",[])}init(){this.game.systems.get(_i).view.addChild(this.view),this.view.addChild(this.nodeContainer);const t=D.content.width*.5-M.bubbleSize*.5,e=D.content.height;this._leftWall=new Dn,this._leftWall.startNode.set(-t,0),this._leftWall.endNode.set(-t,-e),this._rightWall=new Dn,this._rightWall.startNode.set(t,0),this._rightWall.endNode.set(t,-e),this._roof=new Dn,this._roof.startNode.set(t,0),this._roof.endNode.set(t,-e),this.enabled(!1),this.game.systems.get(De).signals.onGameReady.connect(()=>{this.game.hitContainer.on("pointermove",this.updateAim.bind(this)),this.game.hitContainer.on("pointertap",this.updateAim.bind(this)),this.game.hitContainer.on("pointerout",this.enabled.bind(this,!1)),this.game.hitContainer.on("pointerover",this.enabled.bind(this,!0)),this.enabled(!0)})}reset(){this._clear()}updateRoof(){const t=D.content.width*.5,e=this.game.systems.get(De).getLine("bottom").y;this._roof.startNode.set(-t,e+M.bubbleSize),this._roof.endNode.set(t,e+M.bubbleSize)}updateAim(){this._clear();const t=this.game.systems.get(ar);this._calculateEdgeNodes(t.cannonX,t.cannonY,t.angle)}enabled(t){O.killTweensOf(this.nodeContainer),O.to(this.nodeContainer,{alpha:t?1:0,duration:.2})}_calculateEdgeNodes(t,e,i,r){const n=Ut.get(Dn);this._aimLines.push(n),n.startNode.set(t,e);const o=M.maxAimLinesLength,a=t+o*Math.cos(i),h=e+o*Math.sin(i);n.endNode.set(a,h);const l=this._intersection(n,this._roof);if(l){n.endNode.set(l.x,l.y),this._visualiseNodes();return}const c=this._intersection(n,this._leftWall);let u=null;if(c&&(!r||r!==this._leftWall)&&(n.endNode.set(c.x,c.y),u=this._leftWall),!u){const d=this._intersection(n,this._rightWall);d&&(n.endNode.set(d.x,d.y),u=this._rightWall)}if(!u||this._aimLines.length>M.maxAimLines)this._visualiseNodes();else{const d=-(i-2*(Math.PI/2));this._calculateEdgeNodes(n.endNode.x,n.endNode.y,d,u)}}_intersection(t,e){const{startNode:i,endNode:r}=t,{startNode:n,endNode:o}=e,a=(o.y-n.y)*(r.x-i.x)-(o.x-n.x)*(r.y-i.y);if(a===0)return null;const h=((o.x-n.x)*(i.y-n.y)-(o.y-n.y)*(i.x-n.x))/a,l=((r.x-i.x)*(i.y-n.y)-(r.y-i.y)*(i.x-n.x))/a;if(h<0||h>1||l<0||l>1)return null;const c=i.x+h*(r.x-i.x),u=i.y+h*(r.y-i.y);return{x:c,y:u}}_clear(){this._activeNodes.forEach(t=>{Ut.return(t)}),this._activeNodes.length=0,this.nodeContainer.removeChildren(),this._aimLines.forEach(t=>{Ut.return(t)}),this._aimLines.length=0}_visualiseNodes(){const t=(e,i,r)=>{const n=Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2)),o=Math.ceil(n/r),a=[],h=(i.x-e.x)/o,l=(i.y-e.y)/o;for(let c=1;c<o;c++)a.push({x:e.x+h*c,y:e.y+l*c});return a};this._aimLines.forEach((e,i)=>{const r=i===this._aimLines.length-1;if(!r){const o=this.getVisualNode("joint");o.view.position.copyFrom(e.endNode),this.nodeContainer.addChild(o.view)}const n=t(e.startNode,e.endNode,50);n.forEach((o,a)=>{const h=this.getVisualNode("line");if(h.view.position.copyFrom(o),this.nodeContainer.addChild(h.view),r&&a>n.length*.2){const l=1-a/n.length;h.view.alpha=l*.75}})})}getVisualNode(t){const e=Ut.get(yA);return e.type=t,e.view.alpha=1,this._activeNodes.push(e),e}}b(nn,"SYSTEM_ID","aim");class fl{constructor(){b(this,"game");b(this,"_pointMap",new Map)}init(){const t=this.game.systems.get(_i),e=this.game.systems.get(Ms);let i=null;e.signals.onBubbleBounce.connect(r=>{const n=this._pointMap.get(r.dropGroupId)??this._pointMap.set(r.dropGroupId,1).get(r.dropGroupId),o=M.scoreIncrement*n;t.updateScore(o,this.game.stats.increment("score",o),r),i&&clearTimeout(i),i=setTimeout(()=>{this.updateHighscore()},60),this._pointMap.set(r.dropGroupId,n+1)})}updateHighscore(){const t=this.game.stats;if(t.get("score")>t.get("highscore")){const e=t.get("score");t.set("highscore",e),le.setStorageItem("highscore",e)}}reset(){this._pointMap.clear()}}b(fl,"SYSTEM_ID","score");class xA{constructor(){b(this,"view",new F);b(this,"_tick",0);b(this,"_frequency",0);b(this,"_range",.5);const t=Et.from("satellite");t.anchor.set(.5),this.view.addChild(t)}changeView(){this.view.scale.set(xt(.3,.9,!1)),this._tick=xt(-Math.PI*.01,Math.PI*.01,!1),this._frequency=xt(1,2,!1),this._range=xt(-Math.PI*.05,Math.PI*.05,!1)}update(t){this._tick+=t/60;const e=this._tick/this._frequency,i=this._range*Math.sin(e);this.view.rotation=i}}class bA{constructor(){b(this,"view",new F);b(this,"_mainBubble");b(this,"_subBubbles",[]);b(this,"_orbitAngles",[]);b(this,"_orbitDirections",[]);b(this,"_orbitRadii",[]);b(this,"_orbitSpeeds",[])}changeView(){this._mainBubble&&this.reset(),this._mainBubble=Ut.get(Es),this._mainBubble.type=fs(),this._mainBubble.view.x=0,this._mainBubble.view.y=0,this._mainBubble.view.scale.set(xt(.7,2.5,!1)),this.view.addChild(this._mainBubble.view);const t=xt(1,5);for(let e=0;e<t;e++)this._subBubbles[e]=Ut.get(Es),this._subBubbles[e].type=fs(),this._subBubbles[e].view.scale.set(this._mainBubble.view.scale.x*xt(.3,.7,!1)),this._orbitAngles[e]=Math.random()*Math.PI,this._orbitDirections[e]=Math.sign(xt(-1,1,!1)),this._orbitRadii[e]=this._mainBubble.view.width*.5+this._subBubbles[e].view.width*.5+10,this._orbitSpeeds[e]=this._subBubbles[e].view.scale.x/this._mainBubble.view.scale.x*.5,this.view.addChild(this._subBubbles[e].view)}reset(){this._mainBubble.view.removeFromParent();for(let t=0;t<this._subBubbles.length;t++)this._subBubbles[t].view.removeFromParent(),Ut.return(this._subBubbles[t]);this._subBubbles.length=0,this._orbitAngles.length=0,this._orbitDirections.length=0,this._orbitRadii.length=0,this._orbitSpeeds.length=0}update(t){for(let e=0;e<this._subBubbles.length;e++)this._subBubbles[e].view.x=Math.cos(this._orbitAngles[e])*this._orbitRadii[e],this._subBubbles[e].view.y=Math.sin(this._orbitAngles[e])*this._orbitRadii[e],this._orbitAngles[e]+=t/60*this._orbitSpeeds[e]*this._orbitDirections[e]}}class V_{constructor(){b(this,"game");b(this,"view",new F);b(this,"_decor",[]);b(this,"_width");b(this,"_height")}init(){this.game.stage.addChildAt(this.view,0)}generateRandomPoints(t){const e=[],i=D.decorEdgePadding,r=D.decorMinDistance,n=D.content.width*.8;let o=!1,a=1e3;for(;e.length<t&&!o;){const h=xt(i,this._width-i,!1),l=xt(i,this._height-i,!1);if(a<=0&&(o=!0),a--,Math.abs(h-this._width/2)<n&&Math.abs(l-this._height/2)<n)continue;let c=!1;for(const u of e)if(fA(u,{x:h,y:l})<r){c=!0;break}c||e.push({x:h,y:l})}return e}update(t){this._decor.forEach(e=>{e.update(t)})}resize(t,e){if(this._width=t,this._height=e,this._clear(),t>D.content.width*2){const i=N_.isMobileDevice()?D.decorCountMobile:D.decorCountDesktop;this._createDecor(this.generateRandomPoints(i))}}_createDecor(t){t.forEach(e=>{const i=Math.random()<.4?xA:bA,r=Ut.get(i);r.view.position.copyFrom(e),this._decor.push(r),this.view.addChild(r.view),r.changeView()})}_clear(){this._decor.forEach(t=>{t.view.removeFromParent(),Ut.return(t)}),this._decor.length=0}}b(V_,"SYSTEM_ID","spaceDecor");class wA{constructor(){b(this,"stage",new F);b(this,"gameContainer",new F({layer:!0}));b(this,"hitContainer",new F);b(this,"systems");b(this,"stats");b(this,"isGameOver",!1);b(this,"_hitArea");this.stage.addChild(this.gameContainer),this._hitArea=new Ge,this.hitContainer.interactive=!0,this.hitContainer.hitArea=this._hitArea,this.gameContainer.addChild(this.hitContainer),this.systems=new WS(this),this.stats=new VS}addToGame(...t){t.forEach(e=>{this.gameContainer.addChild(e)})}removeFromGame(...t){t.forEach(e=>{e.removeFromParent()})}init(){this.systems.add(V_),this.systems.add(ye),this.systems.add(Ms),this.systems.add(_i),this.systems.add(Ao),this.systems.add(De),this.systems.add(nn),this.systems.add(ar),this.systems.add(Yl),this.systems.add(fl),this.systems.init()}async awake(){this.systems.awake(),this.gameContainer.visible=!0}async start(){this.systems.start()}async gameOver(){this.isGameOver=!0,this.systems.get(nn).enabled(!1),this.systems.get(fl).updateHighscore(),await this.systems.get(_i).closeHud(),this.gameContainer.visible=!1,O.delayedCall(1,()=>{ne.goToScreen(cl,{score:this.stats.get("score"),popped:this.stats.get("bubblesPopped"),powerups:this.stats.get("powerupsUsed"),combo:this.stats.get("bestCombo"),highscore:this.stats.get("highscore")})})}async end(){this.hitContainer.removeAllListeners(),this.systems.end()}update(t){this.systems.get(ye).isPaused||this.isGameOver||this.systems.update(t)}reset(){this.isGameOver=!1,this.stats.reset(),this.systems.reset()}resize(t,e){this.gameContainer.x=t*.5,this.gameContainer.y=e,this._hitArea.x=-t/2,this._hitArea.y=-e,this._hitArea.width=t,this._hitArea.height=e-M.bounceLine*.75,this.systems.resize(t,e)}}class on extends F{constructor(){super();b(this,"_background");b(this,"_game");this._background=new hn({texture:z.from("background-tile-space"),width:64,height:64}),this._background.tileScale.set(D.backgroundTileScale),this.addChild(this._background),this._game=new wA,this._game.init(),this.addChild(this._game.stage)}async show(){O.killTweensOf(this),this.alpha=0,this._game.awake(),await O.to(this,{alpha:1,duration:.2,ease:"linear"}),this._game.start()}async hide(){O.killTweensOf(this),this._game.end(),await O.to(this,{alpha:0,duration:.2,ease:"linear"}),this._game.reset()}update(e){this._game.update(e.deltaTime)}resize(e,i){this._background.width=e,this._background.height=i,this._game.resize(e,i)}}b(on,"SCREEN_ID","game"),b(on,"assetBundles",["images/game-screen"]);function vA(s,t,e){return(1-e)*s+e*t}class Po extends F{constructor(){super();b(this,"_background");b(this,"_spinner");b(this,"_cannon");b(this,"_pixiLogo");b(this,"_bottomContainer",new F);b(this,"_targetOffset",0);b(this,"_tick",0);this._background=new hn({texture:z.from("background-tile"),width:64,height:64}),this._background.tileScale.set(D.backgroundTileScale),this.addChild(this._background),this._spinner=Et.from("loading-circle"),this._spinner.anchor.set(.5),this.addChild(this._spinner),this._cannon=new zl,this._cannon.view.scale.set(.5),this._cannon.type=fs(),this.addChild(this._cannon.view),this._pixiLogo=new F_(Tt.t("pixiLogoHeader")),this._pixiLogo.view.scale.set(.75),this._bottomContainer.addChild(this._pixiLogo.view),this.addChild(this._bottomContainer)}async show(){O.killTweensOf(this),this.alpha=0,this._bottomContainer.y=0,await O.to(this,{alpha:1,duration:.2,ease:"linear"})}async hide(){O.killTweensOf(this),await O.to(this._bottomContainer,{y:100,duration:.25}),await O.to(this,{alpha:0,delay:.1,duration:.2,ease:"linear"})}update(e){this._spinner.rotation-=e/60,this._cannon.rotation=vA(this._cannon.rotation,this._spinner.rotation-this._targetOffset,.1),this._tick<=0?(this._targetOffset=xt(Math.PI*.2,Math.PI*.5),this._tick=1):this._tick-=e/60}resize(e,i){this._background.width=e,this._background.height=i,this._spinner.x=this._cannon.view.x=e*.5,this._spinner.y=this._cannon.view.y=i*.5,this._pixiLogo.view.x=e*.5,this._pixiLogo.view.y=i-55}}b(Po,"SCREEN_ID","loader"),b(Po,"assetBundles",["images/preload"]);const Cs=new ml;let xd=!1;function bd(){const s=window.innerWidth,t=window.innerHeight,e=D.content.width,i=D.content.height,r=s<e?e/s:1,n=t<i?i/t:1,o=r>n?r:n,a=s*o,h=t*o;Cs.renderer.view.element.style.width=`${s}px`,Cs.renderer.view.element.style.height=`${t}px`,window.scrollTo(0,0),Cs.renderer.resize(a,h),ne.init(),ne.resize(a,h)}async function TA(){await Cs.init({resolution:Math.max(window.devicePixelRatio,2),preference:"webgl",backgroundColor:16777215}),document.body.appendChild(Cs.canvas),window.addEventListener("resize",bd),bd(),await Py(),le.readyStorage(),ne.setLoadScreen(Po),Rr.muted(le.getStorageItem("muted")),document.addEventListener("pointerdown",()=>{xd||RT.play("audio/bubbo-bubbo-bg-music.wav"),xd=!0}),document.addEventListener("visibilitychange",()=>{document.visibilityState!=="visible"?Rr.muted(!0):Rr.muted(le.getStorageItem("muted"))}),pd("play")!==null?(await je.loadBundle(or.assetBundles),await ne.goToScreen(on)):pd("loading")!==null?await ne.goToScreen(Po):await ne.goToScreen(or)}TA();export{ly as $,_h as A,pl as B,F as C,ug as D,Xe as E,Xd as F,ci as G,tf as H,zg as I,lc as J,dg as K,wd as L,tt as M,cc as N,hy as O,Gt as P,by as Q,Ge as R,Et as S,z as T,Kd as U,_y as V,Fe as W,ce as X,xc as Y,bh as Z,ns as _,Zt as a,bc as a0,QA as a1,cm as b,lm as c,cr as d,Eo as e,Sg as f,ig as g,fc as h,ie as i,Pr as j,nc as k,Hm as l,Z_ as m,Cd as n,Pg as o,Lr as p,jd as q,Xm as r,Vt as s,Gg as t,Ur as u,Yd as v,am as w,_c as x,mh as y,qm as z};
