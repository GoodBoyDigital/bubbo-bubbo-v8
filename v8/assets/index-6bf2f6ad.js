var Df=Object.defineProperty;var Gf=(i,t,e)=>t in i?Df(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var g=(i,t,e)=>(Gf(i,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerpolicy&&(n.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?n.credentials="include":r.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=e(r);fetch(r.href,n)}})();var Oe=(i=>(i.Renderer="renderer",i.Application="application",i.WebGLRendererPipes="renderer-webgl-pipes",i.WebGLRendererPipesAdaptor="renderer-webgl-pipes-adaptor",i.WebGLRendererSystem="renderer-webgl-system",i.WebGPURendererPipes="renderer-webgpu-pipes",i.WebGPURendererPipesAdaptor="renderer-webgpu-pipes-adaptor",i.WebGPURendererSystem="renderer-webgpu-system",i.CanvasRendererSystem="renderer-canvas-system",i.CanvasRendererPipesAdaptor="renderer-canvas-pipes-adaptor",i.CanvasRendererPipes="renderer-canvas-pipes",i.Asset="asset",i.LoadParser="load-parser",i.ResolveParser="resolve-parser",i.CacheParser="cache-parser",i.DetectionParser="detection-parser",i.MaskEffect="mask-effect",i))(Oe||{});const ra=i=>{if(typeof i=="function"||typeof i=="object"&&i.extension){if(!i.extension)throw new Error("Extension class must have an extension object");i={...typeof i.extension!="object"?{type:i.extension}:i.extension,ref:i}}if(typeof i=="object")i={...i};else throw new Error("Invalid extension type");return typeof i.type=="string"&&(i.type=[i.type]),i},Nr=(i,t)=>ra(i).priority??t,Dn={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...i){return i.map(ra).forEach(t=>{t.type.forEach(e=>{var s,r;return(r=(s=this._removeHandlers)[e])==null?void 0:r.call(s,t)})}),this},add(...i){return i.map(ra).forEach(t=>{t.type.forEach(e=>{const s=this._addHandlers,r=this._queue;s[e]?s[e](t):(r[e]=r[e]||[],r[e].push(t))})}),this},handle(i,t,e){const s=this._addHandlers,r=this._removeHandlers;if(s[i]||r[i])throw new Error(`Extension type ${i} already has a handler`);s[i]=t,r[i]=e;const n=this._queue;return n[i]&&(n[i].forEach(o=>t(o)),delete n[i]),this},handleByMap(i,t){return this.handle(i,e=>{t[e.name]=e.ref},e=>{delete t[e.name]})},handleByNamedList(i,t,e=-1){return this.handle(i,s=>{t.findIndex(n=>n.name===s.name)>=0||(t.push({name:s.name,value:s.ref}),t.sort((n,o)=>Nr(o.value,e)-Nr(n.value,e)))},s=>{const r=t.findIndex(n=>n.name===s.name);r!==-1&&t.splice(r,1)})},handleByList(i,t,e=-1){return this.handle(i,s=>{t.includes(s.ref)||(t.push(s.ref),t.sort((r,n)=>Nr(n,e)-Nr(r,e)))},s=>{const r=t.indexOf(s.ref);r!==-1&&t.splice(r,1)})}};var na=(i=>(i[i.INTERACTION=50]="INTERACTION",i[i.HIGH=25]="HIGH",i[i.NORMAL=0]="NORMAL",i[i.LOW=-25]="LOW",i[i.UTILITY=-50]="UTILITY",i))(na||{});let ao=class{constructor(t,e=null,s=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=s,this.once=r}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}};const qt=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new ao(null,null,1/0),this.deltaMS=1/qt.targetFPMS,this.elapsedMS=1/qt.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,s=na.NORMAL){return this._addListener(new ao(t,e,s))}addOnce(t,e,s=na.NORMAL){return this._addListener(new ao(t,e,s,!0))}_addListener(t){let e=this._head.next,s=this._head;if(!e)t.connect(s);else{for(;e;){if(t.priority>e.priority){t.connect(s);break}s=e,e=e.next}t.previous||t.connect(s)}return this._startIfPossible(),this}remove(t,e){let s=this._head.next;for(;s;)s.match(t,e)?s=s.destroy():s=s.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*qt.targetFPMS;const s=this._head;let r=s.next;for(;r;)r=r.emit(this);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),s=Math.min(Math.max(0,e)/1e3,qt.targetFPMS);this._maxElapsedMS=1/s}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!qt._shared){const t=qt._shared=new qt;t.autoStart=!0,t._protected=!0}return qt._shared}static get system(){if(!qt._system){const t=qt._system=new qt;t.autoStart=!0,t._protected=!0}return qt._system}};let $c=qt;$c.targetFPMS=.06;var Hc=(i=>(i[i.Low=0]="Low",i[i.Normal=1]="Normal",i[i.High=2]="High",i))(Hc||{});const Vf={createCanvas:(i,t)=>{const e=document.createElement("canvas");return e.width=i,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(i,t)=>fetch(i,t),parseXML:i=>new DOMParser().parseFromString(i,"text/xml")},Gt={ADAPTER:Vf,RETINA_PREFIX:/@([0-9\.]+)x/,FAIL_IF_MAJOR_PERFORMANCE_CAVEAT:!1,RESOLUTION:2};function be(i){if(typeof i!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(i)}`)}function Ds(i){return i.split("?")[0].split("#")[0]}function $f(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Hf(i,t,e){return i.replace(new RegExp($f(t),"g"),e)}function zf(i,t){let e="",s=0,r=-1,n=0,o=-1;for(let a=0;a<=i.length;++a){if(a<i.length)o=i.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||n===1))if(r!==a-1&&n===2){if(e.length<2||s!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const h=e.lastIndexOf("/");if(h!==e.length-1){h===-1?(e="",s=0):(e=e.slice(0,h),s=e.length-1-e.lastIndexOf("/")),r=a,n=0;continue}}else if(e.length===2||e.length===1){e="",s=0,r=a,n=0;continue}}t&&(e.length>0?e+="/..":e="..",s=2)}else e.length>0?e+=`/${i.slice(r+1,a)}`:e=i.slice(r+1,a),s=a-r-1;r=a,n=0}else o===46&&n!==-1?++n:n=-1}return e}const hr={toPosix(i){return Hf(i,"\\","/")},isUrl(i){return/^https?:/.test(this.toPosix(i))},isDataUrl(i){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(i)},hasProtocol(i){return/^[^/:]+:\//.test(this.toPosix(i))},getProtocol(i){be(i),i=this.toPosix(i);let t="";const e=/^file:\/\/\//.exec(i),s=/^[^/:]+:\/\//.exec(i),r=/^[^/:]+:\//.exec(i);if(e||s||r){const n=(e==null?void 0:e[0])||(s==null?void 0:s[0])||(r==null?void 0:r[0]);t=n,i=i.slice(n.length)}return t},toAbsolute(i,t,e){if(this.isDataUrl(i))return i;const s=Ds(this.toPosix(t??Gt.ADAPTER.getBaseUrl())),r=Ds(this.toPosix(e??this.rootname(s)));return be(i),i=this.toPosix(i),i.startsWith("/")?hr.join(r,i.slice(1)):this.isAbsolute(i)?i:this.join(s,i)},normalize(i){if(i=this.toPosix(i),be(i),i.length===0)return".";let t="";const e=i.startsWith("/");this.hasProtocol(i)&&(t=this.rootname(i),i=i.slice(t.length));const s=i.endsWith("/");return i=zf(i,!1),i.length>0&&s&&(i+="/"),e?`/${i}`:t+i},isAbsolute(i){return be(i),i=this.toPosix(i),this.hasProtocol(i)?!0:i.startsWith("/")},join(...i){if(i.length===0)return".";let t;for(let e=0;e<i.length;++e){const s=i[e];if(be(s),s.length>0)if(t===void 0)t=s;else{const r=i[e-1]??"";this.extname(r)?t+=`/../${s}`:t+=`/${s}`}}return t===void 0?".":this.normalize(t)},dirname(i){if(be(i),i.length===0)return".";i=this.toPosix(i);let t=i.charCodeAt(0);const e=t===47;let s=-1,r=!0;const n=this.getProtocol(i),o=i;i=i.slice(n.length);for(let a=i.length-1;a>=1;--a)if(t=i.charCodeAt(a),t===47){if(!r){s=a;break}}else r=!1;return s===-1?e?"/":this.isUrl(o)?n+i:n:e&&s===1?"//":n+i.slice(0,s)},rootname(i){be(i),i=this.toPosix(i);let t="";if(i.startsWith("/")?t="/":t=this.getProtocol(i),this.isUrl(i)){const e=i.indexOf("/",t.length);e!==-1?t=i.slice(0,e):t=i,t.endsWith("/")||(t+="/")}return t},basename(i,t){be(i),t&&be(t),i=Ds(this.toPosix(i));let e=0,s=-1,r=!0,n;if(t!==void 0&&t.length>0&&t.length<=i.length){if(t.length===i.length&&t===i)return"";let o=t.length-1,a=-1;for(n=i.length-1;n>=0;--n){const h=i.charCodeAt(n);if(h===47){if(!r){e=n+1;break}}else a===-1&&(r=!1,a=n+1),o>=0&&(h===t.charCodeAt(o)?--o===-1&&(s=n):(o=-1,s=a))}return e===s?s=a:s===-1&&(s=i.length),i.slice(e,s)}for(n=i.length-1;n>=0;--n)if(i.charCodeAt(n)===47){if(!r){e=n+1;break}}else s===-1&&(r=!1,s=n+1);return s===-1?"":i.slice(e,s)},extname(i){be(i),i=Ds(this.toPosix(i));let t=-1,e=0,s=-1,r=!0,n=0;for(let o=i.length-1;o>=0;--o){const a=i.charCodeAt(o);if(a===47){if(!r){e=o+1;break}continue}s===-1&&(r=!1,s=o+1),a===46?t===-1?t=o:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||s===-1||n===0||n===1&&t===s-1&&t===e+1?"":i.slice(t,s)},parse(i){be(i);const t={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return t;i=Ds(this.toPosix(i));let e=i.charCodeAt(0);const s=this.isAbsolute(i);let r;t.root=this.rootname(i),s||this.hasProtocol(i)?r=1:r=0;let n=-1,o=0,a=-1,h=!0,l=i.length-1,c=0;for(;l>=r;--l){if(e=i.charCodeAt(l),e===47){if(!h){o=l+1;break}continue}a===-1&&(h=!1,a=l+1),e===46?n===-1?n=l:c!==1&&(c=1):n!==-1&&(c=-1)}return n===-1||a===-1||c===0||c===1&&n===a-1&&n===o+1?a!==-1&&(o===0&&s?t.base=t.name=i.slice(1,a):t.base=t.name=i.slice(o,a)):(o===0&&s?(t.name=i.slice(1,n),t.base=i.slice(1,a)):(t.name=i.slice(o,n),t.base=i.slice(o,a)),t.ext=i.slice(n,a)),t.dir=this.dirname(i),t},sep:"/",delimiter:":"};var ho=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},jt={},Wf={get exports(){return jt},set exports(i){jt=i}};(function(i){var t=Object.prototype.hasOwnProperty,e="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(e=!1));function r(h,l,c){this.fn=h,this.context=l,this.once=c||!1}function n(h,l,c,u,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new r(c,u||h,d),_=e?e+l:l;return h._events[_]?h._events[_].fn?h._events[_]=[h._events[_],f]:h._events[_].push(f):(h._events[_]=f,h._eventsCount++),h}function o(h,l){--h._eventsCount===0?h._events=new s:delete h._events[l]}function a(){this._events=new s,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],c,u;if(this._eventsCount===0)return l;for(u in c=this._events)t.call(c,u)&&l.push(e?u.slice(1):u);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},a.prototype.listeners=function(l){var c=e?e+l:l,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,f=u.length,_=new Array(f);d<f;d++)_[d]=u[d].fn;return _},a.prototype.listenerCount=function(l){var c=e?e+l:l,u=this._events[c];return u?u.fn?1:u.length:0},a.prototype.emit=function(l,c,u,d,f,_){var m=e?e+l:l;if(!this._events[m])return!1;var p=this._events[m],x=arguments.length,y,b;if(p.fn){switch(p.once&&this.removeListener(l,p.fn,void 0,!0),x){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,c),!0;case 3:return p.fn.call(p.context,c,u),!0;case 4:return p.fn.call(p.context,c,u,d),!0;case 5:return p.fn.call(p.context,c,u,d,f),!0;case 6:return p.fn.call(p.context,c,u,d,f,_),!0}for(b=1,y=new Array(x-1);b<x;b++)y[b-1]=arguments[b];p.fn.apply(p.context,y)}else{var v=p.length,w;for(b=0;b<v;b++)switch(p[b].once&&this.removeListener(l,p[b].fn,void 0,!0),x){case 1:p[b].fn.call(p[b].context);break;case 2:p[b].fn.call(p[b].context,c);break;case 3:p[b].fn.call(p[b].context,c,u);break;case 4:p[b].fn.call(p[b].context,c,u,d);break;default:if(!y)for(w=1,y=new Array(x-1);w<x;w++)y[w-1]=arguments[w];p[b].fn.apply(p[b].context,y)}}return!0},a.prototype.on=function(l,c,u){return n(this,l,c,u,!1)},a.prototype.once=function(l,c,u){return n(this,l,c,u,!0)},a.prototype.removeListener=function(l,c,u,d){var f=e?e+l:l;if(!this._events[f])return this;if(!c)return o(this,f),this;var _=this._events[f];if(_.fn)_.fn===c&&(!d||_.once)&&(!u||_.context===u)&&o(this,f);else{for(var m=0,p=[],x=_.length;m<x;m++)(_[m].fn!==c||d&&!_[m].once||u&&_[m].context!==u)&&p.push(_[m]);p.length?this._events[f]=p.length===1?p[0]:p:o(this,f)}return this},a.prototype.removeAllListeners=function(l){var c;return l?(c=e?e+l:l,this._events[c]&&o(this,c)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,i.exports=a})(Wf);let Ut=class zc{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new zc(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}static get shared(){return lo.x=0,lo.y=0,lo}};const lo=new Ut,Ur=[new Ut,new Ut,new Ut,new Ut];let me=class on{constructor(t=0,e=0,s=0,r=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(s),this.height=Number(r)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new on(0,0,0,0)}clone(){return new on(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const T=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=T)return!1;const M=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>M}const s=this.left,r=this.right,n=this.top,o=this.bottom;if(r<=s||o<=n)return!1;const a=Ur[0].set(t.left,t.top),h=Ur[1].set(t.left,t.bottom),l=Ur[2].set(t.right,t.top),c=Ur[3].set(t.right,t.bottom);if(l.x<=a.x||h.y<=a.y)return!1;const u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(a,a),e.apply(h,h),e.apply(l,l),e.apply(c,c),Math.max(a.x,h.x,l.x,c.x)<=s||Math.min(a.x,h.x,l.x,c.x)>=r||Math.max(a.y,h.y,l.y,c.y)<=n||Math.min(a.y,h.y,l.y,c.y)>=o))return!1;const d=u*(h.y-a.y),f=u*(a.x-h.x),_=d*s+f*n,m=d*r+f*n,p=d*s+f*o,x=d*r+f*o;if(Math.max(_,m,p,x)<=d*a.x+f*a.y||Math.min(_,m,p,x)>=d*c.x+f*c.y)return!1;const y=u*(a.y-l.y),b=u*(l.x-a.x),v=y*s+b*n,w=y*r+b*n,C=y*s+b*o,A=y*r+b*o;return!(Math.max(v,w,C,A)<=y*a.x+b*a.y||Math.min(v,w,C,A)>=y*c.x+b*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),s=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(s-e,0),this.y=r,this.height=Math.max(n-r,0),this}ceil(t=1,e=.001){const s=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=s-this.x,this.height=r-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),s=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=s-e,this.y=r,this.height=n-r,this}getBounds(t){return t=t||new on,t.copyFrom(this),t}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}};const Se=(i,t)=>(Array.isArray(i)||(i=[i]),t?i.map(e=>typeof e=="string"?t(e):e):i);let jf=class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const s=Se(t);let r;for(let a=0;a<this.parsers.length;a++){const h=this.parsers[a];if(h.test(e)){r=h.getCacheableAssets(s,e);break}}r||(r={},s.forEach(a=>{r[a]=e}));const n=Object.keys(r),o={cacheKeys:n,keys:s};s.forEach(a=>{this._cacheMap.set(a,o)}),n.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==e&&console.warn("[Cache] already has key:",a),this._cache.set(a,r[a])})}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(r=>{this._cache.delete(r)}),e.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}};const Ae=new jf,gn=()=>{},co={},Bh={};function Xf(i,t){let e=Bh[i];return e===void 0&&(co[t]===void 0&&(co[t]=1),Bh[i]=e=co[t]++),e}let Yf=0;const Wc=class extends jt{constructor(i={}){super(),this.resourceType="textureSampler",this.uid=Yf++,this._maxAnisotropy=1,i={...Wc.DEFAULT,...i},this.addressMode=i.addressMode,this.addressModeU=i.addressModeU??this.addressModeU,this.addressModeV=i.addressModeV??this.addressModeV,this.addressModeW=i.addressModeW??this.addressModeW,this.scaleMode=i.scaleMode,this.magFilter=i.magFilter??this.magFilter,this.minFilter=i.minFilter??this.minFilter,this.mipmapFilter=i.mipmapFilter??this.mipmapFilter,this.lodMinClamp=i.lodMinClamp,this.lodMaxClamp=i.lodMaxClamp,this.compare=i.compare,this.maxAnisotropy=i.maxAnisotropy??1}set addressMode(i){this.addressModeU=i,this.addressModeV=i,this.addressModeW=i}get addressMode(){return this.addressModeU}set scaleMode(i){this.magFilter=i,this.minFilter=i,this.mipmapFilter=i}get scaleMode(){return this.magFilter}set maxAnisotropy(i){this._maxAnisotropy=Math.min(i,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get resourceId(){return this._resourceId||this.generateResourceId()}update(){this.emit("change",this),this._resourceId=null}generateResourceId(){const i=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._resourceId=Xf(i,"sampler"),this._resourceId}destroy(){this.emit("destroy",this),this.removeAllListeners()}};let lr=Wc;lr.DEFAULT={addressMode:"clamp-to-edge",scaleMode:"nearest"};let qf=0,Kf=0;class jc extends jt{constructor(t={}){var s,r;super(),this.uid=qf++,this.resourceType="textureSource",this.resourceId=Kf++,this.type="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm-srgb",this.viewDimensions="2d",this.dimension="2d",this.antialias=!1,this.depthStencil=!0,this.resource=t.resource,this._resolution=t.resolution??1,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=((s=t.resource)==null?void 0:s.width)??1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=((r=t.resource)==null?void 0:r.height)??1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format??"bgra8unorm",this.viewDimensions=t.view??"2d",this.dimension=t.dimensions??"2d",this.mipLevelCount=t.mipLevelCount??1,this.autoGenerateMipmaps=t.autoGenerateMipmaps??!1,this.sampleCount=t.sampleCount??1,this.antialias=t.antialias??!1;const e=t.style??{};this.style=e instanceof lr?e:new lr(e),this.style.on("change",this.onStyleUpdate,this),this.styleSourceKey=(this.style.resourceId<<24)+this.uid}get source(){return this}update(){this.emit("update",this)}onStyleUpdate(){this.styleSourceKey=(this.style.resourceId<<24)+this.uid}destroy(){this.emit("destroy",this),this.style&&(this.style.destroy(),this.style=null),this.type=null,this.resource=null,this.removeAllListeners()}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,s){s=s||this._resolution,t=t||this.width,e=e||this.height;const r=Math.round(t*s),n=Math.round(e*s);this.width=r/s,this.height=n/s,this._resolution=s,!(this.pixelWidth===r&&this.pixelHeight===n)&&(this.pixelWidth=r,this.pixelHeight=n,this.emit("resize",this),this.resourceId++,this.emit("change",this))}}const Zf=Math.PI*2,Jf=180/Math.PI,Qf=Math.PI/180;let J=class Xc{constructor(t=1,e=0,s=0,r=1,n=0,o=0){this.array=null,this.a=t,this.b=e,this.c=s,this.d=r,this.tx=n,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,s,r,n,o){return this.a=t,this.b=e,this.c=s,this.d=r,this.tx=n,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const s=e||this.array;return t?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(t,e){e=e||new Ut;const s=t.x,r=t.y;return e.x=this.a*s+this.c*r+this.tx,e.y=this.b*s+this.d*r+this.ty,e}applyInverse(t,e){e=e||new Ut;const s=this.a,r=this.b,n=this.c,o=this.d,a=this.tx,h=this.ty,l=1/(s*o+n*-r),c=t.x,u=t.y;return e.x=o*l*c+-n*l*u+(h*n-a*o)*l,e.y=s*l*u+-r*l*c+(-h*s+a*r)*l,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),s=Math.sin(t),r=this.a,n=this.c,o=this.tx;return this.a=r*e-this.b*s,this.b=r*s+this.b*e,this.c=n*e-this.d*s,this.d=n*s+this.d*e,this.tx=o*e-this.ty*s,this.ty=o*s+this.ty*e,this}append(t){const e=this.a,s=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*s+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*s+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*s+t.ty*n+this.ty,this}appendFrom(t,e){const s=t.a,r=t.b,n=t.c,o=t.d,a=t.tx,h=t.ty,l=e.a,c=e.b,u=e.c,d=e.d;return this.a=s*l+r*u,this.b=s*c+r*d,this.c=n*l+o*u,this.d=n*c+o*d,this.tx=a*l+h*u+e.tx,this.ty=a*c+h*d+e.ty,this}setTransform(t,e,s,r,n,o,a,h,l){return this.a=Math.cos(a+l)*n,this.b=Math.sin(a+l)*n,this.c=-Math.sin(a-h)*o,this.d=Math.cos(a-h)*o,this.tx=t-(s*this.a+r*this.c),this.ty=e-(s*this.b+r*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const s=this.a,r=this.c;this.a=s*t.a+this.b*t.c,this.b=s*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,s=this.b,r=this.c,n=this.d,o=t.pivot,a=-Math.atan2(-r,n),h=Math.atan2(s,e),l=Math.abs(a+h);return l<1e-5||Math.abs(Zf-l)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=h),t.scale.x=Math.sqrt(e*e+s*s),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx+(o.x*e+o.y*r),t.position.y=this.ty+(o.x*s+o.y*n),t}invert(){const t=this.a,e=this.b,s=this.c,r=this.d,n=this.tx,o=t*r-e*s;return this.a=r/o,this.b=-e/o,this.c=-s/o,this.d=t/o,this.tx=(s*this.ty-r*n)/o,this.ty=-(t*this.ty-e*n)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Xc;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return ep.identity()}static get shared(){return tp.identity()}};const tp=new J,ep=new J,Ai=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Ei=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Pi=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Ii=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],oa=[],Yc=[],Dr=Math.sign;function ip(){for(let i=0;i<16;i++){const t=[];oa.push(t);for(let e=0;e<16;e++){const s=Dr(Ai[i]*Ai[e]+Pi[i]*Ei[e]),r=Dr(Ei[i]*Ai[e]+Ii[i]*Ei[e]),n=Dr(Ai[i]*Pi[e]+Pi[i]*Ii[e]),o=Dr(Ei[i]*Pi[e]+Ii[i]*Ii[e]);for(let a=0;a<16;a++)if(Ai[a]===s&&Ei[a]===r&&Pi[a]===n&&Ii[a]===o){t.push(a);break}}}for(let i=0;i<16;i++){const t=new J;t.set(Ai[i],Ei[i],Pi[i],Ii[i],0,0),Yc.push(t)}}ip();const ht={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:i=>Ai[i],uY:i=>Ei[i],vX:i=>Pi[i],vY:i=>Ii[i],inv:i=>i&8?i&15:-i&7,add:(i,t)=>oa[i][t],sub:(i,t)=>oa[i][ht.inv(t)],rotate180:i=>i^4,isVertical:i=>(i&3)===2,byDirection:(i,t)=>Math.abs(i)*2<=Math.abs(t)?t>=0?ht.S:ht.N:Math.abs(t)*2<=Math.abs(i)?i>0?ht.E:ht.W:t>0?i>0?ht.SE:ht.SW:i>0?ht.NE:ht.NW,matrixAppendRotationInv:(i,t,e=0,s=0)=>{const r=Yc[ht.inv(t)];r.tx=e,r.ty=s,i.append(r)}};class Lh extends jt{constructor(t={}){super(),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=t.frame||new me(0,0,1,1),this.orig=t.orig||this.frame,this.rotate=t.rotate??0,this.trim=t.trim,this.defaultAnchor=t.defaultAnchor,this.updateUvs()}updateUvs(){const t=this.uvs,e=this.frame;let s=this.rotate;if(s){const r=e.width/2,n=e.height/2,o=e.x+r,a=e.y+n;s=ht.add(s,ht.NW),t.x0=o+r*ht.uX(s),t.y0=a+n*ht.uY(s),s=ht.add(s,2),t.x1=o+r*ht.uX(s),t.y1=a+n*ht.uY(s),s=ht.add(s,2),t.x2=o+r*ht.uX(s),t.y2=a+n*ht.uY(s),s=ht.add(s,2),t.x3=o+r*ht.uX(s),t.y3=a+n*ht.uY(s)}else t.x0=e.x,t.y0=e.y,t.x1=e.x+e.width,t.y1=e.y,t.x2=e.x+e.width,t.y2=e.y+e.height,t.x3=e.x,t.y3=e.y+e.height}update(){this.updateUvs(),this.emit("update",this)}destroy(){this.emit("destroy",this),this.removeAllListeners(),this.frame=null,this.orig=null,this.trim=null,this.defaultAnchor=null,this.uvs=null}}const Oh=new J;let sp=class{constructor(t,e){this.mapCoord=new J,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){var e;this.texture!==t&&((e=this._texture)==null||e.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){e===void 0&&(e=t);const s=this.mapCoord;for(let r=0;r<t.length;r+=2){const n=t[r],o=t[r+1];e[r]=n*s.a+o*s.c+s.tx,e[r+1]=n*s.b+o*s.d+s.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.layout.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const s=t.layout.orig,r=t.layout.trim;r&&(Oh.set(s.width/r.width,0,0,s.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(Oh));const n=t.source,o=this.uClampFrame,a=this.clampMargin/n._resolution,h=this.clampOffset;return o[0]=(t.frameX+a+h)/n.width,o[1]=(t.frameY+a+h)/n.height,o[2]=(t.frameX+t.frameWidth-a+h)/n.width,o[3]=(t.frameY+t.frameHeight-a+h)/n.height,this.uClampOffset[0]=h/n.pixelWidth,this.uClampOffset[1]=h/n.pixelHeight,this.isSimple=t.frameWidth===n.width&&t.frameHeight===n.height&&t.layout.rotate===0,!0}},rp=0,H=class extends jt{constructor({source:t,style:e,layout:s,label:r}={}){super(),this.id=rp++,this.styleSourceKey=0,this.label=r,this.source=(t==null?void 0:t.source)??new jc,this.layout=s instanceof Lh?s:new Lh(s),e&&(this._style=e instanceof lr?e:new lr(e)),this.styleSourceKey=(this.style.resourceId<<24)+this._source.uid}static from(t){return Ae.get(t)}set source(t){this._source&&(this._source.off("update",this.onStyleSourceUpdate,this),this._source.off("resize",this.onUpdate,this)),this._source=t,t.on("update",this.onStyleSourceUpdate,this),t.on("resize",this.onUpdate,this),this.styleSourceKey=(this.style.resourceId<<24)+this._source.uid,this.emit("update",this)}get source(){return this._source}get style(){return this._style||this.source.style}set style(t){var e,s;(e=this._style)==null||e.off("change",this.onStyleSourceUpdate,this),this._style=t,(s=this._style)==null||s.on("change",this.onStyleSourceUpdate,this)}get layout(){return this._layout}set layout(t){var e;(e=this._layout)==null||e.off("update",this.onUpdate,this),this._layout=t,t.on("update",this.onUpdate,this),this.emit("update",this)}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new sp(this)),this._textureMatrix}set frameWidth(t){this._layout.frame.width=t/this._source.width}get frameWidth(){return this._source.pixelWidth/this._source._resolution*this._layout.frame.width}set frameHeight(t){this._layout.frame.height=t/this._source.height}get frameHeight(){return this._source.pixelHeight/this._source._resolution*this._layout.frame.height}set frameX(t){if(t===0){this._layout.frame.x=0;return}this._layout.frame.x=this._source.width/t}get frameX(){return this._source.width*this._layout.frame.x}set frameY(t){if(t===0){this._layout.frame.y=0;return}this._layout.frame.y=this._source.height/t}get frameY(){return this._source.height*this._layout.frame.y}get width(){return this._source.width*this._layout.orig.width}get height(){return this._source.height*this._layout.orig.height}destroy(t=!1){this._style&&(this._style.destroy(),this._style=null),this._layout&&(this._layout.destroy(),this._layout=null),this._source&&t&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.removeAllListeners()}onStyleSourceUpdate(){this.styleSourceKey=(this.style.resourceId<<24)+this._source.uid,this.emit("update",this)}onUpdate(){this.emit("update",this)}};H.EMPTY=new H({});H.EMPTY.label="EMPTY";H.EMPTY.destroy=gn;function np(i,t){if(Array.isArray(t)){for(const e of t)if(i.startsWith(`data:${e}`))return!0;return!1}return i.startsWith(`data:${t}`)}function op(i,t){const e=i.split("?")[0],s=hr.extname(e).toLowerCase();return Array.isArray(t)?t.includes(s):s===t}const Fh={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ze(i){if(typeof i=="number")return i;if(typeof i=="string"){if(Fh[i]!==void 0)return Fh[i];if(i[0]==="#"){if(i.length===4){const t=parseInt(i[1]+i[1],16),e=parseInt(i[2]+i[2],16),s=parseInt(i[3]+i[3],16);return(t<<16)+(e<<8)+s}return parseInt(i.substring(1),16)}console.warn(`[pixi.js] Invalid color: ${i}`)}return 0}class Rr{constructor(t=1/0,e=1/0,s=-1/0,r=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrixStack=[],this.matrix=new J,this.minX=t,this.minY=e,this.maxX=s,this.maxY=r}get rectangle(){this._rectangle||(this._rectangle=new me);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):(t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY),t}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrixStack.length=0,this.matrix.identity()}pushMatrix(t){this.matrixStack.push(t),this.matrixStack.length>1?(this.matrix.copyFrom(this.matrixStack[this.matrixStack.length-2]),this.matrix.append(t)):this.matrix.copyFrom(t)}popMatrix(){this.matrixStack.pop(),this.matrixStack.length>1?(this.matrix.copyFrom(this.matrixStack[this.matrixStack.length-2]),this.matrix.append(this.matrixStack[this.matrixStack.length-1])):this.matrixStack.length===1?this.matrix.copyFrom(this.matrixStack[0]):this.matrix.identity()}setMatrix(t){this.matrix.copyFrom(t)}set(t,e,s,r){this.minX=t,this.minY=e,this.maxX=s,this.maxY=r}addFrame(t,e,s,r){const n=this.matrix,o=n.a,a=n.b,h=n.c,l=n.d,c=n.tx,u=n.ty;let d=this.minX,f=this.minY,_=this.maxX,m=this.maxY,p=o*t+h*e+c,x=a*t+l*e+u;d=p<d?p:d,f=x<f?x:f,_=p>_?p:_,m=x>m?x:m,p=o*s+h*e+c,x=a*s+l*e+u,d=p<d?p:d,f=x<f?x:f,_=p>_?p:_,m=x>m?x:m,p=o*t+h*r+c,x=a*t+l*r+u,d=p<d?p:d,f=x<f?x:f,_=p>_?p:_,m=x>m?x:m,p=o*s+h*r+c,x=a*s+l*r+u,d=p<d?p:d,f=x<f?x:f,_=p>_?p:_,m=x>m?x:m,this.minX=d,this.minY=f,this.maxX=_,this.maxY=m}addRect(t){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height)}addBounds(t){this.addFrame(t.minX,t.minY,t.maxX,t.maxY)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,s=this.minY,r=this.maxX,n=this.maxY,{a:o,b:a,c:h,d:l,tx:c,ty:u}=t;let d=o*e+h*s+c,f=a*e+l*s+u;this.minX=d,this.minY=f,this.maxX=d,this.maxY=f,d=o*r+h*s+c,f=a*r+l*s+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*e+h*n+c,f=a*e+l*n+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*r+h*n+c,f=a*r+l*n+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Rr(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}get y(){return this.minY}get width(){return this.maxX-this.minX}get height(){return this.maxY-this.minY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,s){let r=this.minX,n=this.minY,o=this.maxX,a=this.maxY;const h=this.matrix,l=h.a,c=h.b,u=h.c,d=h.d,f=h.tx,_=h.ty;for(let m=e;m<s;m+=2){const p=t[m],x=t[m+1],y=l*p+u*x+f,b=c*p+d*x+_;r=y<r?y:r,n=b<n?b:n,o=y>o?y:o,a=b>a?b:a}this.minX=r,this.minY=n,this.maxX=o,this.maxY=a}toString(){return`[@pixi:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}}function aa(i){if(typeof i=="string")return i;let t=(i|0).toString(16);return t="000000".substring(0,6-t.length)+t,`#${t}`}class Gn extends jc{constructor(t){super(t),this.type="image",this.alphaMode=t.alphaMode??0}}const Vn=Gt.ADAPTER.createCanvas(),zi=1;Vn.width=zi;Vn.height=zi;const ni=Vn.getContext("2d");ni.fillStyle="#ffffff";ni.fillRect(0,0,zi,zi);ni.beginPath();ni.moveTo(0,0);ni.lineTo(zi,0);ni.lineTo(zi,zi);ni.closePath();ni.fillStyle="#ffffff";ni.fill();H.WHITE=new H({source:new Gn({resource:Vn})});H.WHITE.label="WHITE";H.WHITE.destroy=gn;let ap=0;const ha=class{constructor(i,t,e,s){this.uid=ap++,this.type="linear",this.gradientStops=[],this.x0=i,this.y0=t,this.x1=e,this.y1=s}addColorStop(i,t){return t=aa(t),this.gradientStops.push({offset:i,color:t}),this}buildLinearGradient(){const i=ha.defaultTextureSize,{gradientStops:t}=this,e=Gt.ADAPTER.createCanvas();e.width=i,e.height=i;const s=e.getContext("2d"),r=s.createLinearGradient(0,0,ha.defaultTextureSize,1);for(let _=0;_<t.length;_++){const m=t[_];r.addColorStop(m.offset,m.color)}s.fillStyle=r,s.fillRect(0,0,i,i),this.texture=new H({source:new Gn({resource:e}),style:{addressModeU:"clamp-to-edge",addressModeV:"repeat"}});const{x0:n,y0:o,x1:a,y1:h}=this,l=new J,c=a-n,u=h-o,d=Math.sqrt(c*c+u*u),f=Math.atan2(u,c);l.translate(-n,-o),l.scale(1/i,1/i),l.rotate(-f),l.scale(256/d,1),this.transform=l}};let cr=ha;cr.defaultTextureSize=256;const Nh={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};let hp=0;class eh{constructor(t,e){this.uid=hp++,this.transform=new J,this.texture=t,this.repetition=e,this.transform.scale(1/t.frameWidth,1/t.frameHeight),e&&(t.style.addressModeU=Nh[e].addressModeU,t.style.addressModeV=Nh[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frameWidth,1/e.frameHeight)}}const lp={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0};function cp(i,t){var h;const e=i.match(/[a-df-z][^a-df-z]*/gi),s=(h=i.match(/[+-]?\d*\.?\d+(?:[eE][+-]?\d+)?/g))==null?void 0:h.map(parseFloat),r=[];e.forEach(l=>{var f;const c=(f=l.match(/[+-]?\d*\.?\d+(?:[eE][+-]?\d+)?/g))==null?void 0:f.map(parseFloat),u=l[0];let d=1;c&&(d=c.length/lp[u.toLowerCase()]);for(let _=0;_<d;_++)r.push(u)});let n=0,o=0,a=0;for(let l=0;l<r.length;l++){const c=r[l];switch(c){case"M":o=s[n++],a=s[n++],t.moveTo(o,a);break;case"m":o+=s[n++],a+=s[n++],t.moveTo(o,a);break;case"H":o=s[n++],t.lineTo(o,a);break;case"h":o+=s[n++],t.lineTo(o,a);break;case"V":a=s[n++],t.lineTo(o,a);break;case"v":a+=s[n++],t.lineTo(o,a);break;case"L":o=s[n++],a=s[n++],t.lineTo(o,a);break;case"l":o+=s[n++],a+=s[n++],t.lineTo(o,a);break;case"C":o=s[n+4],a=s[n+5],t.bezierCurveTo(s[n],s[n+1],s[n+2],s[n+3],o,a),n+=6;break;case"c":t.bezierCurveTo(o+s[n],a+s[n+1],o+s[n+2],a+s[n+3],o+s[n+4],a+s[n+5]),o+=s[n+4],a+=s[n+5],n+=6;break;case"S":o=s[n+2],a=s[n+3],t.bezierCurveToShort(s[n],s[n+1],o,a),n+=4;break;case"s":t.bezierCurveToShort(o+s[n],a+s[n+1],o+s[n+2],a+s[n+3]),o+=s[n+2],a+=s[n+3],n+=4;break;case"Q":o=s[n+2],a=s[n+3],t.quadraticCurveTo(s[n],s[n+1],o,a),n+=4;break;case"q":t.quadraticCurveTo(o+s[n],a+s[n+1],o+s[n+2],a+s[n+3]),o+=s[n+2],a+=s[n+3],n+=4;break;case"T":o=s[n++],a=s[n++],t.quadraticCurveToShort(o,a);break;case"t":o+=s[n++],a+=s[n++],t.quadraticCurveToShort(o,a);break;case"A":o=s[n+5],a=s[n+6],t.arcToSvg(s[n],s[n+1],s[n+2],s[n+3],s[n+4],o,a),n+=7;break;case"a":o+=s[n+5],a+=s[n+6],t.arcToSvg(s[n],s[n+1],s[n+2],s[n+3],s[n+4],o,a),n+=7;break;case"Z":case"z":t.closePath();break;default:console.warn(`Unknown SVG path command: ${c}`)}}return t}class ih{constructor(t=0,e=0,s=0){this.type="circle",this.x=t,this.y=e,this.radius=s}clone(){return new ih(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const s=this.radius*this.radius;let r=this.x-t,n=this.y-e;return r*=r,n*=n,r+n<=s}getBounds(t){return t=t||new me,t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class sh{constructor(t=0,e=0,s=0,r=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=s,this.halfHeight=r}clone(){return new sh(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let s=(t-this.x)/this.halfWidth,r=(e-this.y)/this.halfHeight;return s*=s,r*=r,s+r<=1}getBounds(){return new me(this.x-this.halfWidth,this.y-this.halfHeight,this.halfWidth*2,this.halfHeight*2)}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.halfWidth} height=${this.halfHeight}]`}}class ys{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const s=[];for(let r=0,n=e.length;r<n;r++)s.push(e[r].x,e[r].y);e=s}this.points=e,this.closePath=!0}clone(){const t=this.points.slice(),e=new ys(t);return e.closePath=this.closePath,e}contains(t,e){let s=!1;const r=this.points.length/2;for(let n=0,o=r-1;n<r;o=n++){const a=this.points[n*2],h=this.points[n*2+1],l=this.points[o*2],c=this.points[o*2+1];h>e!=c>e&&t<(l-a)*((e-h)/(c-h))+a&&(s=!s)}return s}getBounds(t){t=t||new me;const e=this.points;let s=1/0,r=-1/0,n=1/0,o=-1/0;for(let a=0,h=e.length;a<h;a+=2){const l=e[a],c=e[a+1];s=l<s?l:s,r=l>r?l:r,n=c<n?c:n,o=c>o?c:o}return t.x=s,t.width=r-s,t.y=n,t.height=o-n,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[@pixi/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return this.points[this.points.length-2]}get y(){return this.points[this.points.length-1]}}class rh{constructor(t=0,e=0,s=0,r=0,n=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=s,this.height=r,this.radius=n}getBounds(t){return t=t||new me,t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new rh(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+s&&e<=this.y+this.height-s||t>=this.x+s&&t<=this.x+this.width-s)return!0;let r=t-(this.x+s),n=e-(this.y+s);const o=s*s;if(r*r+n*n<=o||(r=t-(this.x+this.width-s),r*r+n*n<=o)||(n=e-(this.y+this.height-s),r*r+n*n<=o)||(r=t-(this.x+s),r*r+n*n<=o))return!0}return!1}toString(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const up=8,Gr=11920929e-14,dp=1;function qc(i,t,e,s,r,n,o,a,h){let c=dp/1;return c*=c,fp(t,e,s,r,n,o,a,h,i,c),i}function fp(i,t,e,s,r,n,o,a,h,l){la(i,t,e,s,r,n,o,a,h,l,0),h.push(o,a)}function la(i,t,e,s,r,n,o,a,h,l,c){if(c>up)return;const u=(i+e)/2,d=(t+s)/2,f=(e+r)/2,_=(s+n)/2,m=(r+o)/2,p=(n+a)/2,x=(u+f)/2,y=(d+_)/2,b=(f+m)/2,v=(_+p)/2,w=(x+b)/2,C=(y+v)/2;if(c>0){let A=o-i,T=a-t;const S=Math.abs((e-o)*T-(s-a)*A),M=Math.abs((r-o)*T-(n-a)*A);if(S>Gr&&M>Gr){if((S+M)*(S+M)<=l*(A*A+T*T)){h.push(w,C);return}}else if(S>Gr){if(S*S<=l*(A*A+T*T)){h.push(w,C);return}}else if(M>Gr){if(M*M<=l*(A*A+T*T)){h.push(w,C);return}}else if(A=w-(i+o)/2,T=C-(t+a)/2,A*A+T*T<=l){h.push(w,C);return}}la(i,t,u,d,x,y,w,C,h,l,c+1),la(w,C,b,v,m,p,o,a,h,l,c+1)}const pp=8,_p=11920929e-14,mp=1;function gp(i,t,e,s,r,n,o){let h=mp/1;return h*=h,yp(t,e,s,r,n,o,i,h),i}function yp(i,t,e,s,r,n,o,a){ca(o,i,t,e,s,r,n,a,0),o.push(r,n)}function ca(i,t,e,s,r,n,o,a,h){if(h>pp)return;const l=(t+s)/2,c=(e+r)/2,u=(s+n)/2,d=(r+o)/2,f=(l+u)/2,_=(c+d)/2;let m=n-t,p=o-e;const x=Math.abs((s-n)*p-(r-o)*m);if(x>_p){if(x*x<=a*(m*m+p*p)){i.push(f,_);return}}else if(m=f-(t+n)/2,p=_-(e+o)/2,m*m+p*p<=a){i.push(f,_);return}ca(i,t,e,l,c,f,_,a,h+1),ca(i,f,_,u,d,n,o,a,h+1)}function Kc(i,t,e,s,r,n,o,a){let h=Math.abs(r-n);(!o&&r>n||o&&n>r)&&(h=2*Math.PI-h),a=a||Math.max(6,Math.floor(6*Math.pow(s,1/3)*(h/Math.PI))),a=Math.max(a,3);let l=h/a,c=r;l*=o?-1:1;for(let u=0;u<a+1;u++){const d=Math.cos(c),f=Math.sin(c),_=t+d*s,m=e+f*s;i.push(_,m),c+=l}}function bp(i,t,e,s,r,n){const o=i[i.length-2],h=i[i.length-1]-e,l=o-t,c=r-e,u=s-t,d=Math.abs(h*u-l*c);if(d<1e-8||n===0){(i[i.length-2]!==t||i[i.length-1]!==e)&&i.push(t,e);return}const f=h*h+l*l,_=c*c+u*u,m=h*c+l*u,p=n*Math.sqrt(f)/d,x=n*Math.sqrt(_)/d,y=p*m/f,b=x*m/_,v=p*u+x*l,w=p*c+x*h,C=l*(x+y),A=h*(x+y),T=u*(p+b),S=c*(p+b),M=Math.atan2(A-w,C-v),L=Math.atan2(S-w,T-v);Kc(i,v+t,w+e,n,M,L,l*c>u*h)}const er=Math.PI*2,uo={centerX:0,centerY:0,ang1:0,ang2:0},fo=({x:i,y:t},e,s,r,n,o,a,h)=>{i*=e,t*=s;const l=r*i-n*t,c=n*i+r*t;return h.x=l+o,h.y=c+a,h};function xp(i,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),s=t===1.5707963267948966?.551915024494:e,r=Math.cos(i),n=Math.sin(i),o=Math.cos(i+t),a=Math.sin(i+t);return[{x:r-n*s,y:n+r*s},{x:o+a*s,y:a-o*s},{x:o,y:a}]}const Uh=(i,t,e,s)=>{const r=i*s-t*e<0?-1:1;let n=i*e+t*s;return n>1&&(n=1),n<-1&&(n=-1),r*Math.acos(n)},vp=(i,t,e,s,r,n,o,a,h,l,c,u,d)=>{const f=Math.pow(r,2),_=Math.pow(n,2),m=Math.pow(c,2),p=Math.pow(u,2);let x=f*_-f*p-_*m;x<0&&(x=0),x/=f*p+_*m,x=Math.sqrt(x)*(o===a?-1:1);const y=x*r/n*u,b=x*-n/r*c,v=l*y-h*b+(i+e)/2,w=h*y+l*b+(t+s)/2,C=(c-y)/r,A=(u-b)/n,T=(-c-y)/r,S=(-u-b)/n,M=Uh(1,0,C,A);let L=Uh(C,A,T,S);a===0&&L>0&&(L-=er),a===1&&L<0&&(L+=er),d.centerX=v,d.centerY=w,d.ang1=M,d.ang2=L};function wp(i,t,e,s,r,n,o,a=0,h=0,l=0){if(n===0||o===0)return;const c=Math.sin(a*er/360),u=Math.cos(a*er/360),d=u*(t-s)/2+c*(e-r)/2,f=-c*(t-s)/2+u*(e-r)/2;if(d===0&&f===0)return;n=Math.abs(n),o=Math.abs(o);const _=Math.pow(d,2)/Math.pow(n,2)+Math.pow(f,2)/Math.pow(o,2);_>1&&(n*=Math.sqrt(_),o*=Math.sqrt(_)),vp(t,e,s,r,n,o,h,l,c,u,d,f,uo);let{ang1:m,ang2:p}=uo;const{centerX:x,centerY:y}=uo;let b=Math.abs(p)/(er/4);Math.abs(1-b)<1e-7&&(b=1);const v=Math.max(Math.ceil(b),1);p/=v;let w=i[i.length-2],C=i[i.length-1];const A={x:0,y:0};for(let T=0;T<v;T++){const S=xp(m,p),{x:M,y:L}=fo(S[0],n,o,u,c,x,y,A),{x:Q,y:K}=fo(S[1],n,o,u,c,x,y,A),{x:Z,y:W}=fo(S[2],n,o,u,c,x,y,A);qc(i,w,C,M,L,Q,K,Z,W),w=Z,C=W,m+=p}}const Tp=new me;class Cp{constructor(t){this.shapePrimitives=[],this.currentPoly=null,this._bounds=new Rr,this.graphicsPath2D=t}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const s=this.currentPoly.points,r=s[s.length-2],n=s[s.length-1];return(r!==t||n!==e)&&s.push(t,e),this}arc(t,e,s,r,n,o){this._ensurePoly(!1);const a=this.currentPoly.points;return Kc(a,t,e,s,r,n,o),this}arcTo(t,e,s,r,n){this._ensurePoly();const o=this.currentPoly.points;return bp(o,t,e,s,r,n),this}arcToSvg(t,e,s,r,n,o,a){const h=this.currentPoly.points;return wp(h,this.currentPoly.lastX,this.currentPoly.lastY,o,a,t,e,s,r,n),this}bezierCurveTo(t,e,s,r,n,o){this._ensurePoly();const a=this.currentPoly;return qc(this.currentPoly.points,a.lastX,a.lastY,t,e,s,r,n,o),this}quadraticCurveTo(t,e,s,r){this._ensurePoly();const n=this.currentPoly;return gp(this.currentPoly.points,n.lastX,n.lastY,t,e,s,r),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));for(let s=0;s<t.instructions.length;s++){const r=t.instructions[s];this[r.action](...r.data)}return this}finish(t=!1){this.endPoly(t)}rect(t,e,s,r,n){return this.drawShape(new me(t,e,s,r),n),this}circle(t,e,s,r){return this.drawShape(new ih(t,e,s),r),this}poly(t,e,s){const r=new ys(t);r.closePath=e,this.drawShape(r,s)}ellipse(t,e,s,r,n){return this.drawShape(new sh(t,e,s,r),n),this}roundRect(t,e,s,r,n,o){return this.drawShape(new rh(t,e,s,r,n),o),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let s=this.currentPoly;return s&&this.endPoly(),s=new ys,s.points.push(t,e),this.currentPoly=s,this}endPoly(t=!1){const e=this.currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this.currentPoly=null,this}_ensurePoly(t=!0){if(!this.currentPoly&&(this.currentPoly=new ys,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let s=e.shape.x,r=e.shape.y;if(e.transform.isIdentity()){const n=e.transform,o=s;s=n.a*s+n.c*r+n.tx,r=n.b*o+n.d*r+n.ty}this.currentPoly.points.push(s,s)}else this.currentPoly.points.push(0,0)}}buildPath(){const t=this.graphicsPath2D;this.shapePrimitives.length=0,this.currentPoly=null;for(let e=0;e<t.instructions.length;e++){const s=t.instructions[e];this[s.action](...s.data)}this.finish()}isPointInPath(t,e){const s=this.shapePrimitives;for(let r=0;r<s.length;r++)if(s[r].shape.contains(t,e))return!0;return!1}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let s=0;s<e.length;s++){const r=e[s],n=r.shape.getBounds(Tp);r.transform?(t.pushMatrix(r.transform),t.addRect(n),t.popMatrix()):t.addRect(n)}return t}}let Sp=0;class As{constructor(t){this.instructions=[],this.uid=Sp++,this.dirty=!0,typeof t=="string"?cp(t,this):this.instructions=(t==null?void 0:t.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new Cp(this)),this.dirty&&(this.dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this.dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this.dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this.dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this.dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this.dirty=!0,this}bezierCurveToShort(t,e,s,r){const n=this.instructions[this.instructions.length-1],o=this.getLastPoint(Ut.shared);let a=0,h=0;if(!n||n.action!=="bezierCurveTo")a=o.x,h=o.y;else{a=n.data[2],h=n.data[3];const l=o.x,c=o.y;a=l+(l-a),h=c+(c-h)}return this.instructions.push({action:"bezierCurveTo",data:[a,h,t,e,s,r]}),this.dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this.dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this.dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this.dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this.dirty=!0,this}quadraticCurveToShort(t,e){const s=this.instructions[this.instructions.length-1],r=this.getLastPoint(Ut.shared);let n=0,o=0;if(!s||s.action!=="quadraticCurveTo")n=r.x,o=r.y;else{n=s.data[0],o=s.data[1];const a=r.x,h=r.y;n=a+(a-n),o=h+(h-o)}return this.instructions.push({action:"quadraticCurveTo",data:[n,o,t,e]}),this.dirty=!0,this}rect(t,e,s,r,n){return this.instructions.push({action:"rect",data:[t,e,s,r,n]}),this.dirty=!0,this}circle(t,e,s,r){return this.instructions.push({action:"circle",data:[t,e,s,r]}),this.dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this.dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this.dirty=!0,this}star(t,e,s,r,n,o=0,a){n=n||r/2;const h=-1*Math.PI/2+o,l=s*2,c=Math.PI*2/l,u=[];for(let d=0;d<l;d++){const f=d%2?n:r,_=d*c+h;u.push(t+f*Math.cos(_),e+f*Math.sin(_))}return this.poly(u,!0,a),this}clone(t=!1){const e=new As;if(!t)e.instructions=this.instructions.slice();else for(let s=0;s<this.instructions.length;s++){const r=this.instructions[s];e.instructions.push({action:r.action,data:r.data.slice()})}return e}getLastPoint(t){let e=this.instructions.length-1,s=this.instructions[e];if(!s)return t.x=0,t.y=0,t;for(;s.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;s=this.instructions[e]}let r,n,o;switch(s.action){case"moveTo":case"lineTo":t.x=s.data[0],t.y=s.data[1];break;case"quadraticCurveTo":t.x=s.data[2],t.y=s.data[3];break;case"bezierCurveTo":t.x=s.data[4],t.y=s.data[5];break;case"arc":case"arcToSvg":t.x=s.data[5],t.y=s.data[6];break;case"addPath":t.x=s.data[0].lastX,t.y=s.data[2].lastY;break;case"rect":if(o=s.data[4],r=s.data[0],n=s.data[1],o){const{a,b:h,c:l,d:c,tx:u,ty:d}=o;t.x=a*r+l*n+u,t.y=h*r+c*n+d}else t.x=r,t.y=n;break;default:console.warn(`${s.action} is not supported yet`);break}return t}clear(){return this.instructions.length=0,this.dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,s=t.b,r=t.c,n=t.d,o=t.tx,a=t.ty;let h=0,l=0,c=0,u=0,d=0,f=0,_=0,m=0;for(let p=0;p<this.instructions.length;p++){const x=this.instructions[p],y=x.data;switch(x.action){case"moveTo":case"lineTo":h=y[0],l=y[1],y[0]=e*h+r*l+o,y[1]=s*h+n*l+a;break;case"bezierCurveTo":c=y[0],u=y[1],d=y[2],f=y[3],h=y[4],l=y[5],y[0]=e*c+r*u+o,y[1]=s*c+n*u+a,y[2]=e*d+r*f+o,y[3]=s*d+n*f+a,y[4]=e*h+r*l+o,y[5]=s*h+n*l+a;break;case"quadraticCurveTo":c=y[0],u=y[1],h=y[2],l=y[3],y[0]=e*c+r*u+o,y[1]=s*c+n*u+a,y[2]=e*h+r*l+o,y[3]=s*h+n*l+a;break;case"arcToSvg":h=y[5],l=y[6],_=y[0],m=y[1],y[0]=e*_+r*m,y[1]=s*_+n*m,y[5]=e*h+r*l+o,y[6]=s*h+n*l+a;break;case"rect":y[4]=po(y[4],t);break;case"ellipse":y[8]=po(y[8],t);break;case"roundRect":y[5]=po(y[5],t);break;case"addPath":y[0].transform(t);break;default:console.warn("unknown transform action",x.action);break}}return this.dirty=!0,this}get bounds(){return this.shapePath.bounds}}function po(i,t){return i?i.prepend(t):t.clone()}function Ap(i,t){if(typeof i=="string"){const s=document.createElement("div");s.innerHTML=i.trim(),i=s.querySelector("svg")}const e={context:t,path:new As};return Zc(i,e,null,null),t}function Zc(i,t,e,s){const r=i.children,{fillStyle:n,strokeStyle:o}=Ep(i);n&&e?e={...e,...n}:n&&(e=n),o&&s?s={...s,...o}:o&&(s=o),t.context.fillStyle=e,t.context.strokeStyle=s;let a,h,l,c,u,d,f,_,m,p,x,y,b,v,w,C,A;switch(i.nodeName.toLowerCase()){case"path":v=i.getAttribute("d"),w=new As(v),t.context.path(w),e&&t.context.fill(),s&&t.context.stroke();break;case"circle":f=Ct(i,"cx",0),_=Ct(i,"cy",0),m=Ct(i,"r",0),t.context.ellipse(f,_,m,m),e&&t.context.fill(),s&&t.context.stroke();break;case"rect":a=Ct(i,"x",0),h=Ct(i,"y",0),C=Ct(i,"width",0),A=Ct(i,"height",0),p=Ct(i,"rx",0),x=Ct(i,"ry",0),p||x?t.context.roundRect(a,h,C,A,p||x):t.context.rect(a,h,C,A),e&&t.context.fill(),s&&t.context.stroke();break;case"ellipse":f=Ct(i,"cx",0),_=Ct(i,"cy",0),p=Ct(i,"rx",0),x=Ct(i,"ry",0),t.context.beginPath(),t.context.ellipse(f,_,p,x),e&&t.context.fill(),s&&t.context.stroke();break;case"line":l=Ct(i,"x1",0),c=Ct(i,"y1",0),u=Ct(i,"x2",0),d=Ct(i,"y2",0),t.context.beginPath(),t.context.moveTo(l,c),t.context.lineTo(u,d),s&&t.context.stroke();break;case"polygon":b=i.getAttribute("points"),y=b.match(/\d+/g).map(T=>parseInt(T,10)),t.context.poly(y,!0),e&&t.context.fill(),s&&t.context.stroke();break;case"polyline":b=i.getAttribute("points"),y=b.match(/\d+/g).map(T=>parseInt(T,10)),t.context.poly(y,!1),s&&t.context.stroke();break;case"g":case"svg":break;default:{console.info(`[SVG parser] <${i.nodeName}> elements unsupported`);break}}for(let T=0;T<r.length;T++)Zc(r[T],t,e,s)}function Ct(i,t,e){const s=i.getAttribute(t);return s?Number(s):e}function Ep(i){const t=i.getAttribute("style"),e={},s={};let r=!1,n=!1;if(t){const o=t.split(";");for(let a=0;a<o.length;a++){const h=o[a],[l,c]=h.split(":");switch(l){case"stroke":c!=="none"&&(e.color=Ze(c),n=!0);break;case"stroke-width":e.width=Number(c);break;case"fill":c!=="none"&&(r=!0,s.color=Ze(c));break;case"fill-opacity":s.alpha=Number(c);break;case"stroke-opacity":e.alpha=Number(c);break;case"opacity":s.alpha=Number(c),e.alpha=Number(c);break}}}else{const o=i.getAttribute("stroke");o&&o!=="none"&&(n=!0,e.color=Ze(o),e.width=Ct(i,"stroke-width",1));const a=i.getAttribute("fill");a&&a!=="none"&&(r=!0,s.color=Ze(a))}return{strokeStyle:n?e:null,fillStyle:r?s:null}}function yn(i,t){if(!i)return null;let e,s;if(i!=null&&i.fill?(s=i.fill,e={...t,...i}):(s=i,e=t),typeof s=="number"||typeof s=="string")return{...e,color:Ze(s),texture:H.WHITE};if(s instanceof eh){const n=s;return{...e,color:16777215,texture:n.texture,matrix:n.transform}}else if(s instanceof cr){const n=s;return n.buildLinearGradient(),{...e,color:16777215,texture:n.texture,matrix:n.transform}}const r={...t,...i};if(r.texture!==H.WHITE){const n=r.matrix||new J;n.scale(1/r.texture.frameWidth,1/r.texture.frameHeight),r.matrix=n,r.color=16777215}return r.color=Ze(r.color),r}let Pp=0;const Qi=new Ut,Dh=new J,Mi=class extends jt{constructor(){super(...arguments),this.uid=Pp++,this.usage=0,this.dirty=!0,this.batchMode="auto",this.instructions=[],this.activePath=new As,this._transform=new J,this._fillStyle={...Mi.defaultFillStyle},this._fillStyleOriginal=16777215,this._strokeStyle={...Mi.defaultStrokeStyle},this._strokeStyleOriginal=16777215,this._stateStack=[],this._tick=0,this._bounds=new Rr,this.boundsDirty=!0}set fillStyle(i){if(this._fillStyleOriginal!==i)if(this._fillStyleOriginal=i,typeof i=="number"||typeof i=="string")this._fillStyle.color=Ze(i),this._fillStyle.texture=H.WHITE;else if(i instanceof eh){const t=i;this._fillStyle.color=16777215,this._fillStyle.texture=t.texture,this._fillStyle.matrix=t.transform}else if(i instanceof cr){const t=i;t.buildLinearGradient(),this._fillStyle.color=16777215,this._fillStyle.texture=t.texture,this._fillStyle.matrix=t.transform}else this._fillStyle={...Mi.defaultFillStyle,...i}}get fillStyle(){return this._fillStyleOriginal}set strokeStyle(i){if(this._strokeStyleOriginal!==i)if(this._strokeStyleOriginal=i,typeof i=="number"||typeof i=="string")this._strokeStyle.color=Ze(i),this._strokeStyle.texture=H.WHITE;else if(i instanceof cr){const t=i;t.buildLinearGradient(),this._strokeStyle.color=16777215,this._strokeStyle.texture=t.texture,this._strokeStyle.matrix=t.transform}else this._strokeStyle={...Mi.defaultStrokeStyle,...i}}get strokeStyle(){return this._strokeStyleOriginal}setFillStyle(i){return this.fillStyle=i,this}setStrokeStyle(i){return this.strokeStyle=i,this}texture(i,t,e,s,r,n){return this.instructions.push({action:"texture",data:{image:i,dx:e||0,dy:s||0,dw:r||i.frameWidth,dh:n||i.frameHeight,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:t||16777215}}),this.onUpdate(),this}beginPath(){return this.activePath=new As,this}fill(i){let t;const e=this.instructions[this.instructions.length-1];if(this._tick===0&&e&&e.action==="stroke"?t=e.data.path:t=this.activePath.clone(),!t)return this;let s=this._fillStyle;return i&&(s=yn(i,Mi.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:s,path:t}}),this.onUpdate(),this.activePath.instructions.length=0,this._tick=0,this}stroke(i){let t;const e=this.instructions[this.instructions.length-1];if(this._tick===0&&e&&e.action==="fill"?t=e.data.path:t=this.activePath.clone(),!t)return this;let s=this._strokeStyle;return i&&(s=yn(i,Mi.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:s,path:t}}),this.onUpdate(),this.activePath.instructions.length=0,this._tick=0,this}cut(){for(let i=0;i<2;i++){const t=this.instructions[this.instructions.length-1-i],e=this.activePath.clone();t&&(t.action==="stroke"||t.action==="fill")&&(t.data.hole=e)}return this.activePath.instructions.length=0,this}arc(i,t,e,s,r,n){this._tick++;const o=this._transform;return this.activePath.arc(o.a*i+o.c*t+o.tx,o.b*i+o.d*t+o.ty,e,s,r,n),this}arcTo(i,t,e,s,r){this._tick++;const n=this._transform;return this.activePath.arcTo(n.a*i+n.c*t+n.tx,n.b*i+n.d*t+n.ty,n.a*e+n.c*s+n.tx,n.b*e+n.d*s+n.ty,r),this}arcToSvg(i,t,e,s,r,n,o){this._tick++;const a=this._transform;return this.activePath.arcToSvg(i,t,e,s,r,a.a*n+a.c*o+a.tx,a.b*n+a.d*o+a.ty),this}bezierCurveTo(i,t,e,s,r,n){this._tick++;const o=this._transform;return this.activePath.bezierCurveTo(o.a*i+o.c*t+o.tx,o.b*i+o.d*t+o.ty,o.a*e+o.c*s+o.tx,o.b*e+o.d*s+o.ty,o.a*r+o.c*n+o.tx,o.b*r+o.d*n+o.ty),this}closePath(){var i;return this._tick++,(i=this.activePath)==null||i.closePath(),this}ellipse(i,t,e,s){return this._tick++,this.activePath.ellipse(i,t,e,s,this._transform.clone()),this}circle(i,t,e){return this._tick++,this.activePath.circle(i,t,e,this._transform.clone()),this}path(i){return this._tick++,this.activePath.addPath(i,this._transform.clone()),this}lineTo(i,t){this._tick++;const e=this._transform;return this.activePath.lineTo(e.a*i+e.c*t+e.tx,e.b*i+e.d*t+e.ty),this}moveTo(i,t){this._tick++;const e=this._transform;return this.activePath.moveTo(e.a*i+e.c*t+e.tx,e.b*i+e.d*t+e.ty),this}quadraticCurveTo(i,t,e,s){this._tick++;const r=this._transform;this.activePath.quadraticCurveTo(r.a*i+r.c*t+r.tx,r.b*i+r.d*t+r.ty,r.a*e+r.c*s+r.tx,r.b*e+r.d*s+r.ty)}rect(i,t,e,s){return this._tick++,this.activePath.rect(i,t,e,s,this._transform.clone()),this}roundRect(i,t,e,s,r){return this._tick++,this.activePath.roundRect(i,t,e,s,r,this._transform.clone()),this}poly(i,t){return this._tick++,this.activePath.poly(i,t,this._transform.clone()),this}star(i,t,e,s,r,n){return this._tick++,this.activePath.star(i,t,e,s,r,n,this._transform.clone()),this}svg(i){this._tick++,Ap(i,this)}restore(){const i=this._stateStack.pop();i&&(this._transform=i.transform,this._fillStyle=i.fillStyle,this._strokeStyle=i.strokeStyle)}save(){this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}})}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(i){return this._transform.rotate(i),this}scale(i,t=i){return this._transform.scale(i,t),this}setTransform(i,t,e,s,r,n){return i instanceof J?(this._transform.set(i.a,i.b,i.c,i.d,i.tx,i.ty),this):(this._transform.set(i,t,e,s,r,n),this)}transform(i,t,e,s,r,n){return i instanceof J?(this._transform.append(i),this):(Dh.set(i,t,e,s,r,n),this._transform.append(Dh),this)}translate(i,t){return this._transform.translate(i,t),this}clear(){return this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this.dirty||(this.emit("update",this,16),this.dirty=!0,this.boundsDirty=!0)}get bounds(){if(!this.boundsDirty)return this._bounds;const i=this._bounds;i.clear();for(let t=0;t<this.instructions.length;t++){const e=this.instructions[t],s=e.action;if(s==="fill"){const r=e.data;i.addBounds(r.path.bounds)}else if(s==="texture"){const r=e.data;i.pushMatrix(r.transform),i.addFrame(r.dx,r.dy,r.dx+r.dw,r.dy+r.dh),i.popMatrix()}}return i}containsPoint(i){const t=this.instructions;let e=!1;return t.forEach(s=>{var h;const r=s.data,n=r.path;if(!s.action||!n)return;const o=r.style,a=(h=n.shapePath)==null?void 0:h.shapePrimitives;this._forEachShape(a,l=>{var d;if(!o||!l)return;typeof o!="number"&&o.matrix?o.matrix.applyInverse(i,Qi):Qi.copyFrom(i),e=l.contains(Qi.x,Qi.y);const c=r.hole;if(!c)return;const u=(d=c.shapePath)==null?void 0:d.shapePrimitives;u&&this._forEachShape(u,f=>{f.contains(Qi.x,Qi.y)&&(e=!1)})})}),e}_forEachShape(i,t){i==null||i.forEach(e=>{const s=e==null?void 0:e.shape;s&&t(s)})}destroy(i=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof i=="boolean"?i:i==null?void 0:i.texture){const e=typeof i=="boolean"?i:i==null?void 0:i.textureSource;this._fillStyle.texture&&this._fillStyle.texture.destroy(e),this._strokeStyle.texture&&this._strokeStyle.texture.destroy(e)}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this.activePath=null,this._bounds=null,this._stateStack=null,this.transformMatrix=null,this.customShader=null,this._transform=null}};let Wi=Mi;Wi.defaultFillStyle={color:0,alpha:1,texture:H.WHITE};Wi.defaultStrokeStyle={width:1,color:0,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:H.WHITE};function Ip(i,t=1){var s;const e=(s=Gt.RETINA_PREFIX)==null?void 0:s.exec(i);return e?parseFloat(e[1]):t}let Gh=0,_o;const Mp="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",Rp={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${Mp}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},kp={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let mo,Bp=class{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const e=URL.createObjectURL(new Blob([Rp.code],{type:"application/javascript"})),s=new Worker(e);s.addEventListener("message",r=>{s.terminate(),URL.revokeObjectURL(e),t(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){_o===void 0&&(_o=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<_o&&(mo||(mo=URL.createObjectURL(new Blob([kp.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(mo),t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const s=new Promise((r,n)=>{this.queue.push({id:t,arguments:e,resolve:r,reject:n})});return this.next(),s}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),s=e.id;this.resolveHash[Gh]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:Gh++,id:s})}};const Vh=new Bp;function Lp(i,t,e){return new H({source:i,label:e})}const Op=[".jpeg",".jpg",".png",".webp",".avif"],Fp=["image/jpeg","image/png","image/webp","image/avif"];async function Np(i){const t=await Gt.ADAPTER.fetch(i);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${i}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const Up={name:"loadTextures",extension:{type:Oe.LoadParser,priority:Hc.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(i){return np(i,Fp)||op(i,Op)},async load(i,t,e){var n;let s=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Vh.isImageBitmapSupported()?s=await Vh.loadImageBitmap(i):s=await Np(i):s=await new Promise(o=>{s=new Image,s.crossOrigin=this.config.crossOrigin,s.src=i,s.complete?o(s):s.onload=()=>{o(s)}});const r=new Gn({resource:s,resolution:((n=t.data)==null?void 0:n.resolution)||Ip(i),...t.data});return Lp(r,e,i)},unload(i){i.destroy(!0)}},Dp={extension:Oe.ResolveParser,test:Up.test,parse:i=>{var t;return{resolution:parseFloat(((t=Gt.RETINA_PREFIX.exec(i))==null?void 0:t[1])??"1"),format:i.split(".").pop(),src:i}}};let Dt=class Jc{constructor(t,e,s){this._x=e||0,this._y=s||0,this.observer=t}clone(t){return new Jc(t,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.observer.onUpdate()),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.observer.onUpdate()),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=${0} y=${0} scope=${this.observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.observer.onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.observer.onUpdate(this))}};function Gp(i,t,e){const s=i.length;let r;if(t>=s||e===0)return;e=t+e>s?s-t:e;const n=s-e;for(r=t;r<n;++r)i[r]=i[r+e];i.length=n}const Vp={removeChildren(i=0,t){const e=t??this.children.length,s=e-i,r=[];if(s>0&&s<=e){for(let n=e-1;n>=i;n--){const o=this.children[n];o&&(this.layerGroup&&this.layerGroup.removeChild(o),r.push(o),o.parent=null)}Gp(this.children,i,e);for(let n=0;n<r.length;++n)this.emit("childRemoved",r[n],this,n),r[n].emit("removed",this);return r}else if(s===0&&this.children.length===0)return r;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(i){const t=this.getChildAt(i);return this.removeChild(t)},getChildAt(i){if(i<0||i>=this.children.length)throw new Error(`getChildAt: Index (${i}) does not exist.`);return this.children[i]},setChildIndex(i,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(i),this.addChildAt(i,t)},getChildIndex(i){const t=this.children.indexOf(i);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(i,t){const{children:e}=this;if(t<0||t>e.length)throw new Error(`${i}addChildAt: The index ${t} supplied is out of bounds ${e.length}`);if(i.parent){const s=i.parent.children.indexOf(i);if(i.parent===this&&s===t)return i;s!==-1&&i.parent.children.splice(s,1)}return t===e.length?e.push(i):e.splice(t,0,i),i.parent=this,i.didChange=!0,i.didViewUpdate=!1,i.updateFlags=15,this.layerGroup&&this.layerGroup.addChild(i),this.emit("childAdded",i,this,t),i.emit("added",this),i},swapChildren(i,t){if(i===t)return;const e=this.getChildIndex(i),s=this.getChildIndex(t);this.children[e]=t,this.children[s]=i},removeFromParent(){var i;(i=this.parent)==null||i.removeChild(this)}};class $p{constructor(t){this.pipe="filter",this.priority=1,this.filters=t==null?void 0:t.filters}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null}}const Qc=[];function Hp(i){const t=Qc.pop()||new $p;return t.filters=i,t}function zp(i){i.filters=null,Qc.push(i)}class Wp{constructor(t,e){this._pool=[],this._count=0,this._debug=!1,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool.push(new this._classType);this._count+=t}get(t){var s;let e=this._pool.pop();return e||(e=new this._classType),(s=e.init)==null||s.call(e,t),e}return(t){var e;if(this._pool.indexOf(t)!==-1){this._debug&&console.warn("Object already in pool",t);return}(e=t.reset)==null||e.call(t),this._pool.push(t)}get totalSize(){return this._count}get totalFree(){return this._pool.length}get totalUsed(){return this._count-this._pool.length}}class jp{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new Wp(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const s=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[s]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}}const $h=new jp;class Xp{constructor(){this._effectClasses=[],this.tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this.tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this.tests.length;e++){const s=this.tests[e];if(s.test(t))return $h.get(s.maskClass,t)}return t}returnMaskEffect(t){$h.return(t)}}const ua=new Xp;Dn.handleByList(Oe.MaskEffect,ua._effectClasses);const Yp={_mask:null,_filters:null,set mask(i){if(this._mask||(this._mask={mask:null,effect:null}),this._mask.mask===i||(this._mask.effect&&(this.removeEffect(this._mask.effect),ua.returnMaskEffect(this._mask.effect),this._mask.effect=null),this._mask.mask=i,i==null))return;const t=ua.getMaskEffect(i);this._mask.effect=t,this.addEffect(t)},get mask(){var i;return(i=this._mask)==null?void 0:i.mask},set filters(i){if(Array.isArray(i)||(i=[i]),this._filters||(this._filters={filters:null,effect:null}),this._filters.filters===i||(this._filters.effect&&(this.removeEffect(this._filters.effect),zp(this._filters.effect),this._filters.effect=null),this._filters.filters=i,!i))return;const t=Hp(i);this._filters.effect=t,this.addEffect(t)},get filters(){var i;return(i=this._filters)==null?void 0:i.filters}},qp={getChildByLabel(i,t=!1){const e=this.children;for(let s=0;s<e.length;s++){const r=e[s];if(r.label===i||i instanceof RegExp&&i.test(r.label))return r}if(t)for(let s=0;s<e.length;s++){const n=e[s].getChildByLabel(i,!0);if(n)return n}return null},getChildrenByLabel(i,t=!1,e=[]){const s=this.children;for(let r=0;r<s.length;r++){const n=s[r];(n.label===i||i instanceof RegExp&&i.test(n.label))&&e.push(n)}if(t)for(let r=0;r<s.length;r++)s[r].getChildrenByLabel(i,!0,e);return e}};function ur(i,t){const e=t._scale,s=t._pivot,r=t.position,n=e._x,o=e._y,a=s._x,h=s._y;i.a=t._cx*n,i.b=t._sx*n,i.c=t._cy*o,i.d=t._sy*o,i.tx=r._x-(a*i.a+h*i.c),i.ty=r._y-(a*i.b+h*i.d)}function Kp(i,t,e){e.clear();let s;return i.parent?t?s=i.parent.worldTransform:s=bn(i,new J):s=J.IDENTITY,tu(i,e,s,t),e.isValid||e.set(0,0,0,0),e}function tu(i,t,e,s){var n,o;if(!i.visible||!i.measurable)return;let r;s?r=i.worldTransform:(i.didChange&&ur(i.localTransform,i),r=J.shared.appendFrom(i.localTransform,e).clone()),i.view&&(t.setMatrix(r),i.view.addBounds(t));for(let a=0;a<i.children.length;a++)tu(i.children[a],t,r,s);for(let a=0;a<i.effects.length;a++)(o=(n=i.effects[a]).addBounds)==null||o.call(n,t)}function bn(i,t){const e=i.parent;return e&&(bn(e,t),e.didChange&&ur(e.localTransform,e),t.append(e.localTransform)),t}function Gs(i,t,e){t.clear(),e||(e=new J),i.view&&(t.setMatrix(e),i.view.addBounds(t));for(let s=0;s<i.children.length;s++)eu(i.children[s],t,e,i);return t.isValid||t.set(0,0,0,0),t}function eu(i,t,e,s){var o,a;if(!i.visible||!i.measurable)return;i.didChange&&ur(i.localTransform,i);const r=i.localTransform,n=J.shared.appendFrom(r,e).clone();i.view&&(t.setMatrix(n),i.view.addBounds(t));for(let h=0;h<i.children.length;h++)eu(i.children[h],t,n,s);for(let h=0;h<i.effects.length;h++)(a=(o=i.effects[h]).addLocalBounds)==null||a.call(o,t,s)}const ts=new Rr,Vr=new J,Zp={get width(){return this.scale.x*Gs(this,ts,Vr).width},set width(i){this.scale.x=i/Gs(this,ts,Vr).width},get height(){return this.scale.y*Gs(this,ts,Vr).height},set height(i){this.scale.y=i/Gs(this,ts,Vr).height},getLocalBounds(){return Gs(this,ts,this.localTransform).rectangle},getBounds(i){return Kp(this,i,ts).rectangle}},Jp={_onRender:null,set onRender(i){const t=this.layerGroup;if(!i){this._onRender&&(t==null||t.removeOnRender(this)),this._onRender=null;return}this._onRender||t==null||t.addOnRender(this),this._onRender=i},get onRender(){return this._onRender}},Qp={getGlobalPosition(i=new Ut,t=!1){return this.parent?this.parent.toGlobal(this.position,i,t):(i.x=this.position.x,i.y=this.position.y),i},toGlobal(i,t,e=!1){if(!e){this.didChange&&ur(this.localTransform,this);const s=bn(this,new J);return s.append(this.localTransform),s.apply(i,t)}return this.worldTransform.apply(i,t)},toLocal(i,t,e,s){if(t&&(i=t.toGlobal(i,e,s)),!s){this.didChange&&ur(this.localTransform,this);const r=bn(this,new J);return r.append(this.localTransform),r.applyInverse(i,e)}return this.worldTransform.applyInverse(i,e)}};let t_=0;class e_{constructor(){this.uid=t_++,this.instructions=[],this.instructionSize=0}reset(){this.instructionSize=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}lastInstruction(){return this.instructions[this.instructionSize-1]}}class i_ extends jt{constructor({original:t,view:e}){super(),this.uid=r_(),this.view=e,this.original=t,this.layerTransform=new J,this.layerColor=4294967295,this.layerVisibleRenderable=3,this.view.owner=this}get layerBlendMode(){return this.original.layerBlendMode}onViewUpdate(){this.didViewUpdate=!0,this.original.layerGroup.onChildViewUpdate(this)}get isRenderable(){return this.original.isRenderable}}class s_{constructor(t){this.type="layer",this.root=null,this.rootRenderable=null,this.canBundle=!1,this.layerGroupParent=null,this.layerGroupChildren=[],this.children=[],this.worldTransform=new J,this.worldColor=4294967295,this.childrenToUpdate={},this.updateTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new e_,this.onRenderContainers=[],this.root=t;const e=t.view;e&&(this.proxyRenderable=new i_({original:t,view:e})),this.addChild(t)}get localTransform(){return this.root.localTransform}get layerTransform(){return this.root.layerTransform}addLayerGroupChild(t){t.layerGroupParent&&t.layerGroupParent.removeLayerGroupChild(t),t.layerGroupParent=this,this.onChildUpdate(t.root),this.layerGroupChildren.push(t)}removeLayerGroupChild(t){t.root.didChange&&this.removeChildFromUpdate(t.root);const e=this.layerGroupChildren.indexOf(t);e>-1&&this.layerGroupChildren.splice(e,1),t.layerGroupParent=null}addChild(t){if(this.structureDidChange=!0,t!==this.root&&(this.children.push(t),t.updateTick=-1,t.parent===this.root?t.relativeLayerDepth=1:t.relativeLayerDepth=t.parent.relativeLayerDepth+1,t._onRender&&this.addOnRender(t)),t.layerGroup){if(t.layerGroup.root===t){this.addLayerGroupChild(t.layerGroup);return}}else t.layerGroup=this,t.didChange=!0;const e=t.children;t.isLayerRoot||this.onChildUpdate(t);for(let s=0;s<e.length;s++)this.addChild(e[s])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&this.removeOnRender(t),t.layerGroup.root!==t){const s=t.children;for(let r=0;r<s.length;r++)this.removeChild(s[r]);t.didChange&&t.layerGroup.removeChildFromUpdate(t),t.layerGroup=null}else this.removeLayerGroupChild(t.layerGroup);const e=this.children.indexOf(t);e>-1&&this.children.splice(e,1)}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeLayerDepth];e||(e=this.childrenToUpdate[t.relativeLayerDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.layerVisibleRenderable<3||(t.didViewUpdate=!1,this.instructionSet.renderPipes[t.view.type].updateRenderable(t))}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}removeChildFromUpdate(t){const e=this.childrenToUpdate[t.relativeLayerDepth];if(!e)return;const s=e.list.indexOf(t);s>-1&&e.list.splice(s,1),e.index--}get isRenderable(){const t=this.worldColor>>24&255;return this.root.localVisibleRenderable===3&&t>0}addOnRender(t){this.onRenderContainers.push(t)}removeOnRender(t){this.onRenderContainers.splice(this.onRenderContainers.indexOf(t),1)}runOnRender(){this.onRenderContainers.forEach(t=>{t._onRender()})}}let iu=0;function r_(){return iu++}const Hh=new Dt(null),zh=new Dt(null),Wh=new Dt(null,1,1),jh=1,n_=2,Xh=4;class R extends jt{constructor({label:t,layer:e,view:s}={}){super(),this.uid=iu++,this.label=null,this.updateFlags=15,this.isLayerRoot=!1,this.layerGroup=null,this.didChange=!1,this.didViewUpdate=!1,this.relativeLayerDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new J,this.layerTransform=new J,this.position=new Dt(this,0,0),this._scale=Wh,this._pivot=zh,this._skew=Hh,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=4294967295,this.layerColor=4294967295,this.localBlendMode="inherit",this.layerBlendMode="normal",this.localVisibleRenderable=3,this.layerVisibleRenderable=3,this.effects=[],t&&(this.label=t),e&&this.enableLayer(),s&&(this.view=s,this.view.owner=this)}static mixin(t){Object.defineProperties(R.prototype,Object.getOwnPropertyDescriptors(t))}addEffect(t){this.effects.indexOf(t)===-1&&(this.effects.push(t),this.effects.sort((s,r)=>s.priority-r.priority),!this.isLayerRoot&&this.layerGroup&&(this.layerGroup.structureDidChange=!0),this.updateIsSimple())}removeEffect(t){const e=this.effects.indexOf(t);e!==-1&&(this.effects.splice(e,1),!this.isLayerRoot&&this.layerGroup&&(this.layerGroup.structureDidChange=!0),this.updateIsSimple())}addChild(...t){if(t.length>1){for(let s=0;s<t.length;s++)this.addChild(t[s]);return t[0]}const e=t[0];return e.parent===this?(this.children.splice(this.children.indexOf(e),1),this.children.push(e),this.layerGroup&&!this.isLayerRoot&&(this.layerGroup.structureDidChange=!0),e):(e.parent&&e.parent.removeChild(e),this.children.push(e),e.parent=this,e.didChange=!0,e.didViewUpdate=!1,e.updateFlags=15,this.layerGroup&&this.layerGroup.addChild(e),e)}removeChild(...t){if(t.length>1){for(let r=0;r<t.length;r++)this.removeChild(t[r]);return t[0]}const e=t[0],s=this.children.indexOf(e);return s>-1&&(this.children.splice(s,1),this.layerGroup&&this.layerGroup.removeChild(e)),e.parent=null,e}onUpdate(t){if(t&&t===this._skew&&this.updateSkew(),!this.didChange)if(this.didChange=!0,this.isLayerRoot){const e=this.layerGroup.layerGroupParent;e&&e.onChildUpdate(this)}else this.layerGroup&&this.layerGroup.onChildUpdate(this)}onViewUpdate(){this.didViewUpdate||(this.didViewUpdate=!0,this.layerGroup&&this.layerGroup.onChildViewUpdate(this))}set layer(t){if(this.isLayerRoot&&t===!1)throw new Error("[Pixi] cannot undo a layer just yet");t&&this.enableLayer()}get layer(){return this.isLayerRoot}enableLayer(){if(this.layerGroup&&this.layerGroup.root===this)return;this.isLayerRoot=!0;const t=this.layerGroup;if(t&&t.removeChild(this),this.layerGroup=new s_(this),t){for(let e=0;e<t.layerGroupChildren.length;e++){const s=t.layerGroupChildren[e];let r=s.root;for(;r;){if(r===this){this.layerGroup.addLayerGroupChild(s);break}r=r.parent}}t.addLayerGroupChild(this.layerGroup)}this.updateIsSimple()}get worldTransform(){return this._worldTransform||(this._worldTransform=new J),this.layerGroup&&(this.isLayerRoot?this._worldTransform.copyFrom(this.layerGroup.worldTransform):this._worldTransform.appendFrom(this.layerTransform,this.layerGroup.worldTransform)),this._worldTransform}get x(){return this.position.x}set x(t){this.position.x=t}get y(){return this.position.y}set y(t){this.position.y=t}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.onUpdate(this._skew))}get angle(){return this.rotation*Jf}set angle(t){this.rotation=t*Qf}get pivot(){return this._pivot===zh&&(this._pivot=new Dt(this,0,0)),this._pivot}get skew(){return this._skew===Hh&&(this._skew=new Dt(this,0,0)),this._skew}get scale(){return this._scale===Wh&&(this._scale=new Dt(this,1,1)),this._scale}updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}set alpha(t){t=t*255|0,t!==(this.localColor>>24&255)&&(this.localColor=this.localColor&16777215|t<<24,this.updateFlags|=jh,this.onUpdate())}get alpha(){return(this.localColor>>24&255)/255}set tint(t){t=((t&255)<<16)+(t&65280)+(t>>16&255),t!==(this.localColor&16777215)&&(this.localColor=this.localColor&4278190080|t&16777215,this.updateFlags|=jh,this.onUpdate())}get tint(){const t=this.localColor&16777215;return((t&255)<<16)+(t&65280)+(t>>16&255)}set blendMode(t){this.localBlendMode!==t&&(this.layerGroup&&!this.isLayerRoot&&(this.layerGroup.structureDidChange=!0),this.updateFlags|=n_,this.localBlendMode=t,this.onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localVisibleRenderable&2)}set visible(t){const e=t?1:0;(this.localVisibleRenderable&2)>>1!==e&&(this.layerGroup&&!this.isLayerRoot&&(this.layerGroup.structureDidChange=!0),this.updateFlags|=Xh,this.localVisibleRenderable=this.localVisibleRenderable&1|e<<1,this.onUpdate())}get renderable(){return!!(this.localVisibleRenderable&1)}set renderable(t){const e=t?1:0;(this.localVisibleRenderable&1)!==e&&(this.localVisibleRenderable=this.localVisibleRenderable&2|e,this.updateFlags|=Xh,this.layerGroup&&!this.isLayerRoot&&(this.layerGroup.structureDidChange=!0),this.onUpdate())}get isRenderable(){const t=this.layerColor>>24&255;return this.localVisibleRenderable===3&&t>0}updateIsSimple(){this.isSimple=!this.isLayerRoot&&this.effects.length===0}destroy(t=!1){this.removeFromParent(),this.parent=null,this._mask=null,this._filters=null,this.effects=null,this.position=null,this._scale=null,this._pivot=null,this._skew=null,this.emit("destroyed"),this.removeAllListeners();const e=typeof t=="boolean"?t:t==null?void 0:t.children,s=this.removeChildren(0,this.children.length);if(e)for(let r=0;r<s.length;++r)s[r].destroy(t);this.view&&(this.view.destroy(t),this.view.owner=null)}}R.mixin(Vp);R.mixin(Qp);R.mixin(Jp);R.mixin(Zp);R.mixin(Yp);R.mixin(qp);const kr={onViewUpdate:()=>{}};let o_=0;class a_{constructor(t){var e,s;this.owner=kr,this.batched=!0,this.buildId=0,this.uid=o_++,this.type="sprite",this._bounds=[0,1,0,0],this._sourceBounds=[0,1,0,0],this.boundsDirty=!0,this.sourceBoundsDirty=!0,this.anchor=new Dt(this,((e=t.layout.defaultAnchor)==null?void 0:e.x)||0,((s=t.layout.defaultAnchor)==null?void 0:s.y)||0),this.texture=t}set texture(t){this._texture!==t&&(t.on("update",this.onUpdate,this),this._texture=t,t.off("update",this.onUpdate,this),this.onUpdate())}get texture(){return this._texture}get bounds(){return this.boundsDirty&&(this.updateBounds(),this.boundsDirty=!1),this._bounds}get sourceBounds(){return this.sourceBoundsDirty&&(this._updateSourceBounds(),this.sourceBoundsDirty=!1),this._sourceBounds}updateBounds(){const t=this._texture,e=t._source,s=t.layout,r=s.orig,n=s.trim,o=e.width,a=e.height,h=o*r.width,l=a*r.height,c=this.anchor,u=this._bounds;if(n){const d=o*n.width,f=a*n.height;u[1]=n.x*o-c._x*h,u[0]=u[1]+d,u[3]=n.y*a-c._y*l,u[2]=u[3]+f}else u[1]=-c._x*h,u[0]=u[1]+h,u[3]=-c._y*l,u[2]=u[3]+l}_updateSourceBounds(){const t=this.anchor,e=this._texture,s=e._source,n=e.layout.orig,o=this._sourceBounds,a=s.width*n.width,h=s.height*n.height;o[1]=-t._x*a,o[0]=o[1]+a,o[3]=-t._y*h,o[2]=o[3]+h}addBounds(t){if(this._texture._layout.trim){const s=this.sourceBounds;t.addFrame(s[0],s[2],s[1],s[3])}else{const s=this.bounds;t.addFrame(s[0],s[2],s[1],s[3])}}onUpdate(){this.didUpdate=!0,this.sourceBoundsDirty=this.boundsDirty=!0,this.owner.onViewUpdate()}containsPoint(t){const e=this._texture.frameWidth,s=this._texture.frameHeight,r=-e*this.anchor.x;let n=0;return t.x>=r&&t.x<r+e&&(n=-s*this.anchor.y,t.y>=n&&t.y<n+s)}destroy(t=!1){if(this.anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const s=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(s)}this._texture=null,this._bounds=null,this._sourceBounds=null}}class pt extends R{static from(t){return typeof t=="string"?new pt(Ae.get(t)):new pt(t)}constructor(t=H.EMPTY){t instanceof H&&(t={texture:t}),t.texture??(t.texture=H.EMPTY),super({view:new a_(t.texture),label:"Sprite",...t})}get anchor(){return this.view.anchor}get texture(){return this.view.texture}set texture(t){this.view.texture=t}}const h_="modulepreload",l_=function(i,t){return new URL(i,t).href},Yh={},go=function(t,e,s){if(!e||e.length===0)return t();const r=document.getElementsByTagName("link");return Promise.all(e.map(n=>{if(n=l_(n,s),n in Yh)return;Yh[n]=!0;const o=n.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!s)for(let c=r.length-1;c>=0;c--){const u=r[c];if(u.href===n&&(!o||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${n}"]${a}`))return;const l=document.createElement("link");if(l.rel=o?"stylesheet":h_,o||(l.as="script",l.crossOrigin=""),l.href=n,document.head.appendChild(l),o)return new Promise((c,u)=>{l.addEventListener("load",c),l.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${n}`)))})})).then(()=>t())};let yo;function c_(){return typeof yo>"u"&&(yo=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:Gt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!Gt.ADAPTER.getWebGLRenderingContext())return!1;let r=Gt.ADAPTER.createCanvas().getContext("webgl2",t);const n=!!((e=r==null?void 0:r.getContextAttributes())!=null&&e.stencil);if(r){const o=r.getExtension("WEBGL_lose_context");o&&o.loseContext()}return r=null,n}catch{return!1}}()),yo}function u_(){return!!Gt.ADAPTER.getNavigator().gpu}const qh=["webgpu","webgl","canvas"];async function d_(i){let t=[],e;const{webgl:s,webgpu:r,...n}=i;i.preference?(t.push(i.preference),qh.forEach(h=>{h!==i.preference&&t.push(h)})):t=qh.slice();let o;(i.manageImports??!0)&&await go(()=>import("./all-48751678.js"),[],import.meta.url);for(let h=0;h<t.length;h++){const l=t[h];if(l==="webgpu"&&u_()){const{WebGPURenderer:c}=await go(()=>import("./WebGPURenderer-b808f9cb.js"),["./WebGPURenderer-b808f9cb.js","./SystemManager-46335f09.js"],import.meta.url);o=c,e=r;break}else if(l==="webgl"&&c_()){const{WebGLRenderer:c}=await go(()=>import("./WebGLRenderer-4d98ac4d.js"),["./WebGLRenderer-4d98ac4d.js","./SystemManager-46335f09.js"],import.meta.url);o=c,e=s;break}else if(l==="canvas")break}const a=new o;return await a.init({...n,...e}),a}const su=class{constructor(){this.stage=new R}async init(i){i={...i},this.renderer=await d_(i),su._plugins.forEach(t=>{t.init.call(this,i)})}render(){this.renderer.render(this.stage)}get canvas(){return this.renderer.canvas}};let nh=su;nh._plugins=[];Dn.handleByList(Oe.Application,nh._plugins);let f_=class{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<e;s++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}};const xn=i=>!Array.isArray(i);let p_=class{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,s)=>(this._parsersValidated=!1,t[e]=s,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const s={promise:null,parser:null};return s.promise=(async()=>{var o,a;let r=null,n=null;if(e.loadParser&&(n=this._parserHash[e.loadParser],n||console.warn(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!n){for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];if(l.load&&((o=l.test)!=null&&o.call(l,t,e,this))){n=l;break}}if(!n)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await n.load(t,e,this),s.parser=n;for(let h=0;h<this.parsers.length;h++){const l=this.parsers[h];l.parse&&l.parse&&await((a=l.testParse)==null?void 0:a.call(l,r,e,this))&&(r=await l.parse(r,e,this)||r,s.parser=l)}return r})(),s}async load(t,e){this._parsersValidated||this._validateParsers();let s=0;const r={},n=xn(t),o=Se(t,l=>({alias:[l],src:l})),a=o.length,h=o.map(async l=>{const c=hr.toAbsolute(l.src);if(!r[l.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,l)),r[l.src]=await this.promiseCache[c].promise,e&&e(++s/a)}catch(u){throw delete this.promiseCache[c],delete r[l.src],new Error(`[Loader.load] Failed to load ${c}.
${u}`)}});return await Promise.all(h),n?r[o[0].src]:r}async unload(t){const s=Se(t,r=>({alias:[r],src:r})).map(async r=>{var a,h;const n=hr.toAbsolute(r.src),o=this.promiseCache[n];if(o){const l=await o.promise;(h=(a=o.parser)==null?void 0:a.unload)==null||h.call(a,l,r,this),delete this.promiseCache[n]}});await Promise.all(s)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(t[e.name]&&console.warn(`[Assets] loadParser name conflict "${e.name}"`),{...t,[e.name]:e}),{})}};function ru(i,t,e,s,r){const n=t[e];for(let o=0;o<n.length;o++){const a=n[o];e<t.length-1?ru(i.replace(s[e],a),t,e+1,s,r):r.push(i.replace(s[e],a))}}function __(i){const t=/\{(.*?)\}/g,e=i.match(t),s=[];if(e){const r=[];e.forEach(n=>{const o=n.substring(1,n.length-1).split(",");r.push(o)}),ru(i,r,0,e,s)}else s.push(i);return s}let m_=class{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(e[s])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const s=[];Array.isArray(e)?e.forEach(r=>{const n=r.src??r.srcs,o=r.alias??r.name;let a;if(typeof o=="string"){const h=this._createBundleAssetId(t,o);s.push(h),a=[o,h]}else{const h=o.map(l=>this._createBundleAssetId(t,l));s.push(...h),a=[...o,...h]}this.add({...r,alias:a,src:n})}):Object.keys(e).forEach(r=>{const n=[r,this._createBundleAssetId(t,r)];if(typeof e[r]=="string")this.add({alias:n,src:e[r]});else if(Array.isArray(e[r]))this.add({alias:n,src:e[r]});else{const o=e[r],a=o.src??o.srcs;this.add({...o,alias:n,src:Array.isArray(a)?a:[a]})}s.push(...n)}),this._bundles[t]=s}add(t){const e=[];Array.isArray(t)?e.push(...t):e.push(t);const s=n=>{this.hasKey(n)&&console.warn(`[Resolver] already has key: ${n} overwriting`)};Se(e).forEach(n=>{const{alias:o,name:a,src:h,srcs:l}=n;let{data:c,format:u,loadParser:d}=n;const f=Se(h||l).map(p=>typeof p=="string"?__(p):Array.isArray(p)?p:[p]),_=Se(o||a);Array.isArray(o)?o.forEach(s):s(o);const m=[];f.forEach(p=>{p.forEach(x=>{let y={};if(typeof x!="object"){y.src=x;for(let b=0;b<this._parsers.length;b++){const v=this._parsers[b];if(v.test(x)){y=v.parse(x);break}}}else c=x.data??c,u=x.format??u,d=x.loadParser??d,y={...y,...x};y=this.buildResolvedAsset(y,{aliases:_,data:c,format:u,loadParser:d}),m.push(y)})}),_.forEach(p=>{this._assetMap[p]=m})})}resolveBundle(t){const e=xn(t);t=Se(t);const s={};return t.forEach(r=>{const n=this._bundles[r];if(n){const o=this.resolve(n),a={};for(const h in o){const l=o[h];a[this._extractAssetIdFromBundle(r,h)]=l}s[r]=a}}),e?s[t[0]]:s}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const s={};for(const r in e)s[r]=e[r].src;return s}return e.src}resolve(t){const e=xn(t);t=Se(t);const s={};return t.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let n=this._assetMap[r];const o=n[0],a=this._getPreferredOrder(n);a==null||a.priority.forEach(h=>{a.params[h].forEach(l=>{const c=n.filter(u=>u[h]?u[h]===l:!1);c.length&&(n=c)})}),this._resolverHash[r]=n[0]??o}else this._resolverHash[r]=this.buildResolvedAsset({alias:[r],src:r},{});s[r]=this._resolverHash[r]}),e?s[t[0]]:s}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const s=t[0],r=this._preferredOrder.find(n=>n.params.format.includes(s.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}buildResolvedAsset(t,e){const{aliases:s,data:r,loadParser:n,format:o}=e;return(this._basePath||this._rootPath)&&(t.src=hr.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=s??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...r||{},...t.data},t.loadParser=n??t.loadParser,t.format=o??t.src.split(".").pop(),t.srcs=t.src,t.name=t.alias,t}},g_=class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new m_,this.loader=new p_,this.cache=Ae,this._backgroundLoader=new f_(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var n,o,a;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let h=t.manifest;typeof h=="string"&&(h=await this.load(h)),this.resolver.addManifest(h)}const e=((n=t.texturePreference)==null?void 0:n.resolution)??1,s=typeof e=="number"?[e]:e;let r=[];if((o=t.texturePreference)!=null&&o.format){const h=(a=t.texturePreference)==null?void 0:a.format;r=typeof h=="string"?[h]:h;for(const l of this._detections)await l.test()||(r=await l.remove(r))}else for(const h of this._detections)await h.test()&&(r=await h.add(r));this.resolver.prefer({params:{format:r,resolution:s}}),t.preferences&&this.setPreferences(t.preferences)}add(t){this.resolver.add(t)}async load(t,e){this._initialized||await this.init();const s=xn(t),r=Se(t).map(a=>{if(typeof a!="string"){this.add(a);const h=a.src||a.srcs,l=a.alias||a.name;return l&&Array.isArray(l)?l[0]:h&&Array.isArray(h)?h[0]:l||h}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),n=this.resolver.resolve(r),o=await this._mapLoadToResolve(n,e);return s?o[r[0]]:o}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let s=!1;typeof t=="string"&&(s=!0,t=[t]);const r=this.resolver.resolveBundle(t),n={},o=Object.keys(r);let a=0,h=0;const l=()=>{e==null||e(++a/h)},c=o.map(u=>{const d=r[u];return h+=Object.keys(d).length,this._mapLoadToResolve(d,l).then(f=>{n[u]=f})});return await Promise.all(c),s?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(s=>{this._backgroundLoader.add(Object.values(s))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Ae.get(t);const e={};for(let s=0;s<t.length;s++)e[s]=Ae.get(t[s]);return e}async _mapLoadToResolve(t,e){const s=Object.values(t),r=Object.keys(t);this._backgroundLoader.active=!1;const n=await this.loader.load(s,e);this._backgroundLoader.active=!0;const o={};return s.forEach((a,h)=>{const l=n[a.src],c=[a.src];a.alias&&c.push(...a.alias),o[r[h]]=l,Ae.set(c,l)}),o}async unload(t){this._initialized||await this.init();const e=Se(t).map(r=>typeof r!="string"?r.src:r),s=this.resolver.resolve(e);await this._unloadFromResolved(s)}async unloadBundle(t){this._initialized||await this.init(),t=Se(t);const e=this.resolver.resolveBundle(t),s=Object.keys(e).map(r=>this._unloadFromResolved(e[r]));await Promise.all(s)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(s=>{Ae.remove(s.src)}),await this.loader.unload(e)}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(s=>s in t).forEach(s=>{e.config[s]=t[s]})})}};const Fe=new g_;Dn.handleByList(Oe.LoadParser,Fe.loader.parsers).handleByList(Oe.ResolveParser,Fe.resolver.parsers).handleByList(Oe.CacheParser,Fe.cache.parsers).handleByList(Oe.DetectionParser,Fe.detections);class Kh{constructor(t){this.usageTick=0,this.dirty=!0,this.resources={};let e=0;for(const s in t){const r=t[s];this.setResource(r,e++)}this.updateKey()}update(){this.updateKey()}updateKey(){if(!this.dirty)return;this.dirty=!1;const t=[];let e=0;for(const s in this.resources)t[e++]=this.resources[s].resourceId;this.key=t.join("|")}setResource(t,e){var r,n;const s=this.resources[e];t!==s&&(s&&((r=t.off)==null||r.call(t,"change",this.onResourceChange,this)),(n=t.on)==null||n.call(t,"change",this.onResourceChange,this),this.resources[e]=t,this.dirty=!0)}getResource(t){return this.resources[t]}destroy(){var e;const t=this.resources;for(const s in t){const r=t[s];(e=r.off)==null||e.call(r,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(){this.dirty=!0,this.update()}}let y_=class extends jt{constructor({gpuProgram:t,glProgram:e,groups:s,resources:r,groupMap:n}){super(),this.uniformBindMap={},this.gpuProgram=t,this.glProgram=e;const o={};if(r&&s)throw new Error("[Shader] Cannot have both resources and groups");if(!r&&!s)throw new Error("[Shader] Must provide either resources or groups descriptor");if(!t&&s&&!n)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!t&&s&&n)for(const a in n)for(const h in n[a]){const l=n[a][h];o[l]={group:a,binding:h,name:l}}else if(t&&s&&!n){const a=t.structsAndGroups.groups;n={},a.forEach(h=>{n[h.group]=n[h.group]||{},n[h.group][h.binding]=h.name,o[h.name]=h})}else if(r){if(t){const a=t.structsAndGroups.groups;n={},a.forEach(h=>{n[h.group]=n[h.group]||{},n[h.group][h.binding]=h.name,o[h.name]=h})}else{n={},s={99:new Kh};let a=0;for(const h in r)o[h]={group:99,binding:a,name:h},s[99].setResource(r[h],a),n[99]=n[99]||{},n[99][a]=h,a++}s={};for(const a in r){const h=a,l=r[a],c=o[h];c&&(s[c.group]=s[c.group]||new Kh,s[c.group].setResource(l,c.binding))}}this.groups=s,this.uniformBindMap=n,this.resources=this._buildResourceAccessor(s,o)}_buildResourceAccessor(t,e){const s={};for(const r in e){const n=e[r];Object.defineProperty(s,n.name,{get(){return t[n.group].getResource(n.binding)},set(o){t[n.group].setResource(o,n.binding)}})}return s}destroy(t=!1){var e,s;this.emit("destroy",this),t&&((e=this.gpuProgram)==null||e.destroy(),(s=this.glProgram)==null||s.destroy()),this.gpuProgram=null,this.glProgram=null,this.groups=null,this.removeAllListeners(),this.uniformBindMap=null,this.resources=null}};const b_={normal:0,additive:1,multiply:2,screen:3,overlay:4},bo=0,xo=1,vo=2,wo=3,To=4,Co=5;let x_=class nu{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<bo)}set blend(t){!!(this.data&1<<bo)!==t&&(this.data^=1<<bo)}get offsets(){return!!(this.data&1<<xo)}set offsets(t){!!(this.data&1<<xo)!==t&&(this.data^=1<<xo)}set cullMode(t){if(t==="none"){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=t==="front"}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<vo)}set culling(t){!!(this.data&1<<vo)!==t&&(this.data^=1<<vo)}get depthTest(){return!!(this.data&1<<wo)}set depthTest(t){!!(this.data&1<<wo)!==t&&(this.data^=1<<wo)}get depthMask(){return!!(this.data&1<<Co)}set depthMask(t){!!(this.data&1<<Co)!==t&&(this.data^=1<<Co)}get clockwiseFrontFace(){return!!(this.data&1<<To)}set clockwiseFrontFace(t){!!(this.data&1<<To)!==t&&(this.data^=1<<To)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!=="none",this._blendMode=t,this._blendModeId=b_[t]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new nu;return t.depthTest=!1,t.blend=!0,t}};const ou=class extends y_{constructor(t){t={...ou.defaultOptions,...t},super({gpuProgram:t.gpuProgram,glProgram:t.glProgram,resources:t.resources}),this.enabled=!0,this._state=x_.for2d(),this.padding=t.padding,typeof t.antialias=="boolean"?this.antialias=t.antialias?"on":"off":this.antialias=t.antialias??"inherit",this.resolution=t.resolution,this.blendRequired=t.blendRequired}apply(t,e,s,r){t.applyFilter(this,e,s,r)}get blendMode(){return this._state.blendMode}set blendMode(t){this._state.blendMode=t}};let au=ou;au.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"inherit",blendRequired:!1};function v_(i,{requestedPrecision:t,maxSupportedPrecision:e}){if(i.substring(0,9)!=="precision"){let s=t;if(t==="highp"&&e!=="highp"&&(s="mediump"),i.substring(0,8)!=="#version")return`precision ${s} float;
${i}`;const r=i.indexOf(`
`);return`${i.substring(0,r+1)}precision ${s} float;
${i.substring(r+1)}`}else if(e!=="highp"&&i.substring(0,15)==="precision highp")return i.replace("precision highp","precision mediump");return i}const w_={},T_={};function C_(i,{name:t="pixi-program"},e=!0){t=t.replace(/\s+/g,"-"),t+=e?"-fragment":"-vertex";const s=e?w_:T_;if(s[t]?(s[t]++,t+=`-${s[t]}`):s[t]=1,i.indexOf("#define SHADER_NAME")!==-1)return i;const r=`#define SHADER_NAME ${t}`;if(i.substring(0,8)!=="#version")return`${r}
${i}`;const n=i.indexOf(`
`);return`${i.substring(0,n+1)}${r}
${i.substring(n+1)}`}function S_(i,{version:t="300 es"}){return i.substring(0,8)==="#version"?i:`#version ${t}
${i}`}const So={ensurePrecision:v_,setProgramName:C_,setProgramVersion:S_},Xs=class{constructor({fragment:i,vertex:t,name:e}){const s={ensurePrecision:{requestedPrecision:"highp",maxSupportedPrecision:"highp"},setProgramName:{name:e},setProgramVersion:{version:"300 es"}};Object.keys(So).forEach(r=>{const n=s[r]??{};i=So[r](i,n,!0),t=So[r](t,n,!1)}),this.fragment=i,this.vertex=t,this.key=`${this.vertex}:${this.fragment}`}destroy(){this.fragment=null,this.vertex=null,this.attributeData=null,this.uniformData=null,this.uniformBlockData=null,this.transformFeedbackVaryings=null}static from(i){const t=`${i.vertex}:${i.fragment}`;return Xs.programCached[t]||(Xs.programCached[t]=new Xs(i)),Xs.programCached[t]}};let hu=Xs;hu.programCached={};function A_(i){var u;const t=new RegExp("(?<!\\/\\/.*)@(group|binding)\\(\\d+\\)[^;]+;","g"),e=/@group\((\d+)\)/,s=/@binding\((\d+)\)/,r=/var(<[^>]+>)? (\w+)/,n=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,a=/(\w+)\s*:\s*([\w\<\>]+)/g,h=/struct\s+(\w+)/,l=(u=i.match(t))==null?void 0:u.map(d=>({group:parseInt(d.match(e)[1],10),binding:parseInt(d.match(s)[1],10),name:d.match(r)[2],isUniform:d.match(r)[1]==="<uniform>",type:d.match(n)[1]}));if(!l)return{groups:[],structs:[]};const c=i.match(o).map(d=>{const f=d.match(h)[1],_=d.match(a).reduce((m,p)=>{const[x,y]=p.split(":");return m[x.trim()]=y.trim(),m},{});return{name:f,members:_}}).filter(({name:d})=>l.some(f=>f.type===d));return{groups:l,structs:c}}var Ys=(i=>(i[i.VERTEX=1]="VERTEX",i[i.FRAGMENT=2]="FRAGMENT",i[i.COMPUTE=4]="COMPUTE",i))(Ys||{});function E_({groups:i}){const t=[];for(let e=0;e<i.length;e++){const s=i[e];t[s.group]||(t[s.group]=[]),s.isUniform?t[s.group].push({binding:s.binding,visibility:Ys.VERTEX|Ys.FRAGMENT,buffer:{type:"uniform"}}):s.type==="sampler"?t[s.group].push({binding:s.binding,visibility:Ys.FRAGMENT,sampler:{type:"filtering"}}):s.type==="texture_2d"&&t[s.group].push({binding:s.binding,visibility:Ys.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return t}function P_({groups:i}){const t=[];for(let e=0;e<i.length;e++){const s=i[e];t[s.group]||(t[s.group]={}),t[s.group][s.name]=s.binding}return t}const qs=class{constructor({fragment:i,vertex:t,compute:e,layout:s,gpuLayout:r}){this._layoutKey=0,this.fragment=i,this.vertex=t,this.compute=e;const n=A_(this.fragment.source);this.structsAndGroups=n,this.layout=s??P_(n),this.gpuLayout=r??E_(n)}destroy(){this._gpuLayout=null,this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null,this.compute=null}static from(i){const t=`${i.vertex.source}:${i.fragment.source}:${i.fragment.entryPoint}:${i.vertex.entryPoint}`;return qs.programCached[t]||(qs.programCached[t]=new qs(i)),qs.programCached[t]}};let lu=qs;lu.programCached={};let I_=0;function da(){return I_++}const cu=class{constructor(i,t){this.uid=da(),this.resourceType="uniformGroup",this.resourceId=this.uid,this.isUniformGroup=!0,this.dirtyId=0,t={...cu.DEFAULT,...t},this.uniformStructures=i;const e={};for(const s in i){const r=i[s];r.name=s,r.size=r.size??1,e[s]=r.value??r}this.uniforms=e,this.dirtyId=1,this.ubo=t.ubo,this.isStatic=t.isStatic,this.signature=Object.keys(e).map(s=>`${s}-${i[s].type}`).join("-")}update(){this.dirtyId++}};let uu=cu;uu.DEFAULT={ubo:!1,isStatic:!1};var M_=`
in vec2 vTextureCoord;
in vec4 vColor;

uniform vec4 inputSize;
uniform vec4 inputClamp;

out vec4 fragColor;

uniform vec2 uCenter;
uniform float uTime;
uniform float uSpeed;
uniform vec4 uWave;

uniform sampler2D myTexture;


const float PI = 3.14159;

void main()
{
    float uAmplitude = uWave[0];
    float uWavelength = uWave[1];
    float uBrightness = uWave[2];
    float uRadius = uWave[3];

    float halfWavelength = uWavelength * 0.5 / inputSize.x;
    float maxRadius = uRadius / inputSize.x;
    float currentRadius = uTime * uSpeed / inputSize.x;

    float fade = 1.0;

    if (maxRadius > 0.0) {
        if (currentRadius > maxRadius) {
            fragColor = texture(myTexture, vTextureCoord);
            return;
        }
        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);
    }

    vec2 dir = vec2(vTextureCoord - uCenter / inputSize.xy);
    dir.y *= inputSize.y / inputSize.x;
    float dist = length(dir);

    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {
        fragColor = texture(myTexture, vTextureCoord);
        return;
    }

    vec2 diffUV = normalize(dir);

    float diff = (dist - currentRadius) / halfWavelength;

    float p = 1.0 - pow(abs(diff), 2.0);

    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );
    float powDiff = 1.25 * sin(diff * PI) * p * ( uAmplitude * fade );

    vec2 offset = diffUV * powDiff / inputSize.xy;

    // Do clamp :
    vec2 coord = vTextureCoord + offset;
    vec2 clampedCoord = clamp(coord, inputClamp.xy, inputClamp.zw);
    vec4 color = texture(myTexture, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    // No clamp :
    // fragColor = texture(myTexture, vTextureCoord + offset);

    color.rgb *= 1.0 + (uBrightness - 1.0) * p * fade;

    fragColor = color;
}
`,R_=`in vec2 aPosition;
out vec2 vTextureCoord;

uniform globalUniforms {
  mat3 projectionMatrix;
  mat3 worldTransformMatrix;
  float worldAlpha;
};

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aPosition * outputFrame.zw + outputFrame.xy;
    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,Zh=`struct GlobalUniforms {
    projectionMatrix:mat3x3<f32>,
    worldTransformMatrix:mat3x3<f32>,
    worldAlpha: f32
}

struct GlobalFilterUniforms {
    inputSize:vec4<f32>,
    inputPixel:vec4<f32>,
    inputClamp:vec4<f32>,
    outputFrame:vec4<f32>,
    backgroundFrame:vec4<f32>,
    globalFrame:vec4<f32>,
};

struct ShockWaveUniforms {
    uTime: f32,
    uOffset: vec2<f32>,
    uSpeed: f32,
    uWave: vec4<f32>,
};
@group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
@group(1) @binding(0) var<uniform> gfu: GlobalFilterUniforms;
@group(1) @binding(1) var myTexture: texture_2d<f32>;
@group(1) @binding(2) var mySampler : sampler;
@group(1) @binding(3) var backTexture: texture_2d<f32>;
@group(2) @binding(0) var<uniform> shockwaveUniforms : ShockWaveUniforms;

struct VSOutput {
    @builtin(position) position: vec4<f32>,
    @location(0) uv : vec2<f32>,
    @location(1) backgroundUv : vec2<f32>,
};

fn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>
{
    var position = aPosition * gfu.outputFrame.zw + gfu.outputFrame.xy;
    return vec4((globalUniforms.projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

fn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * (gfu.outputFrame.zw * gfu.inputSize.zw);
}

fn filterBackgroundTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return aPosition * gfu.backgroundFrame.zw;
}

fn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>
{
    return  (aPosition.xy / gfu.globalFrame.zw) + (gfu.globalFrame.xy / gfu.globalFrame.zw);  
}
fn getSize() -> vec2<f32>
{
    return gfu.globalFrame.zw;
}

@vertex
fn mainVertex(
    @location(0) aPosition : vec2<f32>, 
) -> VSOutput {
    return VSOutput(
        filterVertexPosition(aPosition),
        filterTextureCoord(aPosition),
        filterBackgroundTextureCoord(aPosition),
    );
}

@fragment
fn mainFragment(
    @location(0) uv: vec2<f32>,
    @location(1) backgroundUv: vec2<f32>,
    @builtin(position) position: vec4<f32>
) -> @location(0) vec4<f32> {

    let uTime = shockwaveUniforms.uTime;
    let uOffset = shockwaveUniforms.uOffset;
    let uSpeed = shockwaveUniforms.uSpeed;
    let uAmplitude = shockwaveUniforms.uWave[0];
    let uWavelength = shockwaveUniforms.uWave[1];
    let uBrightness = shockwaveUniforms.uWave[2];
    let uRadius = shockwaveUniforms.uWave[3];
    let halfWavelength: f32 = uWavelength * 0.5 / gfu.inputSize.x;
    let maxRadius: f32 = uRadius / gfu.inputSize.x;
    let currentRadius: f32 = uTime * uSpeed / gfu.inputSize.x;
    var fade: f32 = 1.0;
    var returnColorOnly: bool = false;
    
    if (maxRadius > 0.0) {
        if (currentRadius > maxRadius) {
            returnColorOnly = true;
        }
        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);
    }
    var dir: vec2<f32> = vec2<f32>(uv - uOffset / gfu.inputSize.xy);
    dir.y *= gfu.inputSize.y / gfu.inputSize.x;

    let dist:f32 = length(dir);

    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {
        returnColorOnly = true;
    }

    let diffUV: vec2<f32> = normalize(dir);
    let diff: f32 = (dist - currentRadius) / halfWavelength;
    let p: f32 = 1.0 - pow(abs(diff), 2.0);
    let powDiff: f32 = 1.25 * sin(diff * PI) * p * ( uAmplitude * fade );
    let offset: vec2<f32> = diffUV * powDiff / gfu.inputSize.xy;
    // Do clamp :
    let coord: vec2<f32> = uv + offset;
    let clampedCoord: vec2<f32> = clamp(coord, gfu.inputClamp.xy, gfu.inputClamp.zw);

    var clampedColor: vec4<f32> = textureSample(myTexture, mySampler, clampedCoord);
    
    if (boolVec2(coord, clampedCoord)) 
    {
        clampedColor *= max(0.0, 1.0 - length(coord - clampedCoord));
    }
    // No clamp :
    return select(clampedColor * vec4<f32>(vec3<f32>(1.0 + (uBrightness - 1.0) * p * fade), clampedColor.a), textureSample(myTexture, mySampler, uv), returnColorOnly);
}

fn boolVec2(x: vec2<f32>, y: vec2<f32>) -> bool
{
    if (x.x == y.x && x.y == y.y)
    {
        return true;
    }
    
    return false;
}

const PI: f32 = 3.14159265358979323846264;
`;const du=class extends au{constructor(i={}){i={...du.DEFAULT,...i};const t=new lu({vertex:{source:Zh,entryPoint:"mainVertex"},fragment:{source:Zh,entryPoint:"mainFragment"}}),e=new hu({vertex:R_,fragment:M_,name:"shockwave-filter"});super({gpuProgram:t,glProgram:e,resources:{shockwaveUniforms:new uu({uTime:{value:0,type:"f32"},uCenter:{value:i.center,type:"vec2<f32>"},uSpeed:{value:i.speed,type:"f32"},uWave:{value:new Float32Array(4),type:"vec4<f32>"}})},resolution:1}),this.time=0,this.uniforms=this.resources.shockwaveUniforms.uniforms,Object.assign(this,i)}apply(i,t,e,s){this.uniforms.uTime=this.time,i.applyFilter(this,t,e,s)}get center(){return this.uniforms.uCenter}set center(i){this.uniforms.uCenter=i}get centerX(){return this.uniforms.uCenter.x}set centerX(i){this.uniforms.uCenter.x=i}get centerY(){return this.uniforms.uCenter.y}set centerY(i){this.uniforms.uCenter.y=i}get speed(){return this.uniforms.uSpeed}set speed(i){this.uniforms.uSpeed=i}get amplitude(){return this.uniforms.uWave[0]}set amplitude(i){this.uniforms.uWave[0]=i}get wavelength(){return this.uniforms.uWave[1]}set wavelength(i){this.uniforms.uWave[1]=i}get brightness(){return this.uniforms.uWave[2]}set brightness(i){this.uniforms.uWave[2]=i}get radius(){return this.uniforms.uWave[3]}set radius(i){this.uniforms.uWave[3]=i}};let fu=du;fu.DEFAULT={center:{x:0,y:0},speed:500,amplitude:30,wavelength:160,brightness:1,radius:-1};function Jh(i){return i+=i===0?1:0,--i,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i+1}let k_=0,ir=class extends jt{constructor({data:t,size:e,usage:s,label:r}){super(),this.resourceType="buffer",this.resourceId=da(),this.uid=k_++,this._updateID=1,t instanceof Array&&(t=new Float32Array(t)),this._data=t,e=e??(t==null?void 0:t.byteLength);const n=!!t;this.descriptor={size:e,usage:s,mappedAtCreation:n,label:r}}get data(){return this._data}set data(t){if(this._data!==t){const e=this._data;this._data=t,e.length!==t.length?(this.descriptor.size=t.byteLength,this.resourceId=da(),this.emit("change",this)):this.emit("update",this)}}update(t){this._updateSize=t||this.descriptor.size,this._updateID++,this.emit("update",this)}destroy(){this.emit("destroy",this),this._data=null,this.descriptor=null,this.removeAllListeners()}};var Jt=(i=>(i[i.MAP_READ=1]="MAP_READ",i[i.MAP_WRITE=2]="MAP_WRITE",i[i.COPY_SRC=4]="COPY_SRC",i[i.COPY_DST=8]="COPY_DST",i[i.INDEX=16]="INDEX",i[i.VERTEX=32]="VERTEX",i[i.UNIFORM=64]="UNIFORM",i[i.STORAGE=128]="STORAGE",i[i.INDIRECT=256]="INDIRECT",i[i.QUERY_RESOLVE=512]="QUERY_RESOLVE",i[i.STATIC=1024]="STATIC",i))(Jt||{});function Qh(i,t){if(!(i instanceof ir)){let e=t?Jt.INDEX:Jt.VERTEX;i instanceof Array&&(t?(i=new Uint32Array(i),e=Jt.INDEX|Jt.COPY_DST):(i=new Float32Array(i),e=Jt.VERTEX|Jt.COPY_DST)),i=new ir({data:i,label:"index-mesh-buffer",usage:e})}return i}let B_=1,L_=class extends jt{constructor({attributes:t,indexBuffer:e,topology:s}){super(),this.uid=B_++,this._layoutKey=0,this.tick=0,this.attributes=t,this.buffers=[];for(const r in t){const n=t[r];n.buffer=Qh(n.buffer,!1),this.buffers.indexOf(n.buffer)===-1&&(this.buffers.push(n.buffer),n.buffer.on("update",this.onBufferUpdate,this))}e&&(this.indexBuffer=Qh(e,!0),this.buffers.push(this.indexBuffer)),this.topology=s||"triangle-list"}setBufferAtIndex(t,e){const s=this.buffers[e];s.off("update",this.onBufferUpdate,this),t.on("update",this.onBufferUpdate,this),this.buffers[e]=t;for(const r in this.attributes){const n=this.attributes[r];n.buffer===s&&(n.buffer=t)}}onBufferUpdate(){this.tick=this.tick++,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.getBuffer(t).data.length/(e.stride/4||e.size)}return 0}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(e=>e.destroy()),this.attributes=null,this.buffers=null}};const pu=class extends L_{constructor(i={}){i={...pu.defaultOptions,...i};const t=i.positions||new Float32Array([0,0,1,0,1,1,0,1]),e=i.uvs||new Float32Array([0,0,1,0,1,1,0,1]),s=i.indices||new Uint32Array([0,1,2,0,2,3]),r=new ir({data:t,label:"attribute-mesh-positions",usage:Jt.VERTEX|Jt.COPY_DST}),n=new ir({data:e,label:"attribute-mesh-uvs",usage:Jt.VERTEX|Jt.COPY_DST}),o=new ir({data:s,label:"index-mesh-buffer",usage:Jt.INDEX|Jt.COPY_DST});super({attributes:{aPosition:{buffer:r,shaderLocation:0,format:"float32x2",stride:2*4,offset:0},aUV:{buffer:n,shaderLocation:1,format:"float32x2",stride:2*4,offset:0}},indexBuffer:o,topology:i.topology}),this.batchMode="auto"}get positions(){return this.attributes.aPosition.buffer.data}set positions(i){this.attributes.aPosition.buffer.data=i}get uvs(){return this.attributes.aUV.buffer.data}set uvs(i){this.attributes.aUV.buffer.data=i}get indices(){return this.indexBuffer.data}set indices(i){this.indexBuffer.data=i}};let _u=pu;_u.defaultOptions={topology:"triangle-list"};const mu=class extends _u{constructor(i={}){super({}),this.build(i)}build(i){i={...mu.defaultOptions,...i},this.verticesX=this.verticesX??i.verticesX,this.verticesY=this.verticesY??i.verticesY,this.width=this.width??i.width,this.height=this.height??i.height;const t=this.verticesX*this.verticesY,e=[],s=[],r=[],n=this.verticesX-1,o=this.verticesY-1,a=this.width/n,h=this.height/o;for(let c=0;c<t;c++){const u=c%this.verticesX,d=c/this.verticesX|0;e.push(u*a,d*h),s.push(u/n,d/o)}const l=n*o;for(let c=0;c<l;c++){const u=c%n,d=c/n|0,f=d*this.verticesX+u,_=d*this.verticesX+u+1,m=(d+1)*this.verticesX+u,p=(d+1)*this.verticesX+u+1;r.push(f,_,m,_,p,m)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(s),this.indexBuffer.data=new Uint32Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}};let gu=mu;gu.defaultOptions={width:100,height:100,verticesX:10,verticesY:10};const yu=class extends gu{constructor(i){i={...yu.defaultOptions,...i},super({width:i.width,height:i.height,verticesX:4,verticesY:4}),this._textureMatrix=new J,this.update(i)}update(i){this.updateUvs(i),this.updatePositions(i)}updatePositions(i){this.width=i.width??this.width,this.height=i.height??this.height,this._leftWidth=i.leftWidth??this._leftWidth,this._rightWidth=i.rightWidth??this._rightWidth,this._topHeight=i.topHeight??this._topHeight,this._bottomHeight=i.bottomHeight??this._bottomHeight;const t=this.positions,e=this._leftWidth+this._rightWidth,s=this.width>e?1:this.width/e,r=this._topHeight+this._bottomHeight,n=this.height>r?1:this.height/r,o=Math.min(s,n);t[9]=t[11]=t[13]=t[15]=this._topHeight*o,t[17]=t[19]=t[21]=t[23]=this.height-this._bottomHeight*o,t[25]=t[27]=t[29]=t[31]=this.height,t[2]=t[10]=t[18]=t[26]=this._leftWidth*o,t[4]=t[12]=t[20]=t[28]=this.width-this._rightWidth*o,t[6]=t[14]=t[22]=t[30]=this.width,this.getBuffer("aPosition").update()}updateUvs(i){this._originalWidth=i.originalWidth??this._originalWidth,this._originalHeight=i.originalHeight??this._originalHeight,this._leftWidth=i.leftWidth??this._leftWidth,this._rightWidth=i.rightWidth??this._rightWidth,this._topHeight=i.topHeight??this._topHeight,this._bottomHeight=i.bottomHeight??this._bottomHeight,i.textureMatrix&&this._textureMatrix.copyFrom(i.textureMatrix);const t=this._textureMatrix,e=this.uvs;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1;const s=1/this._originalWidth,r=1/this._originalHeight;e[2]=e[10]=e[18]=e[26]=s*this._leftWidth,e[9]=e[11]=e[13]=e[15]=r*this._topHeight,e[4]=e[12]=e[20]=e[28]=1-s*this._rightWidth,e[17]=e[19]=e[21]=e[23]=1-r*this._bottomHeight,O_(t,e),this.getBuffer("aUV").update()}};let bu=yu;bu.defaultOptions={width:100,height:100,leftWidth:10,topHeight:10,rightWidth:10,bottomHeight:10,originalWidth:100,originalHeight:100};function O_(i,t,e){e??(e=t);const s=i.a,r=i.b,n=i.c,o=i.d,a=i.tx,h=i.ty;for(let l=0;l<t.length;l+=2){const c=t[l],u=t[l+1];e[l]=c*s+u*n+a,e[l+1]=c*r+u*o+h}return e}let F_=0;const tl=new ys;class N_{constructor(t){this.uid=F_++,this.type="mesh",this.canBundle=!0,this.owner=kr,this.shader=t.shader,t.texture&&(this.texture=t.texture),this._geometry=t.geometry,this._geometry.on("update",this.onGeometryUpdate,this)}set shader(t){this._shader!==t&&(this._shader=t,this.onUpdate())}get shader(){return this._shader}set geometry(t){var e;this._geometry!==t&&((e=this._geometry)==null||e.off("update",this.onUpdate,this),t.on("update",this.onUpdate,this),this._geometry=t,this.onUpdate())}get geometry(){return this._geometry}set texture(t){this._texture!==t&&(this.shader&&(this.shader.resources.uTexture=t.source,this.shader.resources.uSampler=t.style),this._texture=t,this.onUpdate())}get texture(){return this._texture}addBounds(t){t.addVertexData(this.geometry.positions,0,this.geometry.positions.length)}containsPoint(t){const{x:e,y:s}=t,r=this.geometry.getBuffer("aPosition").data,n=tl.points,o=this.geometry.getIndex().data,a=o.length,h=this.geometry.topology==="triangle-strip"?3:1;for(let l=0;l+2<a;l+=h){const c=o[l]*2,u=o[l+1]*2,d=o[l+2]*2;if(n[0]=r[c],n[1]=r[c+1],n[2]=r[u],n[3]=r[u+1],n[4]=r[d],n[5]=r[d+1],tl.contains(e,s))return!0}return!1}get batched(){return this._shader?!1:this._geometry.batchMode==="auto"?this._geometry.positions.length/2<=100:this._geometry.batchMode==="batch"}destroy(t=!1){if(typeof t=="boolean"?t:t==null?void 0:t.texture){const s=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(s)}this._texture=null,this._geometry=null,this._shader=null}onGeometryUpdate(){this.onUpdate()}onUpdate(){this.owner.onViewUpdate()}}const xu=class extends R{constructor(i){i instanceof H&&(i={texture:i}),i={...xu.defaultOptions,...i};const t=i.texture,e=new bu({width:t.width,height:t.height,originalWidth:t.width,originalHeight:t.height,leftWidth:i.leftWidth,topHeight:i.topHeight,rightWidth:i.rightWidth,bottomHeight:i.bottomHeight,textureMatrix:t.textureMatrix.mapCoord});super({view:new N_({geometry:e,texture:t}),label:"NineSlicePlane",...i})}get width(){return this.view.geometry.width}set width(i){this.view.geometry.updatePositions({width:i})}get height(){return this.view.geometry.height}set height(i){this.view.geometry.updatePositions({height:i})}get leftWidth(){return this.view.geometry._leftWidth}set leftWidth(i){this.view.geometry.updateUvs({leftWidth:i})}get topHeight(){return this.view.geometry._topHeight}set topHeight(i){this.view.geometry.updateUvs({topHeight:i})}get rightWidth(){return this.view.geometry._rightWidth}set rightWidth(i){this.view.geometry.updateUvs({rightWidth:i})}get bottomHeight(){return this.view.geometry._bottomHeight}set bottomHeight(i){this.view.geometry.updateUvs({bottomHeight:i})}get texture(){return this.view.texture}set texture(i){i!==this.view.texture&&(this.view.geometry.updateUvs({originalWidth:i.width,originalHeight:i.height,textureMatrix:i.textureMatrix.mapCoord}),this.view.texture=i)}};let us=xu;us.defaultOptions={texture:H.EMPTY,leftWidth:10,topHeight:10,rightWidth:10,bottomHeight:10};var fa={},U_={get exports(){return fa},set exports(i){fa=i}};U_.exports=$n;fa.default=$n;function $n(i,t,e){e=e||2;var s=t&&t.length,r=s?t[0]*e:i.length,n=vu(i,0,r,e,!0),o=[];if(!n||n.next===n.prev)return o;var a,h,l,c,u,d,f;if(s&&(n=H_(i,t,n,e)),i.length>80*e){a=l=i[0],h=c=i[1];for(var _=e;_<r;_+=e)u=i[_],d=i[_+1],u<a&&(a=u),d<h&&(h=d),u>l&&(l=u),d>c&&(c=d);f=Math.max(l-a,c-h),f=f!==0?32767/f:0}return dr(n,o,e,a,h,f,0),o}function vu(i,t,e,s,r){var n,o;if(r===ma(i,t,e,s)>0)for(n=t;n<e;n+=s)o=el(n,i[n],i[n+1],o);else for(n=e-s;n>=t;n-=s)o=el(n,i[n],i[n+1],o);return o&&Hn(o,o.next)&&(pr(o),o=o.next),o}function ji(i,t){if(!i)return i;t||(t=i);var e=i,s;do if(s=!1,!e.steiner&&(Hn(e,e.next)||ut(e.prev,e,e.next)===0)){if(pr(e),e=t=e.prev,e===e.next)break;s=!0}else e=e.next;while(s||e!==t);return t}function dr(i,t,e,s,r,n,o){if(i){!o&&n&&Y_(i,s,r,n);for(var a=i,h,l;i.prev!==i.next;){if(h=i.prev,l=i.next,n?G_(i,s,r,n):D_(i)){t.push(h.i/e|0),t.push(i.i/e|0),t.push(l.i/e|0),pr(i),i=l.next,a=l.next;continue}if(i=l,i===a){o?o===1?(i=V_(ji(i),t,e),dr(i,t,e,s,r,n,2)):o===2&&$_(i,t,e,s,r,n):dr(ji(i),t,e,s,r,n,1);break}}}}function D_(i){var t=i.prev,e=i,s=i.next;if(ut(t,e,s)>=0)return!1;for(var r=t.x,n=e.x,o=s.x,a=t.y,h=e.y,l=s.y,c=r<n?r<o?r:o:n<o?n:o,u=a<h?a<l?a:l:h<l?h:l,d=r>n?r>o?r:o:n>o?n:o,f=a>h?a>l?a:l:h>l?h:l,_=s.next;_!==t;){if(_.x>=c&&_.x<=d&&_.y>=u&&_.y<=f&&ds(r,a,n,h,o,l,_.x,_.y)&&ut(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function G_(i,t,e,s){var r=i.prev,n=i,o=i.next;if(ut(r,n,o)>=0)return!1;for(var a=r.x,h=n.x,l=o.x,c=r.y,u=n.y,d=o.y,f=a<h?a<l?a:l:h<l?h:l,_=c<u?c<d?c:d:u<d?u:d,m=a>h?a>l?a:l:h>l?h:l,p=c>u?c>d?c:d:u>d?u:d,x=pa(f,_,t,e,s),y=pa(m,p,t,e,s),b=i.prevZ,v=i.nextZ;b&&b.z>=x&&v&&v.z<=y;){if(b.x>=f&&b.x<=m&&b.y>=_&&b.y<=p&&b!==r&&b!==o&&ds(a,c,h,u,l,d,b.x,b.y)&&ut(b.prev,b,b.next)>=0||(b=b.prevZ,v.x>=f&&v.x<=m&&v.y>=_&&v.y<=p&&v!==r&&v!==o&&ds(a,c,h,u,l,d,v.x,v.y)&&ut(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;b&&b.z>=x;){if(b.x>=f&&b.x<=m&&b.y>=_&&b.y<=p&&b!==r&&b!==o&&ds(a,c,h,u,l,d,b.x,b.y)&&ut(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;v&&v.z<=y;){if(v.x>=f&&v.x<=m&&v.y>=_&&v.y<=p&&v!==r&&v!==o&&ds(a,c,h,u,l,d,v.x,v.y)&&ut(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function V_(i,t,e){var s=i;do{var r=s.prev,n=s.next.next;!Hn(r,n)&&wu(r,s,s.next,n)&&fr(r,n)&&fr(n,r)&&(t.push(r.i/e|0),t.push(s.i/e|0),t.push(n.i/e|0),pr(s),pr(s.next),s=i=n),s=s.next}while(s!==i);return ji(s)}function $_(i,t,e,s,r,n){var o=i;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&Z_(o,a)){var h=Tu(o,a);o=ji(o,o.next),h=ji(h,h.next),dr(o,t,e,s,r,n,0),dr(h,t,e,s,r,n,0);return}a=a.next}o=o.next}while(o!==i)}function H_(i,t,e,s){var r=[],n,o,a,h,l;for(n=0,o=t.length;n<o;n++)a=t[n]*s,h=n<o-1?t[n+1]*s:i.length,l=vu(i,a,h,s,!1),l===l.next&&(l.steiner=!0),r.push(K_(l));for(r.sort(z_),n=0;n<r.length;n++)e=W_(r[n],e);return e}function z_(i,t){return i.x-t.x}function W_(i,t){var e=j_(i,t);if(!e)return t;var s=Tu(e,i);return ji(s,s.next),ji(e,e.next)}function j_(i,t){var e=t,s=i.x,r=i.y,n=-1/0,o;do{if(r<=e.y&&r>=e.next.y&&e.next.y!==e.y){var a=e.x+(r-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(a<=s&&a>n&&(n=a,o=e.x<e.next.x?e:e.next,a===s))return o}e=e.next}while(e!==t);if(!o)return null;var h=o,l=o.x,c=o.y,u=1/0,d;e=o;do s>=e.x&&e.x>=l&&s!==e.x&&ds(r<c?s:n,r,l,c,r<c?n:s,r,e.x,e.y)&&(d=Math.abs(r-e.y)/(s-e.x),fr(e,i)&&(d<u||d===u&&(e.x>o.x||e.x===o.x&&X_(o,e)))&&(o=e,u=d)),e=e.next;while(e!==h);return o}function X_(i,t){return ut(i.prev,i,t.prev)<0&&ut(t.next,i,i.next)<0}function Y_(i,t,e,s){var r=i;do r.z===0&&(r.z=pa(r.x,r.y,t,e,s)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,q_(r)}function q_(i){var t,e,s,r,n,o,a,h,l=1;do{for(e=i,i=null,n=null,o=0;e;){for(o++,s=e,a=0,t=0;t<l&&(a++,s=s.nextZ,!!s);t++);for(h=l;a>0||h>0&&s;)a!==0&&(h===0||!s||e.z<=s.z)?(r=e,e=e.nextZ,a--):(r=s,s=s.nextZ,h--),n?n.nextZ=r:i=r,r.prevZ=n,n=r;e=s}n.nextZ=null,l*=2}while(o>1);return i}function pa(i,t,e,s,r){return i=(i-e)*r|0,t=(t-s)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,i|t<<1}function K_(i){var t=i,e=i;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==i);return e}function ds(i,t,e,s,r,n,o,a){return(r-o)*(t-a)>=(i-o)*(n-a)&&(i-o)*(s-a)>=(e-o)*(t-a)&&(e-o)*(n-a)>=(r-o)*(s-a)}function Z_(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!J_(i,t)&&(fr(i,t)&&fr(t,i)&&Q_(i,t)&&(ut(i.prev,i,t.prev)||ut(i,t.prev,t))||Hn(i,t)&&ut(i.prev,i,i.next)>0&&ut(t.prev,t,t.next)>0)}function ut(i,t,e){return(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y)}function Hn(i,t){return i.x===t.x&&i.y===t.y}function wu(i,t,e,s){var r=Hr(ut(i,t,e)),n=Hr(ut(i,t,s)),o=Hr(ut(e,s,i)),a=Hr(ut(e,s,t));return!!(r!==n&&o!==a||r===0&&$r(i,e,t)||n===0&&$r(i,s,t)||o===0&&$r(e,i,s)||a===0&&$r(e,t,s))}function $r(i,t,e){return t.x<=Math.max(i.x,e.x)&&t.x>=Math.min(i.x,e.x)&&t.y<=Math.max(i.y,e.y)&&t.y>=Math.min(i.y,e.y)}function Hr(i){return i>0?1:i<0?-1:0}function J_(i,t){var e=i;do{if(e.i!==i.i&&e.next.i!==i.i&&e.i!==t.i&&e.next.i!==t.i&&wu(e,e.next,i,t))return!0;e=e.next}while(e!==i);return!1}function fr(i,t){return ut(i.prev,i,i.next)<0?ut(i,t,i.next)>=0&&ut(i,i.prev,t)>=0:ut(i,t,i.prev)<0||ut(i,i.next,t)<0}function Q_(i,t){var e=i,s=!1,r=(i.x+t.x)/2,n=(i.y+t.y)/2;do e.y>n!=e.next.y>n&&e.next.y!==e.y&&r<(e.next.x-e.x)*(n-e.y)/(e.next.y-e.y)+e.x&&(s=!s),e=e.next;while(e!==i);return s}function Tu(i,t){var e=new _a(i.i,i.x,i.y),s=new _a(t.i,t.x,t.y),r=i.next,n=t.prev;return i.next=t,t.prev=i,e.next=r,r.prev=e,s.next=e,e.prev=s,n.next=s,s.prev=n,s}function el(i,t,e,s){var r=new _a(i,t,e);return s?(r.next=s.next,r.prev=s,s.next.prev=r,s.next=r):(r.prev=r,r.next=r),r}function pr(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function _a(i,t,e){this.i=i,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}$n.deviation=function(i,t,e,s){var r=t&&t.length,n=r?t[0]*e:i.length,o=Math.abs(ma(i,0,n,e));if(r)for(var a=0,h=t.length;a<h;a++){var l=t[a]*e,c=a<h-1?t[a+1]*e:i.length;o-=Math.abs(ma(i,l,c,e))}var u=0;for(a=0;a<s.length;a+=3){var d=s[a]*e,f=s[a+1]*e,_=s[a+2]*e;u+=Math.abs((i[d]-i[_])*(i[f+1]-i[d+1])-(i[d]-i[f])*(i[_+1]-i[d+1]))}return o===0&&u===0?0:Math.abs((u-o)/o)};function ma(i,t,e,s){for(var r=0,n=t,o=e-s;n<e;n+=s)r+=(i[o]-i[n])*(i[n+1]+i[o+1]),o=n;return r}$n.flatten=function(i){for(var t=i[0][0].length,e={vertices:[],holes:[],dimensions:t},s=0,r=0;r<i.length;r++){for(var n=0;n<i[r].length;n++)for(var o=0;o<t;o++)e.vertices.push(i[r][n][o]);r>0&&(s+=i[r-1].length,e.holes.push(s))}return e};let tm=0;class em{constructor(t){this.uid=tm++,this.canBundle=!0,this.owner=kr,this.type="graphics",this._context=t||new Wi,this._context.on("update",this.onGraphicsContextUpdate,this)}set context(t){t!==this._context&&(this._context.off("update",this.onGraphicsContextUpdate,this),this._context=t,this._context.on("update",this.onGraphicsContextUpdate,this),this.onGraphicsContextUpdate())}get context(){return this._context}addBounds(t){t.addBounds(this._context.bounds)}containsPoint(t){return this._context.containsPoint(t)}onGraphicsContextUpdate(){this.didUpdate=!0,this.owner.onViewUpdate()}destroy(t=!1){this.owner=null,(typeof t=="boolean"?t:t==null?void 0:t.context)&&this._context.destroy(t),this._context=null}}class Es extends R{constructor(t){t instanceof Wi&&(t={context:t}),super({view:new em(t==null?void 0:t.context),label:"Graphics",...t})}get context(){return this.view.context}set context(t){this.view.context=t}}function im(i,t=[]){return t[0]=(i>>16&255)/255,t[1]=(i>>8&255)/255,t[2]=(i&255)/255,t}function iT(i){let t=i.toString(16);return t="000000".substring(0,6-t.length)+t,`#${t}`}class sm{constructor(t){this.poolKeyHash={},this.canvasPool={},this.canvasOptions=t||{},this.enableFullScreen=!1}createCanvasAndContext(t,e){const s=Gt.ADAPTER.createCanvas();s.width=t,s.height=e;const r=s.getContext("2d");return{canvas:s,context:r}}getOptimalCanvasAndContext(t,e,s=1){t=Math.ceil(t*s-1e-6),e=Math.ceil(e*s-1e-6),t=Jh(t),e=Jh(e);const r=(t<<17)+(e<<1);this.canvasPool[r]||(this.canvasPool[r]=[]);let n=this.canvasPool[r].pop();return n||(n=this.createCanvasAndContext(t,e)),n}returnCanvasAndContext(t){const{width:e,height:s}=t.canvas,r=(e<<17)+(s<<1);this.canvasPool[r].push(t)}clear(){this.canvasPool={}}}const il=new sm;var Cu=(i=>(i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",i))(Cu||{});const rm=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function ga(i){const t=typeof i.fontSize=="number"?`${i.fontSize}px`:i.fontSize;let e=i.fontFamily;Array.isArray(i.fontFamily)||(e=i.fontFamily.split(","));for(let s=e.length-1;s>=0;s--){let r=e[s].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!rm.includes(r)&&(r=`"${r}"`),e[s]=r}return`${i.fontStyle} ${i.fontVariant} ${i.fontWeight} ${t} ${e.join(",")}`}const Ao={willReadFrequently:!0},k=class{static get experimentalLetterSpacingSupported(){let i=k._experimentalLetterSpacingSupported;if(i!==void 0){const t=Gt.ADAPTER.getCanvasRenderingContext2D().prototype;i=k._experimentalLetterSpacingSupported="letterSpacing"in t||"textLetterSpacing"in t}return i}constructor(i,t,e,s,r,n,o,a,h){this.text=i,this.style=t,this.width=e,this.height=s,this.lines=r,this.lineWidths=n,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=h}static measureText(i=" ",t,e=k._canvas,s=t.wordWrap){var x;const r=`${i}:${t.styleKey}`;if(k._measurementCache[r])return k._measurementCache[r];const n=ga(t),o=k.measureFont(n);o.fontSize===0&&(o.fontSize=t.fontSize,o.ascent=t.fontSize);const a=k.__context;a.font=n;const l=(s?k.wordWrap(i,t,e):i).split(/(?:\r\n|\r|\n)/),c=new Array(l.length);let u=0;for(let y=0;y<l.length;y++){const b=k._measureText(l[y],t.letterSpacing,a);c[y]=b,u=Math.max(u,b)}const d=((x=t.stroke)==null?void 0:x.width)||0;let f=u+d;t.dropShadow&&(f+=t.dropShadow.distance);const _=t.lineHeight||o.fontSize+d;let m=Math.max(_,o.fontSize+d*2)+(l.length-1)*(_+t.leading);return t.dropShadow&&(m+=t.dropShadow.distance),new k(i,t,f,m,l,c,_+t.leading,u,o)}static _measureText(i,t,e){let s=!1;k.experimentalLetterSpacingSupported&&(k.experimentalLetterSpacing?(e.letterSpacing=`${t}px`,e.textLetterSpacing=`${t}px`,s=!0):(e.letterSpacing="0px",e.textLetterSpacing="0px"));let r=e.measureText(i).width;return r>0&&(s?r-=t:r+=(k.graphemeSegmenter(i).length-1)*t),r}static wordWrap(i,t,e=k._canvas){const s=e.getContext("2d",Ao);let r=0,n="",o="";const a=Object.create(null),{letterSpacing:h,whiteSpace:l}=t,c=k.collapseSpaces(l),u=k.collapseNewlines(l);let d=!c;const f=t.wordWrapWidth+h,_=k.tokenize(i);for(let m=0;m<_.length;m++){let p=_[m];if(k.isNewline(p)){if(!u){o+=k.addLine(n),d=!c,n="",r=0;continue}p=" "}if(c){const y=k.isBreakingSpace(p),b=k.isBreakingSpace(n[n.length-1]);if(y&&b)continue}const x=k.getFromCache(p,h,a,s);if(x>f)if(n!==""&&(o+=k.addLine(n),n="",r=0),k.canBreakWords(p,t.breakWords)){const y=k.wordWrapSplit(p);for(let b=0;b<y.length;b++){let v=y[b],w=v,C=1;for(;y[b+C];){const T=y[b+C];if(!k.canBreakChars(w,T,p,b,t.breakWords))v+=T;else break;w=T,C++}b+=C-1;const A=k.getFromCache(v,h,a,s);A+r>f&&(o+=k.addLine(n),d=!1,n="",r=0),n+=v,r+=A}}else{n.length>0&&(o+=k.addLine(n),n="",r=0);const y=m===_.length-1;o+=k.addLine(p,!y),d=!1,n="",r=0}else x+r>f&&(d=!1,o+=k.addLine(n),n="",r=0),(n.length>0||!k.isBreakingSpace(p)||d)&&(n+=p,r+=x)}return o+=k.addLine(n,!1),o}static addLine(i,t=!0){return i=k.trimRight(i),i=t?`${i}
`:i,i}static getFromCache(i,t,e,s){let r=e[i];return typeof r!="number"&&(r=k._measureText(i,t,s)+t,e[i]=r),r}static collapseSpaces(i){return i==="normal"||i==="pre-line"}static collapseNewlines(i){return i==="normal"}static trimRight(i){if(typeof i!="string")return"";for(let t=i.length-1;t>=0;t--){const e=i[t];if(!k.isBreakingSpace(e))break;i=i.slice(0,-1)}return i}static isNewline(i){return typeof i!="string"?!1:k._newlines.includes(i.charCodeAt(0))}static isBreakingSpace(i,t){return typeof i!="string"?!1:k._breakingSpaces.includes(i.charCodeAt(0))}static tokenize(i){const t=[];let e="";if(typeof i!="string")return t;for(let s=0;s<i.length;s++){const r=i[s],n=i[s+1];if(k.isBreakingSpace(r,n)||k.isNewline(r)){e!==""&&(t.push(e),e=""),t.push(r);continue}e+=r}return e!==""&&t.push(e),t}static canBreakWords(i,t){return t}static canBreakChars(i,t,e,s,r){return!0}static wordWrapSplit(i){return k.graphemeSegmenter(i)}static measureFont(i){if(k._fonts[i])return k._fonts[i];const t=k._context;t.font=i;const e=t.measureText(k.METRICS_STRING+k.BASELINE_SYMBOL),s={ascent:e.actualBoundingBoxAscent,descent:e.actualBoundingBoxDescent,fontSize:e.actualBoundingBoxAscent+e.actualBoundingBoxDescent};return k._fonts[i]=s,s}static clearMetrics(i=""){i?delete k._fonts[i]:k._fonts={}}static get _canvas(){if(!k.__canvas){let i;try{const t=new OffscreenCanvas(0,0),e=t.getContext("2d",Ao);if(e!=null&&e.measureText)return k.__canvas=t,t;i=Gt.ADAPTER.createCanvas()}catch{i=Gt.ADAPTER.createCanvas()}i.width=i.height=10,k.__canvas=i}return k.__canvas}static get _context(){return k.__context||(k.__context=k._canvas.getContext("2d",Ao)),k.__context}};let re=k;re.METRICS_STRING="|q";re.BASELINE_SYMBOL="M";re.BASELINE_MULTIPLIER=1.4;re.HEIGHT_MULTIPLIER=2;re.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const i=new Intl.Segmenter;return t=>[...i.segment(t)].map(e=>e.segment)}return i=>[...i]})();re.experimentalLetterSpacing=!1;re._fonts={};re._newlines=[10,13];re._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];re._measurementCache={};function sl(i,t){if(i.texture===H.WHITE&&!i.fill)return aa(i.color);if(i.fill){if(i.fill instanceof eh){const e=i.fill,s=t.createPattern(e.texture.source.resource,"repeat"),r=e.transform.copyTo(J.shared);return r.scale(e.texture.frameWidth,e.texture.frameHeight),s.setTransform(r),s}else if(i.fill instanceof cr){const e=i.fill;if(e.type==="linear"){const s=t.createLinearGradient(e.x0,e.y0,e.x1,e.y1);return e.gradientStops.forEach(r=>{s.addColorStop(r.offset,aa(r.color))}),s}}}else{const e=t.createPattern(i.texture.source.resource,"repeat"),s=i.matrix.copyTo(J.shared);return s.scale(i.texture.frameWidth,i.texture.frameHeight),e.setTransform(s),e}return console.warn("[PixiJS] FillStyle not recognised",i),"red"}const rl=["fontFamily","fontStyle","fontVariant","fontWeight","breakWords","align","leading","letterSpacing","lineHeight","textBaseline","whiteSpace","wordWrap","wordWrapWidth","padding"],os=class extends jt{constructor(i={}){super();const t={...os.defaultTextStyle,...i};for(const e in os.defaultTextStyle){const s=e;this[s]=t[e]}this.dropShadow=null,typeof t.fill=="string"?this.fontSize=parseInt(t.fontSize,10):this.fontSize=t.fontSize,i.dropShadow&&(i.dropShadow instanceof Boolean?i.dropShadow===!0&&(this.dropShadow={...os.defaultTextStyle.dropShadow}):this.dropShadow={...os.defaultTextStyle.dropShadow,...i.dropShadow}),this.update()}generateKey(){const i=[];let t=0;for(let e=0;e<rl.length;e++){const s=rl[e];i[t++]=this[s]}return t=Su(this._fill,i,t),t=nm(this._stroke,i,t),this._styleKey=i.join("-"),this._styleKey}update(){this._styleKey=null,this.emit("update",this)}get fill(){return this._originalFill}set fill(i){i!==this._fill&&(this._originalFill=i,this._fill=yn(i,Wi.defaultFillStyle))}get stroke(){return this._originalStroke}set stroke(i){i!==this._fill&&(this._originalFill=i,this._stroke=yn(i,Wi.defaultStrokeStyle))}get styleKey(){return this._styleKey||this.generateKey()}clone(){return new os({align:this.align,breakWords:this.breakWords,dropShadow:this.dropShadow,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth})}destroy(i=!1){var e,s,r,n;if(this.removeAllListeners(),typeof i=="boolean"?i:i==null?void 0:i.texture){const o=typeof i=="boolean"?i:i==null?void 0:i.textureSource;(e=this._fill)!=null&&e.texture&&this._fill.texture.destroy(o),(s=this._originalFill)!=null&&s.texture&&this._originalFill.texture.destroy(o),(r=this._stroke)!=null&&r.texture&&this._stroke.texture.destroy(o),(n=this._originalStroke)!=null&&n.texture&&this._originalStroke.texture.destroy(o)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}};let Ni=os;Ni.defaultTextStyle={align:"left",breakWords:!1,dropShadow:{alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5},fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};function Su(i,t,e){var s;return i&&(t[e++]=i.color,t[e++]=i.alpha,t[e++]=(s=i.fill)==null?void 0:s.uid),e}function nm(i,t,e){return i&&(e=Su(i,t,e),t[e++]=i.width,t[e++]=i.alignment,t[e++]=i.cap,t[e++]=i.join,t[e++]=i.miterLimit),e}function om(i){typeof i=="string"&&(i=[i]);const t=[];for(let e=0,s=i.length;e<s;e++){const r=i[e];if(Array.isArray(r)){if(r.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);const n=r[0].charCodeAt(0),o=r[1].charCodeAt(0);if(o<n)throw new Error("[BitmapFont]: Invalid character range.");for(let a=n,h=o;a<=h;a++)t.push(String.fromCharCode(a))}else t.push(...Array.from(r))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}class am extends jt{constructor(t){super(),this.baseRenderedFontSize=100,this.baseMeasurementFontSize=100,this.padding=4,this.baseLineOffset=0,this.pages=[],this.chars={},this.lineHeight=0,this.measureCache={},this.currentChars=[],this.dynamic=!0,this.currentX=0,this.currentY=0,this.currentPageIndex=-1,this.resolution=1,this.distanceField={fieldType:"none",distanceRange:0},this.pages=[];const e=t;this.dynamic=!0;let s;e.style instanceof Ni?s=e.style.clone():s=new Ni(e.style),s.fontSize=this.baseMeasurementFontSize,e.overrideFill&&(s._fill.color=16777215,s._fill.alpha=1,s._fill.texture=H.WHITE,s._fill.fill=null),this.style=s;const r=ga(s);this.fontMetrics=re.measureFont(r),this.lineHeight=s.lineHeight||this.fontMetrics.fontSize||s.fontSize}ensureCharacters(t){var m,p;const e=om(t).filter(x=>!this.currentChars.includes(x)).filter((x,y,b)=>b.indexOf(x)===y);if(!e.length)return;this.currentChars=[...this.currentChars,...e];let s;this.currentPageIndex===-1?s=this.nextPage():s=this.pages[this.currentPageIndex];let{canvas:r,context:n}=s.canvasAndContext,o=s.texture.source;const a=this.style;let h=this.currentX,l=this.currentY;const c=this.baseRenderedFontSize/this.baseMeasurementFontSize,u=this.padding*c,d=a.fontStyle==="italic"?2:1;let f=0,_=!1;for(let x=0;x<e.length;x++){const y=e[x],b=re.measureText(y,a,r,!1),v=d*b.width*c,w=b.height*c,C=v+u*2,A=w+u*2;if(_=!1,y!==`
`&&y!=="\r"&&y!=="	"&&y!==" "&&(_=!0,f=Math.ceil(Math.max(A,f))),h+C>512&&(l+=f,f=A,h=0,l+f>512)){o.update();const S=this.nextPage();r=S.canvasAndContext.canvas,n=S.canvasAndContext.context,o=S.texture.source,l=0}const T=v/c-(((m=a.dropShadow)==null?void 0:m.distance)??0)-(((p=a._stroke)==null?void 0:p.width)??0);if(this.chars[y]={id:y.codePointAt(0),xOffset:-this.padding,yOffset:-this.padding,xAdvance:T,kerning:{}},_){this.drawGlyph(n,b,h+u,l+u,c,a);const S=o.width*c,M=o.height*c,L=new me(h/S,l/M,C/S,A/M);this.chars[y].texture=new H({source:o,layout:{frame:L}}),h+=Math.ceil(C)}}o.update(),this.currentX=h,this.currentY=l,this.applyKerning(e,n)}applyKerning(t,e){const s=this.measureCache;for(let r=0;r<t.length;r++){const n=t[r];for(let o=0;o<this.currentChars.length;o++){const a=this.currentChars[o];let h=s[n];h||(h=s[n]=e.measureText(n).width);let l=s[a];l||(l=s[a]=e.measureText(a).width);let c=e.measureText(n+a).width,u=c-(h+l);u&&(this.chars[n].kerning[a]=u),c=e.measureText(n+a).width,u=c-(h+l),u&&(this.chars[a].kerning[n]=u)}}}nextPage(){this.currentPageIndex++;const t=this.resolution,e=il.getOptimalCanvasAndContext(512,512,t);this.setupContext(e.context,this.style,t);const s=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),r=new H({source:new Gn({resource:e.canvas,resolution:s,alphaMode:Cu.PMA})}),n={canvasAndContext:e,texture:r};return this.pages[this.currentPageIndex]=n,n}setupContext(t,e,s){e.fontSize=this.baseRenderedFontSize,t.scale(s,s),t.font=ga(e),e.fontSize=this.baseMeasurementFontSize,t.textBaseline=e.textBaseline;const r=e._stroke,n=(r==null?void 0:r.width)??0;if(r&&(t.lineWidth=n,t.lineJoin=r.join,t.miterLimit=r.miterLimit,t.strokeStyle=sl(r,t)),e._fill&&(t.fillStyle=sl(e._fill,t)),e.dropShadow){const o=e.dropShadow,a=Ze(o.color),h=im(a),l=o.blur*s,c=o.distance*s;t.shadowColor=`rgba(${h[0]*255},${h[1]*255},${h[2]*255},${o.alpha})`,t.shadowBlur=l,t.shadowOffsetX=Math.cos(o.angle)*c,t.shadowOffsetY=Math.sin(o.angle)*c}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}drawGlyph(t,e,s,r,n,o){const a=e.text,h=e.fontProperties,l=o._stroke,c=((l==null?void 0:l.width)??0)*n,u=s+c/2,d=r-c/2,f=h.descent*n,_=e.lineHeight*n;o.stroke&&c&&t.strokeText(a,u,d+_-f),o._fill&&t.fillText(a,u,d+_-f)}destroy(){this.emit("destroy",this),this.removeAllListeners();for(const t in this.chars)this.chars[t].texture.destroy();this.chars=null;for(let t=0;t<this.pages.length;t++){const{canvasAndContext:e,texture:s}=this.pages[t];il.returnCanvasAndContext(e),s.destroy(!0)}this.pages=null}}function hm(i,t,e){const s={width:0,height:0,offsetY:0,scale:t.fontSize/e.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};s.offsetY=e.baseLineOffset;let r=s.lines[0],n=null,o=!0;const a={spaceWord:!1,width:0,start:0,index:0,positions:[],chars:[]},h=f=>{const _=r.width;for(let m=0;m<a.index;m++){const p=f.positions[m];r.chars.push(f.chars[m]),r.charPositions.push(p+_)}r.width+=f.width,o=!1,a.width=0,a.index=0,a.chars.length=0},l=()=>{let f=r.chars.length-1,_=r.chars[f];for(;_===" ";)r.width-=e.chars[_].xAdvance,_=r.chars[--f];s.width=Math.max(s.width,r.width),r={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},o=!0,s.lines.push(r),s.height+=e.lineHeight},c=e.baseMeasurementFontSize/t.fontSize,u=t.letterSpacing*c,d=t.wordWrapWidth*c;for(let f=0;f<i.length+1;f++){let _;const m=f===i.length;m||(_=i[f]);const p=e.chars[_];if(/(?:\s)/.test(_)||_==="\r"||_===`
`||m){if(!o&&t.wordWrap&&r.width+a.width-u>d?(l(),h(a),m||r.charPositions.push(0)):(a.start=r.width,h(a),m||r.charPositions.push(0)),_==="\r"||_===`
`)r.width!==0&&l();else if(!m){const v=p.xAdvance+(p.kerning[n]||0)+u;r.width+=v,r.spaceWidth=v,r.spacesIndex.push(r.charPositions.length),r.chars.push(_)}}else{const b=p.kerning[n]||0,v=p.xAdvance+b+u;a.positions[a.index++]=a.width+b,a.chars.push(_),a.width+=v}n=_}return l(),t.align==="center"?lm(s):t.align==="right"?cm(s):t.align==="justify"&&um(s),s}function lm(i){for(let t=0;t<i.lines.length;t++){const e=i.lines[t],s=i.width/2-e.width/2;for(let r=0;r<e.charPositions.length;r++)e.charPositions[r]+=s}}function cm(i){for(let t=0;t<i.lines.length;t++){const e=i.lines[t],s=i.width-e.width;for(let r=0;r<e.charPositions.length;r++)e.charPositions[r]+=s}}function um(i){const t=i.width;for(let e=0;e<i.lines.length;e++){const s=i.lines[e];let r=0,n=s.spacesIndex[r++],o=0;const a=s.spacesIndex.length,l=(t-s.width)/a;for(let c=0;c<s.charPositions.length;c++)c===n&&(n=s.spacesIndex[r++],o+=l),s.charPositions[c]+=o}}class dm{getFont(t,e){var o;let s=e.fontFamily,r=!0;e._fill.fill&&(s+=e._fill.fill.uid,r=!1),Ae.has(s)||Ae.set(s,new am({style:e,overrideFill:r}));const n=Ae.get(s);return(o=n.ensureCharacters)==null||o.call(n,t),n}getLayout(t,e){const s=this.getFont(t,e);return hm(t.split(""),e,s)}measureText(t,e){return this.getLayout(t,e)}}const fm=new dm;let pm=0;const _m={canvas:"text",html:"text",bitmap:"bitmapText"},an=class{constructor(i){this.uid=pm++,this.batched=!0,this.type="text",this.owner=kr,this._bounds=[0,1,0,0],this.boundsDirty=!0,this._autoResolution=an.defaultAutoResolution,this._resolution=an.defaultResolution,this.didUpdate=!0,this.text=i.text??"",this._style=i.style instanceof Ni?i.style:new Ni(i.style);const t=i.renderMode??this.detectRenderType(this._style);this.type=_m[t],this.anchor=new Dt(this,0,0),this._resolution=i.resolution??an.defaultResolution}set text(i){i=i.toString(),this._text!==i&&(this._text=i,this.onUpdate())}get text(){return this._text}get style(){return this._style}set style(i){var t;i=i||{},(t=this._style)==null||t.off("update",this.onUpdate,this),i instanceof Ni?this._style=i:this._style=new Ni(i),this._style.on("update",this.onUpdate,this),this.onUpdate()}set resolution(i){this._resolution=i}get resolution(){return this._resolution}get bounds(){return this.boundsDirty&&(this.updateBounds(),this.boundsDirty=!1),this._bounds}updateBounds(){const i=this._bounds;if(this.type==="bitmapText"){const t=fm.measureText(this.text,this._style),e=t.scale,s=t.offsetY*e;i[0]=0,i[1]=s,i[2]=t.width*e,i[3]=t.height*e+s}else{const t=re.measureText(this.text,this._style);i[0]=0,i[1]=0,i[2]=t.width,i[3]=t.height}}addBounds(i){const t=this.bounds;i.addFrame(t[0],t[1],t[2],t[3])}onUpdate(){this.didUpdate=!0,this.boundsDirty=!0,this.owner.onViewUpdate()}_getKey(){return`${this.text}:${this._style.styleKey}`}containsPoint(i){const t=this.bounds[2],e=this.bounds[3],s=-t*this.anchor.x;let r=0;return i.x>=s&&i.x<s+t&&(r=-e*this.anchor.y,i.y>=r&&i.y<r+e)}detectRenderType(i){return Ae.has(i.fontFamily)?"bitmap":"canvas"}destroy(i=!1){this.owner=null,this._bounds=null,this.anchor=null,this._style.destroy(i),this._style=null,this._text=null}};let oh=an;oh.defaultResolution=1;oh.defaultAutoResolution=!0;class mt extends R{constructor(t){super({view:new oh(t),label:"Text",...t})}get anchor(){return this.view.anchor}set text(t){this.view.text=t}get text(){return this.view.text}set style(t){this.view.style=t}get style(){return this.view.style}}var Eo=/iPhone/i,nl=/iPod/i,ol=/iPad/i,al=/\biOS-universal(?:.+)Mac\b/i,Po=/\bAndroid(?:.+)Mobile\b/i,hl=/Android/i,es=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,zr=/Silk/i,We=/Windows Phone/i,ll=/\bWindows(?:.+)ARM\b/i,cl=/BlackBerry/i,ul=/BB10/i,dl=/Opera Mini/i,fl=/\b(CriOS|Chrome)(?:.+)Mobile/i,pl=/Mobile(?:.+)Firefox\b/i,_l=function(i){return typeof i<"u"&&i.platform==="MacIntel"&&typeof i.maxTouchPoints=="number"&&i.maxTouchPoints>1&&typeof MSStream>"u"};function mm(i){return function(t){return t.test(i)}}function ml(i){var t={userAgent:"",platform:"",maxTouchPoints:0};!i&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof i=="string"?t.userAgent=i:i&&i.userAgent&&(t={userAgent:i.userAgent,platform:i.platform,maxTouchPoints:i.maxTouchPoints||0});var e=t.userAgent,s=e.split("[FBAN");typeof s[1]<"u"&&(e=s[0]),s=e.split("Twitter"),typeof s[1]<"u"&&(e=s[0]);var r=mm(e),n={apple:{phone:r(Eo)&&!r(We),ipod:r(nl),tablet:!r(Eo)&&(r(ol)||_l(t))&&!r(We),universal:r(al),device:(r(Eo)||r(nl)||r(ol)||r(al)||_l(t))&&!r(We)},amazon:{phone:r(es),tablet:!r(es)&&r(zr),device:r(es)||r(zr)},android:{phone:!r(We)&&r(es)||!r(We)&&r(Po),tablet:!r(We)&&!r(es)&&!r(Po)&&(r(zr)||r(hl)),device:!r(We)&&(r(es)||r(zr)||r(Po)||r(hl))||r(/\bokhttp\b/i)},windows:{phone:r(We),tablet:r(ll),device:r(We)||r(ll)},other:{blackberry:r(cl),blackberry10:r(ul),opera:r(dl),firefox:r(pl),chrome:r(fl),device:r(cl)||r(ul)||r(dl)||r(pl)||r(fl)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}const gm=ml.default??ml,hn=gm(globalThis.navigator);let ym=class{constructor({matrix:t,observer:e}={}){this.dirty=!0,this._matrix=t??new J,this.observer=e,this.position=new Dt(this,0,0),this.scale=new Dt(this,1,1),this.pivot=new Dt(this,0,0),this.skew=new Dt(this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1}get matrix(){const t=this._matrix;return this.dirty&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this.dirty=!1),t}onUpdate(t){var e;this.dirty=!0,t===this.skew&&this.updateSkew(),(e=this.observer)==null||e.onUpdate(this)}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this.dirty=!0}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}setFromMatrix(t){t.decompose(this),this.dirty=!0}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())}},bm=0;const Au=class{constructor(i){this.batched=!0,this.owner=kr,this.uid=bm++,this.type="tilingSprite",this.onRenderableUpdate=gn,this._bounds=[0,1,0,0],this.boundsDirty=!0,i={...Au.defaultOptions,...i},this.anchor=new Dt(this,0,0),this.applyAnchorToTexture=i.applyAnchorToTexture,this.texture=i.texture,this._width=i.width,this._height=i.height,this.tileTransform=new ym({observer:this})}get bounds(){return this.boundsDirty&&(this.updateBounds(),this.boundsDirty=!1),this._bounds}updateBounds(){const i=this._bounds,t=this.anchor,e=this._width,s=this._height;i[1]=-t._x*e,i[0]=i[1]+e,i[3]=-t._y*s,i[2]=i[3]+s}addBounds(i){const t=this.bounds;i.addFrame(t[0],t[1],t[2],t[3])}set texture(i){this._texture!==i&&(this._texture=i,this.onUpdate())}get texture(){return this._texture}set width(i){this._width=i,this.onUpdate()}get width(){return this._width}set height(i){this._height=i,this.onUpdate()}get height(){return this._height}onUpdate(){this.boundsDirty=!0,this.didUpdate=!0,this.owner.onViewUpdate()}containsPoint(i){const t=this.bounds[2],e=this.bounds[3],s=-t*this.anchor.x;let r=0;return i.x>=s&&i.x<s+t&&(r=-e*this.anchor.y,i.y>=r&&i.y<r+e)}destroy(i=!1){if(this.onRenderableUpdate=gn,this.anchor=null,this.tileTransform=null,this._bounds=null,typeof i=="boolean"?i:i==null?void 0:i.texture){const e=typeof i=="boolean"?i:i==null?void 0:i.textureSource;this._texture.destroy(e)}this._texture=null}};let Eu=Au;Eu.defaultOptions={texture:H.WHITE,width:256,height:256,applyAnchorToTexture:!1};class Br extends R{constructor(t){super({view:new Eu(t),label:"TilingSprite",...t})}set texture(t){this.view.texture=t}get texture(){return this.view.texture}get anchor(){return this.view.anchor}get width(){return this.view.width}set width(t){this.view.width=t}get height(){return this.view.height}set height(t){this.view.height=t}get tilePosition(){return this.view.tileTransform.position}set tilePosition(t){this.view.tileTransform.position.copyFrom(t)}get tileScale(){return this.view.tileTransform.scale}set tileScale(t){this.view.tileTransform.scale.copyFrom(t)}set tileRotation(t){this.view.tileTransform.rotation=t}get tileRotation(){return this.view.tileTransform.rotation}get tileTransform(){return this.view.tileTransform}}const xm=[{name:"default",assets:[{name:"audio/bubble-land-sfx.wav",srcs:["./audio/bubble-land-sfx.mp3","./audio/bubble-land-sfx.ogg"]},{name:"audio/bubbles-falling.wav",srcs:["./audio/bubbles-falling.mp3","./audio/bubbles-falling.ogg"]},{name:"audio/bubbo-bubbo-bg-music.wav",srcs:["./audio/bubbo-bubbo-bg-music.mp3","./audio/bubbo-bubbo-bg-music.ogg"]},{name:"audio/cannon-move.wav",srcs:["./audio/cannon-move.mp3","./audio/cannon-move.ogg"]},{name:"audio/powerup-bomb.wav",srcs:["./audio/powerup-bomb.mp3","./audio/powerup-bomb.ogg"]},{name:"audio/powerup-super.wav",srcs:["./audio/powerup-super.mp3","./audio/powerup-super.ogg"]},{name:"audio/powerup-time.wav",srcs:["./audio/powerup-time.mp3","./audio/powerup-time.ogg"]},{name:"audio/primary-button-press.wav",srcs:["./audio/primary-button-press.mp3","./audio/primary-button-press.ogg"]},{name:"audio/secondary-button-press.wav",srcs:["./audio/secondary-button-press.mp3","./audio/secondary-button-press.ogg"]},{name:"fonts/Bungee-Regular.ttf",srcs:["./fonts/Bungee-Regular.woff2"]},{name:"fonts/OpenSans-SemiBold.ttf",srcs:["./fonts/OpenSans-SemiBold.woff2"]},{name:"images/favicon.png",srcs:["images/favicon.png"]}]},{name:"images/game-screen",assets:[{name:"images/game-screen/game-screen.json",srcs:["images/game-screen/game-screen@1x.json","images/game-screen/game-screen@0.5x.json"],data:{tags:{m:!0,tps:!0}}}]},{name:"images/pause-overlay",assets:[{name:"images/pause-overlay/pause-panel.png",srcs:["images/pause-overlay/pause-panel.png"],data:{tags:{m:!0}}}]},{name:"images/preload",assets:[{name:"images/preload/preload.json",srcs:["images/preload/preload@1x.json","images/preload/preload@0.5x.json"],data:{tags:{m:!0,tps:!0}}}]},{name:"images/results-screen",assets:[{name:"images/results-screen/results-screen.json",srcs:["images/results-screen/results-screen@1x.json","images/results-screen/results-screen@0.5x.json"],data:{tags:{m:!0,tps:!0}}}]},{name:"images/title-screen",assets:[{name:"images/title-screen/title-screen.json",srcs:["images/title-screen/title-screen@1x.json","images/title-screen/title-screen@0.5x.json"],data:{tags:{m:!0,tps:!0}}}]}],ya={bundles:xm},vm={extension:Oe.ResolveParser,test:i=>Gt.RETINA_PREFIX.test(i)&&i.endsWith(".json"),parse:Dp.parse};Dn.add(vm);async function wm(){await Fe.init({manifest:ya}),await Fe.loadBundle(["images/preload","default"]);const i=ya.bundles.map(t=>t.name);Fe.backgroundLoadBundle(i)}function Tm(i){const t=ya.bundles.find(e=>e.name===i);if(!t)return!1;for(const e of t.assets)if(!Fe.cache.has(e.name))return!1;return!0}function Cm(i){for(const t of i)if(!Tm(t))return!1;return!0}var Ki=(i=>(i[i.WEBGL_LEGACY=0]="WEBGL_LEGACY",i[i.WEBGL=1]="WEBGL",i[i.WEBGL2=2]="WEBGL2",i))(Ki||{}),ba=(i=>(i[i.COLOR=16384]="COLOR",i[i.DEPTH=256]="DEPTH",i[i.STENCIL=1024]="STENCIL",i))(ba||{}),N=(i=>(i[i.NORMAL=0]="NORMAL",i[i.ADD=1]="ADD",i[i.MULTIPLY=2]="MULTIPLY",i[i.SCREEN=3]="SCREEN",i[i.OVERLAY=4]="OVERLAY",i[i.DARKEN=5]="DARKEN",i[i.LIGHTEN=6]="LIGHTEN",i[i.COLOR_DODGE=7]="COLOR_DODGE",i[i.COLOR_BURN=8]="COLOR_BURN",i[i.HARD_LIGHT=9]="HARD_LIGHT",i[i.SOFT_LIGHT=10]="SOFT_LIGHT",i[i.DIFFERENCE=11]="DIFFERENCE",i[i.EXCLUSION=12]="EXCLUSION",i[i.HUE=13]="HUE",i[i.SATURATION=14]="SATURATION",i[i.COLOR=15]="COLOR",i[i.LUMINOSITY=16]="LUMINOSITY",i[i.NORMAL_NPM=17]="NORMAL_NPM",i[i.ADD_NPM=18]="ADD_NPM",i[i.SCREEN_NPM=19]="SCREEN_NPM",i[i.NONE=20]="NONE",i[i.SRC_OVER=0]="SRC_OVER",i[i.SRC_IN=21]="SRC_IN",i[i.SRC_OUT=22]="SRC_OUT",i[i.SRC_ATOP=23]="SRC_ATOP",i[i.DST_OVER=24]="DST_OVER",i[i.DST_IN=25]="DST_IN",i[i.DST_OUT=26]="DST_OUT",i[i.DST_ATOP=27]="DST_ATOP",i[i.ERASE=26]="ERASE",i[i.SUBTRACT=28]="SUBTRACT",i[i.XOR=29]="XOR",i))(N||{}),vn=(i=>(i[i.POINTS=0]="POINTS",i[i.LINES=1]="LINES",i[i.LINE_LOOP=2]="LINE_LOOP",i[i.LINE_STRIP=3]="LINE_STRIP",i[i.TRIANGLES=4]="TRIANGLES",i[i.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",i[i.TRIANGLE_FAN=6]="TRIANGLE_FAN",i))(vn||{}),E=(i=>(i[i.RGBA=6408]="RGBA",i[i.RGB=6407]="RGB",i[i.RG=33319]="RG",i[i.RED=6403]="RED",i[i.RGBA_INTEGER=36249]="RGBA_INTEGER",i[i.RGB_INTEGER=36248]="RGB_INTEGER",i[i.RG_INTEGER=33320]="RG_INTEGER",i[i.RED_INTEGER=36244]="RED_INTEGER",i[i.ALPHA=6406]="ALPHA",i[i.LUMINANCE=6409]="LUMINANCE",i[i.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",i[i.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",i[i.DEPTH_STENCIL=34041]="DEPTH_STENCIL",i))(E||{}),bs=(i=>(i[i.TEXTURE_2D=3553]="TEXTURE_2D",i[i.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",i[i.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",i[i.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",i[i.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",i[i.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",i[i.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",i[i.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",i))(bs||{}),Y=(i=>(i[i.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",i[i.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",i[i.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",i[i.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",i[i.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",i[i.UNSIGNED_INT=5125]="UNSIGNED_INT",i[i.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",i[i.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",i[i.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",i[i.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",i[i.BYTE=5120]="BYTE",i[i.SHORT=5122]="SHORT",i[i.INT=5124]="INT",i[i.FLOAT=5126]="FLOAT",i[i.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",i[i.HALF_FLOAT=36193]="HALF_FLOAT",i))(Y||{}),xa=(i=>(i[i.FLOAT=0]="FLOAT",i[i.INT=1]="INT",i[i.UINT=2]="UINT",i))(xa||{}),Je=(i=>(i[i.NEAREST=0]="NEAREST",i[i.LINEAR=1]="LINEAR",i))(Je||{}),ah=(i=>(i[i.CLAMP=33071]="CLAMP",i[i.REPEAT=10497]="REPEAT",i[i.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",i))(ah||{}),Xi=(i=>(i[i.OFF=0]="OFF",i[i.POW2=1]="POW2",i[i.ON=2]="ON",i[i.ON_MANUAL=3]="ON_MANUAL",i))(Xi||{}),bi=(i=>(i[i.NPM=0]="NPM",i[i.UNPACK=1]="UNPACK",i[i.PMA=2]="PMA",i[i.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",i[i.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",i[i.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",i))(bi||{}),Ri=(i=>(i[i.NO=0]="NO",i[i.YES=1]="YES",i[i.AUTO=2]="AUTO",i[i.BLEND=0]="BLEND",i[i.CLEAR=1]="CLEAR",i[i.BLIT=2]="BLIT",i))(Ri||{}),hh=(i=>(i[i.AUTO=0]="AUTO",i[i.MANUAL=1]="MANUAL",i))(hh||{}),ue=(i=>(i.LOW="lowp",i.MEDIUM="mediump",i.HIGH="highp",i))(ue||{}),St=(i=>(i[i.NONE=0]="NONE",i[i.SCISSOR=1]="SCISSOR",i[i.STENCIL=2]="STENCIL",i[i.SPRITE=3]="SPRITE",i[i.COLOR=4]="COLOR",i))(St||{}),yt=(i=>(i[i.NONE=0]="NONE",i[i.LOW=2]="LOW",i[i.MEDIUM=4]="MEDIUM",i[i.HIGH=8]="HIGH",i))(yt||{}),Ue=(i=>(i[i.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",i[i.ARRAY_BUFFER=34962]="ARRAY_BUFFER",i[i.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",i))(Ue||{});const Sm={createCanvas:(i,t)=>{const e=document.createElement("canvas");return e.width=i,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(i,t)=>fetch(i,t),parseXML:i=>new DOMParser().parseFromString(i,"text/xml")},V={ADAPTER:Sm,RESOLUTION:1,RENDER_OPTIONS:{view:null,width:800,height:600,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,clearBeforeRender:!0,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,hello:!1},CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Io=/iPhone/i,gl=/iPod/i,yl=/iPad/i,bl=/\biOS-universal(?:.+)Mac\b/i,Mo=/\bAndroid(?:.+)Mobile\b/i,xl=/Android/i,is=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Wr=/Silk/i,je=/Windows Phone/i,vl=/\bWindows(?:.+)ARM\b/i,wl=/BlackBerry/i,Tl=/BB10/i,Cl=/Opera Mini/i,Sl=/\b(CriOS|Chrome)(?:.+)Mobile/i,Al=/Mobile(?:.+)Firefox\b/i,El=function(i){return typeof i<"u"&&i.platform==="MacIntel"&&typeof i.maxTouchPoints=="number"&&i.maxTouchPoints>1&&typeof MSStream>"u"};function Am(i){return function(t){return t.test(i)}}function Em(i){var t={userAgent:"",platform:"",maxTouchPoints:0};!i&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof i=="string"?t.userAgent=i:i&&i.userAgent&&(t={userAgent:i.userAgent,platform:i.platform,maxTouchPoints:i.maxTouchPoints||0});var e=t.userAgent,s=e.split("[FBAN");typeof s[1]<"u"&&(e=s[0]),s=e.split("Twitter"),typeof s[1]<"u"&&(e=s[0]);var r=Am(e),n={apple:{phone:r(Io)&&!r(je),ipod:r(gl),tablet:!r(Io)&&(r(yl)||El(t))&&!r(je),universal:r(bl),device:(r(Io)||r(gl)||r(yl)||r(bl)||El(t))&&!r(je)},amazon:{phone:r(is),tablet:!r(is)&&r(Wr),device:r(is)||r(Wr)},android:{phone:!r(je)&&r(is)||!r(je)&&r(Mo),tablet:!r(je)&&!r(is)&&!r(Mo)&&(r(Wr)||r(xl)),device:!r(je)&&(r(is)||r(Wr)||r(Mo)||r(xl))||r(/\bokhttp\b/i)},windows:{phone:r(je),tablet:r(vl),device:r(je)||r(vl)},other:{blackberry:r(wl),blackberry10:r(Tl),opera:r(Cl),firefox:r(Al),chrome:r(Sl),device:r(wl)||r(Tl)||r(Cl)||r(Al)||r(Sl)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}const fs=Em(globalThis.navigator);V.RETINA_PREFIX=/@([0-9\.]+)x/;V.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Ve={},Pm={get exports(){return Ve},set exports(i){Ve=i}};(function(i){var t=Object.prototype.hasOwnProperty,e="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(e=!1));function r(h,l,c){this.fn=h,this.context=l,this.once=c||!1}function n(h,l,c,u,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new r(c,u||h,d),_=e?e+l:l;return h._events[_]?h._events[_].fn?h._events[_]=[h._events[_],f]:h._events[_].push(f):(h._events[_]=f,h._eventsCount++),h}function o(h,l){--h._eventsCount===0?h._events=new s:delete h._events[l]}function a(){this._events=new s,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],c,u;if(this._eventsCount===0)return l;for(u in c=this._events)t.call(c,u)&&l.push(e?u.slice(1):u);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},a.prototype.listeners=function(l){var c=e?e+l:l,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,f=u.length,_=new Array(f);d<f;d++)_[d]=u[d].fn;return _},a.prototype.listenerCount=function(l){var c=e?e+l:l,u=this._events[c];return u?u.fn?1:u.length:0},a.prototype.emit=function(l,c,u,d,f,_){var m=e?e+l:l;if(!this._events[m])return!1;var p=this._events[m],x=arguments.length,y,b;if(p.fn){switch(p.once&&this.removeListener(l,p.fn,void 0,!0),x){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,c),!0;case 3:return p.fn.call(p.context,c,u),!0;case 4:return p.fn.call(p.context,c,u,d),!0;case 5:return p.fn.call(p.context,c,u,d,f),!0;case 6:return p.fn.call(p.context,c,u,d,f,_),!0}for(b=1,y=new Array(x-1);b<x;b++)y[b-1]=arguments[b];p.fn.apply(p.context,y)}else{var v=p.length,w;for(b=0;b<v;b++)switch(p[b].once&&this.removeListener(l,p[b].fn,void 0,!0),x){case 1:p[b].fn.call(p[b].context);break;case 2:p[b].fn.call(p[b].context,c);break;case 3:p[b].fn.call(p[b].context,c,u);break;case 4:p[b].fn.call(p[b].context,c,u,d);break;default:if(!y)for(w=1,y=new Array(x-1);w<x;w++)y[w-1]=arguments[w];p[b].fn.apply(p[b].context,y)}}return!0},a.prototype.on=function(l,c,u){return n(this,l,c,u,!1)},a.prototype.once=function(l,c,u){return n(this,l,c,u,!0)},a.prototype.removeListener=function(l,c,u,d){var f=e?e+l:l;if(!this._events[f])return this;if(!c)return o(this,f),this;var _=this._events[f];if(_.fn)_.fn===c&&(!d||_.once)&&(!u||_.context===u)&&o(this,f);else{for(var m=0,p=[],x=_.length;m<x;m++)(_[m].fn!==c||d&&!_[m].once||u&&_[m].context!==u)&&p.push(_[m]);p.length?this._events[f]=p.length===1?p[0]:p:o(this,f)}return this},a.prototype.removeAllListeners=function(l){var c;return l?(c=e?e+l:l,this._events[c]&&o(this,c)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,i.exports=a})(Pm);var wn={},Im={get exports(){return wn},set exports(i){wn=i}};/*! https://mths.be/punycode v1.3.2 by @mathias */(function(i,t){(function(e){var s=t&&!t.nodeType&&t,r=i&&!i.nodeType&&i,n=typeof ho=="object"&&ho;(n.global===n||n.window===n||n.self===n)&&(e=n);var o,a=2147483647,h=36,l=1,c=26,u=38,d=700,f=72,_=128,m="-",p=/^xn--/,x=/[^\x20-\x7E]/,y=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},v=h-l,w=Math.floor,C=String.fromCharCode,A;function T(I){throw RangeError(b[I])}function S(I,F){for(var $=I.length,rt=[];$--;)rt[$]=F(I[$]);return rt}function M(I,F){var $=I.split("@"),rt="";$.length>1&&(rt=$[0]+"@",I=$[1]),I=I.replace(y,".");var q=I.split("."),at=S(q,F).join(".");return rt+at}function L(I){for(var F=[],$=0,rt=I.length,q,at;$<rt;)q=I.charCodeAt($++),q>=55296&&q<=56319&&$<rt?(at=I.charCodeAt($++),(at&64512)==56320?F.push(((q&1023)<<10)+(at&1023)+65536):(F.push(q),$--)):F.push(q);return F}function Q(I){return S(I,function(F){var $="";return F>65535&&(F-=65536,$+=C(F>>>10&1023|55296),F=56320|F&1023),$+=C(F),$}).join("")}function K(I){return I-48<10?I-22:I-65<26?I-65:I-97<26?I-97:h}function Z(I,F){return I+22+75*(I<26)-((F!=0)<<5)}function W(I,F,$){var rt=0;for(I=$?w(I/d):I>>1,I+=w(I/F);I>v*c>>1;rt+=h)I=w(I/v);return w(rt+(v+1)*I/(I+u))}function et(I){var F=[],$=I.length,rt,q=0,at=_,Pt=f,Yt,ge,Re,ze,Rt,ae,ye,oi,wi;for(Yt=I.lastIndexOf(m),Yt<0&&(Yt=0),ge=0;ge<Yt;++ge)I.charCodeAt(ge)>=128&&T("not-basic"),F.push(I.charCodeAt(ge));for(Re=Yt>0?Yt+1:0;Re<$;){for(ze=q,Rt=1,ae=h;Re>=$&&T("invalid-input"),ye=K(I.charCodeAt(Re++)),(ye>=h||ye>w((a-q)/Rt))&&T("overflow"),q+=ye*Rt,oi=ae<=Pt?l:ae>=Pt+c?c:ae-Pt,!(ye<oi);ae+=h)wi=h-oi,Rt>w(a/wi)&&T("overflow"),Rt*=wi;rt=F.length+1,Pt=W(q-ze,rt,ze==0),w(q/rt)>a-at&&T("overflow"),at+=w(q/rt),q%=rt,F.splice(q++,0,at)}return Q(F)}function nt(I){var F,$,rt,q,at,Pt,Yt,ge,Re,ze,Rt,ae=[],ye,oi,wi,oo;for(I=L(I),ye=I.length,F=_,$=0,at=f,Pt=0;Pt<ye;++Pt)Rt=I[Pt],Rt<128&&ae.push(C(Rt));for(rt=q=ae.length,q&&ae.push(m);rt<ye;){for(Yt=a,Pt=0;Pt<ye;++Pt)Rt=I[Pt],Rt>=F&&Rt<Yt&&(Yt=Rt);for(oi=rt+1,Yt-F>w((a-$)/oi)&&T("overflow"),$+=(Yt-F)*oi,F=Yt,Pt=0;Pt<ye;++Pt)if(Rt=I[Pt],Rt<F&&++$>a&&T("overflow"),Rt==F){for(ge=$,Re=h;ze=Re<=at?l:Re>=at+c?c:Re-at,!(ge<ze);Re+=h)oo=ge-ze,wi=h-ze,ae.push(C(Z(ze+oo%wi,0))),ge=w(oo/wi);ae.push(C(Z(ge,0))),at=W($,oi,rt==q),$=0,++rt}++$,++F}return ae.join("")}function Et(I){return M(I,function(F){return p.test(F)?et(F.slice(4).toLowerCase()):F})}function He(I){return M(I,function(F){return x.test(F)?"xn--"+nt(F):F})}if(o={version:"1.3.2",ucs2:{decode:L,encode:Q},decode:et,encode:nt,toASCII:He,toUnicode:Et},s&&r)if(i.exports==s)r.exports=o;else for(A in o)o.hasOwnProperty(A)&&(s[A]=o[A]);else e.punycode=o})(ho)})(Im,wn);var Mm={isString:function(i){return typeof i=="string"},isObject:function(i){return typeof i=="object"&&i!==null},isNull:function(i){return i===null},isNullOrUndefined:function(i){return i==null}},_r={};function Rm(i,t){return Object.prototype.hasOwnProperty.call(i,t)}var km=function(i,t,e,s){t=t||"&",e=e||"=";var r={};if(typeof i!="string"||i.length===0)return r;var n=/\+/g;i=i.split(t);var o=1e3;s&&typeof s.maxKeys=="number"&&(o=s.maxKeys);var a=i.length;o>0&&a>o&&(a=o);for(var h=0;h<a;++h){var l=i[h].replace(n,"%20"),c=l.indexOf(e),u,d,f,_;c>=0?(u=l.substr(0,c),d=l.substr(c+1)):(u=l,d=""),f=decodeURIComponent(u),_=decodeURIComponent(d),Rm(r,f)?Array.isArray(r[f])?r[f].push(_):r[f]=[r[f],_]:r[f]=_}return r},Vs=function(i){switch(typeof i){case"string":return i;case"boolean":return i?"true":"false";case"number":return isFinite(i)?i:"";default:return""}},Bm=function(i,t,e,s){return t=t||"&",e=e||"=",i===null&&(i=void 0),typeof i=="object"?Object.keys(i).map(function(r){var n=encodeURIComponent(Vs(r))+e;return Array.isArray(i[r])?i[r].map(function(o){return n+encodeURIComponent(Vs(o))}).join(t):n+encodeURIComponent(Vs(i[r]))}).join(t):s?encodeURIComponent(Vs(s))+e+encodeURIComponent(Vs(i)):""};_r.decode=_r.parse=km;_r.encode=_r.stringify=Bm;var Lm=wn,Be=Mm,Om=zn,Fm=Xm,Nm=jm;function Ee(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Um=/^([a-z0-9.+-]+:)/i,Dm=/:[0-9]*$/,Gm=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Vm=["<",">",'"',"`"," ","\r",`
`,"	"],$m=["{","}","|","\\","^","`"].concat(Vm),va=["'"].concat($m),Pl=["%","/","?",";","#"].concat(va),Il=["/","?","#"],Hm=255,Ml=/^[+a-z0-9A-Z_-]{0,63}$/,zm=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Wm={javascript:!0,"javascript:":!0},wa={javascript:!0,"javascript:":!0},xs={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Ta=_r;function zn(i,t,e){if(i&&Be.isObject(i)&&i instanceof Ee)return i;var s=new Ee;return s.parse(i,t,e),s}Ee.prototype.parse=function(i,t,e){if(!Be.isString(i))throw new TypeError("Parameter 'url' must be a string, not "+typeof i);var s=i.indexOf("?"),r=s!==-1&&s<i.indexOf("#")?"?":"#",n=i.split(r),o=/\\/g;n[0]=n[0].replace(o,"/"),i=n.join(r);var a=i;if(a=a.trim(),!e&&i.split("#").length===1){var h=Gm.exec(a);if(h)return this.path=a,this.href=a,this.pathname=h[1],h[2]?(this.search=h[2],t?this.query=Ta.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var l=Um.exec(a);if(l){l=l[0];var c=l.toLowerCase();this.protocol=c,a=a.substr(l.length)}if(e||l||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var u=a.substr(0,2)==="//";u&&!(l&&wa[l])&&(a=a.substr(2),this.slashes=!0)}if(!wa[l]&&(u||l&&!xs[l])){for(var d=-1,f=0;f<Il.length;f++){var _=a.indexOf(Il[f]);_!==-1&&(d===-1||_<d)&&(d=_)}var m,p;d===-1?p=a.lastIndexOf("@"):p=a.lastIndexOf("@",d),p!==-1&&(m=a.slice(0,p),a=a.slice(p+1),this.auth=decodeURIComponent(m)),d=-1;for(var f=0;f<Pl.length;f++){var _=a.indexOf(Pl[f]);_!==-1&&(d===-1||_<d)&&(d=_)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var x=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!x)for(var y=this.hostname.split(/\./),f=0,b=y.length;f<b;f++){var v=y[f];if(v&&!v.match(Ml)){for(var w="",C=0,A=v.length;C<A;C++)v.charCodeAt(C)>127?w+="x":w+=v[C];if(!w.match(Ml)){var T=y.slice(0,f),S=y.slice(f+1),M=v.match(zm);M&&(T.push(M[1]),S.unshift(M[2])),S.length&&(a="/"+S.join(".")+a),this.hostname=T.join(".");break}}}this.hostname.length>Hm?this.hostname="":this.hostname=this.hostname.toLowerCase(),x||(this.hostname=Lm.toASCII(this.hostname));var L=this.port?":"+this.port:"",Q=this.hostname||"";this.host=Q+L,this.href+=this.host,x&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!Wm[c])for(var f=0,b=va.length;f<b;f++){var K=va[f];if(a.indexOf(K)!==-1){var Z=encodeURIComponent(K);Z===K&&(Z=escape(K)),a=a.split(K).join(Z)}}var W=a.indexOf("#");W!==-1&&(this.hash=a.substr(W),a=a.slice(0,W));var et=a.indexOf("?");if(et!==-1?(this.search=a.substr(et),this.query=a.substr(et+1),t&&(this.query=Ta.parse(this.query)),a=a.slice(0,et)):t&&(this.search="",this.query={}),a&&(this.pathname=a),xs[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var L=this.pathname||"",nt=this.search||"";this.path=L+nt}return this.href=this.format(),this};function jm(i){return Be.isString(i)&&(i=zn(i)),i instanceof Ee?i.format():Ee.prototype.format.call(i)}Ee.prototype.format=function(){var i=this.auth||"";i&&(i=encodeURIComponent(i),i=i.replace(/%3A/i,":"),i+="@");var t=this.protocol||"",e=this.pathname||"",s=this.hash||"",r=!1,n="";this.host?r=i+this.host:this.hostname&&(r=i+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&Be.isObject(this.query)&&Object.keys(this.query).length&&(n=Ta.stringify(this.query));var o=this.search||n&&"?"+n||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||xs[t])&&r!==!1?(r="//"+(r||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):r||(r=""),s&&s.charAt(0)!=="#"&&(s="#"+s),o&&o.charAt(0)!=="?"&&(o="?"+o),e=e.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),t+r+e+o+s};function Xm(i,t){return zn(i,!1,!0).resolve(t)}Ee.prototype.resolve=function(i){return this.resolveObject(zn(i,!1,!0)).format()};Ee.prototype.resolveObject=function(i){if(Be.isString(i)){var t=new Ee;t.parse(i,!1,!0),i=t}for(var e=new Ee,s=Object.keys(this),r=0;r<s.length;r++){var n=s[r];e[n]=this[n]}if(e.hash=i.hash,i.href==="")return e.href=e.format(),e;if(i.slashes&&!i.protocol){for(var o=Object.keys(i),a=0;a<o.length;a++){var h=o[a];h!=="protocol"&&(e[h]=i[h])}return xs[e.protocol]&&e.hostname&&!e.pathname&&(e.path=e.pathname="/"),e.href=e.format(),e}if(i.protocol&&i.protocol!==e.protocol){if(!xs[i.protocol]){for(var l=Object.keys(i),c=0;c<l.length;c++){var u=l[c];e[u]=i[u]}return e.href=e.format(),e}if(e.protocol=i.protocol,!i.host&&!wa[i.protocol]){for(var b=(i.pathname||"").split("/");b.length&&!(i.host=b.shift()););i.host||(i.host=""),i.hostname||(i.hostname=""),b[0]!==""&&b.unshift(""),b.length<2&&b.unshift(""),e.pathname=b.join("/")}else e.pathname=i.pathname;if(e.search=i.search,e.query=i.query,e.host=i.host||"",e.auth=i.auth,e.hostname=i.hostname||i.host,e.port=i.port,e.pathname||e.search){var d=e.pathname||"",f=e.search||"";e.path=d+f}return e.slashes=e.slashes||i.slashes,e.href=e.format(),e}var _=e.pathname&&e.pathname.charAt(0)==="/",m=i.host||i.pathname&&i.pathname.charAt(0)==="/",p=m||_||e.host&&i.pathname,x=p,y=e.pathname&&e.pathname.split("/")||[],b=i.pathname&&i.pathname.split("/")||[],v=e.protocol&&!xs[e.protocol];if(v&&(e.hostname="",e.port=null,e.host&&(y[0]===""?y[0]=e.host:y.unshift(e.host)),e.host="",i.protocol&&(i.hostname=null,i.port=null,i.host&&(b[0]===""?b[0]=i.host:b.unshift(i.host)),i.host=null),p=p&&(b[0]===""||y[0]==="")),m)e.host=i.host||i.host===""?i.host:e.host,e.hostname=i.hostname||i.hostname===""?i.hostname:e.hostname,e.search=i.search,e.query=i.query,y=b;else if(b.length)y||(y=[]),y.pop(),y=y.concat(b),e.search=i.search,e.query=i.query;else if(!Be.isNullOrUndefined(i.search)){if(v){e.hostname=e.host=y.shift();var w=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;w&&(e.auth=w.shift(),e.host=e.hostname=w.shift())}return e.search=i.search,e.query=i.query,(!Be.isNull(e.pathname)||!Be.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!y.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var C=y.slice(-1)[0],A=(e.host||i.host||y.length>1)&&(C==="."||C==="..")||C==="",T=0,S=y.length;S>=0;S--)C=y[S],C==="."?y.splice(S,1):C===".."?(y.splice(S,1),T++):T&&(y.splice(S,1),T--);if(!p&&!x)for(;T--;T)y.unshift("..");p&&y[0]!==""&&(!y[0]||y[0].charAt(0)!=="/")&&y.unshift(""),A&&y.join("/").substr(-1)!=="/"&&y.push("");var M=y[0]===""||y[0]&&y[0].charAt(0)==="/";if(v){e.hostname=e.host=M?"":y.length?y.shift():"";var w=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;w&&(e.auth=w.shift(),e.host=e.hostname=w.shift())}return p=p||e.host&&y.length,p&&!M&&y.unshift(""),y.length?e.pathname=y.join("/"):(e.pathname=null,e.path=null),(!Be.isNull(e.pathname)||!Be.isNull(e.search))&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=i.auth||e.auth,e.slashes=e.slashes||i.slashes,e.href=e.format(),e};Ee.prototype.parseHost=function(){var i=this.host,t=Dm.exec(i);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),i=i.substr(0,i.length-t.length)),i&&(this.hostname=i)};const Ym={parse:Om,format:Nm,resolve:Fm};function xe(i){if(typeof i!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(i)}`)}function $s(i){return i.split("?")[0].split("#")[0]}function qm(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Km(i,t,e){return i.replace(new RegExp(qm(t),"g"),e)}function Zm(i,t){let e="",s=0,r=-1,n=0,o=-1;for(let a=0;a<=i.length;++a){if(a<i.length)o=i.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||n===1))if(r!==a-1&&n===2){if(e.length<2||s!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const h=e.lastIndexOf("/");if(h!==e.length-1){h===-1?(e="",s=0):(e=e.slice(0,h),s=e.length-1-e.lastIndexOf("/")),r=a,n=0;continue}}else if(e.length===2||e.length===1){e="",s=0,r=a,n=0;continue}}t&&(e.length>0?e+="/..":e="..",s=2)}else e.length>0?e+=`/${i.slice(r+1,a)}`:e=i.slice(r+1,a),s=a-r-1;r=a,n=0}else o===46&&n!==-1?++n:n=-1}return e}const Xt={toPosix(i){return Km(i,"\\","/")},isUrl(i){return/^https?:/.test(this.toPosix(i))},isDataUrl(i){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(i)},hasProtocol(i){return/^[^/:]+:\//.test(this.toPosix(i))},getProtocol(i){xe(i),i=this.toPosix(i);let t="";const e=/^file:\/\/\//.exec(i),s=/^[^/:]+:\/\//.exec(i),r=/^[^/:]+:\//.exec(i);if(e||s||r){const n=(e==null?void 0:e[0])||(s==null?void 0:s[0])||(r==null?void 0:r[0]);t=n,i=i.slice(n.length)}return t},toAbsolute(i,t,e){if(this.isDataUrl(i))return i;const s=$s(this.toPosix(t??V.ADAPTER.getBaseUrl())),r=$s(this.toPosix(e??this.rootname(s)));return xe(i),i=this.toPosix(i),i.startsWith("/")?Xt.join(r,i.slice(1)):this.isAbsolute(i)?i:this.join(s,i)},normalize(i){if(i=this.toPosix(i),xe(i),i.length===0)return".";let t="";const e=i.startsWith("/");this.hasProtocol(i)&&(t=this.rootname(i),i=i.slice(t.length));const s=i.endsWith("/");return i=Zm(i,!1),i.length>0&&s&&(i+="/"),e?`/${i}`:t+i},isAbsolute(i){return xe(i),i=this.toPosix(i),this.hasProtocol(i)?!0:i.startsWith("/")},join(...i){if(i.length===0)return".";let t;for(let e=0;e<i.length;++e){const s=i[e];if(xe(s),s.length>0)if(t===void 0)t=s;else{const r=i[e-1]??"";this.extname(r)?t+=`/../${s}`:t+=`/${s}`}}return t===void 0?".":this.normalize(t)},dirname(i){if(xe(i),i.length===0)return".";i=this.toPosix(i);let t=i.charCodeAt(0);const e=t===47;let s=-1,r=!0;const n=this.getProtocol(i),o=i;i=i.slice(n.length);for(let a=i.length-1;a>=1;--a)if(t=i.charCodeAt(a),t===47){if(!r){s=a;break}}else r=!1;return s===-1?e?"/":this.isUrl(o)?n+i:n:e&&s===1?"//":n+i.slice(0,s)},rootname(i){xe(i),i=this.toPosix(i);let t="";if(i.startsWith("/")?t="/":t=this.getProtocol(i),this.isUrl(i)){const e=i.indexOf("/",t.length);e!==-1?t=i.slice(0,e):t=i,t.endsWith("/")||(t+="/")}return t},basename(i,t){xe(i),t&&xe(t),i=$s(this.toPosix(i));let e=0,s=-1,r=!0,n;if(t!==void 0&&t.length>0&&t.length<=i.length){if(t.length===i.length&&t===i)return"";let o=t.length-1,a=-1;for(n=i.length-1;n>=0;--n){const h=i.charCodeAt(n);if(h===47){if(!r){e=n+1;break}}else a===-1&&(r=!1,a=n+1),o>=0&&(h===t.charCodeAt(o)?--o===-1&&(s=n):(o=-1,s=a))}return e===s?s=a:s===-1&&(s=i.length),i.slice(e,s)}for(n=i.length-1;n>=0;--n)if(i.charCodeAt(n)===47){if(!r){e=n+1;break}}else s===-1&&(r=!1,s=n+1);return s===-1?"":i.slice(e,s)},extname(i){xe(i),i=$s(this.toPosix(i));let t=-1,e=0,s=-1,r=!0,n=0;for(let o=i.length-1;o>=0;--o){const a=i.charCodeAt(o);if(a===47){if(!r){e=o+1;break}continue}s===-1&&(r=!1,s=o+1),a===46?t===-1?t=o:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||s===-1||n===0||n===1&&t===s-1&&t===e+1?"":i.slice(t,s)},parse(i){xe(i);const t={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return t;i=$s(this.toPosix(i));let e=i.charCodeAt(0);const s=this.isAbsolute(i);let r;t.root=this.rootname(i),s||this.hasProtocol(i)?r=1:r=0;let n=-1,o=0,a=-1,h=!0,l=i.length-1,c=0;for(;l>=r;--l){if(e=i.charCodeAt(l),e===47){if(!h){o=l+1;break}continue}a===-1&&(h=!1,a=l+1),e===46?n===-1?n=l:c!==1&&(c=1):n!==-1&&(c=-1)}return n===-1||a===-1||c===0||c===1&&n===a-1&&n===o+1?a!==-1&&(o===0&&s?t.base=t.name=i.slice(1,a):t.base=t.name=i.slice(o,a)):(o===0&&s?(t.name=i.slice(1,n),t.base=i.slice(1,a)):(t.name=i.slice(o,n),t.base=i.slice(o,a)),t.ext=i.slice(n,a)),t.dir=this.dirname(i),t},sep:"/",delimiter:":"},Rl={};function tt(i,t,e=3){if(Rl[t])return;let s=new Error().stack;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`):(s=s.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${i}`),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${i}`),console.warn(s))),Rl[t]=!0}let Ro;function Jm(){return typeof Ro>"u"&&(Ro=function(){var e;const t={stencil:!0,failIfMajorPerformanceCaveat:V.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!V.ADAPTER.getWebGLRenderingContext())return!1;const s=V.ADAPTER.createCanvas();let r=s.getContext("webgl",t)||s.getContext("experimental-webgl",t);const n=!!((e=r==null?void 0:r.getContextAttributes())!=null&&e.stencil);if(r){const o=r.getExtension("WEBGL_lose_context");o&&o.loseContext()}return r=null,n}catch{return!1}}()),Ro}var Qm="#f0f8ff",tg="#faebd7",eg="#00ffff",ig="#7fffd4",sg="#f0ffff",rg="#f5f5dc",ng="#ffe4c4",og="#000000",ag="#ffebcd",hg="#0000ff",lg="#8a2be2",cg="#a52a2a",ug="#deb887",dg="#5f9ea0",fg="#7fff00",pg="#d2691e",_g="#ff7f50",mg="#6495ed",gg="#fff8dc",yg="#dc143c",bg="#00ffff",xg="#00008b",vg="#008b8b",wg="#b8860b",Tg="#a9a9a9",Cg="#006400",Sg="#a9a9a9",Ag="#bdb76b",Eg="#8b008b",Pg="#556b2f",Ig="#ff8c00",Mg="#9932cc",Rg="#8b0000",kg="#e9967a",Bg="#8fbc8f",Lg="#483d8b",Og="#2f4f4f",Fg="#2f4f4f",Ng="#00ced1",Ug="#9400d3",Dg="#ff1493",Gg="#00bfff",Vg="#696969",$g="#696969",Hg="#1e90ff",zg="#b22222",Wg="#fffaf0",jg="#228b22",Xg="#ff00ff",Yg="#dcdcdc",qg="#f8f8ff",Kg="#daa520",Zg="#ffd700",Jg="#808080",Qg="#008000",ty="#adff2f",ey="#808080",iy="#f0fff0",sy="#ff69b4",ry="#cd5c5c",ny="#4b0082",oy="#fffff0",ay="#f0e68c",hy="#fff0f5",ly="#e6e6fa",cy="#7cfc00",uy="#fffacd",dy="#add8e6",fy="#f08080",py="#e0ffff",_y="#fafad2",my="#d3d3d3",gy="#90ee90",yy="#d3d3d3",by="#ffb6c1",xy="#ffa07a",vy="#20b2aa",wy="#87cefa",Ty="#778899",Cy="#778899",Sy="#b0c4de",Ay="#ffffe0",Ey="#00ff00",Py="#32cd32",Iy="#faf0e6",My="#ff00ff",Ry="#800000",ky="#66cdaa",By="#0000cd",Ly="#ba55d3",Oy="#9370db",Fy="#3cb371",Ny="#7b68ee",Uy="#00fa9a",Dy="#48d1cc",Gy="#c71585",Vy="#191970",$y="#f5fffa",Hy="#ffe4e1",zy="#ffe4b5",Wy="#ffdead",jy="#000080",Xy="#fdf5e6",Yy="#808000",qy="#6b8e23",Ky="#ffa500",Zy="#ff4500",Jy="#da70d6",Qy="#eee8aa",t0="#98fb98",e0="#afeeee",i0="#db7093",s0="#ffefd5",r0="#ffdab9",n0="#cd853f",o0="#ffc0cb",a0="#dda0dd",h0="#b0e0e6",l0="#800080",c0="#663399",u0="#ff0000",d0="#bc8f8f",f0="#4169e1",p0="#8b4513",_0="#fa8072",m0="#f4a460",g0="#2e8b57",y0="#fff5ee",b0="#a0522d",x0="#c0c0c0",v0="#87ceeb",w0="#6a5acd",T0="#708090",C0="#708090",S0="#fffafa",A0="#00ff7f",E0="#4682b4",P0="#d2b48c",I0="#008080",M0="#d8bfd8",R0="#ff6347",k0="#40e0d0",B0="#ee82ee",L0="#f5deb3",O0="#ffffff",F0="#f5f5f5",N0="#ffff00",U0="#9acd32",D0={aliceblue:Qm,antiquewhite:tg,aqua:eg,aquamarine:ig,azure:sg,beige:rg,bisque:ng,black:og,blanchedalmond:ag,blue:hg,blueviolet:lg,brown:cg,burlywood:ug,cadetblue:dg,chartreuse:fg,chocolate:pg,coral:_g,cornflowerblue:mg,cornsilk:gg,crimson:yg,cyan:bg,darkblue:xg,darkcyan:vg,darkgoldenrod:wg,darkgray:Tg,darkgreen:Cg,darkgrey:Sg,darkkhaki:Ag,darkmagenta:Eg,darkolivegreen:Pg,darkorange:Ig,darkorchid:Mg,darkred:Rg,darksalmon:kg,darkseagreen:Bg,darkslateblue:Lg,darkslategray:Og,darkslategrey:Fg,darkturquoise:Ng,darkviolet:Ug,deeppink:Dg,deepskyblue:Gg,dimgray:Vg,dimgrey:$g,dodgerblue:Hg,firebrick:zg,floralwhite:Wg,forestgreen:jg,fuchsia:Xg,gainsboro:Yg,ghostwhite:qg,goldenrod:Kg,gold:Zg,gray:Jg,green:Qg,greenyellow:ty,grey:ey,honeydew:iy,hotpink:sy,indianred:ry,indigo:ny,ivory:oy,khaki:ay,lavenderblush:hy,lavender:ly,lawngreen:cy,lemonchiffon:uy,lightblue:dy,lightcoral:fy,lightcyan:py,lightgoldenrodyellow:_y,lightgray:my,lightgreen:gy,lightgrey:yy,lightpink:by,lightsalmon:xy,lightseagreen:vy,lightskyblue:wy,lightslategray:Ty,lightslategrey:Cy,lightsteelblue:Sy,lightyellow:Ay,lime:Ey,limegreen:Py,linen:Iy,magenta:My,maroon:Ry,mediumaquamarine:ky,mediumblue:By,mediumorchid:Ly,mediumpurple:Oy,mediumseagreen:Fy,mediumslateblue:Ny,mediumspringgreen:Uy,mediumturquoise:Dy,mediumvioletred:Gy,midnightblue:Vy,mintcream:$y,mistyrose:Hy,moccasin:zy,navajowhite:Wy,navy:jy,oldlace:Xy,olive:Yy,olivedrab:qy,orange:Ky,orangered:Zy,orchid:Jy,palegoldenrod:Qy,palegreen:t0,paleturquoise:e0,palevioletred:i0,papayawhip:s0,peachpuff:r0,peru:n0,pink:o0,plum:a0,powderblue:h0,purple:l0,rebeccapurple:c0,red:u0,rosybrown:d0,royalblue:f0,saddlebrown:p0,salmon:_0,sandybrown:m0,seagreen:g0,seashell:y0,sienna:b0,silver:x0,skyblue:v0,slateblue:w0,slategray:T0,slategrey:C0,snow:S0,springgreen:A0,steelblue:E0,tan:P0,teal:I0,thistle:M0,tomato:R0,turquoise:k0,violet:B0,wheat:L0,white:O0,whitesmoke:F0,yellow:N0,yellowgreen:U0};function G0(i,t=[]){return t[0]=(i>>16&255)/255,t[1]=(i>>8&255)/255,t[2]=(i&255)/255,t}function V0(i){let t=i.toString(16);return t="000000".substring(0,6-t.length)+t,`#${t}`}function $0(i){if(typeof i=="string"&&(i=D0[i.toLowerCase()]||i,i[0]==="#"&&(i=i.slice(1)),i.length===3)){const[t,e,s]=i;i=t+t+e+e+s+s}return parseInt(i,16)}function H0(){const i=[],t=[];for(let s=0;s<32;s++)i[s]=s,t[s]=s;i[N.NORMAL_NPM]=N.NORMAL,i[N.ADD_NPM]=N.ADD,i[N.SCREEN_NPM]=N.SCREEN,t[N.NORMAL]=N.NORMAL_NPM,t[N.ADD]=N.ADD_NPM,t[N.SCREEN]=N.SCREEN_NPM;const e=[];return e.push(t),e.push(i),e}const z0=H0();function W0(i,t){if(t===1)return(t*255<<24)+i;if(t===0)return 0;let e=i>>16&255,s=i>>8&255,r=i&255;return e=e*t+.5|0,s=s*t+.5|0,r=r*t+.5|0,(t*255<<24)+(e<<16)+(s<<8)+r}function Pu(i){if(i.BYTES_PER_ELEMENT===4)return i instanceof Float32Array?"Float32Array":i instanceof Uint32Array?"Uint32Array":"Int32Array";if(i.BYTES_PER_ELEMENT===2){if(i instanceof Uint16Array)return"Uint16Array"}else if(i.BYTES_PER_ELEMENT===1&&i instanceof Uint8Array)return"Uint8Array";return null}function Tn(i){return i+=i===0?1:0,--i,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i+1}function kl(i){return!(i&i-1)&&!!i}function Bl(i){let t=(i>65535?1:0)<<4;i>>>=t;let e=(i>255?1:0)<<3;return i>>>=e,t|=e,e=(i>15?1:0)<<2,i>>>=e,t|=e,e=(i>3?1:0)<<1,i>>>=e,t|=e,t|i>>1}function j0(i,t,e){const s=i.length;let r;if(t>=s||e===0)return;e=t+e>s?s-t:e;const n=s-e;for(r=t;r<n;++r)i[r]=i[r+e];i.length=n}let X0=0;function mr(){return++X0}const Ll={},ke=Object.create(null),ai=Object.create(null);let jr;function Y0(i,t=globalThis.location){if(i.startsWith("data:"))return"";t=t||globalThis.location,jr||(jr=document.createElement("a")),jr.href=i;const e=Ym.parse(jr.href),s=!e.port&&t.port===""||e.port===t.port;return e.hostname!==t.hostname||!s||e.protocol!==t.protocol?"anonymous":""}function Cn(i,t=1){var s;const e=(s=V.RETINA_PREFIX)==null?void 0:s.exec(i);return e?parseFloat(e[1]):t}var B=(i=>(i.Renderer="renderer",i.Application="application",i.RendererSystem="renderer-webgl-system",i.RendererPlugin="renderer-webgl-plugin",i.CanvasRendererSystem="renderer-canvas-system",i.CanvasRendererPlugin="renderer-canvas-plugin",i.Asset="asset",i.LoadParser="load-parser",i.ResolveParser="resolve-parser",i.CacheParser="cache-parser",i.DetectionParser="detection-parser",i))(B||{});const Ca=i=>{if(typeof i=="function"||typeof i=="object"&&i.extension){if(!i.extension)throw new Error("Extension class must have an extension object");i={...typeof i.extension!="object"?{type:i.extension}:i.extension,ref:i}}if(typeof i=="object")i={...i};else throw new Error("Invalid extension type");return typeof i.type=="string"&&(i.type=[i.type]),i},Ol=(i,t)=>Ca(i).priority??t,D={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...i){return i.map(Ca).forEach(t=>{t.type.forEach(e=>{var s,r;return(r=(s=this._removeHandlers)[e])==null?void 0:r.call(s,t)})}),this},add(...i){return i.map(Ca).forEach(t=>{t.type.forEach(e=>{const s=this._addHandlers,r=this._queue;s[e]?s[e](t):(r[e]=r[e]||[],r[e].push(t))})}),this},handle(i,t,e){const s=this._addHandlers,r=this._removeHandlers;if(s[i]||r[i])throw new Error(`Extension type ${i} already has a handler`);s[i]=t,r[i]=e;const n=this._queue;return n[i]&&(n[i].forEach(o=>t(o)),delete n[i]),this},handleByMap(i,t){return this.handle(i,e=>{t[e.name]=e.ref},e=>{delete t[e.name]})},handleByList(i,t,e=-1){return this.handle(i,s=>{t.includes(s.ref)||(t.push(s.ref),t.sort((r,n)=>Ol(n,e)-Ol(r,e)))},s=>{const r=t.indexOf(s.ref);r!==-1&&t.splice(r,1)})}};class q0{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const K0=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Z0(i){let t="";for(let e=0;e<i;++e)e>0&&(t+=`
else `),e<i-1&&(t+=`if(test == ${e}.0){}`);return t}function J0(i,t){if(i===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);for(;;){const s=K0.replace(/%forloop%/gi,Z0(i));if(t.shaderSource(e,s),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))i=i/2|0;else break}return i}const ko=0,Bo=1,Lo=2,Oo=3,Fo=4,No=5;class Lr{constructor(){this.data=0,this.blendMode=N.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<ko)}set blend(t){!!(this.data&1<<ko)!==t&&(this.data^=1<<ko)}get offsets(){return!!(this.data&1<<Bo)}set offsets(t){!!(this.data&1<<Bo)!==t&&(this.data^=1<<Bo)}get culling(){return!!(this.data&1<<Lo)}set culling(t){!!(this.data&1<<Lo)!==t&&(this.data^=1<<Lo)}get depthTest(){return!!(this.data&1<<Oo)}set depthTest(t){!!(this.data&1<<Oo)!==t&&(this.data^=1<<Oo)}get depthMask(){return!!(this.data&1<<No)}set depthMask(t){!!(this.data&1<<No)!==t&&(this.data^=1<<No)}get clockwiseFrontFace(){return!!(this.data&1<<Fo)}set clockwiseFrontFace(t){!!(this.data&1<<Fo)!==t&&(this.data^=1<<Fo)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==N.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new Lr;return t.depthTest=!1,t.blend=!0,t}}const Sa=[];function Iu(i,t){if(!i)return null;let e="";if(typeof i=="string"){const s=/\.(\w{3,4})(?:$|\?|#)/i.exec(i);s&&(e=s[1].toLowerCase())}for(let s=Sa.length-1;s>=0;--s){const r=Sa[s];if(r.test&&r.test(i,e))return new r(i,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class Pe{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,s,r,n,o,a,h){if(arguments.length>8)throw new Error("max arguments reached");const{name:l,items:c}=this;this._aliasCount++;for(let u=0,d=c.length;u<d;u++)c[u][l](t,e,s,r,n,o,a,h);return c===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(Pe.prototype,{dispatch:{value:Pe.prototype.emit},run:{value:Pe.prototype.emit}});class gr{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Pe("setRealSize"),this.onUpdate=new Pe("update"),this.onError=new Pe("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,s){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class lh extends gr{constructor(t,e){const{width:s,height:r}=e||{};if(!s||!r)throw new Error("BufferResource width or height invalid");super(s,r),this.data=t}upload(t,e,s){const r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===bi.UNPACK);const n=e.realWidth,o=e.realHeight;return s.width===n&&s.height===o?r.texSubImage2D(e.target,0,0,0,n,o,e.format,s.type,this.data):(s.width=n,s.height=o,r.texImage2D(e.target,0,s.internalFormat,n,o,0,e.format,s.type,this.data)),!0}dispose(){this.data=null}static test(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array}}const Q0={scaleMode:Je.NEAREST,format:E.RGBA,alphaMode:bi.NPM},as=class extends Ve{constructor(i=null,t=null){super(),t=Object.assign({},as.defaultOptions,t);const{alphaMode:e,mipmap:s,anisotropicLevel:r,scaleMode:n,width:o,height:a,wrapMode:h,format:l,type:c,target:u,resolution:d,resourceOptions:f}=t;i&&!(i instanceof gr)&&(i=Iu(i,f),i.internal=!0),this.resolution=d||V.RESOLUTION,this.width=Math.round((o||0)*this.resolution)/this.resolution,this.height=Math.round((a||0)*this.resolution)/this.resolution,this._mipmap=s,this.anisotropicLevel=r,this._wrapMode=h,this._scaleMode=n,this.format=l,this.type=c,this.target=u,this.alphaMode=e,this.uid=mr(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=o>0&&a>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(i)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(i){this._mipmap!==i&&(this._mipmap=i,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(i){this._scaleMode!==i&&(this._scaleMode=i,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(i){this._wrapMode!==i&&(this._wrapMode=i,this.dirtyStyleId++)}setStyle(i,t){let e;return i!==void 0&&i!==this.scaleMode&&(this.scaleMode=i,e=!0),t!==void 0&&t!==this.mipmap&&(this.mipmap=t,e=!0),e&&this.dirtyStyleId++,this}setSize(i,t,e){return e=e||this.resolution,this.setRealSize(i*e,t*e,e)}setRealSize(i,t,e){return this.resolution=e||this.resolution,this.width=Math.round(i)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=kl(this.realWidth)&&kl(this.realHeight)}setResolution(i){const t=this.resolution;return t===i?this:(this.resolution=i,this.valid&&(this.width=Math.round(this.width*t)/i,this.height=Math.round(this.height*t)/i,this.emit("update",this)),this._refreshPOT(),this)}setResource(i){if(this.resource===i)return this;if(this.resource)throw new Error("Resource can be set only once");return i.bind(this),this.resource=i,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(i){this.emit("error",this,i)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete ai[this.cacheId],delete ke[this.cacheId],this.cacheId=null),this.dispose(),as.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(i,t,e=V.STRICT_TEXTURE_CACHE){const s=typeof i=="string";let r=null;if(s)r=i;else{if(!i._pixiId){const o=(t==null?void 0:t.pixiIdPrefix)||"pixiid";i._pixiId=`${o}_${mr()}`}r=i._pixiId}let n=ai[r];if(s&&e&&!n)throw new Error(`The cacheId "${r}" does not exist in BaseTextureCache.`);return n||(n=new as(i,t),n.cacheId=r,as.addToCache(n,r)),n}static fromBuffer(i,t,e,s){i=i||new Float32Array(t*e*4);const r=new lh(i,{width:t,height:e}),n=i instanceof Float32Array?Y.FLOAT:Y.UNSIGNED_BYTE;return new as(r,Object.assign({},Q0,s||{width:t,height:e,type:n}))}static addToCache(i,t){t&&(i.textureCacheIds.includes(t)||i.textureCacheIds.push(t),ai[t]&&ai[t]!==i&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),ai[t]=i)}static removeFromCache(i){if(typeof i=="string"){const t=ai[i];if(t){const e=t.textureCacheIds.indexOf(i);return e>-1&&t.textureCacheIds.splice(e,1),delete ai[i],t}}else if(i!=null&&i.textureCacheIds){for(let t=0;t<i.textureCacheIds.length;++t)delete ai[i.textureCacheIds[t]];return i.textureCacheIds.length=0,i}return null}};let j=as;j.defaultOptions={mipmap:Xi.POW2,anisotropicLevel:0,scaleMode:Je.LINEAR,wrapMode:ah.CLAMP,alphaMode:bi.UNPACK,target:bs.TEXTURE_2D,format:E.RGBA,type:Y.UNSIGNED_BYTE};j._globalBatch=0;class tb{constructor(){this.texArray=null,this.blend=0,this.type=vn.TRIANGLES,this.start=0,this.size=0,this.data=null}}let eb=0;class Nt{constructor(t,e=!0,s=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=s,this.static=e,this.id=eb++,this.disposeRunner=new Pe("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?Ue.ELEMENT_ARRAY_BUFFER:Ue.ARRAY_BUFFER}get index(){return this.type===Ue.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new Nt(t)}}class Sn{constructor(t,e=0,s=!1,r=Y.FLOAT,n,o,a,h=1){this.buffer=t,this.size=e,this.normalized=s,this.type=r,this.stride=n,this.start=o,this.instance=a,this.divisor=h}destroy(){this.buffer=null}static from(t,e,s,r,n){return new Sn(t,e,s,r,n)}}const ib={Float32Array,Uint32Array,Int32Array,Uint8Array};function sb(i,t){let e=0,s=0;const r={};for(let h=0;h<i.length;h++)s+=t[h],e+=i[h].length;const n=new ArrayBuffer(e*4);let o=null,a=0;for(let h=0;h<i.length;h++){const l=t[h],c=i[h],u=Pu(c);r[u]||(r[u]=new ib[u](n)),o=r[u];for(let d=0;d<c.length;d++){const f=(d/l|0)*s+a,_=d%l;o[f+_]=c[d]}a+=l}return new Float32Array(n)}const Fl={5126:4,5123:2,5121:1};let rb=0;const nb={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Ps{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=rb++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Pe("disposeGeometry"),this.refCount=0}addAttribute(t,e,s=0,r=!1,n,o,a,h=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Nt||(e instanceof Array&&(e=new Float32Array(e)),e=new Nt(e));const l=t.split("|");if(l.length>1){for(let u=0;u<l.length;u++)this.addAttribute(l[u],e,s,r,n);return this}let c=this.buffers.indexOf(e);return c===-1&&(this.buffers.push(e),c=this.buffers.length-1),this.attributes[t]=new Sn(c,s,r,n,o,a,h),this.instanced=this.instanced||h,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof Nt||(t instanceof Array&&(t=new Uint16Array(t)),t=new Nt(t)),t.type=Ue.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],e=[],s=new Nt;let r;for(r in this.attributes){const n=this.attributes[r],o=this.buffers[n.buffer];t.push(o.data),e.push(n.size*Fl[n.type]/4),n.buffer=0}for(s.data=sb(t,e),r=0;r<this.buffers.length;r++)this.buffers[r]!==this.indexBuffer&&this.buffers[r].destroy();return this.buffers=[s],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new Ps;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new Nt(this.buffers[e].data.slice(0));for(const e in this.attributes){const s=this.attributes[e];t.attributes[e]=new Sn(s.buffer,s.size,s.normalized,s.type,s.stride,s.start,s.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=Ue.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new Ps,s=[],r=[],n=[];let o;for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)r[h]=r[h]||0,r[h]+=o.buffers[h].data.length,n[h]=0}for(let a=0;a<o.buffers.length;a++)s[a]=new nb[Pu(o.buffers[a].data)](r[a]),e.buffers[a]=new Nt(s[a]);for(let a=0;a<t.length;a++){o=t[a];for(let h=0;h<o.buffers.length;h++)s[h].set(o.buffers[h].data,n[h]),n[h]+=o.buffers[h].data.length}if(e.attributes=o.attributes,o.indexBuffer){e.indexBuffer=e.buffers[o.buffers.indexOf(o.indexBuffer)],e.indexBuffer.type=Ue.ELEMENT_ARRAY_BUFFER;let a=0,h=0,l=0,c=0;for(let u=0;u<o.buffers.length;u++)if(o.buffers[u]!==o.indexBuffer){c=u;break}for(const u in o.attributes){const d=o.attributes[u];(d.buffer|0)===c&&(h+=d.size*Fl[d.type]/4)}for(let u=0;u<t.length;u++){const d=t[u].indexBuffer.data;for(let f=0;f<d.length;f++)e.indexBuffer.data[f+l]+=a;a+=t[u].buffers[c].data.length/h,l+=d.length}}return e}}class ob extends Ps{constructor(t=!1){super(),this._buffer=new Nt(null,t,!1),this._indexBuffer=new Nt(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,Y.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,Y.FLOAT).addAttribute("aColor",this._buffer,4,!0,Y.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,Y.FLOAT).addIndex(this._indexBuffer)}}const ab=Math.PI*2;var Mu=(i=>(i[i.POLY=0]="POLY",i[i.RECT=1]="RECT",i[i.CIRC=2]="CIRC",i[i.ELIP=3]="ELIP",i[i.RREC=4]="RREC",i))(Mu||{});class $t{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new $t(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`}}const Xr=[new $t,new $t,new $t,new $t];class vt{constructor(t=0,e=0,s=0,r=0){this.x=Number(t),this.y=Number(e),this.width=Number(s),this.height=Number(r),this.type=Mu.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new vt(0,0,0,0)}clone(){return new vt(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const T=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=T)return!1;const M=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>M}const s=this.left,r=this.right,n=this.top,o=this.bottom;if(r<=s||o<=n)return!1;const a=Xr[0].set(t.left,t.top),h=Xr[1].set(t.left,t.bottom),l=Xr[2].set(t.right,t.top),c=Xr[3].set(t.right,t.bottom);if(l.x<=a.x||h.y<=a.y)return!1;const u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(a,a),e.apply(h,h),e.apply(l,l),e.apply(c,c),Math.max(a.x,h.x,l.x,c.x)<=s||Math.min(a.x,h.x,l.x,c.x)>=r||Math.max(a.y,h.y,l.y,c.y)<=n||Math.min(a.y,h.y,l.y,c.y)>=o))return!1;const d=u*(h.y-a.y),f=u*(a.x-h.x),_=d*s+f*n,m=d*r+f*n,p=d*s+f*o,x=d*r+f*o;if(Math.max(_,m,p,x)<=d*a.x+f*a.y||Math.min(_,m,p,x)>=d*c.x+f*c.y)return!1;const y=u*(a.y-l.y),b=u*(l.x-a.x),v=y*s+b*n,w=y*r+b*n,C=y*s+b*o,A=y*r+b*o;return!(Math.max(v,w,C,A)<=y*a.x+b*a.y||Math.min(v,w,C,A)>=y*c.x+b*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),s=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(s-e,0),this.y=r,this.height=Math.max(n-r,0),this}ceil(t=1,e=.001){const s=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=s-this.x,this.height=r-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),s=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=s-e,this.y=r,this.height=n-r,this}toString(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}class Mt{constructor(t=1,e=0,s=0,r=1,n=0,o=0){this.array=null,this.a=t,this.b=e,this.c=s,this.d=r,this.tx=n,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,s,r,n,o){return this.a=t,this.b=e,this.c=s,this.d=r,this.tx=n,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const s=e||this.array;return t?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(t,e){e=e||new $t;const s=t.x,r=t.y;return e.x=this.a*s+this.c*r+this.tx,e.y=this.b*s+this.d*r+this.ty,e}applyInverse(t,e){e=e||new $t;const s=1/(this.a*this.d+this.c*-this.b),r=t.x,n=t.y;return e.x=this.d*s*r+-this.c*s*n+(this.ty*this.c-this.tx*this.d)*s,e.y=this.a*s*n+-this.b*s*r+(-this.ty*this.a+this.tx*this.b)*s,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),s=Math.sin(t),r=this.a,n=this.c,o=this.tx;return this.a=r*e-this.b*s,this.b=r*s+this.b*e,this.c=n*e-this.d*s,this.d=n*s+this.d*e,this.tx=o*e-this.ty*s,this.ty=o*s+this.ty*e,this}append(t){const e=this.a,s=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*s+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*s+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*s+t.ty*n+this.ty,this}setTransform(t,e,s,r,n,o,a,h,l){return this.a=Math.cos(a+l)*n,this.b=Math.sin(a+l)*n,this.c=-Math.sin(a-h)*o,this.d=Math.cos(a-h)*o,this.tx=t-(s*this.a+r*this.c),this.ty=e-(s*this.b+r*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const s=this.a,r=this.c;this.a=s*t.a+this.b*t.c,this.b=s*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,s=this.b,r=this.c,n=this.d,o=t.pivot,a=-Math.atan2(-r,n),h=Math.atan2(s,e),l=Math.abs(a+h);return l<1e-5||Math.abs(ab-l)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=h),t.scale.x=Math.sqrt(e*e+s*s),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx+(o.x*e+o.y*r),t.position.y=this.ty+(o.x*s+o.y*n),t}invert(){const t=this.a,e=this.b,s=this.c,r=this.d,n=this.tx,o=t*r-e*s;return this.a=r/o,this.b=-e/o,this.c=-s/o,this.d=t/o,this.tx=(s*this.ty-r*n)/o,this.ty=-(t*this.ty-e*n)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Mt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}toString(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return new Mt}static get TEMP_MATRIX(){return new Mt}}const ki=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Bi=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Li=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Oi=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Aa=[],Ru=[],Yr=Math.sign;function hb(){for(let i=0;i<16;i++){const t=[];Aa.push(t);for(let e=0;e<16;e++){const s=Yr(ki[i]*ki[e]+Li[i]*Bi[e]),r=Yr(Bi[i]*ki[e]+Oi[i]*Bi[e]),n=Yr(ki[i]*Li[e]+Li[i]*Oi[e]),o=Yr(Bi[i]*Li[e]+Oi[i]*Oi[e]);for(let a=0;a<16;a++)if(ki[a]===s&&Bi[a]===r&&Li[a]===n&&Oi[a]===o){t.push(a);break}}}for(let i=0;i<16;i++){const t=new Mt;t.set(ki[i],Bi[i],Li[i],Oi[i],0,0),Ru.push(t)}}hb();const lt={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:i=>ki[i],uY:i=>Bi[i],vX:i=>Li[i],vY:i=>Oi[i],inv:i=>i&8?i&15:-i&7,add:(i,t)=>Aa[i][t],sub:(i,t)=>Aa[i][lt.inv(t)],rotate180:i=>i^4,isVertical:i=>(i&3)===2,byDirection:(i,t)=>Math.abs(i)*2<=Math.abs(t)?t>=0?lt.S:lt.N:Math.abs(t)*2<=Math.abs(i)?i>0?lt.E:lt.W:t>0?i>0?lt.SE:lt.SW:i>0?lt.NE:lt.NW,matrixAppendRotationInv:(i,t,e=0,s=0)=>{const r=Ru[lt.inv(t)];r.tx=e,r.ty=s,i.append(r)}};class ps{constructor(t,e,s=0,r=0){this._x=s,this._y=r,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new ps(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[@pixi/math:ObservablePoint x=${0} y=${0} scope=${this.scope}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}const ku=class{constructor(){this.worldTransform=new Mt,this.localTransform=new Mt,this.position=new ps(this.onChange,this,0,0),this.scale=new ps(this.onChange,this,1,1),this.pivot=new ps(this.onChange,this,0,0),this.skew=new ps(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}toString(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}updateLocalTransform(){const i=this.localTransform;this._localID!==this._currentLocalID&&(i.a=this._cx*this.scale.x,i.b=this._sx*this.scale.x,i.c=this._cy*this.scale.y,i.d=this._sy*this.scale.y,i.tx=this.position.x-(this.pivot.x*i.a+this.pivot.y*i.c),i.ty=this.position.y-(this.pivot.x*i.b+this.pivot.y*i.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(i){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==i._worldID){const e=i.worldTransform,s=this.worldTransform;s.a=t.a*e.a+t.b*e.c,s.b=t.a*e.b+t.b*e.d,s.c=t.c*e.a+t.d*e.c,s.d=t.c*e.b+t.d*e.d,s.tx=t.tx*e.a+t.ty*e.c+e.tx,s.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=i._worldID,this._worldID++}}setFromMatrix(i){i.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(i){this._rotation!==i&&(this._rotation=i,this.updateSkew())}};let Bu=ku;Bu.IDENTITY=new ku;var lb=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,cb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Nl(i,t,e){const s=i.createShader(t);return i.shaderSource(s,e),i.compileShader(s),s}function Uo(i){const t=new Array(i);for(let e=0;e<t.length;e++)t[e]=!1;return t}function Lu(i,t){switch(i){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return Uo(2*t);case"bvec3":return Uo(3*t);case"bvec4":return Uo(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const vs=[{test:i=>i.type==="float"&&i.size===1&&!i.isArray,code:i=>`
            if(uv["${i}"] !== ud["${i}"].value)
            {
                ud["${i}"].value = uv["${i}"]
                gl.uniform1f(ud["${i}"].location, uv["${i}"])
            }
            `},{test:(i,t)=>(i.type==="sampler2D"||i.type==="samplerCube"||i.type==="sampler2DArray")&&i.size===1&&!i.isArray&&(t==null||t.castToBaseTexture!==void 0),code:i=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${i}"], t);

            if(ud["${i}"].value !== t)
            {
                ud["${i}"].value = t;
                gl.uniform1i(ud["${i}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(i,t)=>i.type==="mat3"&&i.size===1&&!i.isArray&&t.a!==void 0,code:i=>`
            gl.uniformMatrix3fv(ud["${i}"].location, false, uv["${i}"].toArray(true));
            `,codeUbo:i=>`
                var ${i}_matrix = uv.${i}.toArray(true);

                data[offset] = ${i}_matrix[0];
                data[offset+1] = ${i}_matrix[1];
                data[offset+2] = ${i}_matrix[2];
        
                data[offset + 4] = ${i}_matrix[3];
                data[offset + 5] = ${i}_matrix[4];
                data[offset + 6] = ${i}_matrix[5];
        
                data[offset + 8] = ${i}_matrix[6];
                data[offset + 9] = ${i}_matrix[7];
                data[offset + 10] = ${i}_matrix[8];
            `},{test:(i,t)=>i.type==="vec2"&&i.size===1&&!i.isArray&&t.x!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${i}"].location, v.x, v.y);
                }`,codeUbo:i=>`
                v = uv.${i};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:i=>i.type==="vec2"&&i.size===1&&!i.isArray,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${i}"].location, v[0], v[1]);
                }
            `},{test:(i,t)=>i.type==="vec4"&&i.size===1&&!i.isArray&&t.width!==void 0,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${i}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:i=>`
                    v = uv.${i};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:i=>i.type==="vec4"&&i.size===1&&!i.isArray,code:i=>`
                cv = ud["${i}"].value;
                v = uv["${i}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${i}"].location, v[0], v[1], v[2], v[3])
                }`}],ub={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},db={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function fb(i,t){var s;const e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const r in i.uniforms){const n=t[r];if(!n){(s=i.uniforms[r])!=null&&s.group&&(i.uniforms[r].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${r}, '${r}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${r}, syncData);
                    `));continue}const o=i.uniforms[r];let a=!1;for(let h=0;h<vs.length;h++)if(vs[h].test(n,o)){e.push(vs[h].code(r,o)),a=!0;break}if(!a){const l=(n.size===1&&!n.isArray?ub:db)[n.type].replace("location",`ud["${r}"].location`);e.push(`
            cu = ud["${r}"];
            cv = cu.value;
            v = uv["${r}"];
            ${l};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}const Ou={};let ss=Ou;function pb(){if(ss===Ou||ss!=null&&ss.isContextLost()){const i=V.ADAPTER.createCanvas();let t;V.PREFER_ENV>=Ki.WEBGL2&&(t=i.getContext("webgl2",{})),t||(t=i.getContext("webgl",{})||i.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),ss=t}return ss}let qr;function _b(){if(!qr){qr=ue.MEDIUM;const i=pb();i&&i.getShaderPrecisionFormat&&(qr=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision?ue.HIGH:ue.MEDIUM)}return qr}function Ul(i,t){const e=i.getShaderSource(t).split(`
`).map((l,c)=>`${c}: ${l}`),s=i.getShaderInfoLog(t),r=s.split(`
`),n={},o=r.map(l=>parseFloat(l.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(l=>l&&!n[l]?(n[l]=!0,!0):!1),a=[""];o.forEach(l=>{e[l-1]=`%c${e[l-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const h=e.join(`
`);a[0]=h,console.error(s),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function mb(i,t,e,s){i.getProgramParameter(t,i.LINK_STATUS)||(i.getShaderParameter(e,i.COMPILE_STATUS)||Ul(i,e),i.getShaderParameter(s,i.COMPILE_STATUS)||Ul(i,s),console.error("PixiJS Error: Could not initialize shader."),i.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",i.getProgramInfoLog(t)))}const gb={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Fu(i){return gb[i]}let Kr=null;const Dl={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Nu(i,t){if(!Kr){const e=Object.keys(Dl);Kr={};for(let s=0;s<e.length;++s){const r=e[s];Kr[i[r]]=Dl[r]}}return Kr[t]}function Gl(i,t,e){if(i.substring(0,9)!=="precision"){let s=t;return t===ue.HIGH&&e!==ue.HIGH&&(s=ue.MEDIUM),`precision ${s} float;
${i}`}else if(e!==ue.HIGH&&i.substring(0,15)==="precision highp")return i.replace("precision highp","precision mediump");return i}let Hs;function yb(){if(typeof Hs=="boolean")return Hs;try{Hs=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Hs=!1}return Hs}let bb=0;const Zr={},hs=class{constructor(i,t,e="pixi-shader",s={}){this.extra={},this.id=bb++,this.vertexSrc=i||hs.defaultVertexSrc,this.fragmentSrc=t||hs.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=s,this.vertexSrc.substring(0,8)!=="#version"&&(e=e.replace(/\s+/g,"-"),Zr[e]?(Zr[e]++,e+=`-${Zr[e]}`):Zr[e]=1,this.vertexSrc=`#define SHADER_NAME ${e}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${e}
${this.fragmentSrc}`,this.vertexSrc=Gl(this.vertexSrc,hs.defaultVertexPrecision,ue.HIGH),this.fragmentSrc=Gl(this.fragmentSrc,hs.defaultFragmentPrecision,_b())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return cb}static get defaultFragmentSrc(){return lb}static from(i,t,e){const s=i+t;let r=Ll[s];return r||(Ll[s]=r=new hs(i,t,e)),r}};let Qe=hs;Qe.defaultVertexPrecision=ue.HIGH;Qe.defaultFragmentPrecision=fs.apple.device?ue.HIGH:ue.MEDIUM;let xb=0;class De{constructor(t,e,s){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=xb++,this.static=!!e,this.ubo=!!s,t instanceof Nt?(this.buffer=t,this.buffer.type=Ue.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Nt(new Float32Array(1)),this.buffer.type=Ue.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,s){if(!this.ubo)this.uniforms[t]=new De(e,s);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,s){return new De(t,e,s)}static uboFrom(t,e){return new De(t,e??!0,!0)}}class Wn{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof De?this.uniformGroup=e:this.uniformGroup=new De(e):this.uniformGroup=new De({}),this.disposeRunner=new Pe("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const s in e.uniforms){const r=e.uniforms[s];if(r.group&&this.checkUniformExists(t,r))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,s){const r=Qe.from(t,e);return new Wn(r,s)}}class vb{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const s=new Int32Array(t);for(let n=0;n<t;n++)s[n]=n;this.defaultGroupCache[t]=De.from({uSamplers:s},!0);let r=this.fragTemplate;r=r.replace(/%count%/gi,`${t}`),r=r.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Qe(this.vertexSrc,r)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new Mt,default:this.defaultGroupCache[t]};return new Wn(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let s=0;s<t;s++)s>0&&(e+=`
else `),s<t-1&&(e+=`if(vTextureId < ${s}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${s}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}class wb{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function Tb(){return!fs.apple.device}function Cb(i){let t=!0;const e=V.ADAPTER.getNavigator();if(fs.tablet||fs.phone){if(fs.apple.device){const s=e.userAgent.match(/OS (\d+)_(\d+)?/);s&&parseInt(s[1],10)<11&&(t=!1)}if(fs.android.device){const s=e.userAgent.match(/Android\s([0-9.]*)/);s&&parseInt(s[1],10)<7&&(t=!1)}}return t?i:4}class Uu{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var Sb=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,Ab=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const ve=class extends Uu{constructor(i){super(i),this.setShaderGenerator(),this.geometryClass=ob,this.vertexSize=6,this.state=Lr.for2d(),this.size=ve.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),i.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??Cb(32),this._defaultMaxTextures}static set defaultMaxTextures(i){this._defaultMaxTextures=i}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??Tb(),this._canUploadSameBuffer}static set canUploadSameBuffer(i){this._canUploadSameBuffer=i}get MAX_TEXTURES(){return tt("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return Ab}static get defaultFragmentTemplate(){return Sb}setShaderGenerator({vertex:i=ve.defaultVertexSrc,fragment:t=ve.defaultFragmentTemplate}={}){this.shaderGenerator=new vb(i,t)}contextChange(){const i=this.renderer.gl;V.PREFER_ENV===Ki.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),ve.defaultMaxTextures),this.maxTextures=J0(this.maxTextures,i)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:i,_textureArrayPool:t}=ve,e=this.size/4,s=Math.floor(e/this.maxTextures)+1;for(;i.length<e;)i.push(new tb);for(;t.length<s;)t.push(new wb);for(let r=0;r<this.maxTextures;r++)this._tempBoundTextures[r]=null}onPrerender(){this._flushId=0}render(i){i._texture.valid&&(this._vertexCount+i.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=i.vertexData.length/2,this._indexCount+=i.indices.length,this._bufferedTextures[this._bufferSize]=i._texture.baseTexture,this._bufferedElements[this._bufferSize++]=i)}buildTexturesAndDrawCalls(){const{_bufferedTextures:i,maxTextures:t}=this,e=ve._textureArrayPool,s=this.renderer.batch,r=this._tempBoundTextures,n=this.renderer.textureGC.count;let o=++j._globalBatch,a=0,h=e[0],l=0;s.copyBoundTextures(r,t);for(let c=0;c<this._bufferSize;++c){const u=i[c];i[c]=null,u._batchEnabled!==o&&(h.count>=t&&(s.boundArray(h,r,o,t),this.buildDrawCalls(h,l,c),l=c,h=e[++a],++o),u._batchEnabled=o,u.touched=n,h.elements[h.count++]=u)}h.count>0&&(s.boundArray(h,r,o,t),this.buildDrawCalls(h,l,this._bufferSize),++a,++o);for(let c=0;c<r.length;c++)r[c]=null;j._globalBatch=o}buildDrawCalls(i,t,e){const{_bufferedElements:s,_attributeBuffer:r,_indexBuffer:n,vertexSize:o}=this,a=ve._drawCallPool;let h=this._dcIndex,l=this._aIndex,c=this._iIndex,u=a[h];u.start=this._iIndex,u.texArray=i;for(let d=t;d<e;++d){const f=s[d],_=f._texture.baseTexture,m=z0[_.alphaMode?1:0][f.blendMode];s[d]=null,t<d&&u.blend!==m&&(u.size=c-u.start,t=d,u=a[++h],u.texArray=i,u.start=c),this.packInterleavedGeometry(f,r,n,l,c),l+=f.vertexData.length/2*o,c+=f.indices.length,u.blend=m}t<e&&(u.size=c-u.start,++h),this._dcIndex=h,this._aIndex=l,this._iIndex=c}bindAndClearTexArray(i){const t=this.renderer.texture;for(let e=0;e<i.count;e++)t.bind(i.elements[e],i.ids[e]),i.elements[e]=null;i.count=0}updateGeometry(){const{_packedGeometries:i,_attributeBuffer:t,_indexBuffer:e}=this;ve.canUploadSameBuffer?(i[this._flushId]._buffer.update(t.rawBinaryData),i[this._flushId]._indexBuffer.update(e),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,i[this._flushId]=new this.geometryClass),i[this._flushId]._buffer.update(t.rawBinaryData),i[this._flushId]._indexBuffer.update(e),this.renderer.geometry.bind(i[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const i=this._dcIndex,{gl:t,state:e}=this.renderer,s=ve._drawCallPool;let r=null;for(let n=0;n<i;n++){const{texArray:o,type:a,size:h,start:l,blend:c}=s[n];r!==o&&(r=o,this.bindAndClearTexArray(o)),this.state.blendMode=c,e.set(this.state),t.drawElements(a,h,t.UNSIGNED_SHORT,l*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),ve.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]&&this._packedGeometries[i].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(i){const t=Tn(Math.ceil(i/8)),e=Bl(t),s=t*8;this._aBuffers.length<=e&&(this._iBuffers.length=e+1);let r=this._aBuffers[s];return r||(this._aBuffers[s]=r=new q0(s*this.vertexSize*4)),r}getIndexBuffer(i){const t=Tn(Math.ceil(i/12)),e=Bl(t),s=t*12;this._iBuffers.length<=e&&(this._iBuffers.length=e+1);let r=this._iBuffers[e];return r||(this._iBuffers[e]=r=new Uint16Array(s)),r}packInterleavedGeometry(i,t,e,s,r){const{uint32View:n,float32View:o}=t,a=s/this.vertexSize,h=i.uvs,l=i.indices,c=i.vertexData,u=i._texture.baseTexture._batchLocation,d=Math.min(i.worldAlpha,1),f=d<1&&i._texture.baseTexture.alphaMode?W0(i._tintRGB,d):i._tintRGB+(d*255<<24);for(let _=0;_<c.length;_+=2)o[s++]=c[_],o[s++]=c[_+1],o[s++]=h[_],o[s++]=h[_+1],n[s++]=f,o[s++]=u;for(let _=0;_<l.length;_++)e[r++]=a+l[_]}};let Te=ve;Te.defaultBatchSize=4096;Te.extension={name:"batch",type:B.RendererPlugin};Te._drawCallPool=[];Te._textureArrayPool=[];D.add(Te);var Eb=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,Pb=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const Ks=class extends Wn{constructor(i,t,e){const s=Qe.from(i||Ks.defaultVertexSrc,t||Ks.defaultFragmentSrc);super(s,e),this.padding=0,this.resolution=Ks.defaultResolution,this.multisample=Ks.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new Lr}apply(i,t,e,s,r){i.applyFilter(this,t,e,s)}get blendMode(){return this.state.blendMode}set blendMode(i){this.state.blendMode=i}get resolution(){return this._resolution}set resolution(i){this._resolution=i}static get defaultVertexSrc(){return Pb}static get defaultFragmentSrc(){return Eb}};let hi=Ks;hi.defaultResolution=1;hi.defaultMultisample=yt.NONE;class Du{constructor(){this.clearBeforeRender=!0,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,1],this._backgroundColorString="#000000",this.color=this._backgroundColor,this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender,t.color&&(this.color=typeof t.color=="string"?$0(t.color):t.color),this.alpha=t.alpha}get color(){return this._backgroundColor}set color(t){this._backgroundColor=t,this._backgroundColorString=V0(t),G0(t,this._backgroundColorRgba)}get alpha(){return this._backgroundColorRgba[3]}set alpha(t){this._backgroundColorRgba[3]=t}get colorRgba(){return this._backgroundColorRgba}get colorString(){return this._backgroundColorString}destroy(){}}Du.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"background"};D.add(Du);class Gu{constructor(t){this.renderer=t,this.emptyRenderer=new Uu(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:s}=this.renderer.texture;for(let r=e-1;r>=0;--r)t[r]=s[r]||null,t[r]&&(t[r]._batchLocation=r)}boundArray(t,e,s,r){const{elements:n,ids:o,count:a}=t;let h=0;for(let l=0;l<a;l++){const c=n[l],u=c._batchLocation;if(u>=0&&u<r&&e[u]===c){o[l]=u;continue}for(;h<r;){const d=e[h];if(d&&d._batchEnabled===s&&d._batchLocation===h){h++;continue}o[l]=h,c._batchLocation=h,e[h]=c;break}}}destroy(){this.renderer=null}}Gu.extension={type:B.RendererSystem,name:"batch"};D.add(Gu);let Vl=0;class Vu{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Vl++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,s=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:s,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Vl++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let s;if(V.PREFER_ENV>=Ki.WEBGL2&&(s=t.getContext("webgl2",e)),s)this.webGLVersion=2;else if(this.webGLVersion=1,s=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!s)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=s,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),s="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;s&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=s||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=r,r||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}Vu.extension={type:B.RendererSystem,name:"context"};D.add(Vu);class Ib extends lh{upload(t,e,s){const r=t.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===bi.UNPACK);const n=e.realWidth,o=e.realHeight;return s.width===n&&s.height===o?r.texSubImage2D(e.target,0,0,0,n,o,e.format,s.type,this.data):(s.width=n,s.height=o,r.texImage2D(e.target,0,s.internalFormat,n,o,0,e.format,s.type,this.data)),!0}}class Ea{constructor(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Pe("disposeFramebuffer"),this.multisample=yt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new j(null,{scaleMode:Je.NEAREST,resolution:1,mipmap:Xi.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new j(new Ib(null,{width:this.width,height:this.height}),{scaleMode:Je.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Xi.OFF,format:E.DEPTH_COMPONENT,type:Y.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let s=0;s<this.colorTextures.length;s++){const r=this.colorTextures[s],n=r.resolution;r.setSize(t/n,e/n)}if(this.depthTexture){const s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class $u extends j{constructor(t={}){if(typeof t=="number"){const e=arguments[0],s=arguments[1],r=arguments[2],n=arguments[3];t={width:e,height:s,scaleMode:r,resolution:n}}t.width=t.width||100,t.height=t.height||100,t.multisample??(t.multisample=yt.NONE),super(null,t),this.mipmap=Xi.OFF,this.valid=!0,this.clearColor=[0,0,0,0],this.framebuffer=new Ea(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class pi extends gr{constructor(t){const e=t,s=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;super(s,r),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,s){s===void 0&&!e.startsWith("data:")?t.crossOrigin=Y0(e):s!==!1&&(t.crossOrigin=typeof s=="string"?s:"anonymous")}upload(t,e,s,r){const n=t.gl,o=e.realWidth,a=e.realHeight;if(r=r||this.source,typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement){if(!r.complete||r.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement&&r.readyState<=1&&r.buffered.length===0)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===bi.UNPACK),!this.noSubImage&&e.target===n.TEXTURE_2D&&s.width===o&&s.height===a?n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,s.type,r):(s.width=o,s.height=a,n.texImage2D(e.target,0,s.internalFormat,e.format,s.type,r)),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,s=t.naturalHeight||t.videoHeight||t.height;this.resize(e,s),super.update()}dispose(){this.source=null}}class Hu extends pi{constructor(t,e){if(e=e||{},typeof t=="string"){const s=new Image;pi.crossOrigin(s,t,e.crossorigin),s.src=t,t=s}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??V.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,s)=>{const r=this.source;this.url=r.src;const n=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.resize(r.width,r.height),this._load=null,this.createBitmap?e(this.process()):e(this))};r.complete&&r.src?n():(r.onload=n,r.onerror=o=>{s(o),this.onError.emit(o)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,s=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:s?"cors":"no-cors"}).then(r=>r.blob()).then(r=>e(r,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===bi.UNPACK?"premultiply":"none"})).then(r=>this.destroyed?Promise.reject():(this.bitmap=r,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,s){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,s);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,s,this.bitmap),!this.preserveBitmap){let r=!0;const n=e._glTextures;for(const o in n){const a=n[o];if(a!==s&&a.dirtyId!==e.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class zu{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,s){const r=e.width,n=e.height;if(s){const o=t.width/2/r,a=t.height/2/n,h=t.x/r+o,l=t.y/n+a;s=lt.add(s,lt.NW),this.x0=h+o*lt.uX(s),this.y0=l+a*lt.uY(s),s=lt.add(s,2),this.x1=h+o*lt.uX(s),this.y1=l+a*lt.uY(s),s=lt.add(s,2),this.x2=h+o*lt.uX(s),this.y2=l+a*lt.uY(s),s=lt.add(s,2),this.x3=h+o*lt.uX(s),this.y3=l+a*lt.uY(s)}else this.x0=t.x/r,this.y0=t.y/n,this.x1=(t.x+t.width)/r,this.y1=t.y/n,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/n,this.x3=t.x/r,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}toString(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`}}const $l=new zu;function Jr(i){i.destroy=function(){},i.on=function(){},i.once=function(){},i.emit=function(){}}class X extends Ve{constructor(t,e,s,r,n,o){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new vt(0,0,1,1)),t instanceof X&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=r,this.valid=!1,this._uvs=$l,this.uvMatrix=null,this.orig=s||e,this._rotate=Number(n||0),n===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new $t(o.x,o.y):new $t(0,0),this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:e}=this.baseTexture;e!=null&&e.url&&ke[e.url]&&X.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,X.removeFromCache(this),this.textureCacheIds=null}clone(){var r;const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),s=new X(this.baseTexture,!this.noFrame&&t,e,(r=this.trim)==null?void 0:r.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(s._frame=t),s}updateUvs(){this._uvs===$l&&(this._uvs=new zu),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},s=V.STRICT_TEXTURE_CACHE){const r=typeof t=="string";let n=null;if(r)n=t;else if(t instanceof j){if(!t.cacheId){const a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${a}-${mr()}`,j.addToCache(t,t.cacheId)}n=t.cacheId}else{if(!t._pixiId){const a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${a}_${mr()}`}n=t._pixiId}let o=ke[n];if(r&&s&&!o)throw new Error(`The cacheId "${n}" does not exist in TextureCache.`);return!o&&!(t instanceof j)?(e.resolution||(e.resolution=Cn(t)),o=new X(new j(t,e)),o.baseTexture.cacheId=n,j.addToCache(o.baseTexture,n),X.addToCache(o,n)):!o&&t instanceof j&&(o=new X(t),X.addToCache(o,n)),o}static fromURL(t,e){const s=Object.assign({autoLoad:!1},e==null?void 0:e.resourceOptions),r=X.from(t,Object.assign({resourceOptions:s},e),!1),n=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):n.load().then(()=>Promise.resolve(r))}static fromBuffer(t,e,s,r){return new X(j.fromBuffer(t,e,s,r))}static fromLoader(t,e,s,r){const n=new j(t,Object.assign({scaleMode:j.defaultOptions.scaleMode,resolution:Cn(e)},r)),{resource:o}=n;o instanceof Hu&&(o.url=e);const a=new X(n);return s||(s=e),j.addToCache(a.baseTexture,s),X.addToCache(a,s),s!==e&&(j.addToCache(a.baseTexture,e),X.addToCache(a,e)),a.baseTexture.valid?Promise.resolve(a):new Promise(h=>{a.baseTexture.once("loaded",()=>h(a))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),ke[e]&&ke[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),ke[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=ke[t];if(e){const s=e.textureCacheIds.indexOf(t);return s>-1&&e.textureCacheIds.splice(s,1),delete ke[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)ke[t.textureCacheIds[e]]===t&&delete ke[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:s,width:r,height:n}=t,o=e+r>this.baseTexture.width,a=s+n>this.baseTexture.height;if(o||a){const h=o&&a?"and":"or",l=`X: ${e} + ${r} = ${e+r} > ${this.baseTexture.width}`,c=`Y: ${s} + ${n} = ${s+n} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${l} ${h} ${c}`)}this.valid=r&&n&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return X._EMPTY||(X._EMPTY=new X(new j),Jr(X._EMPTY),Jr(X._EMPTY.baseTexture)),X._EMPTY}static get WHITE(){if(!X._WHITE){const t=V.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),X._WHITE=new X(j.from(t)),Jr(X._WHITE),Jr(X._WHITE.baseTexture)}return X._WHITE}}class jn extends X{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,s=!0){const r=this.baseTexture.resolution,n=Math.round(t*r)/r,o=Math.round(e*r)/r;this.valid=n>0&&o>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=o,s&&this.baseTexture.resize(n,o),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new jn(new $u(t))}}class Wu{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,s=yt.NONE){const r=new $u(Object.assign({width:t,height:e,resolution:1,multisample:s},this.textureOptions));return new jn(r)}getOptimalTexture(t,e,s=1,r=yt.NONE){let n;t=Math.ceil(t*s-1e-6),e=Math.ceil(e*s-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=Tn(t),e=Tn(e),n=((t&65535)<<16|e&65535)>>>0,r>1&&(n+=r*4294967296)):n=r>1?-r:-1,this.texturePool[n]||(this.texturePool[n]=[]);let o=this.texturePool[n].pop();return o||(o=this.createTexture(t,e,r)),o.filterPoolKey=n,o.setResolution(s),o}getFilterTexture(t,e,s){const r=this.getOptimalTexture(t.width,t.height,e||t.resolution,s||yt.NONE);return r.filterFrame=t.filterFrame,r}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const e in this.texturePool){const s=this.texturePool[e];if(s)for(let r=0;r<s.length;r++)s[r].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const s=this.texturePool[e];if(s)for(let r=0;r<s.length;r++)s[r].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}Wu.SCREEN_KEY=-1;class Mb extends Ps{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class Rb extends Ps{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Nt(this.vertices),this.uvBuffer=new Nt(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let s=0,r=0;return this.uvs[0]=s,this.uvs[1]=r,this.uvs[2]=s+e.width/t.width,this.uvs[3]=r,this.uvs[4]=s+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=s,this.uvs[7]=r+e.height/t.height,s=e.x,r=e.y,this.vertices[0]=s,this.vertices[1]=r,this.vertices[2]=s+e.width,this.vertices[3]=r,this.vertices[4]=s+e.width,this.vertices[5]=r+e.height,this.vertices[6]=s,this.vertices[7]=r+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class kb{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=yt.NONE,this.sourceFrame=new vt,this.destinationFrame=new vt,this.bindingSourceFrame=new vt,this.bindingDestinationFrame=new vt,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Qr=[new $t,new $t,new $t,new $t],Do=new Mt;class ju{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Wu,this.statePool=[],this.quad=new Mb,this.quadUv=new Rb,this.tempRect=new vt,this.activeState={},this.globalUniforms=new De({outputFrame:new vt,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const s=this.renderer,r=this.defaultFilterStack,n=this.statePool.pop()||new kb,o=this.renderer.renderTexture;let a=e[0].resolution,h=e[0].multisample,l=e[0].padding,c=e[0].autoFit,u=e[0].legacy??!0;for(let _=1;_<e.length;_++){const m=e[_];a=Math.min(a,m.resolution),h=Math.min(h,m.multisample),l=this.useMaxPadding?Math.max(l,m.padding):l+m.padding,c=c&&m.autoFit,u=u||(m.legacy??!0)}r.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),r.push(n),n.resolution=a,n.multisample=h,n.legacy=u,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(l);const d=this.tempRect.copyFrom(o.sourceFrame);s.projection.transform&&this.transformAABB(Do.copyFrom(s.projection.transform).invert(),d),c?(n.sourceFrame.fit(d),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(d)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,o.current?o.current.resolution:s.resolution,o.sourceFrame,o.destinationFrame,s.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,a,h),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;const f=this.tempRect;f.x=0,f.y=0,f.width=n.sourceFrame.width,f.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(o.sourceFrame),n.bindingDestinationFrame.copyFrom(o.destinationFrame),n.transform=s.projection.transform,s.projection.transform=null,o.bind(n.renderTexture,n.sourceFrame,f),s.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),s=e.filters;this.activeState=e;const r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;const n=r.inputSize,o=r.inputPixel,a=r.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],o[0]=Math.round(n[0]*e.resolution),o[1]=Math.round(n[1]*e.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=e.sourceFrame.width*n[2]-.5*o[2],a[3]=e.sourceFrame.height*n[3]-.5*o[3],e.legacy){const l=r.filterArea;l[0]=e.destinationFrame.width,l[1]=e.destinationFrame.height,l[2]=e.sourceFrame.x,l[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();const h=t[t.length-1];if(this.renderer.framebuffer.blit(),s.length===1)s[0].apply(this,e.renderTexture,h.renderTexture,Ri.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let l=e.renderTexture,c=this.getOptimalFilterTexture(l.width,l.height,e.resolution);c.filterFrame=l.filterFrame;let u=0;for(u=0;u<s.length-1;++u){u===1&&e.multisample>1&&(c=this.getOptimalFilterTexture(l.width,l.height,e.resolution),c.filterFrame=l.filterFrame),s[u].apply(this,l,c,Ri.CLEAR,e);const d=l;l=c,c=d}s[u].apply(this,l,h.renderTexture,Ri.BLEND,e),u>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(l),this.returnFilterTexture(c)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=Ri.CLEAR){const{renderTexture:s,state:r}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t!=null&&t.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=t.filterFrame.width,o.height=t.filterFrame.height,s.bind(t,t.filterFrame,o)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?s.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const n=r.stateId&1||this.forceClear;(e===Ri.CLEAR||e===Ri.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,s,r){const n=this.renderer;n.state.set(t.state),this.bindAndClear(s,r),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(vn.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(vn.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:s,destinationFrame:r}=this.activeState,{orig:n}=e._texture,o=t.set(r.width,0,0,r.height,s.x,s.y),a=e.worldTransform.copyTo(Mt.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/n.width,1/n.height),o.translate(e.anchor.x,e.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,s=1,r=yt.NONE){return this.texturePool.getOptimalTexture(t,e,s,r)}getFilterTexture(t,e,s){if(typeof t=="number"){const n=t;t=e,e=n}t=t||this.activeState.renderTexture;const r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,s||yt.NONE);return r.filterFrame=t.filterFrame,r}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const s=Qr[0],r=Qr[1],n=Qr[2],o=Qr[3];s.set(e.left,e.top),r.set(e.left,e.bottom),n.set(e.right,e.top),o.set(e.right,e.bottom),t.apply(s,s),t.apply(r,r),t.apply(n,n),t.apply(o,o);const a=Math.min(s.x,r.x,n.x,o.x),h=Math.min(s.y,r.y,n.y,o.y),l=Math.max(s.x,r.x,n.x,o.x),c=Math.max(s.y,r.y,n.y,o.y);e.x=a,e.y=h,e.width=l-a,e.height=c-h}roundFrame(t,e,s,r,n){if(!(t.width<=0||t.height<=0||s.width<=0||s.height<=0)){if(n){const{a:o,b:a,c:h,d:l}=n;if((Math.abs(a)>1e-4||Math.abs(h)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(l)>1e-4))return}n=n?Do.copyFrom(n):Do.identity(),n.translate(-s.x,-s.y).scale(r.width/s.width,r.height/s.height).translate(r.x,r.y),this.transformAABB(n,t),t.ceil(e),this.transformAABB(n.invert(),t)}}}ju.extension={type:B.RendererSystem,name:"filter"};D.add(ju);class Bb{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=yt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const Lb=new vt;class Xu{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Ea(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new vt,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,s=this.renderer.context.extensions.depthTexture;V.PREFER_ENV===Ki.WEBGL_LEGACY&&(e=null,s=null),e?t.drawBuffers=r=>e.drawBuffersWEBGL(r):(this.hasMRT=!1,t.drawBuffers=()=>{}),s||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,s=0){const{gl:r}=this;if(t){const n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,r.bindFramebuffer(r.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==s&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=s),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,s)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let o=0;o<t.colorTextures.length;o++){const a=t.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const o=e.width>>s,a=e.height>>s,h=o/e.width;this.setViewport(e.x*h,e.y*h,o,a)}else{const o=t.width>>s,a=t.height>>s;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,s,r){const n=this.viewport;t=Math.round(t),e=Math.round(e),s=Math.round(s),r=Math.round(r),(n.width!==s||n.height!==r||n.x!==t||n.y!==e)&&(n.x=t,n.y=e,n.width=s,n.height=r,this.gl.viewport(t,e,s,r))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,s,r,n=ba.COLOR|ba.DEPTH){const{gl:o}=this;o.clearColor(t,e,s,r),o.clear(n)}initFramebuffer(t){const{gl:e}=this,s=new Bb(e.createFramebuffer());return s.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=s,this.managedFramebuffers.push(t),t.disposeRunner.add(this),s}resizeFramebuffer(t){const{gl:e}=this,s=t.glFramebuffers[this.CONTEXT_UID];s.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,s.stencil),s.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,s.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));const r=t.colorTextures;let n=r.length;e.drawBuffers||(n=Math.min(n,1));for(let o=0;o<n;o++){const a=r[o],h=a.parentTextureArray||a;this.renderer.texture.bind(h,0),o===0&&s.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,s.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,s.multisample,h._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:s}=this,r=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures;let o=n.length;s.drawBuffers||(o=Math.min(o,1)),r.multisample>1&&this.canMultisampleFramebuffer(t)?r.msaaBuffer=r.msaaBuffer||s.createRenderbuffer():r.msaaBuffer&&(s.deleteRenderbuffer(r.msaaBuffer),r.msaaBuffer=null,r.blitFramebuffer&&(r.blitFramebuffer.dispose(),r.blitFramebuffer=null));const a=[];for(let h=0;h<o;h++){const l=n[h],c=l.parentTextureArray||l;this.renderer.texture.bind(c,0),h===0&&r.msaaBuffer?(s.bindRenderbuffer(s.RENDERBUFFER,r.msaaBuffer),s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,r.msaaBuffer)):(s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+h,l.target,c._glTextures[this.CONTEXT_UID].texture,e),a.push(s.COLOR_ATTACHMENT0+h))}if(a.length>1&&s.drawBuffers(a),t.depthTexture&&this.writeDepthTexture){const l=t.depthTexture;this.renderer.texture.bind(l,0),s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,e)}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(r.stencil=r.stencil||s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,r.stencil),r.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,r.multisample,s.DEPTH24_STENCIL8,t.width,t.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,t.width,t.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,r.stencil)):r.stencil&&(s.deleteRenderbuffer(r.stencil),r.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let s=yt.NONE;if(t<=1||e===null)return s;for(let r=0;r<e.length;r++)if(e[r]<=t){s=e[r];break}return s===1&&(s=yt.NONE),s}blit(t,e,s){const{current:r,renderer:n,gl:o,CONTEXT_UID:a}=this;if(n.context.webGLVersion!==2||!r)return;const h=r.glFramebuffers[a];if(!h)return;if(!t){if(!h.msaaBuffer)return;const c=r.colorTextures[0];if(!c)return;h.blitFramebuffer||(h.blitFramebuffer=new Ea(r.width,r.height),h.blitFramebuffer.addColorTexture(0,c)),t=h.blitFramebuffer,t.colorTextures[0]!==c&&(t.colorTextures[0]=c,t.dirtyId++,t.dirtyFormat++),(t.width!==r.width||t.height!==r.height)&&(t.width=r.width,t.height=r.height,t.dirtyId++,t.dirtySize++)}e||(e=Lb,e.width=r.width,e.height=r.height),s||(s=e);const l=e.width===s.width&&e.height===s.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,h.framebuffer),o.blitFramebuffer(e.left,e.top,e.right,e.bottom,s.left,s.top,s.right,s.bottom,o.COLOR_BUFFER_BIT,l?o.NEAREST:o.LINEAR)}disposeFramebuffer(t,e){const s=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(!s)return;delete t.glFramebuffers[this.CONTEXT_UID];const n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(s.framebuffer),s.msaaBuffer&&r.deleteRenderbuffer(s.msaaBuffer),s.stencil&&r.deleteRenderbuffer(s.stencil)),s.blitFramebuffer&&s.blitFramebuffer.dispose()}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let s=0;s<e.length;s++)this.disposeFramebuffer(e[s],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil)return;t.stencil=!0;const s=t.width,r=t.height,n=this.gl,o=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,o),e.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,e.multisample,n.DEPTH24_STENCIL8,s,r):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,s,r),e.stencil=o,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new vt}destroy(){this.renderer=null}}Xu.extension={type:B.RendererSystem,name:"framebuffer"};D.add(Xu);const Go={5126:4,5123:2,5121:1};class Yu{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let s=this.renderer.context.extensions.vertexArrayObject;V.PREFER_ENV===Ki.WEBGL_LEGACY&&(s=null),s?(t.createVertexArray=()=>s.createVertexArrayOES(),t.bindVertexArray=r=>s.bindVertexArrayOES(r),t.deleteVertexArray=r=>s.deleteVertexArrayOES(r)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){const s=t.getExtension("ANGLE_instanced_arrays");s?(t.vertexAttribDivisor=(r,n)=>s.vertexAttribDivisorANGLE(r,n),t.drawElementsInstanced=(r,n,o,a,h)=>s.drawElementsInstancedANGLE(r,n,o,a,h),t.drawArraysInstanced=(r,n,o,a)=>s.drawArraysInstancedANGLE(r,n,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:s}=this;let r=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={},n=!0);const o=r[e.program.id]||this.initGeometryVao(t,e,n);this._activeGeometry=t,this._activeVao!==o&&(this._activeVao=o,this.hasVao?s.bindVertexArray(o):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let s=0;s<t.buffers.length;s++){const r=t.buffers[s];e.update(r)}}checkCompatibility(t,e){const s=t.attributes,r=e.attributeData;for(const n in r)if(!s[n])throw new Error(`shader and geometry incompatible, geometry missing the "${n}" attribute`)}getSignature(t,e){const s=t.attributes,r=e.attributeData,n=["g",t.id];for(const o in s)r[o]&&n.push(o,r[o].location);return n.join("-")}initGeometryVao(t,e,s=!0){const r=this.gl,n=this.CONTEXT_UID,o=this.renderer.buffer,a=e.program;a.glPrograms[n]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,a);const h=this.getSignature(t,a),l=t.glVertexArrayObjects[this.CONTEXT_UID];let c=l[h];if(c)return l[a.id]=c,c;const u=t.buffers,d=t.attributes,f={},_={};for(const m in u)f[m]=0,_[m]=0;for(const m in d)!d[m].size&&a.attributeData[m]?d[m].size=a.attributeData[m].size:d[m].size||console.warn(`PIXI Geometry attribute '${m}' size cannot be determined (likely the bound shader does not have the attribute)`),f[d[m].buffer]+=d[m].size*Go[d[m].type];for(const m in d){const p=d[m],x=p.size;p.stride===void 0&&(f[p.buffer]===x*Go[p.type]?p.stride=0:p.stride=f[p.buffer]),p.start===void 0&&(p.start=_[p.buffer],_[p.buffer]+=x*Go[p.type])}c=r.createVertexArray(),r.bindVertexArray(c);for(let m=0;m<u.length;m++){const p=u[m];o.bind(p),s&&p._glBuffers[n].refCount++}return this.activateVao(t,a),l[a.id]=c,l[h]=c,r.bindVertexArray(null),o.unbind(Ue.ARRAY_BUFFER),c}disposeGeometry(t,e){var a;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const s=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,n=t.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(t.disposeRunner.remove(this),!!s){if(o)for(let h=0;h<n.length;h++){const l=n[h]._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!e&&o.dispose(n[h],e))}if(!e){for(const h in s)if(h[0]==="g"){const l=s[h];this._activeVao===l&&this.unbind(),r.deleteVertexArray(l)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let s=0;s<e.length;s++)this.disposeGeometry(this.managedGeometries[e[s]],t)}activateVao(t,e){const s=this.gl,r=this.CONTEXT_UID,n=this.renderer.buffer,o=t.buffers,a=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);let h=null;for(const l in a){const c=a[l],u=o[c.buffer],d=u._glBuffers[r];if(e.attributeData[l]){h!==d&&(n.bind(u),h=d);const f=e.attributeData[l].location;if(s.enableVertexAttribArray(f),s.vertexAttribPointer(f,c.size,c.type||s.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)s.vertexAttribDivisor(f,c.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,s,r){const{gl:n}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,h=a===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?n.drawElementsInstanced(t,e||o.indexBuffer.data.length,h,(s||0)*a,r||1):n.drawElements(t,e||o.indexBuffer.data.length,h,(s||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?n.drawArraysInstanced(t,s,e||o.getSize(),r||1):n.drawArrays(t,s,e||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}Yu.extension={type:B.RendererSystem,name:"geometry"};D.add(Yu);const Hl=new Mt;class Ob{constructor(t,e){this._texture=t,this.mapCoord=new Mt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);const s=this.mapCoord;for(let r=0;r<t.length;r+=2){const n=t[r],o=t[r+1];e[r]=n*s.a+o*s.c+s.tx,e[r+1]=n*s.b+o*s.d+s.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const s=e._uvs;this.mapCoord.set(s.x1-s.x0,s.y1-s.y0,s.x3-s.x0,s.y3-s.y0,s.x0,s.y0);const r=e.orig,n=e.trim;n&&(Hl.set(r.width/n.width,0,0,r.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Hl));const o=e.baseTexture,a=this.uClampFrame,h=this.clampMargin/o.resolution,l=this.clampOffset;return a[0]=(e._frame.x+h+l)/o.width,a[1]=(e._frame.y+h+l)/o.height,a[2]=(e._frame.x+e._frame.width-h+l)/o.width,a[3]=(e._frame.y+e._frame.height-h+l)/o.height,this.uClampOffset[0]=l/o.realWidth,this.uClampOffset[1]=l/o.realHeight,this.isSimple=e._frame.width===o.width&&e._frame.height===o.height&&e.rotate===0,!0}}var Fb=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,Nb=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class Ub extends hi{constructor(t,e,s){let r=null;typeof t!="string"&&e===void 0&&s===void 0&&(r=t,t=void 0,e=void 0,s=void 0),super(t||Nb,e||Fb,s),this.maskSprite=r,this.maskMatrix=new Mt}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,s,r){const n=this._maskSprite,o=n._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new Ob(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,e,s,r))}}class Db{constructor(t=null){this.type=St.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=hi.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=St.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class qu{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let s=e;if(!s.isMaskData){const n=this.maskDataPool.pop()||new Db;n.pooled=!0,n.maskObject=e,s=n}const r=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(s.copyCountersOrReset(r),s._colorMask=r?r._colorMask:15,s.autoDetect&&this.detect(s),s._target=t,s.type!==St.SPRITE&&this.maskStack.push(s),s.enabled)switch(s.type){case St.SCISSOR:this.renderer.scissor.push(s);break;case St.STENCIL:this.renderer.stencil.push(s);break;case St.SPRITE:s.copyCountersOrReset(null),this.pushSpriteMask(s);break;case St.COLOR:this.pushColorMask(s);break}s.type===St.SPRITE&&this.maskStack.push(s)}pop(t){const e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case St.SCISSOR:this.renderer.scissor.pop(e);break;case St.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case St.SPRITE:this.popSpriteMask(e);break;case St.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){const s=this.maskStack[this.maskStack.length-1];s.type===St.SPRITE&&s._filters&&(s._filters[0].maskSprite=s.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=St.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=St.SCISSOR:t.type=St.STENCIL:t.type=St.COLOR}pushSpriteMask(t){const{maskObject:e}=t,s=t._target;let r=t._filters;r||(r=this.alphaMaskPool[this.alphaMaskIndex],r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new Ub]));const n=this.renderer,o=n.renderTexture;let a,h;if(o.current){const c=o.current;a=t.resolution||c.resolution,h=t.multisample??c.multisample}else a=t.resolution||n.resolution,h=t.multisample??n.multisample;r[0].resolution=a,r[0].multisample=h,r[0].maskSprite=e;const l=s.filterArea;s.filterArea=e.getBounds(!0),n.filter.push(s,r),s.filterArea=l,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,s=t._colorMask=e&t.colorMask;s!==e&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)}popColorMask(t){const e=t._colorMask,s=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;s!==e&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)}destroy(){this.renderer=null}}qu.extension={type:B.RendererSystem,name:"mask"};D.add(qu);class Ku{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,s=this.getStackLength();this.maskStack=t;const r=this.getStackLength();r!==s&&(r===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const zl=new Mt,Wl=[],ln=class extends Ku{constructor(i){super(i),this.glConst=V.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const i=this.maskStack[this.maskStack.length-1];return i?i._scissorCounter:0}calcScissorRect(i){if(i._scissorRectLocal)return;const t=i._scissorRect,{maskObject:e}=i,{renderer:s}=this,r=s.renderTexture,n=e.getBounds(!0,Wl.pop()??new vt);this.roundFrameToPixels(n,r.current?r.current.resolution:s.resolution,r.sourceFrame,r.destinationFrame,s.projection.transform),t&&n.fit(t),i._scissorRectLocal=n}static isMatrixRotated(i){if(!i)return!1;const{a:t,b:e,c:s,d:r}=i;return(Math.abs(e)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(r)>1e-4)}testScissor(i){const{maskObject:t}=i;if(!t.isFastRect||!t.isFastRect()||ln.isMatrixRotated(t.worldTransform)||ln.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(i);const e=i._scissorRectLocal;return e.width>0&&e.height>0}roundFrameToPixels(i,t,e,s,r){ln.isMatrixRotated(r)||(r=r?zl.copyFrom(r):zl.identity(),r.translate(-e.x,-e.y).scale(s.width/e.width,s.height/e.height).translate(s.x,s.y),this.renderer.filter.transformAABB(r,i),i.fit(s),i.x=Math.round(i.x*t),i.y=Math.round(i.y*t),i.width=Math.round(i.width*t),i.height=Math.round(i.height*t))}push(i){i._scissorRectLocal||this.calcScissorRect(i);const{gl:t}=this.renderer;i._scissorRect||t.enable(t.SCISSOR_TEST),i._scissorCounter++,i._scissorRect=i._scissorRectLocal,this._useCurrent()}pop(i){const{gl:t}=this.renderer;i&&Wl.push(i._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){const i=this.maskStack[this.maskStack.length-1]._scissorRect;let t;this.renderer.renderTexture.current?t=i.y:t=this.renderer.height-i.height-i.y,this.renderer.gl.scissor(i.x,t,i.width,i.height)}};let Zu=ln;Zu.extension={type:B.RendererSystem,name:"scissor"};D.add(Zu);class Ju extends Ku{constructor(t){super(t),this.glConst=V.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:s}=this.renderer,r=t._stencilCounter;r===0&&(this.renderer.framebuffer.forceStencil(),s.clearStencil(0),s.clear(s.STENCIL_BUFFER_BIT),s.enable(s.STENCIL_TEST)),t._stencilCounter++;const n=t._colorMask;n!==0&&(t._colorMask=0,s.colorMask(!1,!1,!1,!1)),s.stencilFunc(s.EQUAL,r,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,n!==0&&(t._colorMask=n,s.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}pop(t){const e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{const s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,r=s?s._colorMask:15;r!==0&&(s._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,r!==0&&(s._colorMask=r,e.colorMask((r&1)!==0,(r&2)!==0,(r&4)!==0,(r&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}Ju.extension={type:B.RendererSystem,name:"stencil"};D.add(Ju);class Qu{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return tt("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return tt("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return tt("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(t){for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}Qu.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"_plugin"};D.add(Qu);class td{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Mt,this.transform=null}update(t,e,s,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,s,r),this.transform&&this.projectionMatrix.append(this.transform);const n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(t,e,s,r){const n=this.projectionMatrix,o=r?-1:1;n.identity(),n.a=1/e.width*2,n.d=o*(1/e.height*2),n.tx=-1-e.x*n.a,n.ty=-o-e.y*n.d}setTransform(t){}destroy(){this.renderer=null}}td.extension={type:B.RendererSystem,name:"projection"};D.add(td);const Gb=new Bu;class ed{constructor(t){this.renderer=t,this._tempMatrix=new Mt}generateTexture(t,e){const{region:s,...r}=e||{},n=s||t.getLocalBounds(null,!0);n.width===0&&(n.width=1),n.height===0&&(n.height=1);const o=jn.create({width:n.width,height:n.height,...r});this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;const a=t.transform;return t.transform=Gb,this.renderer.render(t,{renderTexture:o,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=a,o}destroy(){}}ed.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"textureGenerator"};D.add(ed);const Ti=new vt,zs=new vt;class id{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new vt,this.destinationFrame=new vt,this.viewportFrame=new vt}bind(t=null,e,s){const r=this.renderer;this.current=t;let n,o,a;t?(n=t.baseTexture,a=n.resolution,e||(Ti.width=t.frame.width,Ti.height=t.frame.height,e=Ti),s||(zs.x=t.frame.x,zs.y=t.frame.y,zs.width=e.width,zs.height=e.height,s=zs),o=n.framebuffer):(a=r.resolution,e||(Ti.width=r._view.screen.width,Ti.height=r._view.screen.height,e=Ti),s||(s=Ti,s.width=e.width,s.height=e.height));const h=this.viewportFrame;h.x=s.x*a,h.y=s.y*a,h.width=s.width*a,h.height=s.height*a,t||(h.y=r.view.height-(h.y+h.height)),h.ceil(),this.renderer.framebuffer.bind(o,h),this.renderer.projection.update(s,e,a,!o),t?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(s)}clear(t,e){this.current?t=t||this.current.baseTexture.clearColor:t=t||this.renderer.background.colorRgba;const s=this.destinationFrame,r=this.current?this.current.baseTexture:this.renderer._view.screen,n=s.width!==r.width||s.height!==r.height;if(n){let{x:o,y:a,width:h,height:l}=this.viewportFrame;o=Math.round(o),a=Math.round(a),h=Math.round(h),l=Math.round(l),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(o,a,h,l)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),n&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}id.extension={type:B.RendererSystem,name:"renderTexture"};D.add(id);class Vb{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function $b(i,t){const e={},s=t.getProgramParameter(i,t.ACTIVE_ATTRIBUTES);for(let r=0;r<s;r++){const n=t.getActiveAttrib(i,r);if(n.name.startsWith("gl_"))continue;const o=Nu(t,n.type),a={type:o,name:n.name,size:Fu(o),location:t.getAttribLocation(i,n.name)};e[n.name]=a}return e}function Hb(i,t){const e={},s=t.getProgramParameter(i,t.ACTIVE_UNIFORMS);for(let r=0;r<s;r++){const n=t.getActiveUniform(i,r),o=n.name.replace(/\[.*?\]$/,""),a=!!n.name.match(/\[.*?\]$/),h=Nu(t,n.type);e[o]={name:o,index:r,type:h,size:n.size,isArray:a,value:Lu(h,n.size)}}return e}function zb(i,t){var h;const e=Nl(i,i.VERTEX_SHADER,t.vertexSrc),s=Nl(i,i.FRAGMENT_SHADER,t.fragmentSrc),r=i.createProgram();i.attachShader(r,e),i.attachShader(r,s);const n=(h=t.extra)==null?void 0:h.transformFeedbackVaryings;if(n&&(typeof i.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):i.transformFeedbackVaryings(r,n.names,n.bufferMode==="separate"?i.SEPARATE_ATTRIBS:i.INTERLEAVED_ATTRIBS)),i.linkProgram(r),i.getProgramParameter(r,i.LINK_STATUS)||mb(i,r,e,s),t.attributeData=$b(r,i),t.uniformData=Hb(r,i),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const l=Object.keys(t.attributeData);l.sort((c,u)=>c>u?1:-1);for(let c=0;c<l.length;c++)t.attributeData[l[c]].location=c,i.bindAttribLocation(r,c,l[c]);i.linkProgram(r)}i.deleteShader(e),i.deleteShader(s);const o={};for(const l in t.uniformData){const c=t.uniformData[l];o[l]={location:i.getUniformLocation(r,l),value:Lu(c.type,c.size)}}return new Vb(r,o)}function Wb(i,t,e,s,r){e.buffer.update(r)}const jb={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},sd={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function Xb(i){const t=i.map(n=>({data:n,offset:0,dataLen:0,dirty:0}));let e=0,s=0,r=0;for(let n=0;n<t.length;n++){const o=t[n];if(e=sd[o.data.type],o.data.size>1&&(e=Math.max(e,16)*o.data.size),o.dataLen=e,s%e!==0&&s<16){const a=s%e%16;s+=a,r+=a}s+e>16?(r=Math.ceil(r/16)*16,o.offset=r,r+=e,s=e):(o.offset=r,s+=e,r+=e)}return r=Math.ceil(r/16)*16,{uboElements:t,size:r}}function Yb(i,t){const e=[];for(const s in i)t[s]&&e.push(t[s]);return e.sort((s,r)=>s.index-r.index),e}function qb(i,t){if(!i.autoManage)return{size:0,syncFunc:Wb};const e=Yb(i.uniforms,t),{uboElements:s,size:r}=Xb(e),n=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<s.length;o++){const a=s[o],h=i.uniforms[a.data.name],l=a.data.name;let c=!1;for(let u=0;u<vs.length;u++){const d=vs[u];if(d.codeUbo&&d.test(a.data,h)){n.push(`offset = ${a.offset/4};`,vs[u].codeUbo(a.data.name,h)),c=!0;break}}if(!c)if(a.data.size>1){const u=Fu(a.data.type),d=Math.max(sd[a.data.type]/16,1),f=u/d,_=(4-f%4)%4;n.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*d}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${_};
                }

                `)}else{const u=jb[a.data.type];n.push(`
                cv = ud.${l}.value;
                v = uv.${l};
                offset = ${a.offset/4};
                ${u};
                `)}}return n.push(`
       renderer.buffer.update(buffer);
    `),{size:r,syncFunc:new Function("ud","uv","renderer","syncData","buffer",n.join(`
`))}}let Kb=0;const tn={textureCount:0,uboCount:0};class rd{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=Kb++}systemCheck(){if(!yb())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const s=t.program,r=s.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==s&&(this.program=s,this.gl.useProgram(r.program)),e||(tn.textureCount=0,tn.uboCount=0,this.syncUniformGroup(t.uniformGroup,tn)),r}setUniforms(t){const e=this.shader.program,s=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(s.uniformData,t,this.renderer)}syncUniformGroup(t,e){const s=this.getGlProgram();(!t.static||t.dirtyId!==s.uniformDirtyGroups[t.id])&&(s.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,s,e))}syncUniforms(t,e,s){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,s)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=fb(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const s=this.getGlProgram();if(!t.static||t.dirtyId!==0||!s.uniformGroups[t.id]){t.dirtyId=0;const r=s.uniformGroups[t.id]||this.createSyncBufferGroup(t,s,e);t.buffer.update(),r(s.uniformData,t.uniforms,this.renderer,tn,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,s.uniformBufferBindings[e])}createSyncBufferGroup(t,e,s){const{gl:r}=this.renderer;this.renderer.buffer.bind(t.buffer);const n=this.gl.getUniformBlockIndex(e.program,s);e.uniformBufferBindings[s]=this.shader.uniformBindCount,r.uniformBlockBinding(e.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(t,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=qb(t,this.shader.program.uniformData)),t.autoManage){const h=new Float32Array(a.size/4);t.buffer.update(h)}return e.uniformGroups[t.id]=a.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,s){const r=t.uniforms,n=[`${s}-`];for(const o in r)n.push(o),e[o]&&n.push(e[o].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,s=t.program,r=zb(e,s);return s.glPrograms[this.renderer.CONTEXT_UID]=r,r}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}rd.extension={type:B.RendererSystem,name:"shader"};D.add(rd);class nd{constructor(t){this.renderer=t}run(t){const e=this.renderer;e.emitWithCustomOptions(e.runners.init,t),t.hello&&console.log(`PixiJS 7.1.2 - ${e.rendererLogId} - https://pixijs.com`),e.resize(this.renderer.screen.width,this.renderer.screen.height)}destroy(){}}nd.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"startup"};D.add(nd);function Zb(i,t=[]){return t[N.NORMAL]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.ADD]=[i.ONE,i.ONE],t[N.MULTIPLY]=[i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.SCREEN]=[i.ONE,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.OVERLAY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.DARKEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.LIGHTEN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.COLOR_DODGE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.COLOR_BURN]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.HARD_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.SOFT_LIGHT]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.DIFFERENCE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.EXCLUSION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.HUE]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.SATURATION]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.COLOR]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.LUMINOSITY]=[i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.NONE]=[0,0],t[N.NORMAL_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.ADD_NPM]=[i.SRC_ALPHA,i.ONE,i.ONE,i.ONE],t[N.SCREEN_NPM]=[i.SRC_ALPHA,i.ONE_MINUS_SRC_COLOR,i.ONE,i.ONE_MINUS_SRC_ALPHA],t[N.SRC_IN]=[i.DST_ALPHA,i.ZERO],t[N.SRC_OUT]=[i.ONE_MINUS_DST_ALPHA,i.ZERO],t[N.SRC_ATOP]=[i.DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],t[N.DST_OVER]=[i.ONE_MINUS_DST_ALPHA,i.ONE],t[N.DST_IN]=[i.ZERO,i.SRC_ALPHA],t[N.DST_OUT]=[i.ZERO,i.ONE_MINUS_SRC_ALPHA],t[N.DST_ATOP]=[i.ONE_MINUS_DST_ALPHA,i.SRC_ALPHA],t[N.XOR]=[i.ONE_MINUS_DST_ALPHA,i.ONE_MINUS_SRC_ALPHA],t[N.SUBTRACT]=[i.ONE,i.ONE,i.ONE,i.ONE,i.FUNC_REVERSE_SUBTRACT,i.FUNC_ADD],t}const Jb=0,Qb=1,tx=2,ex=3,ix=4,sx=5,Pa=class{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=N.NONE,this._blendEq=!1,this.map=[],this.map[Jb]=this.setBlend,this.map[Qb]=this.setOffset,this.map[tx]=this.setCullFace,this.map[ex]=this.setDepthTest,this.map[ix]=this.setFrontFace,this.map[sx]=this.setDepthMask,this.checks=[],this.defaultState=new Lr,this.defaultState.blend=!0}contextChange(i){this.gl=i,this.blendModes=Zb(i),this.set(this.defaultState),this.reset()}set(i){if(i=i||this.defaultState,this.stateId!==i.data){let t=this.stateId^i.data,e=0;for(;t;)t&1&&this.map[e].call(this,!!(i.data&1<<e)),t=t>>1,e++;this.stateId=i.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,i)}forceState(i){i=i||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(i.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,i);this.stateId=i.data}setBlend(i){this.updateCheck(Pa.checkBlendMode,i),this.gl[i?"enable":"disable"](this.gl.BLEND)}setOffset(i){this.updateCheck(Pa.checkPolygonOffset,i),this.gl[i?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(i){this.gl[i?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(i){this.gl.depthMask(i)}setCullFace(i){this.gl[i?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(i){this.gl.frontFace(this.gl[i?"CW":"CCW"])}setBlendMode(i){if(i===this.blendMode)return;this.blendMode=i;const t=this.blendModes[i],e=this.gl;t.length===2?e.blendFunc(t[0],t[1]):e.blendFuncSeparate(t[0],t[1],t[2],t[3]),t.length===6?(this._blendEq=!0,e.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD))}setPolygonOffset(i,t){this.gl.polygonOffset(i,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(i,t){const e=this.checks.indexOf(i);t&&e===-1?this.checks.push(i):!t&&e!==-1&&this.checks.splice(e,1)}static checkBlendMode(i,t){i.setBlendMode(t.blendMode)}static checkPolygonOffset(i,t){i.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};let od=Pa;od.extension={type:B.RendererSystem,name:"state"};D.add(od);class rx extends Ve{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(r=>t.systems[r]),s=[...e,...Object.keys(t.systems).filter(r=>!e.includes(r))];for(const r of s)this.addSystem(t.systems[r],r)}addRunners(...t){t.forEach(e=>{this.runners[e]=new Pe(e)})}addSystem(t,e){const s=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=s,this._systemsHash[e]=s;for(const r in this.runners)this.runners[r].add(s);return this}emitWithCustomOptions(t,e){const s=Object.keys(this._systemsHash);t.items.forEach(r=>{const n=s.find(o=>this._systemsHash[o]===r);r[t.name](e[n])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const cn=class{constructor(i){this.renderer=i,this.count=0,this.checkCount=0,this.maxIdle=cn.defaultMaxIdle,this.checkCountMax=cn.defaultCheckCountMax,this.mode=cn.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==hh.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const i=this.renderer.texture,t=i.managedTextures;let e=!1;for(let s=0;s<t.length;s++){const r=t[s];!r.framebuffer&&this.count-r.touched>this.maxIdle&&(i.destroyTexture(r,!0),t[s]=null,e=!0)}if(e){let s=0;for(let r=0;r<t.length;r++)t[r]!==null&&(t[s++]=t[r]);t.length=s}}unload(i){const t=this.renderer.texture,e=i._texture;e&&!e.framebuffer&&t.destroyTexture(e);for(let s=i.children.length-1;s>=0;s--)this.unload(i.children[s])}destroy(){this.renderer=null}};let Ce=cn;Ce.defaultMode=hh.AUTO;Ce.defaultMaxIdle=60*60;Ce.defaultCheckCountMax=60*10;Ce.extension={type:B.RendererSystem,name:"textureGC"};D.add(Ce);class Vo{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=Y.UNSIGNED_BYTE,this.internalFormat=E.RGBA,this.samplerType=0}}function nx(i){let t;return"WebGL2RenderingContext"in globalThis&&i instanceof globalThis.WebGL2RenderingContext?t={[Y.UNSIGNED_BYTE]:{[E.RGBA]:i.RGBA8,[E.RGB]:i.RGB8,[E.RG]:i.RG8,[E.RED]:i.R8,[E.RGBA_INTEGER]:i.RGBA8UI,[E.RGB_INTEGER]:i.RGB8UI,[E.RG_INTEGER]:i.RG8UI,[E.RED_INTEGER]:i.R8UI,[E.ALPHA]:i.ALPHA,[E.LUMINANCE]:i.LUMINANCE,[E.LUMINANCE_ALPHA]:i.LUMINANCE_ALPHA},[Y.BYTE]:{[E.RGBA]:i.RGBA8_SNORM,[E.RGB]:i.RGB8_SNORM,[E.RG]:i.RG8_SNORM,[E.RED]:i.R8_SNORM,[E.RGBA_INTEGER]:i.RGBA8I,[E.RGB_INTEGER]:i.RGB8I,[E.RG_INTEGER]:i.RG8I,[E.RED_INTEGER]:i.R8I},[Y.UNSIGNED_SHORT]:{[E.RGBA_INTEGER]:i.RGBA16UI,[E.RGB_INTEGER]:i.RGB16UI,[E.RG_INTEGER]:i.RG16UI,[E.RED_INTEGER]:i.R16UI,[E.DEPTH_COMPONENT]:i.DEPTH_COMPONENT16},[Y.SHORT]:{[E.RGBA_INTEGER]:i.RGBA16I,[E.RGB_INTEGER]:i.RGB16I,[E.RG_INTEGER]:i.RG16I,[E.RED_INTEGER]:i.R16I},[Y.UNSIGNED_INT]:{[E.RGBA_INTEGER]:i.RGBA32UI,[E.RGB_INTEGER]:i.RGB32UI,[E.RG_INTEGER]:i.RG32UI,[E.RED_INTEGER]:i.R32UI,[E.DEPTH_COMPONENT]:i.DEPTH_COMPONENT24},[Y.INT]:{[E.RGBA_INTEGER]:i.RGBA32I,[E.RGB_INTEGER]:i.RGB32I,[E.RG_INTEGER]:i.RG32I,[E.RED_INTEGER]:i.R32I},[Y.FLOAT]:{[E.RGBA]:i.RGBA32F,[E.RGB]:i.RGB32F,[E.RG]:i.RG32F,[E.RED]:i.R32F,[E.DEPTH_COMPONENT]:i.DEPTH_COMPONENT32F},[Y.HALF_FLOAT]:{[E.RGBA]:i.RGBA16F,[E.RGB]:i.RGB16F,[E.RG]:i.RG16F,[E.RED]:i.R16F},[Y.UNSIGNED_SHORT_5_6_5]:{[E.RGB]:i.RGB565},[Y.UNSIGNED_SHORT_4_4_4_4]:{[E.RGBA]:i.RGBA4},[Y.UNSIGNED_SHORT_5_5_5_1]:{[E.RGBA]:i.RGB5_A1},[Y.UNSIGNED_INT_2_10_10_10_REV]:{[E.RGBA]:i.RGB10_A2,[E.RGBA_INTEGER]:i.RGB10_A2UI},[Y.UNSIGNED_INT_10F_11F_11F_REV]:{[E.RGB]:i.R11F_G11F_B10F},[Y.UNSIGNED_INT_5_9_9_9_REV]:{[E.RGB]:i.RGB9_E5},[Y.UNSIGNED_INT_24_8]:{[E.DEPTH_STENCIL]:i.DEPTH24_STENCIL8},[Y.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[E.DEPTH_STENCIL]:i.DEPTH32F_STENCIL8}}:t={[Y.UNSIGNED_BYTE]:{[E.RGBA]:i.RGBA,[E.RGB]:i.RGB,[E.ALPHA]:i.ALPHA,[E.LUMINANCE]:i.LUMINANCE,[E.LUMINANCE_ALPHA]:i.LUMINANCE_ALPHA},[Y.UNSIGNED_SHORT_5_6_5]:{[E.RGB]:i.RGB},[Y.UNSIGNED_SHORT_4_4_4_4]:{[E.RGBA]:i.RGBA},[Y.UNSIGNED_SHORT_5_5_5_1]:{[E.RGBA]:i.RGBA}},t}class ad{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new j,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=nx(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let r=0;r<e;r++)this.boundTextures[r]=null;this.emptyTextures={};const s=new Vo(t.createTexture());t.bindTexture(t.TEXTURE_2D,s.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=s,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Vo(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let r=0;r<6;r++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let r=0;r<this.boundTextures.length;r++)this.bind(null,r)}bind(t,e=0){const{gl:s}=this;if(t=t==null?void 0:t.castToBaseTexture(),t!=null&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,s.activeTexture(s.TEXTURE0+e)),s.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,s.activeTexture(s.TEXTURE0+e)),this.updateTexture(t)):r.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,s.activeTexture(s.TEXTURE0+e)),s.bindTexture(s.TEXTURE_2D,this.emptyTextures[s.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:s}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let r=0;r<s.length;r++)s[r]===this.unknownTexture&&this.bind(null,r)}for(let r=0;r<s.length;r++)s[r]===t&&(this.currentLocation!==r&&(e.activeTexture(e.TEXTURE0+r),this.currentLocation=r),e.bindTexture(t.target,this.emptyTextures[t.target].texture),s[r]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:s,CONTEXT_UID:r}=this;if(s)for(let n=t-1;n>=0;--n){const o=e[n];o&&o._glTextures[r].samplerType!==xa.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(t){const e=new Vo(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var s;e.internalFormat=((s=this.internalFormats[t.type])==null?void 0:s[t.format])??t.format,this.webGLVersion===2&&t.type===Y.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var r;const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const s=this.renderer;if(this.initTextureType(t,e),(r=t.resource)!=null&&r.upload(s,t,e))e.samplerType!==xa.FLOAT&&(this.hasIntegerTextures=!0);else{const n=t.realWidth,o=t.realHeight,a=s.gl;(e.width!==n||e.height!==o||e.dirtyId<0)&&(e.width=n,e.height=o,a.texImage2D(t.target,0,e.internalFormat,n,o,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:s}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),s.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const r=this.managedTextures.indexOf(t);r!==-1&&j0(this.managedTextures,r,1)}}updateTextureStyle(t){var s;const e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===Xi.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=ah.CLAMP:e.wrapMode=t.wrapMode,(s=t.resource)!=null&&s.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const s=this.gl;if(e.mipmap&&t.mipmap!==Xi.ON_MANUAL&&s.generateMipmap(t.target),s.texParameteri(t.target,s.TEXTURE_WRAP_S,e.wrapMode),s.texParameteri(t.target,s.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){s.texParameteri(t.target,s.TEXTURE_MIN_FILTER,t.scaleMode===Je.LINEAR?s.LINEAR_MIPMAP_LINEAR:s.NEAREST_MIPMAP_NEAREST);const r=this.renderer.context.extensions.anisotropicFiltering;if(r&&t.anisotropicLevel>0&&t.scaleMode===Je.LINEAR){const n=Math.min(t.anisotropicLevel,s.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));s.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else s.texParameteri(t.target,s.TEXTURE_MIN_FILTER,t.scaleMode===Je.LINEAR?s.LINEAR:s.NEAREST);s.texParameteri(t.target,s.TEXTURE_MAG_FILTER,t.scaleMode===Je.LINEAR?s.LINEAR:s.NEAREST)}destroy(){this.renderer=null}}ad.extension={type:B.RendererSystem,name:"texture"};D.add(ad);class hd{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:s}=this,r=t._glTransformFeedbacks[s]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,r)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:s,renderer:r}=this;e&&r.shader.bind(e),s.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:s,CONTEXT_UID:r}=this,n=e.createTransformFeedback();t._glTransformFeedbacks[r]=n,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,n);for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];a&&(s.buffer.update(a),a._glBuffers[r].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[r].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),n}disposeTransformFeedback(t,e){const s=t._glTransformFeedbacks[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this);const n=this.renderer.buffer;if(n)for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];if(!a)continue;const h=a._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!e&&n.dispose(a,e))}s&&(e||r.deleteTransformFeedback(s),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}hd.extension={type:B.RendererSystem,name:"transformFeedback"};D.add(hd);class ld{constructor(t){this.renderer=t}init(t){this.screen=new vt(0,0,t.width,t.height),this.element=t.view||V.ADAPTER.createCanvas(),this.resolution=t.resolution||V.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const s=this.element.width/this.resolution,r=this.element.height/this.resolution;this.screen.width=s,this.screen.height=r,this.autoDensity&&(this.element.style.width=`${s}px`,this.element.style.height=`${r}px`),this.renderer.emit("resize",s,r),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&((e=this.element.parentNode)==null||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}ld.extension={type:[B.RendererSystem,B.CanvasRendererSystem],name:"_view"};D.add(ld);V.PREFER_ENV=Ki.WEBGL2;V.STRICT_TEXTURE_CACHE=!1;Object.defineProperties(V,{WRAP_MODE:{get(){return j.defaultOptions.wrapMode},set(i){tt("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),j.defaultOptions.wrapMode=i}},SCALE_MODE:{get(){return j.defaultOptions.scaleMode},set(i){tt("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),j.defaultOptions.scaleMode=i}},MIPMAP_TEXTURES:{get(){return j.defaultOptions.mipmap},set(i){tt("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),j.defaultOptions.mipmap=i}},ANISOTROPIC_LEVEL:{get(){return j.defaultOptions.anisotropicLevel},set(i){tt("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),j.defaultOptions.anisotropicLevel=i}},FILTER_RESOLUTION:{get(){return tt("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),hi.defaultResolution},set(i){hi.defaultResolution=i}},FILTER_MULTISAMPLE:{get(){return tt("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),hi.defaultMultisample},set(i){hi.defaultMultisample=i}},SPRITE_MAX_TEXTURES:{get(){return Te.defaultMaxTextures},set(i){tt("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),Te.defaultMaxTextures=i}},SPRITE_BATCH_SIZE:{get(){return Te.defaultBatchSize},set(i){tt("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),Te.defaultBatchSize=i}},CAN_UPLOAD_SAME_BUFFER:{get(){return Te.canUploadSameBuffer},set(i){tt("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),Te.canUploadSameBuffer=i}},GC_MODE:{get(){return Ce.defaultMode},set(i){tt("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),Ce.defaultMode=i}},GC_MAX_IDLE:{get(){return Ce.defaultMaxIdle},set(i){tt("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),Ce.defaultMaxIdle=i}},GC_MAX_CHECK_COUNT:{get(){return Ce.defaultCheckCountMax},set(i){tt("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),Ce.defaultCheckCountMax=i}},PRECISION_VERTEX:{get(){return Qe.defaultVertexPrecision},set(i){tt("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),Qe.defaultVertexPrecision=i}},PRECISION_FRAGMENT:{get(){return Qe.defaultFragmentPrecision},set(i){tt("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),Qe.defaultFragmentPrecision=i}}});var An=(i=>(i[i.HIGH=25]="HIGH",i[i.NORMAL=0]="NORMAL",i[i.LOW=-25]="LOW",i[i.UTILITY=-50]="UTILITY",i))(An||{});class $o{constructor(t,e=null,s=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=s,this.once=r}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const Kt=class{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new $o(null,null,1/0),this.deltaMS=1/Kt.targetFPMS,this.elapsedMS=1/Kt.targetFPMS,this._tick=i=>{this._requestId=null,this.started&&(this.update(i),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(i,t,e=An.NORMAL){return this._addListener(new $o(i,t,e))}addOnce(i,t,e=An.NORMAL){return this._addListener(new $o(i,t,e,!0))}_addListener(i){let t=this._head.next,e=this._head;if(!t)i.connect(e);else{for(;t;){if(i.priority>t.priority){i.connect(e);break}e=t,t=t.next}i.previous||i.connect(e)}return this._startIfPossible(),this}remove(i,t){let e=this._head.next;for(;e;)e.match(i,t)?e=e.destroy():e=e.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let i=0,t=this._head;for(;t=t.next;)i++;return i}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let i=this._head.next;for(;i;)i=i.destroy(!0);this._head.destroy(),this._head=null}}update(i=performance.now()){let t;if(i>this.lastTime){if(t=this.elapsedMS=i-this.lastTime,t>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){const r=i-this._lastFrame|0;if(r<this._minElapsedMS)return;this._lastFrame=i-r%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*Kt.targetFPMS;const e=this._head;let s=e.next;for(;s;)s=s.emit(this.deltaTime);e.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=i}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(i){const t=Math.min(this.maxFPS,i),e=Math.min(Math.max(0,t)/1e3,Kt.targetFPMS);this._maxElapsedMS=1/e}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(i){if(i===0)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,i);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!Kt._shared){const i=Kt._shared=new Kt;i.autoStart=!0,i._protected=!0}return Kt._shared}static get system(){if(!Kt._system){const i=Kt._system=new Kt;i.autoStart=!0,i._protected=!0}return Kt._system}};let kt=Kt;kt.targetFPMS=.06;Object.defineProperties(V,{TARGET_FPMS:{get(){return kt.targetFPMS},set(i){tt("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),kt.targetFPMS=i}}});class cd{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,An.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?kt.shared:new kt,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}cd.extension=B.Application;D.add(cd);const ox=[];D.handleByList(B.Renderer,ox);class ud{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){const s=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,s)}else{const s=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,s)}e>=yt.HIGH?this.multisample=yt.HIGH:e>=yt.MEDIUM?this.multisample=yt.MEDIUM:e>=yt.LOW?this.multisample=yt.LOW:this.multisample=yt.NONE}destroy(){}}ud.extension={type:B.RendererSystem,name:"_multisample"};D.add(ud);class ax{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class dd{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:s}=this,r=t._glBuffers[s]||this.createGLBuffer(t);e.bindBuffer(t.type,r.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:s,CONTEXT_UID:r}=this;if(this.boundBufferBases[e]!==t){const n=t._glBuffers[r]||this.createGLBuffer(t);this.boundBufferBases[e]=t,s.bindBufferBase(s.UNIFORM_BUFFER,e,n.buffer)}}bindBufferRange(t,e,s){const{gl:r,CONTEXT_UID:n}=this;s=s||0;const o=t._glBuffers[n]||this.createGLBuffer(t);r.bindBufferRange(r.UNIFORM_BUFFER,e||0,o.buffer,s*256,256)}update(t){const{gl:e,CONTEXT_UID:s}=this,r=t._glBuffers[s]||this.createGLBuffer(t);if(t._updateID!==r.updateID)if(r.updateID=t._updateID,e.bindBuffer(t.type,r.buffer),r.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const n=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;r.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,n)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const s=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),s&&(e||r.deleteBuffer(s.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let s=0;s<e.length;s++)this.dispose(this.managedBuffers[e[s]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:s}=this;return t._glBuffers[e]=new ax(s.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}dd.extension={type:B.RendererSystem,name:"buffer"};D.add(dd);class fd{constructor(t){this.renderer=t}render(t,e){const s=this.renderer;let r,n,o,a;if(e&&(r=e.renderTexture,n=e.clear,o=e.transform,a=e.skipUpdateTransform),this.renderingToScreen=!r,s.runners.prerender.emit(),s.emit("prerender"),s.projection.transform=o,!s.context.isLost){if(r||(this.lastObjectRendered=t),!a){const h=t.enableTempParent();t.updateTransform(),t.disableTempParent(h)}s.renderTexture.bind(r),s.batch.currentRenderer.start(),(n??s.background.clearBeforeRender)&&s.renderTexture.clear(),t.render(s),s.batch.currentRenderer.flush(),r&&(e.blit&&s.framebuffer.blit(),r.baseTexture.update()),s.runners.postrender.emit(),s.projection.transform=null,s.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}fd.extension={type:B.RendererSystem,name:"objectRenderer"};D.add(fd);const Ia=class extends rx{constructor(i){super(),i=Object.assign({},V.RENDER_OPTIONS,i),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new De({projectionMatrix:new Mt},!0);const t={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:Ia.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(t),"useContextAlpha"in i&&(tt("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),i.premultipliedAlpha=i.useContextAlpha&&i.useContextAlpha!=="notMultiplied",i.backgroundAlpha=i.useContextAlpha===!1?1:i.backgroundAlpha);const e={hello:i.hello,_plugin:Ia.__plugins,background:{alpha:i.backgroundAlpha,color:i.background??i.backgroundColor,clearBeforeRender:i.clearBeforeRender},_view:{height:i.height,width:i.width,autoDensity:i.autoDensity,resolution:i.resolution,view:i.view},context:{antialias:i.antialias,context:i.context,powerPreference:i.powerPreference,premultipliedAlpha:i.premultipliedAlpha,preserveDrawingBuffer:i.preserveDrawingBuffer}};this.options=i,this.startup.run(e)}static test(i){return i!=null&&i.forceCanvas?!1:Jm()}render(i,t){this.objectRenderer.render(i,t)}resize(i,t){this._view.resizeView(i,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(i=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:i}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(i){this._view.resolution=i,this.runners.resolutionChange.emit(i)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return tt("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return tt("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return tt("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return tt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(i){tt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=i}get backgroundAlpha(){return tt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.color}set backgroundAlpha(i){tt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=i}get powerPreference(){return tt("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(i,t){return this.textureGenerator.generateTexture(i,t)}};let Us=Ia;Us.extension={type:B.Renderer,priority:1};Us.__plugins={};Us.__systems={};D.handleByMap(B.RendererPlugin,Us.__plugins);D.handleByMap(B.RendererSystem,Us.__systems);D.add(Us);class pd extends gr{constructor(t,e){const{width:s,height:r}=e||{};super(s,r),this.items=[],this.itemDirtyIds=[];for(let n=0;n<t;n++){const o=new j;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let s=0;s<this.length;s++)t[s]&&(t[s].castToBaseTexture?this.addBaseTextureAt(t[s].castToBaseTexture(),s):t[s]instanceof gr?this.addResourceAt(t[s],s):this.addResourceAt(Iu(t[s],e),s))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const e=this.items.map(s=>s.resource).filter(s=>s).map(s=>s.load());return this._load=Promise.all(e).then(()=>{const{realWidth:s,realHeight:r}=this.items[0];return this.resize(s,r),Promise.resolve(this)}),this._load}}class hx extends pd{constructor(t,e){const{width:s,height:r}=e||{};let n,o;Array.isArray(t)?(n=t,o=t.length):o=t,super(o,{width:s,height:r}),n&&this.initFromArray(n,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=bs.TEXTURE_2D_ARRAY}upload(t,e,s){const{length:r,itemDirtyIds:n,items:o}=this,{gl:a}=t;s.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,s.internalFormat,this._width,this._height,r,0,e.format,s.type,null);for(let h=0;h<r;h++){const l=o[h];n[h]<l.dirtyId&&(n[h]=l.dirtyId,l.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,h,l.resource.width,l.resource.height,1,e.format,s.type,l.resource.source))}return!0}}class lx extends pi{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const Zs=class extends pd{constructor(i,t){const{width:e,height:s,autoLoad:r,linkBaseTexture:n}=t||{};if(i&&i.length!==Zs.SIDES)throw new Error(`Invalid length. Got ${i.length}, expected 6`);super(6,{width:e,height:s});for(let o=0;o<Zs.SIDES;o++)this.items[o].target=bs.TEXTURE_CUBE_MAP_POSITIVE_X+o;this.linkBaseTexture=n!==!1,i&&this.initFromArray(i,t),r!==!1&&this.load()}bind(i){super.bind(i),i.target=bs.TEXTURE_CUBE_MAP}addBaseTextureAt(i,t,e){if(e===void 0&&(e=this.linkBaseTexture),!this.items[t])throw new Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||i.parentTextureArray||Object.keys(i._glTextures).length>0)if(i.resource)this.addResourceAt(i.resource,t);else throw new Error("CubeResource does not support copying of renderTexture.");else i.target=bs.TEXTURE_CUBE_MAP_POSITIVE_X+t,i.parentTextureArray=this.baseTexture,this.items[t]=i;return i.valid&&!this.valid&&this.resize(i.realWidth,i.realHeight),this.items[t]=i,this}upload(i,t,e){const s=this.itemDirtyIds;for(let r=0;r<Zs.SIDES;r++){const n=this.items[r];(s[r]<n.dirtyId||e.dirtyId<t.dirtyId)&&(n.valid&&n.resource?(n.resource.upload(i,n,e),s[r]=n.dirtyId):s[r]<-1&&(i.gl.texImage2D(n.target,0,e.internalFormat,t.realWidth,t.realHeight,0,t.format,e.type,null),s[r]=-1))}return!0}static test(i){return Array.isArray(i)&&i.length===Zs.SIDES}};let _d=Zs;_d.SIDES=6;class _s extends pi{constructor(t,e){e=e||{};let s,r;typeof t=="string"?(s=_s.EMPTY,r=t):(s=t,r=null),super(s),this.url=r,this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{const s=await V.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const r=await s.blob();if(this.destroyed)return;const n=await createImageBitmap(r,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===bi.UNPACK?"premultiply":"none"});if(this.destroyed)return;this.source=n,this.update(),t(this)}catch(s){if(this.destroyed)return;e(s),this.onError.emit(s)}}),this._load)}upload(t,e,s){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,s)):(this.load(),!1)}dispose(){this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return _s._EMPTY=_s._EMPTY??V.ADAPTER.createCanvas(0,0),_s._EMPTY}}const un=class extends pi{constructor(i,t){t=t||{},super(V.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=i,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,t.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(i=>{if(this._resolve=()=>{this.resize(this.source.width,this.source.height),i(this)},un.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const i=new Image;pi.crossOrigin(i,this.svg,this._crossorigin),i.src=this.svg,i.onerror=t=>{this._resolve&&(i.onerror=null,this.onError.emit(t))},i.onload=()=>{if(!this._resolve)return;const t=i.width,e=i.height;if(!t||!e)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let s=t*this.scale,r=e*this.scale;(this._overrideWidth||this._overrideHeight)&&(s=this._overrideWidth||this._overrideHeight/e*t,r=this._overrideHeight||this._overrideWidth/t*e),s=Math.round(s),r=Math.round(r);const n=this.source;n.width=s,n.height=r,n._pixiId=`canvas_${mr()}`,n.getContext("2d").drawImage(i,0,0,t,e,0,0,s,r),this._resolve(),this._resolve=null}}static getSize(i){const t=un.SVG_SIZE.exec(i),e={};return t&&(e[t[1]]=Math.round(parseFloat(t[3])),e[t[5]]=Math.round(parseFloat(t[7]))),e}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(i,t){return t==="svg"||typeof i=="string"&&i.startsWith("data:image/svg+xml")||typeof i=="string"&&un.SVG_XML.test(i)}};let yr=un;yr.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m;yr.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const Ma=class extends pi{constructor(i,t){if(t=t||{},!(i instanceof HTMLVideoElement)){const e=document.createElement("video");e.setAttribute("preload","auto"),e.setAttribute("webkit-playsinline",""),e.setAttribute("playsinline",""),typeof i=="string"&&(i=[i]);const s=i[0].src||i[0];pi.crossOrigin(e,s,t.crossorigin);for(let r=0;r<i.length;++r){const n=document.createElement("source");let{src:o,mime:a}=i[r];o=o||i[r];const h=o.split("?").shift().toLowerCase(),l=h.slice(h.lastIndexOf(".")+1);a=a||Ma.MIME_TYPES[l]||`video/${l}`,n.src=o,n.type=a,e.appendChild(n)}i=e}super(i),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),t.autoLoad!==!1&&this.load()}update(i=0){if(!this.destroyed){const t=kt.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t),(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}load(){if(this._load)return this._load;const i=this.source;return(i.readyState===i.HAVE_ENOUGH_DATA||i.readyState===i.HAVE_FUTURE_DATA)&&i.width&&i.height&&(i.complete=!0),i.addEventListener("play",this._onPlayStart.bind(this)),i.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(i.addEventListener("canplay",this._onCanPlay),i.addEventListener("canplaythrough",this._onCanPlay),i.addEventListener("error",this._onError,!0)),this._load=new Promise(t=>{this.valid?t(this):(this._resolve=t,i.load())}),this._load}_onError(i){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(i)}_isSourcePlaying(){const i=this.source;return!i.paused&&!i.ended&&this._isSourceReady()}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(kt.shared.add(this.update,this),this._isConnectedToTicker=!0)}_onPlayStop(){this._isConnectedToTicker&&(kt.shared.remove(this.update,this),this._isConnectedToTicker=!1)}_onCanPlay(){const i=this.source;i.removeEventListener("canplay",this._onCanPlay),i.removeEventListener("canplaythrough",this._onCanPlay);const t=this.valid;this.resize(i.videoWidth,i.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&i.play()}dispose(){this._isConnectedToTicker&&(kt.shared.remove(this.update,this),this._isConnectedToTicker=!1);const i=this.source;i&&(i.removeEventListener("error",this._onError,!0),i.pause(),i.src="",i.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(i){i!==this._autoUpdate&&(this._autoUpdate=i,!this._autoUpdate&&this._isConnectedToTicker?(kt.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(kt.shared.add(this.update,this),this._isConnectedToTicker=!0))}get updateFPS(){return this._updateFPS}set updateFPS(i){i!==this._updateFPS&&(this._updateFPS=i)}static test(i,t){return globalThis.HTMLVideoElement&&i instanceof HTMLVideoElement||Ma.TYPES.includes(t)}};let ch=Ma;ch.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];ch.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};Sa.push(_s,Hu,lx,ch,yr,lh,_d,hx);const jl={loader:B.LoadParser,resolver:B.ResolveParser,cache:B.CacheParser,detection:B.DetectionParser};D.handle(B.Asset,i=>{const t=i.ref;Object.entries(jl).filter(([e])=>!!t[e]).forEach(([e,s])=>D.add(Object.assign(t[e],{extension:t[e].extension??s})))},i=>{const t=i.ref;Object.keys(jl).filter(e=>!!t[e]).forEach(e=>D.remove(t[e]))});class cx{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<e;s++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function md(i,t){if(Array.isArray(t)){for(const e of t)if(i.startsWith(`data:${e}`))return!0;return!1}return i.startsWith(`data:${t}`)}function gd(i,t){const e=i.split("?")[0],s=Xt.extname(e).toLowerCase();return Array.isArray(t)?t.includes(s):s===t}const ei=(i,t)=>(Array.isArray(i)||(i=[i]),t?i.map(e=>typeof e=="string"?t(e):e):i);function yd(i,t,e,s,r){const n=t[e];for(let o=0;o<n.length;o++){const a=n[o];e<t.length-1?yd(i.replace(s[e],a),t,e+1,s,r):r.push(i.replace(s[e],a))}}function ux(i){const t=/\{(.*?)\}/g,e=i.match(t),s=[];if(e){const r=[];e.forEach(n=>{const o=n.substring(1,n.length-1).split(",");r.push(o)}),yd(i,r,0,e,s)}else s.push(i);return s}const En=i=>!Array.isArray(i);class dx{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const s=ei(t);let r;for(let a=0;a<this.parsers.length;a++){const h=this.parsers[a];if(h.test(e)){r=h.getCacheableAssets(s,e);break}}r||(r={},s.forEach(a=>{r[a]=e}));const n=Object.keys(r),o={cacheKeys:n,keys:s};if(s.forEach(a=>{this._cacheMap.set(a,o)}),n.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==e&&console.warn("[Cache] already has key:",a),this._cache.set(a,r[a])}),e instanceof X){const a=e;s.forEach(h=>{a.baseTexture!==X.EMPTY.baseTexture&&j.addToCache(a.baseTexture,h),X.addToCache(a,h)})}}remove(t){if(this._cacheMap.get(t),!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(r=>{this._cache.delete(r)}),e.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const Ws=new dx;class fx{constructor(){this._parsers=[],this.promiseCache={}}reset(){this.promiseCache={}}_getLoadPromiseAndParser(t,e){const s={promise:null,parser:null};return s.promise=(async()=>{var n,o;let r=null;for(let a=0;a<this.parsers.length;a++){const h=this.parsers[a];if(h.load&&((n=h.test)!=null&&n.call(h,t,e,this))){r=await h.load(t,e,this),s.parser=h;break}}if(!s.parser)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has being added`),null;for(let a=0;a<this.parsers.length;a++){const h=this.parsers[a];h.parse&&h.parse&&await((o=h.testParse)==null?void 0:o.call(h,r,e,this))&&(r=await h.parse(r,e,this)||r,s.parser=h)}return r})(),s}async load(t,e){let s=0;const r={},n=En(t),o=ei(t,l=>({src:l})),a=o.length,h=o.map(async l=>{const c=Xt.toAbsolute(l.src);if(!r[l.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,l)),r[l.src]=await this.promiseCache[c].promise,e&&e(++s/a)}catch(u){throw delete this.promiseCache[c],delete r[l.src],new Error(`[Loader.load] Failed to load ${c}.
${u}`)}});return await Promise.all(h),n?r[o[0].src]:r}async unload(t){const s=ei(t,r=>({src:r})).map(async r=>{var a,h;const n=Xt.toAbsolute(r.src),o=this.promiseCache[n];if(o){const l=await o.promise;(h=(a=o.parser)==null?void 0:a.unload)==null||h.call(a,l,r,this),delete this.promiseCache[n]}});await Promise.all(s)}get parsers(){return this._parsers}}var Zi=(i=>(i[i.Low=0]="Low",i[i.Normal=1]="Normal",i[i.High=2]="High",i))(Zi||{});const px={extension:{type:B.LoadParser,priority:Zi.Low},test(i){return Xt.extname(i).toLowerCase()===".json"},async load(i){return await(await V.ADAPTER.fetch(i)).json()}};D.add(px);const _x={extension:{type:B.LoadParser,priority:Zi.Low},test(i){return Xt.extname(i).toLowerCase()===".txt"},async load(i){return await(await V.ADAPTER.fetch(i)).text()}};D.add(_x);const mx=["normal","bold","100","200","300","400","500","600","700","800","900"],gx=[".ttf",".otf",".woff",".woff2"],yx=["font/ttf","font/otf","font/woff","font/woff2"];function bx(i){const t=Xt.extname(i);return Xt.basename(i,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")}const xx={extension:{type:B.LoadParser,priority:Zi.Low},test(i){return md(i,yx)||gd(i,gx)},async load(i,t){var s,r,n;const e=V.ADAPTER.getFontFaceSet();if(e){const o=[],a=((s=t.data)==null?void 0:s.family)??bx(i),h=((n=(r=t.data)==null?void 0:r.weights)==null?void 0:n.filter(c=>mx.includes(c)))??["normal"],l=t.data??{};for(let c=0;c<h.length;c++){const u=h[c],d=new FontFace(a,`url(${encodeURI(i)})`,{...l,weight:u});await d.load(),e.add(d),o.push(d)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(i){(Array.isArray(i)?i:[i]).forEach(t=>V.ADAPTER.getFontFaceSet().delete(t))}};D.add(xx);let Xl=0,Ho;const vx="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",wx={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${vx}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},Tx={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let zo;class Cx{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const e=URL.createObjectURL(new Blob([wx.code],{type:"application/javascript"})),s=new Worker(e);s.addEventListener("message",r=>{s.terminate(),URL.revokeObjectURL(e),t(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){Ho===void 0&&(Ho=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<Ho&&(zo||(zo=URL.createObjectURL(new Blob([Tx.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(zo),t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const s=new Promise((r,n)=>{this.queue.push({id:t,arguments:e,resolve:r,reject:n})});return this.next(),s}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),s=e.id;this.resolveHash[Xl]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:Xl++,id:s})}}const Yl=new Cx;function bd(i,t,e){const s=new X(i);return s.baseTexture.on("dispose",()=>{delete t.promiseCache[e]}),s}const Sx=[".jpeg",".jpg",".png",".webp",".avif"],Ax=["image/jpeg","image/png","image/webp","image/avif"];async function Ex(i){const t=await V.ADAPTER.fetch(i);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${i}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const br={extension:{type:B.LoadParser,priority:Zi.High},config:{preferWorkers:!0},test(i){return md(i,Ax)||gd(i,Sx)},async load(i,t,e){let s=null;globalThis.createImageBitmap?this.config.preferWorkers&&await Yl.isImageBitmapSupported()?s=await Yl.loadImageBitmap(i):s=await Ex(i):s=await new Promise(n=>{s=new Image,s.crossOrigin="anonymous",s.src=i,s.complete?n(s):s.onload=()=>{n(s)}});const r=new j(s,{resolution:Cn(i),...t.data});return r.resource.src=i,bd(r,e,i)},unload(i){i.destroy(!0)}};D.add(br);const Px={extension:{type:B.LoadParser,priority:Zi.High},test(i){return Xt.extname(i).toLowerCase()===".svg"},async testParse(i){return yr.test(i)},async parse(i,t,e){var o,a,h;const s=new yr(i,(o=t==null?void 0:t.data)==null?void 0:o.resourceOptions),r=new j(s,{resolution:Cn(i),...t==null?void 0:t.data});r.resource.src=i;const n=bd(r,e,i);return(h=(a=t==null?void 0:t.data)==null?void 0:a.resourceOptions)!=null&&h.autoLoad||await s.load(),n},async load(i,t){return(await V.ADAPTER.fetch(i)).text()},unload:br.unload};D.add(Px);class Ix{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(e[s])}`).join("&")}}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const s=[];Array.isArray(e)?e.forEach(r=>{if(typeof r.name=="string"){const n=this._createBundleAssetId(t,r.name);s.push(n),this.add([r.name,n],r.srcs,r.data)}else{const n=r.name.map(o=>this._createBundleAssetId(t,o));n.forEach(o=>{s.push(o)}),this.add([...r.name,...n],r.srcs)}}):Object.keys(e).forEach(r=>{s.push(this._createBundleAssetId(t,r)),this.add([r,this._createBundleAssetId(t,r)],e[r])}),this._bundles[t]=s}add(t,e,s){const r=ei(t);r.forEach(o=>{this.hasKey(o)&&console.warn(`[Resolver] already has key: ${o} overwriting`)}),Array.isArray(e)||(typeof e=="string"?e=ux(e):e=[e]);const n=e.map(o=>{let a=o;if(typeof o=="string"){let h=!1;for(let l=0;l<this._parsers.length;l++){const c=this._parsers[l];if(c.test(o)){a=c.parse(o),h=!0;break}}h||(a={src:o})}return a.format||(a.format=a.src.split(".").pop()),a.alias||(a.alias=r),(this._basePath||this._rootPath)&&(a.src=Xt.toAbsolute(a.src,this._basePath,this._rootPath)),a.src=this._appendDefaultSearchParams(a.src),a.data=a.data??s,a});r.forEach(o=>{this._assetMap[o]=n})}resolveBundle(t){const e=En(t);t=ei(t);const s={};return t.forEach(r=>{const n=this._bundles[r];if(n){const o=this.resolve(n),a={};for(const h in o){const l=o[h];a[this._extractAssetIdFromBundle(r,h)]=l}s[r]=a}}),e?s[t[0]]:s}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const s={};for(const r in e)s[r]=e[r].src;return s}return e.src}resolve(t){const e=En(t);t=ei(t);const s={};return t.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let n=this._assetMap[r];const o=this._getPreferredOrder(n),a=n[0];o==null||o.priority.forEach(h=>{o.params[h].forEach(l=>{const c=n.filter(u=>u[h]?u[h]===l:!1);c.length&&(n=c)})}),this._resolverHash[r]=n[0]??a}else{let n=r;(this._basePath||this._rootPath)&&(n=Xt.toAbsolute(n,this._basePath,this._rootPath)),n=this._appendDefaultSearchParams(n),this._resolverHash[r]={src:n}}s[r]=this._resolverHash[r]}),e?s[t[0]]:s}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const s=t[0],r=this._preferredOrder.find(n=>n.params.format.includes(s.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}}class Mx{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Ix,this.loader=new fx,this.cache=Ws,this._backgroundLoader=new cx(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var n,o,a;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let h=t.manifest;typeof h=="string"&&(h=await this.load(h)),this.resolver.addManifest(h)}const e=((n=t.texturePreference)==null?void 0:n.resolution)??1,s=typeof e=="number"?[e]:e;let r=[];if((o=t.texturePreference)!=null&&o.format){const h=(a=t.texturePreference)==null?void 0:a.format;r=typeof h=="string"?[h]:h;for(const l of this._detections)await l.test()||(r=await l.remove(r))}else for(const h of this._detections)await h.test()&&(r=await h.add(r));this.resolver.prefer({params:{format:r,resolution:s}})}add(t,e,s){this.resolver.add(t,e,s)}async load(t,e){this._initialized||await this.init();const s=En(t),r=ei(t).map(a=>typeof a!="string"?(this.resolver.add(a.src,a),a.src):(this.resolver.hasKey(a)||this.resolver.add(a,a),a)),n=this.resolver.resolve(r),o=await this._mapLoadToResolve(n,e);return s?o[r[0]]:o}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let s=!1;typeof t=="string"&&(s=!0,t=[t]);const r=this.resolver.resolveBundle(t),n={},o=Object.keys(r);let a=0,h=0;const l=()=>{e==null||e(++a/h)},c=o.map(u=>{const d=r[u];return h+=Object.keys(d).length,this._mapLoadToResolve(d,l).then(f=>{n[u]=f})});return await Promise.all(c),s?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(s=>{this._backgroundLoader.add(Object.values(s))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return Ws.get(t);const e={};for(let s=0;s<t.length;s++)e[s]=Ws.get(t[s]);return e}async _mapLoadToResolve(t,e){const s=Object.values(t),r=Object.keys(t);this._backgroundLoader.active=!1;const n=await this.loader.load(s,e);this._backgroundLoader.active=!0;const o={};return s.forEach((a,h)=>{const l=n[a.src],c=[a.src];a.alias&&c.push(...a.alias),o[r[h]]=l,Ws.set(c,l)}),o}async unload(t){this._initialized||await this.init();const e=ei(t).map(r=>typeof r!="string"?r.src:r),s=this.resolver.resolve(e);await this._unloadFromResolved(s)}async unloadBundle(t){this._initialized||await this.init(),t=ei(t);const e=this.resolver.resolveBundle(t),s=Object.keys(e).map(r=>this._unloadFromResolved(e[r]));await Promise.all(s)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(s=>{Ws.remove(s.src)}),await this.loader.unload(e)}get detections(){return this._detections}get preferWorkers(){return br.config.preferWorkers}set preferWorkers(t){br.config.preferWorkers=t}}const en=new Mx;D.handleByList(B.LoadParser,en.loader.parsers).handleByList(B.ResolveParser,en.resolver.parsers).handleByList(B.CacheParser,en.cache.parsers).handleByList(B.DetectionParser,en.detections);const Rx={extension:B.CacheParser,test:i=>Array.isArray(i)&&i.every(t=>t instanceof X),getCacheableAssets:(i,t)=>{const e={};return i.forEach(s=>{t.forEach((r,n)=>{e[s+(n===0?"":n+1)]=r})}),e}};D.add(Rx);const kx={extension:{type:B.DetectionParser,priority:1},test:async()=>{if(!globalThis.createImageBitmap)return!1;const i="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=",t=await V.ADAPTER.fetch(i).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async i=>[...i,"avif"],remove:async i=>i.filter(t=>t!=="avif")};D.add(kx);const Bx={extension:{type:B.DetectionParser,priority:0},test:async()=>{if(!globalThis.createImageBitmap)return!1;const i="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=",t=await V.ADAPTER.fetch(i).then(e=>e.blob());return createImageBitmap(t).then(()=>!0,()=>!1)},add:async i=>[...i,"webp"],remove:async i=>i.filter(t=>t!=="webp")};D.add(Bx);const ql=["png","jpg","jpeg"],Lx={extension:{type:B.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async i=>[...i,...ql],remove:async i=>i.filter(t=>!ql.includes(t))};D.add(Lx);const Ox={extension:B.ResolveParser,test:br.test,parse:i=>{var t;return{resolution:parseFloat(((t=V.RETINA_PREFIX.exec(i))==null?void 0:t[1])??"1"),format:i.split(".").pop(),src:i}}};D.add(Ox);let xd;function Fx(i){return xd=i,i}function xr(){return xd}let Nx=0;const Ra=class extends Ve{constructor(i){super(),this.id=Nx++,this.init(i)}set(i,t){if(this[i]===void 0)throw new Error(`Property with name ${i} does not exist.`);switch(i){case"speed":this.speed=t;break;case"volume":this.volume=t;break;case"paused":this.paused=t;break;case"loop":this.loop=t;break;case"muted":this.muted=t;break}return this}get progress(){const{currentTime:i}=this._source;return i/this._duration}get paused(){return this._paused}set paused(i){this._paused=i,this.refreshPaused()}_onPlay(){this._playing=!0}_onPause(){this._playing=!1}init(i){this._playing=!1,this._duration=i.source.duration;const t=this._source=i.source.cloneNode(!1);t.src=i.parent.url,t.onplay=this._onPlay.bind(this),t.onpause=this._onPause.bind(this),i.context.on("refresh",this.refresh,this),i.context.on("refreshPaused",this.refreshPaused,this),this._media=i}_internalStop(){this._source&&this._playing&&(this._source.onended=null,this._source.pause())}stop(){this._internalStop(),this._source&&this.emit("stop")}get speed(){return this._speed}set speed(i){this._speed=i,this.refresh()}get volume(){return this._volume}set volume(i){this._volume=i,this.refresh()}get loop(){return this._loop}set loop(i){this._loop=i,this.refresh()}get muted(){return this._muted}set muted(i){this._muted=i,this.refresh()}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(i){console.warn("HTML Audio does not support filters")}refresh(){const i=this._media.context,t=this._media.parent;this._source.loop=this._loop||t.loop;const e=i.volume*(i.muted?0:1),s=t.volume*(t.muted?0:1),r=this._volume*(this._muted?0:1);this._source.volume=r*e*s,this._source.playbackRate=this._speed*i.speed*t.speed}refreshPaused(){const i=this._media.context,t=this._media.parent,e=this._paused||t.paused||i.paused;e!==this._pausedReal&&(this._pausedReal=e,e?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._source.currentTime,end:this._end,volume:this._volume,speed:this._speed,loop:this._loop})),this.emit("pause",e))}play(i){const{start:t,end:e,speed:s,loop:r,volume:n,muted:o}=i;e&&console.assert(e>t,"End time is before start time"),this._speed=s,this._volume=n,this._loop=!!r,this._muted=o,this.refresh(),this.loop&&e!==null&&(console.warn('Looping not support when specifying an "end" time'),this.loop=!1),this._start=t,this._end=e||this._duration,this._start=Math.max(0,this._start-Ra.PADDING),this._end=Math.min(this._end+Ra.PADDING,this._duration),this._source.onloadedmetadata=()=>{this._source&&(this._source.currentTime=t,this._source.onloadedmetadata=null,this.emit("progress",t,this._duration),kt.shared.add(this._onUpdate,this))},this._source.onended=this._onComplete.bind(this),this._source.play(),this.emit("start")}_onUpdate(){this.emit("progress",this.progress,this._duration),this._source.currentTime>=this._end&&!this._source.loop&&this._onComplete()}_onComplete(){kt.shared.remove(this._onUpdate,this),this._internalStop(),this.emit("progress",1,this._duration),this.emit("end",this)}destroy(){kt.shared.remove(this._onUpdate,this),this.removeAllListeners();const i=this._source;i&&(i.onended=null,i.onplay=null,i.onpause=null,this._internalStop()),this._source=null,this._speed=1,this._volume=1,this._loop=!1,this._end=null,this._start=0,this._duration=0,this._playing=!1,this._pausedReal=!1,this._paused=!1,this._muted=!1,this._media&&(this._media.context.off("refresh",this.refresh,this),this._media.context.off("refreshPaused",this.refreshPaused,this),this._media=null)}toString(){return`[HTMLAudioInstance id=${this.id}]`}};let vd=Ra;vd.PADDING=.1;class Ux extends Ve{init(t){this.parent=t,this._source=t.options.source||new Audio,t.url&&(this._source.src=t.url)}create(){return new vd(this)}get isPlayable(){return!!this._source&&this._source.readyState===4}get duration(){return this._source.duration}get context(){return this.parent.context}get filters(){return null}set filters(t){console.warn("HTML Audio does not support filters")}destroy(){this.removeAllListeners(),this.parent=null,this._source&&(this._source.src="",this._source.load(),this._source=null)}get source(){return this._source}load(t){const e=this._source,s=this.parent;if(e.readyState===4){s.isLoaded=!0;const h=s.autoPlayStart();t&&setTimeout(()=>{t(null,s,h)},0);return}if(!s.url){t(new Error("sound.url or sound.source must be set"));return}e.src=s.url;const r=()=>{a(),s.isLoaded=!0;const h=s.autoPlayStart();t&&t(null,s,h)},n=()=>{a(),t&&t(new Error("Sound loading has been aborted"))},o=()=>{a();const h=`Failed to load audio element (code: ${e.error.code})`;t?t(new Error(h)):console.error(h)},a=()=>{e.removeEventListener("canplaythrough",r),e.removeEventListener("load",r),e.removeEventListener("abort",n),e.removeEventListener("error",o)};e.addEventListener("canplaythrough",r,!1),e.addEventListener("load",r,!1),e.addEventListener("abort",n,!1),e.addEventListener("error",o,!1),e.load()}}class Dx{constructor(t,e){this.parent=t,Object.assign(this,e),this.duration=this.end-this.start,console.assert(this.duration>0,"End time must be after start time")}play(t){return this.parent.play({complete:t,speed:this.speed||this.parent.speed,end:this.end,start:this.start,loop:this.loop})}destroy(){this.parent=null}}class ka{static setParamValue(t,e){if(t.setValueAtTime){const s=xr().context;t.setValueAtTime(e,s.audioContext.currentTime)}else t.value=e;return e}}let Gx=0;class Vx extends Ve{constructor(t){super(),this.id=Gx++,this._media=null,this._paused=!1,this._muted=!1,this._elapsed=0,this.init(t)}set(t,e){if(this[t]===void 0)throw new Error(`Property with name ${t} does not exist.`);switch(t){case"speed":this.speed=e;break;case"volume":this.volume=e;break;case"muted":this.muted=e;break;case"loop":this.loop=e;break;case"paused":this.paused=e;break}return this}stop(){this._source&&(this._internalStop(),this.emit("stop"))}get speed(){return this._speed}set speed(t){this._speed=t,this.refresh(),this._update(!0)}get volume(){return this._volume}set volume(t){this._volume=t,this.refresh()}get muted(){return this._muted}set muted(t){this._muted=t,this.refresh()}get loop(){return this._loop}set loop(t){this._loop=t,this.refresh()}get filters(){return this._filters}set filters(t){var e;this._filters&&((e=this._filters)==null||e.filter(s=>s).forEach(s=>s.disconnect()),this._filters=null,this._source.connect(this._gain)),this._filters=t!=null&&t.length?t.slice(0):null,this.refresh()}refresh(){if(!this._source)return;const t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;const s=t.volume*(t.muted?0:1),r=e.volume*(e.muted?0:1),n=this._volume*(this._muted?0:1);ka.setParamValue(this._gain.gain,n*r*s),ka.setParamValue(this._source.playbackRate,this._speed*e.speed*t.speed),this.applyFilters()}applyFilters(){var t;if((t=this._filters)!=null&&t.length){this._source.disconnect();let e=this._source;this._filters.forEach(s=>{e.connect(s.destination),e=s}),e.connect(this._gain)}}refreshPaused(){const t=this._media.context,e=this._media.parent,s=this._paused||e.paused||t.paused;s!==this._pausedReal&&(this._pausedReal=s,s?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._elapsed%this._duration,end:this._end,speed:this._speed,loop:this._loop,volume:this._volume})),this.emit("pause",s))}play(t){const{start:e,end:s,speed:r,loop:n,volume:o,muted:a,filters:h}=t;s&&console.assert(s>e,"End time is before start time"),this._paused=!1;const{source:l,gain:c}=this._media.nodes.cloneBufferSource();this._source=l,this._gain=c,this._speed=r,this._volume=o,this._loop=!!n,this._muted=a,this._filters=h,this.refresh();const u=this._source.buffer.duration;this._duration=u,this._end=s,this._lastUpdate=this._now(),this._elapsed=e,this._source.onended=this._onComplete.bind(this),this._loop?(this._source.loopEnd=s,this._source.loopStart=e,this._source.start(0,e)):s?this._source.start(0,e,s-e):this._source.start(0,e),this.emit("start"),this._update(!0),this.enableTicker(!0)}enableTicker(t){kt.shared.remove(this._updateListener,this),t&&kt.shared.add(this._updateListener,this)}get progress(){return this._progress}get paused(){return this._paused}set paused(t){this._paused=t,this.refreshPaused()}destroy(){var t;this.removeAllListeners(),this._internalStop(),this._gain&&(this._gain.disconnect(),this._gain=null),this._media&&(this._media.context.events.off("refresh",this.refresh,this),this._media.context.events.off("refreshPaused",this.refreshPaused,this),this._media=null),(t=this._filters)==null||t.forEach(e=>e.disconnect()),this._filters=null,this._end=null,this._speed=1,this._volume=1,this._loop=!1,this._elapsed=0,this._duration=0,this._paused=!1,this._muted=!1,this._pausedReal=!1}toString(){return`[WebAudioInstance id=${this.id}]`}_now(){return this._media.context.audioContext.currentTime}_updateListener(){this._update()}_update(t=!1){if(this._source){const e=this._now(),s=e-this._lastUpdate;if(s>0||t){const r=this._source.playbackRate.value;this._elapsed+=s*r,this._lastUpdate=e;const n=this._duration;let o;if(this._source.loopStart){const a=this._source.loopEnd-this._source.loopStart;o=(this._source.loopStart+this._elapsed%a)/n}else o=this._elapsed%n/n;this._progress=o,this.emit("progress",this._progress,n)}}}init(t){this._media=t,t.context.events.on("refresh",this.refresh,this),t.context.events.on("refreshPaused",this.refreshPaused,this)}_internalStop(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.stop(0),this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null}}_onComplete(){if(this._source){this.enableTicker(!1),this._source.onended=null,this._source.disconnect();try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}}this._source=null,this._progress=1,this.emit("progress",1,this._duration),this.emit("end",this)}}class wd{constructor(t,e){this._output=e,this._input=t}get destination(){return this._input}get filters(){return this._filters}set filters(t){if(this._filters&&(this._filters.forEach(e=>{e&&e.disconnect()}),this._filters=null,this._input.connect(this._output)),t&&t.length){this._filters=t.slice(0),this._input.disconnect();let e=null;t.forEach(s=>{e===null?this._input.connect(s.destination):e.connect(s.destination),e=s}),e.connect(this._output)}}destroy(){this.filters=null,this._input=null,this._output=null}}const Td=class extends wd{constructor(i){const t=i.audioContext,e=t.createBufferSource(),s=t.createGain(),r=t.createAnalyser();e.connect(r),r.connect(s),s.connect(i.destination),super(r,s),this.context=i,this.bufferSource=e,this.gain=s,this.analyser=r}get script(){return this._script||(this._script=this.context.audioContext.createScriptProcessor(Td.BUFFER_SIZE),this._script.connect(this.context.destination)),this._script}destroy(){super.destroy(),this.bufferSource.disconnect(),this._script&&this._script.disconnect(),this.gain.disconnect(),this.analyser.disconnect(),this.bufferSource=null,this._script=null,this.gain=null,this.analyser=null,this.context=null}cloneBufferSource(){const i=this.bufferSource,t=this.context.audioContext.createBufferSource();t.buffer=i.buffer,ka.setParamValue(t.playbackRate,i.playbackRate.value),t.loop=i.loop;const e=this.context.audioContext.createGain();return t.connect(e),e.connect(this.destination),{source:t,gain:e}}get bufferSize(){return this.script.bufferSize}};let Cd=Td;Cd.BUFFER_SIZE=0;class $x{init(t){this.parent=t,this._nodes=new Cd(this.context),this._source=this._nodes.bufferSource,this.source=t.options.source}destroy(){this.parent=null,this._nodes.destroy(),this._nodes=null;try{this._source.buffer=null}catch(t){console.warn("Failed to set AudioBufferSourceNode.buffer to null:",t)}this._source=null,this.source=null}create(){return new Vx(this)}get context(){return this.parent.context}get isPlayable(){return!!this._source&&!!this._source.buffer}get filters(){return this._nodes.filters}set filters(t){this._nodes.filters=t}get duration(){return console.assert(this.isPlayable,"Sound not yet playable, no duration"),this._source.buffer.duration}get buffer(){return this._source.buffer}set buffer(t){this._source.buffer=t}get nodes(){return this._nodes}load(t){this.source?this._decode(this.source,t):this.parent.url?this._loadUrl(t):t?t(new Error("sound.url or sound.source must be set")):console.error("sound.url or sound.source must be set")}async _loadUrl(t){const e=this.parent.url,s=await V.ADAPTER.fetch(e);this._decode(await s.arrayBuffer(),t)}_decode(t,e){const s=(r,n)=>{if(r)e&&e(r);else{this.parent.isLoaded=!0,this.buffer=n;const o=this.parent.autoPlayStart();e&&e(null,this.parent,o)}};t instanceof AudioBuffer?s(null,t):this.parent.context.decode(t,s)}}var Hx=Object.defineProperty,Kl=Object.getOwnPropertySymbols,zx=Object.prototype.hasOwnProperty,Wx=Object.prototype.propertyIsEnumerable,Zl=(i,t,e)=>t in i?Hx(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Jl=(i,t)=>{for(var e in t||(t={}))zx.call(t,e)&&Zl(i,e,t[e]);if(Kl)for(var e of Kl(t))Wx.call(t,e)&&Zl(i,e,t[e]);return i};const ls=class{static from(i){let t={};typeof i=="string"?t.url=i:i instanceof ArrayBuffer||i instanceof AudioBuffer||i instanceof HTMLAudioElement?t.source=i:t=i,t=Jl({autoPlay:!1,singleInstance:!1,url:null,source:null,preload:!1,volume:1,speed:1,complete:null,loaded:null,loop:!1},t),Object.freeze(t);const e=xr().useLegacy?new Ux:new $x;return new ls(e,t)}constructor(i,t){this.media=i,this.options=t,this._instances=[],this._sprites={},this.media.init(this);const e=t.complete;this._autoPlayOptions=e?{complete:e}:null,this.isLoaded=!1,this.isPlaying=!1,this.autoPlay=t.autoPlay,this.singleInstance=t.singleInstance,this.preload=t.preload||this.autoPlay,this.url=t.url,this.speed=t.speed,this.volume=t.volume,this.loop=t.loop,t.sprites&&this.addSprites(t.sprites),this.preload&&this._preload(t.loaded)}get context(){return xr().context}pause(){return this.isPlaying=!1,this.paused=!0,this}resume(){return this.isPlaying=this._instances.length>0,this.paused=!1,this}get paused(){return this._paused}set paused(i){this._paused=i,this.refreshPaused()}get speed(){return this._speed}set speed(i){this._speed=i,this.refresh()}get filters(){return this.media.filters}set filters(i){this.media.filters=i}addSprites(i,t){if(typeof i=="object"){const s={};for(const r in i)s[r]=this.addSprites(r,i[r]);return s}console.assert(!this._sprites[i],`Alias ${i} is already taken`);const e=new Dx(this,t);return this._sprites[i]=e,e}destroy(){this._removeInstances(),this.removeSprites(),this.media.destroy(),this.media=null,this._sprites=null,this._instances=null}removeSprites(i){if(i){const t=this._sprites[i];t!==void 0&&(t.destroy(),delete this._sprites[i])}else for(const t in this._sprites)this.removeSprites(t);return this}get isPlayable(){return this.isLoaded&&this.media&&this.media.isPlayable}stop(){if(!this.isPlayable)return this.autoPlay=!1,this._autoPlayOptions=null,this;this.isPlaying=!1;for(let i=this._instances.length-1;i>=0;i--)this._instances[i].stop();return this}play(i,t){let e;if(typeof i=="string"?e={sprite:i,loop:this.loop,complete:t}:typeof i=="function"?(e={},e.complete=i):e=i,e=Jl({complete:null,loaded:null,sprite:null,end:null,start:0,volume:1,speed:1,muted:!1,loop:!1},e||{}),e.sprite){const r=e.sprite;console.assert(!!this._sprites[r],`Alias ${r} is not available`);const n=this._sprites[r];e.start=n.start+(e.start||0),e.end=n.end,e.speed=n.speed||1,e.loop=n.loop||e.loop,delete e.sprite}if(e.offset&&(e.start=e.offset),!this.isLoaded)return new Promise((r,n)=>{this.autoPlay=!0,this._autoPlayOptions=e,this._preload((o,a,h)=>{o?n(o):(e.loaded&&e.loaded(o,a,h),r(h))})});(this.singleInstance||e.singleInstance)&&this._removeInstances();const s=this._createInstance();return this._instances.push(s),this.isPlaying=!0,s.once("end",()=>{e.complete&&e.complete(this),this._onComplete(s)}),s.once("stop",()=>{this._onComplete(s)}),s.play(e),s}refresh(){const i=this._instances.length;for(let t=0;t<i;t++)this._instances[t].refresh()}refreshPaused(){const i=this._instances.length;for(let t=0;t<i;t++)this._instances[t].refreshPaused()}get volume(){return this._volume}set volume(i){this._volume=i,this.refresh()}get muted(){return this._muted}set muted(i){this._muted=i,this.refresh()}get loop(){return this._loop}set loop(i){this._loop=i,this.refresh()}_preload(i){this.media.load(i)}get instances(){return this._instances}get sprites(){return this._sprites}get duration(){return this.media.duration}autoPlayStart(){let i;return this.autoPlay&&(i=this.play(this._autoPlayOptions)),i}_removeInstances(){for(let i=this._instances.length-1;i>=0;i--)this._poolInstance(this._instances[i]);this._instances.length=0}_onComplete(i){if(this._instances){const t=this._instances.indexOf(i);t>-1&&this._instances.splice(t,1),this.isPlaying=this._instances.length>0}this._poolInstance(i)}_createInstance(){if(ls._pool.length>0){const i=ls._pool.pop();return i.init(this.media),i}return this.media.create()}_poolInstance(i){i.destroy(),ls._pool.indexOf(i)<0&&ls._pool.push(i)}};let Pn=ls;Pn._pool=[];class jx extends Ve{constructor(){super(...arguments),this.speed=1,this.muted=!1,this.volume=1,this.paused=!1}refresh(){this.emit("refresh")}refreshPaused(){this.emit("refreshPaused")}get filters(){return console.warn("HTML Audio does not support filters"),null}set filters(t){console.warn("HTML Audio does not support filters")}get audioContext(){return console.warn("HTML Audio does not support audioContext"),null}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this.paused}destroy(){this.removeAllListeners()}}class vr extends wd{constructor(){const t=window,e=new vr.AudioContext,s=e.createDynamicsCompressor(),r=e.createAnalyser();r.connect(s),s.connect(e.destination),super(r,s),this._ctx=e,this._offlineCtx=new vr.OfflineAudioContext(1,2,t.OfflineAudioContext?Math.max(8e3,Math.min(96e3,e.sampleRate)):44100),this._unlocked=!1,this.compressor=s,this.analyser=r,this.events=new Ve,this.volume=1,this.speed=1,this.muted=!1,this.paused=!1,e.state!=="running"&&(this._unlock(),this._unlock=this._unlock.bind(this),document.addEventListener("mousedown",this._unlock,!0),document.addEventListener("touchstart",this._unlock,!0),document.addEventListener("touchend",this._unlock,!0))}_unlock(){this._unlocked||(this.playEmptySound(),this._ctx.state==="running"&&(document.removeEventListener("mousedown",this._unlock,!0),document.removeEventListener("touchend",this._unlock,!0),document.removeEventListener("touchstart",this._unlock,!0),this._unlocked=!0))}playEmptySound(){const t=this._ctx.createBufferSource();t.buffer=this._ctx.createBuffer(1,1,22050),t.connect(this._ctx.destination),t.start(0,0,0),t.context.state==="suspended"&&t.context.resume()}static get AudioContext(){const t=window;return t.AudioContext||t.webkitAudioContext||null}static get OfflineAudioContext(){const t=window;return t.OfflineAudioContext||t.webkitOfflineAudioContext||null}destroy(){super.destroy();const t=this._ctx;typeof t.close<"u"&&t.close(),this.events.removeAllListeners(),this.analyser.disconnect(),this.compressor.disconnect(),this.analyser=null,this.compressor=null,this.events=null,this._offlineCtx=null,this._ctx=null}get audioContext(){return this._ctx}get offlineContext(){return this._offlineCtx}set paused(t){t&&this._ctx.state==="running"?this._ctx.suspend():!t&&this._ctx.state==="suspended"&&this._ctx.resume(),this._paused=t}get paused(){return this._paused}refresh(){this.events.emit("refresh")}refreshPaused(){this.events.emit("refreshPaused")}toggleMute(){return this.muted=!this.muted,this.refresh(),this.muted}togglePause(){return this.paused=!this.paused,this.refreshPaused(),this._paused}decode(t,e){const s=n=>{e(new Error((n==null?void 0:n.message)||"Unable to decode file"))},r=this._offlineCtx.decodeAudioData(t,n=>{e(null,n)},s);r&&r.catch(s)}}var Xx=Object.defineProperty,Ql=Object.getOwnPropertySymbols,Yx=Object.prototype.hasOwnProperty,qx=Object.prototype.propertyIsEnumerable,tc=(i,t,e)=>t in i?Xx(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,ec=(i,t)=>{for(var e in t||(t={}))Yx.call(t,e)&&tc(i,e,t[e]);if(Ql)for(var e of Ql(t))qx.call(t,e)&&tc(i,e,t[e]);return i};class Kx{constructor(){this.init()}init(){return this.supported&&(this._webAudioContext=new vr),this._htmlAudioContext=new jx,this._sounds={},this.useLegacy=!this.supported,this}get context(){return this._context}get filtersAll(){return this.useLegacy?[]:this._context.filters}set filtersAll(t){this.useLegacy||(this._context.filters=t)}get supported(){return vr.AudioContext!==null}add(t,e){if(typeof t=="object"){const n={};for(const o in t){const a=this._getOptions(t[o],e);n[o]=this.add(o,a)}return n}if(console.assert(!this._sounds[t],`Sound with alias ${t} already exists.`),e instanceof Pn)return this._sounds[t]=e,e;const s=this._getOptions(e),r=Pn.from(s);return this._sounds[t]=r,r}_getOptions(t,e){let s;return typeof t=="string"?s={url:t}:t instanceof ArrayBuffer||t instanceof AudioBuffer||t instanceof HTMLAudioElement?s={source:t}:s=t,s=ec(ec({},s),e||{}),s}get useLegacy(){return this._useLegacy}set useLegacy(t){this._useLegacy=t,this._context=!t&&this.supported?this._webAudioContext:this._htmlAudioContext}remove(t){return this.exists(t,!0),this._sounds[t].destroy(),delete this._sounds[t],this}get volumeAll(){return this._context.volume}set volumeAll(t){this._context.volume=t,this._context.refresh()}get speedAll(){return this._context.speed}set speedAll(t){this._context.speed=t,this._context.refresh()}togglePauseAll(){return this._context.togglePause()}pauseAll(){return this._context.paused=!0,this._context.refreshPaused(),this}resumeAll(){return this._context.paused=!1,this._context.refreshPaused(),this}toggleMuteAll(){return this._context.toggleMute()}muteAll(){return this._context.muted=!0,this._context.refresh(),this}unmuteAll(){return this._context.muted=!1,this._context.refresh(),this}removeAll(){for(const t in this._sounds)this._sounds[t].destroy(),delete this._sounds[t];return this}stopAll(){for(const t in this._sounds)this._sounds[t].stop();return this}exists(t,e=!1){const s=!!this._sounds[t];return e&&console.assert(s,`No sound matching alias '${t}'.`),s}find(t){return this.exists(t,!0),this._sounds[t]}play(t,e){return this.find(t).play(e)}stop(t){return this.find(t).stop()}pause(t){return this.find(t).pause()}resume(t){return this.find(t).resume()}volume(t,e){const s=this.find(t);return e!==void 0&&(s.volume=e),s.volume}speed(t,e){const s=this.find(t);return e!==void 0&&(s.speed=e),s.speed}duration(t){return this.find(t).duration}close(){return this.removeAll(),this._sounds=null,this._webAudioContext&&(this._webAudioContext.destroy(),this._webAudioContext=null),this._htmlAudioContext&&(this._htmlAudioContext.destroy(),this._htmlAudioContext=null),this._context=null,this}}var Zx=Object.defineProperty,ic=Object.getOwnPropertySymbols,Jx=Object.prototype.hasOwnProperty,Qx=Object.prototype.propertyIsEnumerable,sc=(i,t,e)=>t in i?Zx(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,tv=(i,t)=>{for(var e in t||(t={}))Jx.call(t,e)&&sc(i,e,t[e]);if(ic)for(var e of ic(t))Qx.call(t,e)&&sc(i,e,t[e]);return i};const Sd=["mp3","ogg","oga","opus","mpeg","wav","m4a","aiff","wma","mid","caf"],Ba={};function ev(i){const t=tv({m4a:"audio/mp4",oga:"audio/ogg",opus:'audio/ogg; codecs="opus"',caf:'audio/x-caf; codecs="opus"'},i||{}),e=document.createElement("audio"),s={},r=/^no$/;Sd.forEach(n=>{const o=e.canPlayType(`audio/${n}`).replace(r,""),a=t[n]?e.canPlayType(t[n]).replace(r,""):"";s[n]=!!o||!!a}),Object.assign(Ba,s)}ev();var iv=Object.defineProperty,sv=Object.defineProperties,rv=Object.getOwnPropertyDescriptors,rc=Object.getOwnPropertySymbols,nv=Object.prototype.hasOwnProperty,ov=Object.prototype.propertyIsEnumerable,nc=(i,t,e)=>t in i?iv(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,av=(i,t)=>{for(var e in t||(t={}))nv.call(t,e)&&nc(i,e,t[e]);if(rc)for(var e of rc(t))ov.call(t,e)&&nc(i,e,t[e]);return i},hv=(i,t)=>sv(i,rv(t));const oc=i=>{var t,e;const s=i.src;return(e=(t=i==null?void 0:i.alias)==null?void 0:t[0])!=null?e:Xt.basename(s,Xt.extname(s))},lv={extension:B.Asset,detection:{test:async()=>!0,add:async i=>[...i,...Sd.filter(t=>Ba[t])],remove:async i=>i.filter(t=>i.includes(t))},loader:{extension:{type:[B.LoadParser],priority:Zi.High},test(i){const t=Xt.extname(i).slice(1);return!!Ba[t]},async load(i,t){const e=await new Promise((s,r)=>Pn.from(hv(av({},t.data),{url:i,preload:!0,loaded(n,o){var a,h;n?r(n):s(o),(h=(a=t.data)==null?void 0:a.loaded)==null||h.call(a,n,o)}})));return xr().add(oc(t),e),e},async unload(i,t){xr().remove(oc(t))}}};D.add(lv);const rs=Fx(new Kx);function qe(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function Ad(i,t){i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.__proto__=t}/*!
 * GSAP 3.11.4
 * https://greensock.com
 *
 * @license Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var ee={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Is={duration:.5,overwrite:!1,delay:0},uh,Ot,bt,de=1e8,st=1/de,La=Math.PI*2,cv=La/4,uv=0,Ed=Math.sqrt,dv=Math.cos,fv=Math.sin,At=function(t){return typeof t=="string"},ft=function(t){return typeof t=="function"},ii=function(t){return typeof t=="number"},dh=function(t){return typeof t>"u"},$e=function(t){return typeof t=="object"},Ht=function(t){return t!==!1},Pd=function(){return typeof window<"u"},sn=function(t){return ft(t)||At(t)},Id=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},Ft=Array.isArray,Oa=/(?:-?\.?\d|\.)+/gi,Md=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,ms=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Wo=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Rd=/[+-]=-?[.\d]+/,kd=/[^,'"\[\]\s]+/gi,pv=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,ct,le,Fa,fh,ne={},In={},Bd,Ld=function(t){return(In=Yi(t,ne))&&oe},ph=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},Mn=function(t,e){return!e&&console.warn(t)},Od=function(t,e){return t&&(ne[t]=e)&&In&&(In[t]=e)||ne},wr=function(){return 0},_v={suppressEvents:!0,isStart:!0,kill:!1},dn={suppressEvents:!0,kill:!1},mv={suppressEvents:!0},_h={},di=[],Na={},Fd,Zt={},jo={},ac=30,fn=[],mh="",gh=function(t){var e=t[0],s,r;if($e(e)||ft(e)||(t=[t]),!(s=(e._gsap||{}).harness)){for(r=fn.length;r--&&!fn[r].targetTest(e););s=fn[r]}for(r=t.length;r--;)t[r]&&(t[r]._gsap||(t[r]._gsap=new nf(t[r],s)))||t.splice(r,1);return t},Di=function(t){return t._gsap||gh(fe(t))[0]._gsap},Nd=function(t,e,s){return(s=t[e])&&ft(s)?t[e]():dh(s)&&t.getAttribute&&t.getAttribute(e)||s},zt=function(t,e){return(t=t.split(",")).forEach(e)||t},_t=function(t){return Math.round(t*1e5)/1e5||0},It=function(t){return Math.round(t*1e7)/1e7||0},ws=function(t,e){var s=e.charAt(0),r=parseFloat(e.substr(2));return t=parseFloat(t),s==="+"?t+r:s==="-"?t-r:s==="*"?t*r:t/r},gv=function(t,e){for(var s=e.length,r=0;t.indexOf(e[r])<0&&++r<s;);return r<s},Rn=function(){var t=di.length,e=di.slice(0),s,r;for(Na={},di.length=0,s=0;s<t;s++)r=e[s],r&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},Ud=function(t,e,s,r){di.length&&!Ot&&Rn(),t.render(e,s,r||Ot&&e<0&&(t._initted||t._startAt)),di.length&&!Ot&&Rn()},Dd=function(t){var e=parseFloat(t);return(e||e===0)&&(t+"").match(kd).length<2?e:At(t)?t.trim():t},Gd=function(t){return t},_e=function(t,e){for(var s in e)s in t||(t[s]=e[s]);return t},yv=function(t){return function(e,s){for(var r in s)r in e||r==="duration"&&t||r==="ease"||(e[r]=s[r])}},Yi=function(t,e){for(var s in e)t[s]=e[s];return t},hc=function i(t,e){for(var s in e)s!=="__proto__"&&s!=="constructor"&&s!=="prototype"&&(t[s]=$e(e[s])?i(t[s]||(t[s]={}),e[s]):e[s]);return t},kn=function(t,e){var s={},r;for(r in t)r in e||(s[r]=t[r]);return s},sr=function(t){var e=t.parent||ct,s=t.keyframes?yv(Ft(t.keyframes)):_e;if(Ht(t.inherit))for(;e;)s(t,e.vars.defaults),e=e.parent||e._dp;return t},bv=function(t,e){for(var s=t.length,r=s===e.length;r&&s--&&t[s]===e[s];);return s<0},Vd=function(t,e,s,r,n){s===void 0&&(s="_first"),r===void 0&&(r="_last");var o=t[r],a;if(n)for(a=e[n];o&&o[n]>a;)o=o._prev;return o?(e._next=o._next,o._next=e):(e._next=t[s],t[s]=e),e._next?e._next._prev=e:t[r]=e,e._prev=o,e.parent=e._dp=t,e},Xn=function(t,e,s,r){s===void 0&&(s="_first"),r===void 0&&(r="_last");var n=e._prev,o=e._next;n?n._next=o:t[s]===e&&(t[s]=o),o?o._prev=n:t[r]===e&&(t[r]=n),e._next=e._prev=e.parent=null},_i=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove(t),t._act=0},Gi=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var s=t;s;)s._dirty=1,s=s.parent;return t},xv=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},Ua=function(t,e,s,r){return t._startAt&&(Ot?t._startAt.revert(dn):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,r))},vv=function i(t){return!t||t._ts&&i(t.parent)},lc=function(t){return t._repeat?Ms(t._tTime,t=t.duration()+t._rDelay)*t:0},Ms=function(t,e){var s=Math.floor(t/=e);return t&&s===t?s-1:s},Bn=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},Yn=function(t){return t._end=It(t._start+(t._tDur/Math.abs(t._ts||t._rts||st)||0))},qn=function(t,e){var s=t._dp;return s&&s.smoothChildTiming&&t._ts&&(t._start=It(s._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),Yn(t),s._dirty||Gi(s,t)),t},$d=function(t,e){var s;if((e._time||e._initted&&!e._dur)&&(s=Bn(t.rawTime(),e),(!e._dur||Or(0,e.totalDuration(),s)-e._tTime>st)&&e.render(s,!0)),Gi(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(s=t;s._dp;)s.rawTime()>=0&&s.totalTime(s._tTime),s=s._dp;t._zTime=-st}},Le=function(t,e,s,r){return e.parent&&_i(e),e._start=It((ii(s)?s:s||t!==ct?he(t,s,e):t._time)+e._delay),e._end=It(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),Vd(t,e,"_first","_last",t._sort?"_start":0),Da(e)||(t._recent=e),r||$d(t,e),t._ts<0&&qn(t,t._tTime),t},Hd=function(t,e){return(ne.ScrollTrigger||ph("scrollTrigger",e))&&ne.ScrollTrigger.create(e,t)},zd=function(t,e,s,r,n){if(bh(t,e,n),!t._initted)return 1;if(!s&&t._pt&&!Ot&&(t._dur&&t.vars.lazy!==!1||!t._dur&&t.vars.lazy)&&Fd!==Qt.frame)return di.push(t),t._lazy=[n,r],1},wv=function i(t){var e=t.parent;return e&&e._ts&&e._initted&&!e._lock&&(e.rawTime()<0||i(e))},Da=function(t){var e=t.data;return e==="isFromStart"||e==="isStart"},Tv=function(t,e,s,r){var n=t.ratio,o=e<0||!e&&(!t._start&&wv(t)&&!(!t._initted&&Da(t))||(t._ts<0||t._dp._ts<0)&&!Da(t))?0:1,a=t._rDelay,h=0,l,c,u;if(a&&t._repeat&&(h=Or(0,t._tDur,e),c=Ms(h,a),t._yoyo&&c&1&&(o=1-o),c!==Ms(t._tTime,a)&&(n=1-o,t.vars.repeatRefresh&&t._initted&&t.invalidate())),o!==n||Ot||r||t._zTime===st||!e&&t._zTime){if(!t._initted&&zd(t,e,r,s,h))return;for(u=t._zTime,t._zTime=e||(s?st:0),s||(s=e&&!u),t.ratio=o,t._from&&(o=1-o),t._time=0,t._tTime=h,l=t._pt;l;)l.r(o,l.d),l=l._next;e<0&&Ua(t,e,s,!0),t._onUpdate&&!s&&pe(t,"onUpdate"),h&&t._repeat&&!s&&t.parent&&pe(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===o&&(o&&_i(t,1),!s&&!Ot&&(pe(t,o?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)},Cv=function(t,e,s){var r;if(s>e)for(r=t._first;r&&r._start<=s;){if(r.data==="isPause"&&r._start>e)return r;r=r._next}else for(r=t._last;r&&r._start>=s;){if(r.data==="isPause"&&r._start<e)return r;r=r._prev}},Rs=function(t,e,s,r){var n=t._repeat,o=It(e)||0,a=t._tTime/t._tDur;return a&&!r&&(t._time*=o/t._dur),t._dur=o,t._tDur=n?n<0?1e10:It(o*(n+1)+t._rDelay*n):o,a>0&&!r&&qn(t,t._tTime=t._tDur*a),t.parent&&Yn(t),s||Gi(t.parent,t),t},cc=function(t){return t instanceof Vt?Gi(t):Rs(t,t._dur)},Sv={_start:0,endTime:wr,totalDuration:wr},he=function i(t,e,s){var r=t.labels,n=t._recent||Sv,o=t.duration()>=de?n.endTime(!1):t._dur,a,h,l;return At(e)&&(isNaN(e)||e in r)?(h=e.charAt(0),l=e.substr(-1)==="%",a=e.indexOf("="),h==="<"||h===">"?(a>=0&&(e=e.replace(/=/,"")),(h==="<"?n._start:n.endTime(n._repeat>=0))+(parseFloat(e.substr(1))||0)*(l?(a<0?n:s).totalDuration()/100:1)):a<0?(e in r||(r[e]=o),r[e]):(h=parseFloat(e.charAt(a-1)+e.substr(a+1)),l&&s&&(h=h/100*(Ft(s)?s[0]:s).totalDuration()),a>1?i(t,e.substr(0,a-1),s)+h:o+h)):e==null?o:+e},rr=function(t,e,s){var r=ii(e[1]),n=(r?2:1)+(t<2?0:1),o=e[n],a,h;if(r&&(o.duration=e[1]),o.parent=s,t){for(a=o,h=s;h&&!("immediateRender"in a);)a=h.vars.defaults||{},h=Ht(h.vars.inherit)&&h.parent;o.immediateRender=Ht(a.immediateRender),t<2?o.runBackwards=1:o.startAt=e[n-1]}return new wt(e[0],o,e[n+1])},xi=function(t,e){return t||t===0?e(t):e},Or=function(t,e,s){return s<t?t:s>e?e:s},Bt=function(t,e){return!At(t)||!(e=pv.exec(t))?"":e[1]},Av=function(t,e,s){return xi(s,function(r){return Or(t,e,r)})},Ga=[].slice,Wd=function(t,e){return t&&$e(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&$e(t[0]))&&!t.nodeType&&t!==le},Ev=function(t,e,s){return s===void 0&&(s=[]),t.forEach(function(r){var n;return At(r)&&!e||Wd(r,1)?(n=s).push.apply(n,fe(r)):s.push(r)})||s},fe=function(t,e,s){return bt&&!e&&bt.selector?bt.selector(t):At(t)&&!s&&(Fa||!ks())?Ga.call((e||fh).querySelectorAll(t),0):Ft(t)?Ev(t,s):Wd(t)?Ga.call(t,0):t?[t]:[]},Va=function(t){return t=fe(t)[0]||Mn("Invalid scope")||{},function(e){var s=t.current||t.nativeElement||t;return fe(e,s.querySelectorAll?s:s===t?Mn("Invalid scope")||fh.createElement("div"):t)}},jd=function(t){return t.sort(function(){return .5-Math.random()})},Xd=function(t){if(ft(t))return t;var e=$e(t)?t:{each:t},s=Vi(e.ease),r=e.from||0,n=parseFloat(e.base)||0,o={},a=r>0&&r<1,h=isNaN(r)||a,l=e.axis,c=r,u=r;return At(r)?c=u={center:.5,edges:.5,end:1}[r]||0:!a&&h&&(c=r[0],u=r[1]),function(d,f,_){var m=(_||e).length,p=o[m],x,y,b,v,w,C,A,T,S;if(!p){if(S=e.grid==="auto"?0:(e.grid||[1,de])[1],!S){for(A=-de;A<(A=_[S++].getBoundingClientRect().left)&&S<m;);S--}for(p=o[m]=[],x=h?Math.min(S,m)*c-.5:r%S,y=S===de?0:h?m*u/S-.5:r/S|0,A=0,T=de,C=0;C<m;C++)b=C%S-x,v=y-(C/S|0),p[C]=w=l?Math.abs(l==="y"?v:b):Ed(b*b+v*v),w>A&&(A=w),w<T&&(T=w);r==="random"&&jd(p),p.max=A-T,p.min=T,p.v=m=(parseFloat(e.amount)||parseFloat(e.each)*(S>m?m-1:l?l==="y"?m/S:S:Math.max(S,m/S))||0)*(r==="edges"?-1:1),p.b=m<0?n-m:n,p.u=Bt(e.amount||e.each)||0,s=s&&m<0?ef(s):s}return m=(p[d]-p.min)/p.max||0,It(p.b+(s?s(m):m)*p.v)+p.u}},$a=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(s){var r=It(Math.round(parseFloat(s)/t)*t*e);return(r-r%1)/e+(ii(s)?0:Bt(s))}},Yd=function(t,e){var s=Ft(t),r,n;return!s&&$e(t)&&(r=s=t.radius||de,t.values?(t=fe(t.values),(n=!ii(t[0]))&&(r*=r)):t=$a(t.increment)),xi(e,s?ft(t)?function(o){return n=t(o),Math.abs(n-o)<=r?n:o}:function(o){for(var a=parseFloat(n?o.x:o),h=parseFloat(n?o.y:0),l=de,c=0,u=t.length,d,f;u--;)n?(d=t[u].x-a,f=t[u].y-h,d=d*d+f*f):d=Math.abs(t[u]-a),d<l&&(l=d,c=u);return c=!r||l<=r?t[c]:o,n||c===o||ii(o)?c:c+Bt(o)}:$a(t))},qd=function(t,e,s,r){return xi(Ft(t)?!e:s===!0?!!(s=0):!r,function(){return Ft(t)?t[~~(Math.random()*t.length)]:(s=s||1e-5)&&(r=s<1?Math.pow(10,(s+"").length-2):1)&&Math.floor(Math.round((t-s/2+Math.random()*(e-t+s*.99))/s)*s*r)/r})},Pv=function(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return function(r){return e.reduce(function(n,o){return o(n)},r)}},Iv=function(t,e){return function(s){return t(parseFloat(s))+(e||Bt(s))}},Mv=function(t,e,s){return Zd(t,e,0,1,s)},Kd=function(t,e,s){return xi(s,function(r){return t[~~e(r)]})},Rv=function i(t,e,s){var r=e-t;return Ft(t)?Kd(t,i(0,t.length),e):xi(s,function(n){return(r+(n-t)%r)%r+t})},kv=function i(t,e,s){var r=e-t,n=r*2;return Ft(t)?Kd(t,i(0,t.length-1),e):xi(s,function(o){return o=(n+(o-t)%n)%n||0,t+(o>r?n-o:o)})},Tr=function(t){for(var e=0,s="",r,n,o,a;~(r=t.indexOf("random(",e));)o=t.indexOf(")",r),a=t.charAt(r+7)==="[",n=t.substr(r+7,o-r-7).match(a?kd:Oa),s+=t.substr(e,r-e)+qd(a?n:+n[0],a?0:+n[1],+n[2]||1e-5),e=o+1;return s+t.substr(e,t.length-e)},Zd=function(t,e,s,r,n){var o=e-t,a=r-s;return xi(n,function(h){return s+((h-t)/o*a||0)})},Bv=function i(t,e,s,r){var n=isNaN(t+e)?0:function(f){return(1-f)*t+f*e};if(!n){var o=At(t),a={},h,l,c,u,d;if(s===!0&&(r=1)&&(s=null),o)t={p:t},e={p:e};else if(Ft(t)&&!Ft(e)){for(c=[],u=t.length,d=u-2,l=1;l<u;l++)c.push(i(t[l-1],t[l]));u--,n=function(_){_*=u;var m=Math.min(d,~~_);return c[m](_-m)},s=e}else r||(t=Yi(Ft(t)?[]:{},t));if(!c){for(h in e)yh.call(a,t,h,"get",e[h]);n=function(_){return wh(_,a)||(o?t.p:t)}}}return xi(s,n)},uc=function(t,e,s){var r=t.labels,n=de,o,a,h;for(o in r)a=r[o]-e,a<0==!!s&&a&&n>(a=Math.abs(a))&&(h=o,n=a);return h},pe=function(t,e,s){var r=t.vars,n=r[e],o=bt,a=t._ctx,h,l,c;if(n)return h=r[e+"Params"],l=r.callbackScope||t,s&&di.length&&Rn(),a&&(bt=a),c=h?n.apply(l,h):n.call(l),bt=o,c},Js=function(t){return _i(t),t.scrollTrigger&&t.scrollTrigger.kill(!!Ot),t.progress()<1&&pe(t,"onInterrupt"),t},gs,Lv=function(t){t=!t.name&&t.default||t;var e=t.name,s=ft(t),r=e&&!s&&t.init?function(){this._props=[]}:t,n={init:wr,render:wh,add:yh,kill:Kv,modifier:qv,rawVars:0},o={targetTest:0,get:0,getSetter:vh,aliases:{},register:0};if(ks(),t!==r){if(Zt[e])return;_e(r,_e(kn(t,n),o)),Yi(r.prototype,Yi(n,kn(t,o))),Zt[r.prop=e]=r,t.targetTest&&(fn.push(r),_h[e]=1),e=(e==="css"?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}Od(e,r),t.register&&t.register(oe,r,Wt)},it=255,Qs={aqua:[0,it,it],lime:[0,it,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,it],navy:[0,0,128],white:[it,it,it],olive:[128,128,0],yellow:[it,it,0],orange:[it,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[it,0,0],pink:[it,192,203],cyan:[0,it,it],transparent:[it,it,it,0]},Xo=function(t,e,s){return t+=t<0?1:t>1?-1:0,(t*6<1?e+(s-e)*t*6:t<.5?s:t*3<2?e+(s-e)*(2/3-t)*6:e)*it+.5|0},Jd=function(t,e,s){var r=t?ii(t)?[t>>16,t>>8&it,t&it]:0:Qs.black,n,o,a,h,l,c,u,d,f,_;if(!r){if(t.substr(-1)===","&&(t=t.substr(0,t.length-1)),Qs[t])r=Qs[t];else if(t.charAt(0)==="#"){if(t.length<6&&(n=t.charAt(1),o=t.charAt(2),a=t.charAt(3),t="#"+n+n+o+o+a+a+(t.length===5?t.charAt(4)+t.charAt(4):"")),t.length===9)return r=parseInt(t.substr(1,6),16),[r>>16,r>>8&it,r&it,parseInt(t.substr(7),16)/255];t=parseInt(t.substr(1),16),r=[t>>16,t>>8&it,t&it]}else if(t.substr(0,3)==="hsl"){if(r=_=t.match(Oa),!e)h=+r[0]%360/360,l=+r[1]/100,c=+r[2]/100,o=c<=.5?c*(l+1):c+l-c*l,n=c*2-o,r.length>3&&(r[3]*=1),r[0]=Xo(h+1/3,n,o),r[1]=Xo(h,n,o),r[2]=Xo(h-1/3,n,o);else if(~t.indexOf("="))return r=t.match(Md),s&&r.length<4&&(r[3]=1),r}else r=t.match(Oa)||Qs.transparent;r=r.map(Number)}return e&&!_&&(n=r[0]/it,o=r[1]/it,a=r[2]/it,u=Math.max(n,o,a),d=Math.min(n,o,a),c=(u+d)/2,u===d?h=l=0:(f=u-d,l=c>.5?f/(2-u-d):f/(u+d),h=u===n?(o-a)/f+(o<a?6:0):u===o?(a-n)/f+2:(n-o)/f+4,h*=60),r[0]=~~(h+.5),r[1]=~~(l*100+.5),r[2]=~~(c*100+.5)),s&&r.length<4&&(r[3]=1),r},Qd=function(t){var e=[],s=[],r=-1;return t.split(fi).forEach(function(n){var o=n.match(ms)||[];e.push.apply(e,o),s.push(r+=o.length+1)}),e.c=s,e},dc=function(t,e,s){var r="",n=(t+r).match(fi),o=e?"hsla(":"rgba(",a=0,h,l,c,u;if(!n)return t;if(n=n.map(function(d){return(d=Jd(d,e,1))&&o+(e?d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:d.join(","))+")"}),s&&(c=Qd(t),h=s.c,h.join(r)!==c.c.join(r)))for(l=t.replace(fi,"1").split(ms),u=l.length-1;a<u;a++)r+=l[a]+(~h.indexOf(a)?n.shift()||o+"0,0,0,0)":(c.length?c:n.length?n:s).shift());if(!l)for(l=t.split(fi),u=l.length-1;a<u;a++)r+=l[a]+n[a];return r+l[u]},fi=function(){var i="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in Qs)i+="|"+t+"\\b";return new RegExp(i+")","gi")}(),Ov=/hsl[a]?\(/,tf=function(t){var e=t.join(" "),s;if(fi.lastIndex=0,fi.test(e))return s=Ov.test(e),t[1]=dc(t[1],s),t[0]=dc(t[0],s,Qd(t[1])),!0},Cr,Qt=function(){var i=Date.now,t=500,e=33,s=i(),r=s,n=1e3/240,o=n,a=[],h,l,c,u,d,f,_=function m(p){var x=i()-r,y=p===!0,b,v,w,C;if(x>t&&(s+=x-e),r+=x,w=r-s,b=w-o,(b>0||y)&&(C=++u.frame,d=w-u.time*1e3,u.time=w=w/1e3,o+=b+(b>=n?4:n-b),v=1),y||(h=l(m)),v)for(f=0;f<a.length;f++)a[f](w,d,C,p)};return u={time:0,frame:0,tick:function(){_(!0)},deltaRatio:function(p){return d/(1e3/(p||60))},wake:function(){Bd&&(!Fa&&Pd()&&(le=Fa=window,fh=le.document||{},ne.gsap=oe,(le.gsapVersions||(le.gsapVersions=[])).push(oe.version),Ld(In||le.GreenSockGlobals||!le.gsap&&le||{}),c=le.requestAnimationFrame),h&&u.sleep(),l=c||function(p){return setTimeout(p,o-u.time*1e3+1|0)},Cr=1,_(2))},sleep:function(){(c?le.cancelAnimationFrame:clearTimeout)(h),Cr=0,l=wr},lagSmoothing:function(p,x){t=p||1/0,e=Math.min(x||33,t)},fps:function(p){n=1e3/(p||240),o=u.time*1e3+n},add:function(p,x,y){var b=x?function(v,w,C,A){p(v,w,C,A),u.remove(b)}:p;return u.remove(p),a[y?"unshift":"push"](b),ks(),b},remove:function(p,x){~(x=a.indexOf(p))&&a.splice(x,1)&&f>=x&&f--},_listeners:a},u}(),ks=function(){return!Cr&&Qt.wake()},z={},Fv=/^[\d.\-M][\d.\-,\s]/,Nv=/["']/g,Uv=function(t){for(var e={},s=t.substr(1,t.length-3).split(":"),r=s[0],n=1,o=s.length,a,h,l;n<o;n++)h=s[n],a=n!==o-1?h.lastIndexOf(","):h.length,l=h.substr(0,a),e[r]=isNaN(l)?l.replace(Nv,"").trim():+l,r=h.substr(a+1).trim();return e},Dv=function(t){var e=t.indexOf("(")+1,s=t.indexOf(")"),r=t.indexOf("(",e);return t.substring(e,~r&&r<s?t.indexOf(")",s+1):s)},Gv=function(t){var e=(t+"").split("("),s=z[e[0]];return s&&e.length>1&&s.config?s.config.apply(null,~t.indexOf("{")?[Uv(e[1])]:Dv(t).split(",").map(Dd)):z._CE&&Fv.test(t)?z._CE("",t):s},ef=function(t){return function(e){return 1-t(1-e)}},sf=function i(t,e){for(var s=t._first,r;s;)s instanceof Vt?i(s,e):s.vars.yoyoEase&&(!s._yoyo||!s._repeat)&&s._yoyo!==e&&(s.timeline?i(s.timeline,e):(r=s._ease,s._ease=s._yEase,s._yEase=r,s._yoyo=e)),s=s._next},Vi=function(t,e){return t&&(ft(t)?t:z[t]||Gv(t))||e},Ji=function(t,e,s,r){s===void 0&&(s=function(h){return 1-e(1-h)}),r===void 0&&(r=function(h){return h<.5?e(h*2)/2:1-e((1-h)*2)/2});var n={easeIn:e,easeOut:s,easeInOut:r},o;return zt(t,function(a){z[a]=ne[a]=n,z[o=a.toLowerCase()]=s;for(var h in n)z[o+(h==="easeIn"?".in":h==="easeOut"?".out":".inOut")]=z[a+"."+h]=n[h]}),n},rf=function(t){return function(e){return e<.5?(1-t(1-e*2))/2:.5+t((e-.5)*2)/2}},Yo=function i(t,e,s){var r=e>=1?e:1,n=(s||(t?.3:.45))/(e<1?e:1),o=n/La*(Math.asin(1/r)||0),a=function(c){return c===1?1:r*Math.pow(2,-10*c)*fv((c-o)*n)+1},h=t==="out"?a:t==="in"?function(l){return 1-a(1-l)}:rf(a);return n=La/n,h.config=function(l,c){return i(t,l,c)},h},qo=function i(t,e){e===void 0&&(e=1.70158);var s=function(o){return o?--o*o*((e+1)*o+e)+1:0},r=t==="out"?s:t==="in"?function(n){return 1-s(1-n)}:rf(s);return r.config=function(n){return i(t,n)},r};zt("Linear,Quad,Cubic,Quart,Quint,Strong",function(i,t){var e=t<5?t+1:t;Ji(i+",Power"+(e-1),t?function(s){return Math.pow(s,e)}:function(s){return s},function(s){return 1-Math.pow(1-s,e)},function(s){return s<.5?Math.pow(s*2,e)/2:1-Math.pow((1-s)*2,e)/2})});z.Linear.easeNone=z.none=z.Linear.easeIn;Ji("Elastic",Yo("in"),Yo("out"),Yo());(function(i,t){var e=1/t,s=2*e,r=2.5*e,n=function(a){return a<e?i*a*a:a<s?i*Math.pow(a-1.5/t,2)+.75:a<r?i*(a-=2.25/t)*a+.9375:i*Math.pow(a-2.625/t,2)+.984375};Ji("Bounce",function(o){return 1-n(1-o)},n)})(7.5625,2.75);Ji("Expo",function(i){return i?Math.pow(2,10*(i-1)):0});Ji("Circ",function(i){return-(Ed(1-i*i)-1)});Ji("Sine",function(i){return i===1?1:-dv(i*cv)+1});Ji("Back",qo("in"),qo("out"),qo());z.SteppedEase=z.steps=ne.SteppedEase={config:function(t,e){t===void 0&&(t=1);var s=1/t,r=t+(e?0:1),n=e?1:0,o=1-st;return function(a){return((r*Or(0,o,a)|0)+n)*s}}};Is.ease=z["quad.out"];zt("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(i){return mh+=i+","+i+"Params,"});var nf=function(t,e){this.id=uv++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:Nd,this.set=e?e.getSetter:vh},Bs=function(){function i(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,Rs(this,+e.duration,1,1),this.data=e.data,bt&&(this._ctx=bt,bt.data.push(this)),Cr||Qt.wake()}var t=i.prototype;return t.delay=function(s){return s||s===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+s-this._delay),this._delay=s,this):this._delay},t.duration=function(s){return arguments.length?this.totalDuration(this._repeat>0?s+(s+this._rDelay)*this._repeat:s):this.totalDuration()&&this._dur},t.totalDuration=function(s){return arguments.length?(this._dirty=0,Rs(this,this._repeat<0?s:(s-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(s,r){if(ks(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(qn(this,s),!n._dp||n.parent||$d(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&s<this._tDur||this._ts<0&&s>0||!this._tDur&&!s)&&Le(this._dp,this,this._start-this._delay)}return(this._tTime!==s||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===st||!s&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=s),Ud(this,s,r)),this},t.time=function(s,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),s+lc(this))%(this._dur+this._rDelay)||(s?this._dur:0),r):this._time},t.totalProgress=function(s,r){return arguments.length?this.totalTime(this.totalDuration()*s,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},t.progress=function(s,r){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-s:s)+lc(this),r):this.duration()?Math.min(1,this._time/this._dur):this.ratio},t.iteration=function(s,r){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(s-1)*n,r):this._repeat?Ms(this._tTime,n)+1:1},t.timeScale=function(s){if(!arguments.length)return this._rts===-st?0:this._rts;if(this._rts===s)return this;var r=this.parent&&this._ts?Bn(this.parent._time,this):this._tTime;return this._rts=+s||0,this._ts=this._ps||s===-st?0:this._rts,this.totalTime(Or(-this._delay,this._tDur,r),!0),Yn(this),xv(this)},t.paused=function(s){return arguments.length?(this._ps!==s&&(this._ps=s,s?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(ks(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==st&&(this._tTime-=st)))),this):this._ps},t.startTime=function(s){if(arguments.length){this._start=s;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&Le(r,this,s-this._delay),this}return this._start},t.endTime=function(s){return this._start+(Ht(s)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(s){var r=this.parent||this._dp;return r?s&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Bn(r.rawTime(s),this):this._tTime:this._tTime},t.revert=function(s){s===void 0&&(s=mv);var r=Ot;return Ot=s,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(s),this.totalTime(-.01,s.suppressEvents)),this.data!=="nested"&&s.kill!==!1&&this.kill(),Ot=r,this},t.globalTime=function(s){for(var r=this,n=arguments.length?s:r.rawTime();r;)n=r._start+n/(r._ts||1),r=r._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1:this._sat.globalTime(s):n},t.repeat=function(s){return arguments.length?(this._repeat=s===1/0?-2:s,cc(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(s){if(arguments.length){var r=this._time;return this._rDelay=s,cc(this),r?this.time(r):this}return this._rDelay},t.yoyo=function(s){return arguments.length?(this._yoyo=s,this):this._yoyo},t.seek=function(s,r){return this.totalTime(he(this,s),Ht(r))},t.restart=function(s,r){return this.play().totalTime(s?-this._delay:0,Ht(r))},t.play=function(s,r){return s!=null&&this.seek(s,r),this.reversed(!1).paused(!1)},t.reverse=function(s,r){return s!=null&&this.seek(s||this.totalDuration(),r),this.reversed(!0).paused(!1)},t.pause=function(s,r){return s!=null&&this.seek(s,r),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(s){return arguments.length?(!!s!==this.reversed()&&this.timeScale(-this._rts||(s?-st:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-st,this},t.isActive=function(){var s=this.parent||this._dp,r=this._start,n;return!!(!s||this._ts&&this._initted&&s.isActive()&&(n=s.rawTime(!0))>=r&&n<this.endTime(!0)-st)},t.eventCallback=function(s,r,n){var o=this.vars;return arguments.length>1?(r?(o[s]=r,n&&(o[s+"Params"]=n),s==="onUpdate"&&(this._onUpdate=r)):delete o[s],this):o[s]},t.then=function(s){var r=this;return new Promise(function(n){var o=ft(s)?s:Gd,a=function(){var l=r.then;r.then=null,ft(o)&&(o=o(r))&&(o.then||o===r)&&(r.then=l),n(o),r.then=l};r._initted&&r.totalProgress()===1&&r._ts>=0||!r._tTime&&r._ts<0?a():r._prom=a})},t.kill=function(){Js(this)},i}();_e(Bs.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-st,_prom:0,_ps:!1,_rts:1});var Vt=function(i){Ad(t,i);function t(s,r){var n;return s===void 0&&(s={}),n=i.call(this,s)||this,n.labels={},n.smoothChildTiming=!!s.smoothChildTiming,n.autoRemoveChildren=!!s.autoRemoveChildren,n._sort=Ht(s.sortChildren),ct&&Le(s.parent||ct,qe(n),r),s.reversed&&n.reverse(),s.paused&&n.paused(!0),s.scrollTrigger&&Hd(qe(n),s.scrollTrigger),n}var e=t.prototype;return e.to=function(r,n,o){return rr(0,arguments,this),this},e.from=function(r,n,o){return rr(1,arguments,this),this},e.fromTo=function(r,n,o,a){return rr(2,arguments,this),this},e.set=function(r,n,o){return n.duration=0,n.parent=this,sr(n).repeatDelay||(n.repeat=0),n.immediateRender=!!n.immediateRender,new wt(r,n,he(this,o),1),this},e.call=function(r,n,o){return Le(this,wt.delayedCall(0,r,n),o)},e.staggerTo=function(r,n,o,a,h,l,c){return o.duration=n,o.stagger=o.stagger||a,o.onComplete=l,o.onCompleteParams=c,o.parent=this,new wt(r,o,he(this,h)),this},e.staggerFrom=function(r,n,o,a,h,l,c){return o.runBackwards=1,sr(o).immediateRender=Ht(o.immediateRender),this.staggerTo(r,n,o,a,h,l,c)},e.staggerFromTo=function(r,n,o,a,h,l,c,u){return a.startAt=o,sr(a).immediateRender=Ht(a.immediateRender),this.staggerTo(r,n,a,h,l,c,u)},e.render=function(r,n,o){var a=this._time,h=this._dirty?this.totalDuration():this._tDur,l=this._dur,c=r<=0?0:It(r),u=this._zTime<0!=r<0&&(this._initted||!l),d,f,_,m,p,x,y,b,v,w,C,A;if(this!==ct&&c>h&&r>=0&&(c=h),c!==this._tTime||o||u){if(a!==this._time&&l&&(c+=this._time-a,r+=this._time-a),d=c,v=this._start,b=this._ts,x=!b,u&&(l||(a=this._zTime),(r||!n)&&(this._zTime=r)),this._repeat){if(C=this._yoyo,p=l+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(p*100+r,n,o);if(d=It(c%p),c===h?(m=this._repeat,d=l):(m=~~(c/p),m&&m===c/p&&(d=l,m--),d>l&&(d=l)),w=Ms(this._tTime,p),!a&&this._tTime&&w!==m&&(w=m),C&&m&1&&(d=l-d,A=1),m!==w&&!this._lock){var T=C&&w&1,S=T===(C&&m&1);if(m<w&&(T=!T),a=T?0:l,this._lock=1,this.render(a||(A?0:It(m*p)),n,!l)._lock=0,this._tTime=c,!n&&this.parent&&pe(this,"onRepeat"),this.vars.repeatRefresh&&!A&&(this.invalidate()._lock=1),a&&a!==this._time||x!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(l=this._dur,h=this._tDur,S&&(this._lock=2,a=T?l:-1e-4,this.render(a,!0),this.vars.repeatRefresh&&!A&&this.invalidate()),this._lock=0,!this._ts&&!x)return this;sf(this,A)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(y=Cv(this,It(a),It(d)),y&&(c-=d-(d=y._start))),this._tTime=c,this._time=d,this._act=!b,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,a=0),!a&&d&&!n&&(pe(this,"onStart"),this._tTime!==c))return this;if(d>=a&&r>=0)for(f=this._first;f;){if(_=f._next,(f._act||d>=f._start)&&f._ts&&y!==f){if(f.parent!==this)return this.render(r,n,o);if(f.render(f._ts>0?(d-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(d-f._start)*f._ts,n,o),d!==this._time||!this._ts&&!x){y=0,_&&(c+=this._zTime=-st);break}}f=_}else{f=this._last;for(var M=r<0?r:d;f;){if(_=f._prev,(f._act||M<=f._end)&&f._ts&&y!==f){if(f.parent!==this)return this.render(r,n,o);if(f.render(f._ts>0?(M-f._start)*f._ts:(f._dirty?f.totalDuration():f._tDur)+(M-f._start)*f._ts,n,o||Ot&&(f._initted||f._startAt)),d!==this._time||!this._ts&&!x){y=0,_&&(c+=this._zTime=M?-st:st);break}}f=_}}if(y&&!n&&(this.pause(),y.render(d>=a?0:-st)._zTime=d>=a?1:-1,this._ts))return this._start=v,Yn(this),this.render(r,n,o);this._onUpdate&&!n&&pe(this,"onUpdate",!0),(c===h&&this._tTime>=this.totalDuration()||!c&&a)&&(v===this._start||Math.abs(b)!==Math.abs(this._ts))&&(this._lock||((r||!l)&&(c===h&&this._ts>0||!c&&this._ts<0)&&_i(this,1),!n&&!(r<0&&!a)&&(c||a||!h)&&(pe(this,c===h&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(c<h&&this.timeScale()>0)&&this._prom())))}return this},e.add=function(r,n){var o=this;if(ii(n)||(n=he(this,n,r)),!(r instanceof Bs)){if(Ft(r))return r.forEach(function(a){return o.add(a,n)}),this;if(At(r))return this.addLabel(r,n);if(ft(r))r=wt.delayedCall(0,r);else return this}return this!==r?Le(this,r,n):this},e.getChildren=function(r,n,o,a){r===void 0&&(r=!0),n===void 0&&(n=!0),o===void 0&&(o=!0),a===void 0&&(a=-de);for(var h=[],l=this._first;l;)l._start>=a&&(l instanceof wt?n&&h.push(l):(o&&h.push(l),r&&h.push.apply(h,l.getChildren(!0,n,o)))),l=l._next;return h},e.getById=function(r){for(var n=this.getChildren(1,1,1),o=n.length;o--;)if(n[o].vars.id===r)return n[o]},e.remove=function(r){return At(r)?this.removeLabel(r):ft(r)?this.killTweensOf(r):(Xn(this,r),r===this._recent&&(this._recent=this._last),Gi(this))},e.totalTime=function(r,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=It(Qt.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),i.prototype.totalTime.call(this,r,n),this._forcing=0,this):this._tTime},e.addLabel=function(r,n){return this.labels[r]=he(this,n),this},e.removeLabel=function(r){return delete this.labels[r],this},e.addPause=function(r,n,o){var a=wt.delayedCall(0,n||wr,o);return a.data="isPause",this._hasPause=1,Le(this,a,he(this,r))},e.removePause=function(r){var n=this._first;for(r=he(this,r);n;)n._start===r&&n.data==="isPause"&&_i(n),n=n._next},e.killTweensOf=function(r,n,o){for(var a=this.getTweensOf(r,o),h=a.length;h--;)li!==a[h]&&a[h].kill(r,n);return this},e.getTweensOf=function(r,n){for(var o=[],a=fe(r),h=this._first,l=ii(n),c;h;)h instanceof wt?gv(h._targets,a)&&(l?(!li||h._initted&&h._ts)&&h.globalTime(0)<=n&&h.globalTime(h.totalDuration())>n:!n||h.isActive())&&o.push(h):(c=h.getTweensOf(a,n)).length&&o.push.apply(o,c),h=h._next;return o},e.tweenTo=function(r,n){n=n||{};var o=this,a=he(o,r),h=n,l=h.startAt,c=h.onStart,u=h.onStartParams,d=h.immediateRender,f,_=wt.to(o,_e({ease:n.ease||"none",lazy:!1,immediateRender:!1,time:a,overwrite:"auto",duration:n.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale())||st,onStart:function(){if(o.pause(),!f){var p=n.duration||Math.abs((a-(l&&"time"in l?l.time:o._time))/o.timeScale());_._dur!==p&&Rs(_,p,0,1).render(_._time,!0,!0),f=1}c&&c.apply(_,u||[])}},n));return d?_.render(0):_},e.tweenFromTo=function(r,n,o){return this.tweenTo(n,_e({startAt:{time:he(this,r)}},o))},e.recent=function(){return this._recent},e.nextLabel=function(r){return r===void 0&&(r=this._time),uc(this,he(this,r))},e.previousLabel=function(r){return r===void 0&&(r=this._time),uc(this,he(this,r),1)},e.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+st)},e.shiftChildren=function(r,n,o){o===void 0&&(o=0);for(var a=this._first,h=this.labels,l;a;)a._start>=o&&(a._start+=r,a._end+=r),a=a._next;if(n)for(l in h)h[l]>=o&&(h[l]+=r);return Gi(this)},e.invalidate=function(r){var n=this._first;for(this._lock=0;n;)n.invalidate(r),n=n._next;return i.prototype.invalidate.call(this,r)},e.clear=function(r){r===void 0&&(r=!0);for(var n=this._first,o;n;)o=n._next,this.remove(n),n=o;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),Gi(this)},e.totalDuration=function(r){var n=0,o=this,a=o._last,h=de,l,c,u;if(arguments.length)return o.timeScale((o._repeat<0?o.duration():o.totalDuration())/(o.reversed()?-r:r));if(o._dirty){for(u=o.parent;a;)l=a._prev,a._dirty&&a.totalDuration(),c=a._start,c>h&&o._sort&&a._ts&&!o._lock?(o._lock=1,Le(o,a,c-a._delay,1)._lock=0):h=c,c<0&&a._ts&&(n-=c,(!u&&!o._dp||u&&u.smoothChildTiming)&&(o._start+=c/o._ts,o._time-=c,o._tTime-=c),o.shiftChildren(-c,!1,-1/0),h=0),a._end>n&&a._ts&&(n=a._end),a=l;Rs(o,o===ct&&o._time>n?o._time:n,1,1),o._dirty=0}return o._tDur},t.updateRoot=function(r){if(ct._ts&&(Ud(ct,Bn(r,ct)),Fd=Qt.frame),Qt.frame>=ac){ac+=ee.autoSleep||120;var n=ct._first;if((!n||!n._ts)&&ee.autoSleep&&Qt._listeners.length<2){for(;n&&!n._ts;)n=n._next;n||Qt.sleep()}}},t}(Bs);_e(Vt.prototype,{_lock:0,_hasPause:0,_forcing:0});var Vv=function(t,e,s,r,n,o,a){var h=new Wt(this._pt,t,e,0,1,uf,null,n),l=0,c=0,u,d,f,_,m,p,x,y;for(h.b=s,h.e=r,s+="",r+="",(x=~r.indexOf("random("))&&(r=Tr(r)),o&&(y=[s,r],o(y,t,e),s=y[0],r=y[1]),d=s.match(Wo)||[];u=Wo.exec(r);)_=u[0],m=r.substring(l,u.index),f?f=(f+1)%5:m.substr(-5)==="rgba("&&(f=1),_!==d[c++]&&(p=parseFloat(d[c-1])||0,h._pt={_next:h._pt,p:m||c===1?m:",",s:p,c:_.charAt(1)==="="?ws(p,_)-p:parseFloat(_)-p,m:f&&f<4?Math.round:0},l=Wo.lastIndex);return h.c=l<r.length?r.substring(l,r.length):"",h.fp=a,(Rd.test(r)||x)&&(h.e=0),this._pt=h,h},yh=function(t,e,s,r,n,o,a,h,l,c){ft(r)&&(r=r(n||0,t,o));var u=t[e],d=s!=="get"?s:ft(u)?l?t[e.indexOf("set")||!ft(t["get"+e.substr(3)])?e:"get"+e.substr(3)](l):t[e]():u,f=ft(u)?l?jv:lf:xh,_;if(At(r)&&(~r.indexOf("random(")&&(r=Tr(r)),r.charAt(1)==="="&&(_=ws(d,r)+(Bt(d)||0),(_||_===0)&&(r=_))),!c||d!==r||Ha)return!isNaN(d*r)&&r!==""?(_=new Wt(this._pt,t,e,+d||0,r-(d||0),typeof u=="boolean"?Yv:cf,0,f),l&&(_.fp=l),a&&_.modifier(a,this,t),this._pt=_):(!u&&!(e in t)&&ph(e,r),Vv.call(this,t,e,d,r,f,h||ee.stringFilter,l))},$v=function(t,e,s,r,n){if(ft(t)&&(t=nr(t,n,e,s,r)),!$e(t)||t.style&&t.nodeType||Ft(t)||Id(t))return At(t)?nr(t,n,e,s,r):t;var o={},a;for(a in t)o[a]=nr(t[a],n,e,s,r);return o},of=function(t,e,s,r,n,o){var a,h,l,c;if(Zt[t]&&(a=new Zt[t]).init(n,a.rawVars?e[t]:$v(e[t],r,n,o,s),s,r,o)!==!1&&(s._pt=h=new Wt(s._pt,n,t,0,1,a.render,a,0,a.priority),s!==gs))for(l=s._ptLookup[s._targets.indexOf(n)],c=a._props.length;c--;)l[a._props[c]]=h;return a},li,Ha,bh=function i(t,e,s){var r=t.vars,n=r.ease,o=r.startAt,a=r.immediateRender,h=r.lazy,l=r.onUpdate,c=r.onUpdateParams,u=r.callbackScope,d=r.runBackwards,f=r.yoyoEase,_=r.keyframes,m=r.autoRevert,p=t._dur,x=t._startAt,y=t._targets,b=t.parent,v=b&&b.data==="nested"?b.vars.targets:y,w=t._overwrite==="auto"&&!uh,C=t.timeline,A,T,S,M,L,Q,K,Z,W,et,nt,Et,He;if(C&&(!_||!n)&&(n="none"),t._ease=Vi(n,Is.ease),t._yEase=f?ef(Vi(f===!0?n:f,Is.ease)):0,f&&t._yoyo&&!t._repeat&&(f=t._yEase,t._yEase=t._ease,t._ease=f),t._from=!C&&!!r.runBackwards,!C||_&&!r.stagger){if(Z=y[0]?Di(y[0]).harness:0,Et=Z&&r[Z.prop],A=kn(r,_h),x&&(x._zTime<0&&x.progress(1),e<0&&d&&a&&!m?x.render(-1,!0):x.revert(d&&p?dn:_v),x._lazy=0),o){if(_i(t._startAt=wt.set(y,_e({data:"isStart",overwrite:!1,parent:b,immediateRender:!0,lazy:!x&&Ht(h),startAt:null,delay:0,onUpdate:l,onUpdateParams:c,callbackScope:u,stagger:0},o))),t._startAt._dp=0,t._startAt._sat=t,e<0&&(Ot||!a&&!m)&&t._startAt.revert(dn),a&&p&&e<=0&&s<=0){e&&(t._zTime=e);return}}else if(d&&p&&!x){if(e&&(a=!1),S=_e({overwrite:!1,data:"isFromStart",lazy:a&&!x&&Ht(h),immediateRender:a,stagger:0,parent:b},A),Et&&(S[Z.prop]=Et),_i(t._startAt=wt.set(y,S)),t._startAt._dp=0,t._startAt._sat=t,e<0&&(Ot?t._startAt.revert(dn):t._startAt.render(-1,!0)),t._zTime=e,!a)i(t._startAt,st,st);else if(!e)return}for(t._pt=t._ptCache=0,h=p&&Ht(h)||h&&!p,T=0;T<y.length;T++){if(L=y[T],K=L._gsap||gh(y)[T]._gsap,t._ptLookup[T]=et={},Na[K.id]&&di.length&&Rn(),nt=v===y?T:v.indexOf(L),Z&&(W=new Z).init(L,Et||A,t,nt,v)!==!1&&(t._pt=M=new Wt(t._pt,L,W.name,0,1,W.render,W,0,W.priority),W._props.forEach(function(I){et[I]=M}),W.priority&&(Q=1)),!Z||Et)for(S in A)Zt[S]&&(W=of(S,A,t,nt,L,v))?W.priority&&(Q=1):et[S]=M=yh.call(t,L,S,"get",A[S],nt,v,0,r.stringFilter);t._op&&t._op[T]&&t.kill(L,t._op[T]),w&&t._pt&&(li=t,ct.killTweensOf(L,et,t.globalTime(e)),He=!t.parent,li=0),t._pt&&h&&(Na[K.id]=1)}Q&&df(t),t._onInit&&t._onInit(t)}t._onUpdate=l,t._initted=(!t._op||t._pt)&&!He,_&&e<=0&&C.render(de,!0,!0)},Hv=function(t,e,s,r,n,o,a){var h=(t._pt&&t._ptCache||(t._ptCache={}))[e],l,c,u,d;if(!h)for(h=t._ptCache[e]=[],u=t._ptLookup,d=t._targets.length;d--;){if(l=u[d][e],l&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==e&&l.fp!==e;)l=l._next;if(!l)return Ha=1,t.vars[e]="+=0",bh(t,a),Ha=0,1;h.push(l)}for(d=h.length;d--;)c=h[d],l=c._pt||c,l.s=(r||r===0)&&!n?r:l.s+(r||0)+o*l.c,l.c=s-l.s,c.e&&(c.e=_t(s)+Bt(c.e)),c.b&&(c.b=l.s+Bt(c.b))},zv=function(t,e){var s=t[0]?Di(t[0]).harness:0,r=s&&s.aliases,n,o,a,h;if(!r)return e;n=Yi({},e);for(o in r)if(o in n)for(h=r[o].split(","),a=h.length;a--;)n[h[a]]=n[o];return n},Wv=function(t,e,s,r){var n=e.ease||r||"power1.inOut",o,a;if(Ft(e))a=s[t]||(s[t]=[]),e.forEach(function(h,l){return a.push({t:l/(e.length-1)*100,v:h,e:n})});else for(o in e)a=s[o]||(s[o]=[]),o==="ease"||a.push({t:parseFloat(t),v:e[o],e:n})},nr=function(t,e,s,r,n){return ft(t)?t.call(e,s,r,n):At(t)&&~t.indexOf("random(")?Tr(t):t},af=mh+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",hf={};zt(af+",id,stagger,delay,duration,paused,scrollTrigger",function(i){return hf[i]=1});var wt=function(i){Ad(t,i);function t(s,r,n,o){var a;typeof r=="number"&&(n.duration=r,r=n,n=null),a=i.call(this,o?r:sr(r))||this;var h=a.vars,l=h.duration,c=h.delay,u=h.immediateRender,d=h.stagger,f=h.overwrite,_=h.keyframes,m=h.defaults,p=h.scrollTrigger,x=h.yoyoEase,y=r.parent||ct,b=(Ft(s)||Id(s)?ii(s[0]):"length"in r)?[s]:fe(s),v,w,C,A,T,S,M,L;if(a._targets=b.length?gh(b):Mn("GSAP target "+s+" not found. https://greensock.com",!ee.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=f,_||d||sn(l)||sn(c)){if(r=a.vars,v=a.timeline=new Vt({data:"nested",defaults:m||{},targets:y&&y.data==="nested"?y.vars.targets:b}),v.kill(),v.parent=v._dp=qe(a),v._start=0,d||sn(l)||sn(c)){if(A=b.length,M=d&&Xd(d),$e(d))for(T in d)~af.indexOf(T)&&(L||(L={}),L[T]=d[T]);for(w=0;w<A;w++)C=kn(r,hf),C.stagger=0,x&&(C.yoyoEase=x),L&&Yi(C,L),S=b[w],C.duration=+nr(l,qe(a),w,S,b),C.delay=(+nr(c,qe(a),w,S,b)||0)-a._delay,!d&&A===1&&C.delay&&(a._delay=c=C.delay,a._start+=c,C.delay=0),v.to(S,C,M?M(w,S,b):0),v._ease=z.none;v.duration()?l=c=0:a.timeline=0}else if(_){sr(_e(v.vars.defaults,{ease:"none"})),v._ease=Vi(_.ease||r.ease||"none");var Q=0,K,Z,W;if(Ft(_))_.forEach(function(et){return v.to(b,et,">")}),v.duration();else{C={};for(T in _)T==="ease"||T==="easeEach"||Wv(T,_[T],C,_.easeEach);for(T in C)for(K=C[T].sort(function(et,nt){return et.t-nt.t}),Q=0,w=0;w<K.length;w++)Z=K[w],W={ease:Z.e,duration:(Z.t-(w?K[w-1].t:0))/100*l},W[T]=Z.v,v.to(b,W,Q),Q+=W.duration;v.duration()<l&&v.to({},{duration:l-v.duration()})}}l||a.duration(l=v.duration())}else a.timeline=0;return f===!0&&!uh&&(li=qe(a),ct.killTweensOf(b),li=0),Le(y,qe(a),n),r.reversed&&a.reverse(),r.paused&&a.paused(!0),(u||!l&&!_&&a._start===It(y._time)&&Ht(u)&&vv(qe(a))&&y.data!=="nested")&&(a._tTime=-st,a.render(Math.max(0,-c)||0)),p&&Hd(qe(a),p),a}var e=t.prototype;return e.render=function(r,n,o){var a=this._time,h=this._tDur,l=this._dur,c=r<0,u=r>h-st&&!c?h:r<st?0:r,d,f,_,m,p,x,y,b,v;if(!l)Tv(this,r,n,o);else if(u!==this._tTime||!r||o||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==c){if(d=u,b=this.timeline,this._repeat){if(m=l+this._rDelay,this._repeat<-1&&c)return this.totalTime(m*100+r,n,o);if(d=It(u%m),u===h?(_=this._repeat,d=l):(_=~~(u/m),_&&_===u/m&&(d=l,_--),d>l&&(d=l)),x=this._yoyo&&_&1,x&&(v=this._yEase,d=l-d),p=Ms(this._tTime,m),d===a&&!o&&this._initted)return this._tTime=u,this;_!==p&&(b&&this._yEase&&sf(b,x),this.vars.repeatRefresh&&!x&&!this._lock&&(this._lock=o=1,this.render(It(m*_),!0).invalidate()._lock=0))}if(!this._initted){if(zd(this,c?r:d,o,n,u))return this._tTime=0,this;if(a!==this._time)return this;if(l!==this._dur)return this.render(r,n,o)}if(this._tTime=u,this._time=d,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=y=(v||this._ease)(d/l),this._from&&(this.ratio=y=1-y),d&&!a&&!n&&(pe(this,"onStart"),this._tTime!==u))return this;for(f=this._pt;f;)f.r(y,f.d),f=f._next;b&&b.render(r<0?r:!d&&x?-st:b._dur*b._ease(d/this._dur),n,o)||this._startAt&&(this._zTime=r),this._onUpdate&&!n&&(c&&Ua(this,r,n,o),pe(this,"onUpdate")),this._repeat&&_!==p&&this.vars.onRepeat&&!n&&this.parent&&pe(this,"onRepeat"),(u===this._tDur||!u)&&this._tTime===u&&(c&&!this._onUpdate&&Ua(this,r,!0,!0),(r||!l)&&(u===this._tDur&&this._ts>0||!u&&this._ts<0)&&_i(this,1),!n&&!(c&&!a)&&(u||a||x)&&(pe(this,u===h?"onComplete":"onReverseComplete",!0),this._prom&&!(u<h&&this.timeScale()>0)&&this._prom()))}return this},e.targets=function(){return this._targets},e.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),i.prototype.invalidate.call(this,r)},e.resetTo=function(r,n,o,a){Cr||Qt.wake(),this._ts||this.play();var h=Math.min(this._dur,(this._dp._time-this._start)*this._ts),l;return this._initted||bh(this,h),l=this._ease(h/this._dur),Hv(this,r,n,o,a,l,h)?this.resetTo(r,n,o,a):(qn(this,0),this.parent||Vd(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},e.kill=function(r,n){if(n===void 0&&(n="all"),!r&&(!n||n==="all"))return this._lazy=this._pt=0,this.parent?Js(this):this;if(this.timeline){var o=this.timeline.totalDuration();return this.timeline.killTweensOf(r,n,li&&li.vars.overwrite!==!0)._first||Js(this),this.parent&&o!==this.timeline.totalDuration()&&Rs(this,this._dur*this.timeline._tDur/o,0,1),this}var a=this._targets,h=r?fe(r):a,l=this._ptLookup,c=this._pt,u,d,f,_,m,p,x;if((!n||n==="all")&&bv(a,h))return n==="all"&&(this._pt=0),Js(this);for(u=this._op=this._op||[],n!=="all"&&(At(n)&&(m={},zt(n,function(y){return m[y]=1}),n=m),n=zv(a,n)),x=a.length;x--;)if(~h.indexOf(a[x])){d=l[x],n==="all"?(u[x]=n,_=d,f={}):(f=u[x]=u[x]||{},_=n);for(m in _)p=d&&d[m],p&&((!("kill"in p.d)||p.d.kill(m)===!0)&&Xn(this,p,"_pt"),delete d[m]),f!=="all"&&(f[m]=1)}return this._initted&&!this._pt&&c&&Js(this),this},t.to=function(r,n){return new t(r,n,arguments[2])},t.from=function(r,n){return rr(1,arguments)},t.delayedCall=function(r,n,o,a){return new t(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:n,onReverseComplete:n,onCompleteParams:o,onReverseCompleteParams:o,callbackScope:a})},t.fromTo=function(r,n,o){return rr(2,arguments)},t.set=function(r,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new t(r,n)},t.killTweensOf=function(r,n,o){return ct.killTweensOf(r,n,o)},t}(Bs);_e(wt.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});zt("staggerTo,staggerFrom,staggerFromTo",function(i){wt[i]=function(){var t=new Vt,e=Ga.call(arguments,0);return e.splice(i==="staggerFromTo"?5:4,0,0),t[i].apply(t,e)}});var xh=function(t,e,s){return t[e]=s},lf=function(t,e,s){return t[e](s)},jv=function(t,e,s,r){return t[e](r.fp,s)},Xv=function(t,e,s){return t.setAttribute(e,s)},vh=function(t,e){return ft(t[e])?lf:dh(t[e])&&t.setAttribute?Xv:xh},cf=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e6)/1e6,e)},Yv=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},uf=function(t,e){var s=e._pt,r="";if(!t&&e.b)r=e.b;else if(t===1&&e.e)r=e.e;else{for(;s;)r=s.p+(s.m?s.m(s.s+s.c*t):Math.round((s.s+s.c*t)*1e4)/1e4)+r,s=s._next;r+=e.c}e.set(e.t,e.p,r,e)},wh=function(t,e){for(var s=e._pt;s;)s.r(t,s.d),s=s._next},qv=function(t,e,s,r){for(var n=this._pt,o;n;)o=n._next,n.p===r&&n.modifier(t,e,s),n=o},Kv=function(t){for(var e=this._pt,s,r;e;)r=e._next,e.p===t&&!e.op||e.op===t?Xn(this,e,"_pt"):e.dep||(s=1),e=r;return!s},Zv=function(t,e,s,r){r.mSet(t,e,r.m.call(r.tween,s,r.mt),r)},df=function(t){for(var e=t._pt,s,r,n,o;e;){for(s=e._next,r=n;r&&r.pr>e.pr;)r=r._next;(e._prev=r?r._prev:o)?e._prev._next=e:n=e,(e._next=r)?r._prev=e:o=e,e=s}t._pt=n},Wt=function(){function i(e,s,r,n,o,a,h,l,c){this.t=s,this.s=n,this.c=o,this.p=r,this.r=a||cf,this.d=h||this,this.set=l||xh,this.pr=c||0,this._next=e,e&&(e._prev=this)}var t=i.prototype;return t.modifier=function(s,r,n){this.mSet=this.mSet||this.set,this.set=Zv,this.m=s,this.mt=n,this.tween=r},i}();zt(mh+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(i){return _h[i]=1});ne.TweenMax=ne.TweenLite=wt;ne.TimelineLite=ne.TimelineMax=Vt;ct=new Vt({sortChildren:!1,defaults:Is,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});ee.stringFilter=tf;var Ls=[],pn={},Jv=[],fc=0,Ko=function(t){return(pn[t]||Jv).map(function(e){return e()})},za=function(){var t=Date.now(),e=[];t-fc>2&&(Ko("matchMediaInit"),Ls.forEach(function(s){var r=s.queries,n=s.conditions,o,a,h,l;for(a in r)o=le.matchMedia(r[a]).matches,o&&(h=1),o!==n[a]&&(n[a]=o,l=1);l&&(s.revert(),h&&e.push(s))}),Ko("matchMediaRevert"),e.forEach(function(s){return s.onMatch(s)}),fc=t,Ko("matchMedia"))},ff=function(){function i(e,s){this.selector=s&&Va(s),this.data=[],this._r=[],this.isReverted=!1,e&&this.add(e)}var t=i.prototype;return t.add=function(s,r,n){ft(s)&&(n=r,r=s,s=ft);var o=this,a=function(){var l=bt,c=o.selector,u;return l&&l!==o&&l.data.push(o),n&&(o.selector=Va(n)),bt=o,u=r.apply(o,arguments),ft(u)&&o._r.push(u),bt=l,o.selector=c,o.isReverted=!1,u};return o.last=a,s===ft?a(o):s?o[s]=a:a},t.ignore=function(s){var r=bt;bt=null,s(this),bt=r},t.getTweens=function(){var s=[];return this.data.forEach(function(r){return r instanceof i?s.push.apply(s,r.getTweens()):r instanceof wt&&!(r.parent&&r.parent.data==="nested")&&s.push(r)}),s},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(s,r){var n=this;if(s){var o=this.getTweens();this.data.forEach(function(h){h.data==="isFlip"&&(h.revert(),h.getChildren(!0,!0,!1).forEach(function(l){return o.splice(o.indexOf(l),1)}))}),o.map(function(h){return{g:h.globalTime(0),t:h}}).sort(function(h,l){return l.g-h.g||-1}).forEach(function(h){return h.t.revert(s)}),this.data.forEach(function(h){return!(h instanceof Bs)&&h.revert&&h.revert(s)}),this._r.forEach(function(h){return h(s,n)}),this.isReverted=!0}else this.data.forEach(function(h){return h.kill&&h.kill()});if(this.clear(),r){var a=Ls.indexOf(this);~a&&Ls.splice(a,1)}},t.revert=function(s){this.kill(s||{})},i}(),Qv=function(){function i(e){this.contexts=[],this.scope=e}var t=i.prototype;return t.add=function(s,r,n){$e(s)||(s={matches:s});var o=new ff(0,n||this.scope),a=o.conditions={},h,l,c;this.contexts.push(o),r=o.add("onMatch",r),o.queries=s;for(l in s)l==="all"?c=1:(h=le.matchMedia(s[l]),h&&(Ls.indexOf(o)<0&&Ls.push(o),(a[l]=h.matches)&&(c=1),h.addListener?h.addListener(za):h.addEventListener("change",za)));return c&&r(o),this},t.revert=function(s){this.kill(s||{})},t.kill=function(s){this.contexts.forEach(function(r){return r.kill(s,!0)})},i}(),Ln={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];e.forEach(function(r){return Lv(r)})},timeline:function(t){return new Vt(t)},getTweensOf:function(t,e){return ct.getTweensOf(t,e)},getProperty:function(t,e,s,r){At(t)&&(t=fe(t)[0]);var n=Di(t||{}).get,o=s?Gd:Dd;return s==="native"&&(s=""),t&&(e?o((Zt[e]&&Zt[e].get||n)(t,e,s,r)):function(a,h,l){return o((Zt[a]&&Zt[a].get||n)(t,a,h,l))})},quickSetter:function(t,e,s){if(t=fe(t),t.length>1){var r=t.map(function(c){return oe.quickSetter(c,e,s)}),n=r.length;return function(c){for(var u=n;u--;)r[u](c)}}t=t[0]||{};var o=Zt[e],a=Di(t),h=a.harness&&(a.harness.aliases||{})[e]||e,l=o?function(c){var u=new o;gs._pt=0,u.init(t,s?c+s:c,gs,0,[t]),u.render(1,u),gs._pt&&wh(1,gs)}:a.set(t,h);return o?l:function(c){return l(t,h,s?c+s:c,a,1)}},quickTo:function(t,e,s){var r,n=oe.to(t,Yi((r={},r[e]="+=0.1",r.paused=!0,r),s||{})),o=function(h,l,c){return n.resetTo(e,h,l,c)};return o.tween=n,o},isTweening:function(t){return ct.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=Vi(t.ease,Is.ease)),hc(Is,t||{})},config:function(t){return hc(ee,t||{})},registerEffect:function(t){var e=t.name,s=t.effect,r=t.plugins,n=t.defaults,o=t.extendTimeline;(r||"").split(",").forEach(function(a){return a&&!Zt[a]&&!ne[a]&&Mn(e+" effect requires "+a+" plugin.")}),jo[e]=function(a,h,l){return s(fe(a),_e(h||{},n),l)},o&&(Vt.prototype[e]=function(a,h,l){return this.add(jo[e](a,$e(h)?h:(l=h)&&{},this),l)})},registerEase:function(t,e){z[t]=Vi(e)},parseEase:function(t,e){return arguments.length?Vi(t,e):z},getById:function(t){return ct.getById(t)},exportRoot:function(t,e){t===void 0&&(t={});var s=new Vt(t),r,n;for(s.smoothChildTiming=Ht(t.smoothChildTiming),ct.remove(s),s._dp=0,s._time=s._tTime=ct._time,r=ct._first;r;)n=r._next,(e||!(!r._dur&&r instanceof wt&&r.vars.onComplete===r._targets[0]))&&Le(s,r,r._start-r._delay),r=n;return Le(ct,s,0),s},context:function(t,e){return t?new ff(t,e):bt},matchMedia:function(t){return new Qv(t)},matchMediaRefresh:function(){return Ls.forEach(function(t){var e=t.conditions,s,r;for(r in e)e[r]&&(e[r]=!1,s=1);s&&t.revert()})||za()},addEventListener:function(t,e){var s=pn[t]||(pn[t]=[]);~s.indexOf(e)||s.push(e)},removeEventListener:function(t,e){var s=pn[t],r=s&&s.indexOf(e);r>=0&&s.splice(r,1)},utils:{wrap:Rv,wrapYoyo:kv,distribute:Xd,random:qd,snap:Yd,normalize:Mv,getUnit:Bt,clamp:Av,splitColor:Jd,toArray:fe,selector:Va,mapRange:Zd,pipe:Pv,unitize:Iv,interpolate:Bv,shuffle:jd},install:Ld,effects:jo,ticker:Qt,updateRoot:Vt.updateRoot,plugins:Zt,globalTimeline:ct,core:{PropTween:Wt,globals:Od,Tween:wt,Timeline:Vt,Animation:Bs,getCache:Di,_removeLinkedListItem:Xn,reverting:function(){return Ot},context:function(t){return t&&bt&&(bt.data.push(t),t._ctx=bt),bt},suppressOverwrites:function(t){return uh=t}}};zt("to,from,fromTo,delayedCall,set,killTweensOf",function(i){return Ln[i]=wt[i]});Qt.add(Vt.updateRoot);gs=Ln.to({},{duration:0});var tw=function(t,e){for(var s=t._pt;s&&s.p!==e&&s.op!==e&&s.fp!==e;)s=s._next;return s},ew=function(t,e){var s=t._targets,r,n,o;for(r in e)for(n=s.length;n--;)o=t._ptLookup[n][r],o&&(o=o.d)&&(o._pt&&(o=tw(o,r)),o&&o.modifier&&o.modifier(e[r],t,s[n],r))},Zo=function(t,e){return{name:t,rawVars:1,init:function(r,n,o){o._onInit=function(a){var h,l;if(At(n)&&(h={},zt(n,function(c){return h[c]=1}),n=h),e){h={};for(l in n)h[l]=e(n[l]);n=h}ew(a,n)}}}},oe=Ln.registerPlugin({name:"attr",init:function(t,e,s,r,n){var o,a,h;this.tween=s;for(o in e)h=t.getAttribute(o)||"",a=this.add(t,"setAttribute",(h||0)+"",e[o],r,n,0,0,o),a.op=o,a.b=h,this._props.push(o)},render:function(t,e){for(var s=e._pt;s;)Ot?s.set(s.t,s.p,s.b,s):s.r(t,s.d),s=s._next}},{name:"endArray",init:function(t,e){for(var s=e.length;s--;)this.add(t,s,t[s]||0,e[s],0,0,0,0,0,1)}},Zo("roundProps",$a),Zo("modifiers"),Zo("snap",Yd))||Ln;wt.version=Vt.version=oe.version="3.11.4";Bd=1;Pd()&&ks();z.Power0;z.Power1;z.Power2;z.Power3;z.Power4;z.Linear;z.Quad;z.Cubic;z.Quart;z.Quint;z.Strong;z.Elastic;z.Back;z.SteppedEase;z.Bounce;z.Sine;z.Expo;z.Circ;/*!
 * CSSPlugin 3.11.4
 * https://greensock.com
 *
 * Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var pc,ci,Ts,Th,Ui,_c,Ch,iw=function(){return typeof window<"u"},si={},Fi=180/Math.PI,Cs=Math.PI/180,ns=Math.atan2,mc=1e8,Sh=/([A-Z])/g,sw=/(left|right|width|margin|padding|x)/i,rw=/[\s,\(]\S/,ti={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Wa=function(t,e){return e.set(e.t,e.p,Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},nw=function(t,e){return e.set(e.t,e.p,t===1?e.e:Math.round((e.s+e.c*t)*1e4)/1e4+e.u,e)},ow=function(t,e){return e.set(e.t,e.p,t?Math.round((e.s+e.c*t)*1e4)/1e4+e.u:e.b,e)},aw=function(t,e){var s=e.s+e.c*t;e.set(e.t,e.p,~~(s+(s<0?-.5:.5))+e.u,e)},pf=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},_f=function(t,e){return e.set(e.t,e.p,t!==1?e.b:e.e,e)},hw=function(t,e,s){return t.style[e]=s},lw=function(t,e,s){return t.style.setProperty(e,s)},cw=function(t,e,s){return t._gsap[e]=s},uw=function(t,e,s){return t._gsap.scaleX=t._gsap.scaleY=s},dw=function(t,e,s,r,n){var o=t._gsap;o.scaleX=o.scaleY=s,o.renderTransform(n,o)},fw=function(t,e,s,r,n){var o=t._gsap;o[e]=s,o.renderTransform(n,o)},dt="transform",Ie=dt+"Origin",pw=function(t,e){var s=this,r=this.target,n=r.style;if(t in si){if(this.tfm=this.tfm||{},t!=="transform"&&(t=ti[t]||t,~t.indexOf(",")?t.split(",").forEach(function(o){return s.tfm[o]=Ke(r,o)}):this.tfm[t]=r._gsap.x?r._gsap[t]:Ke(r,t)),this.props.indexOf(dt)>=0)return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(Ie,e,"")),t=dt}(n||e)&&this.props.push(t,e,n[t])},mf=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},_w=function(){var t=this.props,e=this.target,s=e.style,r=e._gsap,n,o;for(n=0;n<t.length;n+=3)t[n+1]?e[t[n]]=t[n+2]:t[n+2]?s[t[n]]=t[n+2]:s.removeProperty(t[n].replace(Sh,"-$1").toLowerCase());if(this.tfm){for(o in this.tfm)r[o]=this.tfm[o];r.svg&&(r.renderTransform(),e.setAttribute("data-svg-origin",this.svgo||"")),n=Ch(),n&&!n.isStart&&!s[dt]&&(mf(s),r.uncache=1)}},gf=function(t,e){var s={target:t,props:[],revert:_w,save:pw};return e&&e.split(",").forEach(function(r){return s.save(r)}),s},yf,ja=function(t,e){var s=ci.createElementNS?ci.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):ci.createElement(t);return s.style?s:ci.createElement(t)},Ge=function i(t,e,s){var r=getComputedStyle(t);return r[e]||r.getPropertyValue(e.replace(Sh,"-$1").toLowerCase())||r.getPropertyValue(e)||!s&&i(t,Os(e)||e,1)||""},gc="O,Moz,ms,Ms,Webkit".split(","),Os=function(t,e,s){var r=e||Ui,n=r.style,o=5;if(t in n&&!s)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);o--&&!(gc[o]+t in n););return o<0?null:(o===3?"ms":o>=0?gc[o]:"")+t},Xa=function(){iw()&&window.document&&(pc=window,ci=pc.document,Ts=ci.documentElement,Ui=ja("div")||{style:{}},ja("div"),dt=Os(dt),Ie=dt+"Origin",Ui.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",yf=!!Os("perspective"),Ch=oe.core.reverting,Th=1)},Jo=function i(t){var e=ja("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),s=this.parentNode,r=this.nextSibling,n=this.style.cssText,o;if(Ts.appendChild(e),e.appendChild(this),this.style.display="block",t)try{o=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=i}catch{}else this._gsapBBox&&(o=this._gsapBBox());return s&&(r?s.insertBefore(this,r):s.appendChild(this)),Ts.removeChild(e),this.style.cssText=n,o},yc=function(t,e){for(var s=e.length;s--;)if(t.hasAttribute(e[s]))return t.getAttribute(e[s])},bf=function(t){var e;try{e=t.getBBox()}catch{e=Jo.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===Jo||(e=Jo.call(t,!0)),e&&!e.width&&!e.x&&!e.y?{x:+yc(t,["x","cx","x1"])||0,y:+yc(t,["y","cy","y1"])||0,width:0,height:0}:e},xf=function(t){return!!(t.getCTM&&(!t.parentNode||t.ownerSVGElement)&&bf(t))},Sr=function(t,e){if(e){var s=t.style;e in si&&e!==Ie&&(e=dt),s.removeProperty?((e.substr(0,2)==="ms"||e.substr(0,6)==="webkit")&&(e="-"+e),s.removeProperty(e.replace(Sh,"-$1").toLowerCase())):s.removeAttribute(e)}},ui=function(t,e,s,r,n,o){var a=new Wt(t._pt,e,s,0,1,o?_f:pf);return t._pt=a,a.b=r,a.e=n,t._props.push(s),a},bc={deg:1,rad:1,turn:1},mw={grid:1,flex:1},mi=function i(t,e,s,r){var n=parseFloat(s)||0,o=(s+"").trim().substr((n+"").length)||"px",a=Ui.style,h=sw.test(e),l=t.tagName.toLowerCase()==="svg",c=(l?"client":"offset")+(h?"Width":"Height"),u=100,d=r==="px",f=r==="%",_,m,p,x;return r===o||!n||bc[r]||bc[o]?n:(o!=="px"&&!d&&(n=i(t,e,s,"px")),x=t.getCTM&&xf(t),(f||o==="%")&&(si[e]||~e.indexOf("adius"))?(_=x?t.getBBox()[h?"width":"height"]:t[c],_t(f?n/_*u:n/100*_)):(a[h?"width":"height"]=u+(d?o:r),m=~e.indexOf("adius")||r==="em"&&t.appendChild&&!l?t:t.parentNode,x&&(m=(t.ownerSVGElement||{}).parentNode),(!m||m===ci||!m.appendChild)&&(m=ci.body),p=m._gsap,p&&f&&p.width&&h&&p.time===Qt.time&&!p.uncache?_t(n/p.width*u):((f||o==="%")&&!mw[Ge(m,"display")]&&(a.position=Ge(t,"position")),m===t&&(a.position="static"),m.appendChild(Ui),_=Ui[c],m.removeChild(Ui),a.position="absolute",h&&f&&(p=Di(m),p.time=Qt.time,p.width=m[c]),_t(d?_*n/u:_&&n?u/_*n:0))))},Ke=function(t,e,s,r){var n;return Th||Xa(),e in ti&&e!=="transform"&&(e=ti[e],~e.indexOf(",")&&(e=e.split(",")[0])),si[e]&&e!=="transform"?(n=Er(t,r),n=e!=="transformOrigin"?n[e]:n.svg?n.origin:Fn(Ge(t,Ie))+" "+n.zOrigin+"px"):(n=t.style[e],(!n||n==="auto"||r||~(n+"").indexOf("calc("))&&(n=On[e]&&On[e](t,e,s)||Ge(t,e)||Nd(t,e)||(e==="opacity"?1:0))),s&&!~(n+"").trim().indexOf(" ")?mi(t,e,n,s)+s:n},gw=function(t,e,s,r){if(!s||s==="none"){var n=Os(e,t,1),o=n&&Ge(t,n,1);o&&o!==s?(e=n,s=o):e==="borderColor"&&(s=Ge(t,"borderTopColor"))}var a=new Wt(this._pt,t.style,e,0,1,uf),h=0,l=0,c,u,d,f,_,m,p,x,y,b,v,w;if(a.b=s,a.e=r,s+="",r+="",r==="auto"&&(t.style[e]=r,r=Ge(t,e)||r,t.style[e]=s),c=[s,r],tf(c),s=c[0],r=c[1],d=s.match(ms)||[],w=r.match(ms)||[],w.length){for(;u=ms.exec(r);)p=u[0],y=r.substring(h,u.index),_?_=(_+1)%5:(y.substr(-5)==="rgba("||y.substr(-5)==="hsla(")&&(_=1),p!==(m=d[l++]||"")&&(f=parseFloat(m)||0,v=m.substr((f+"").length),p.charAt(1)==="="&&(p=ws(f,p)+v),x=parseFloat(p),b=p.substr((x+"").length),h=ms.lastIndex-b.length,b||(b=b||ee.units[e]||v,h===r.length&&(r+=b,a.e+=b)),v!==b&&(f=mi(t,e,m,b)||0),a._pt={_next:a._pt,p:y||l===1?y:",",s:f,c:x-f,m:_&&_<4||e==="zIndex"?Math.round:0});a.c=h<r.length?r.substring(h,r.length):""}else a.r=e==="display"&&r==="none"?_f:pf;return Rd.test(r)&&(a.e=0),this._pt=a,a},xc={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},yw=function(t){var e=t.split(" "),s=e[0],r=e[1]||"50%";return(s==="top"||s==="bottom"||r==="left"||r==="right")&&(t=s,s=r,r=t),e[0]=xc[s]||s,e[1]=xc[r]||r,e.join(" ")},bw=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var s=e.t,r=s.style,n=e.u,o=s._gsap,a,h,l;if(n==="all"||n===!0)r.cssText="",h=1;else for(n=n.split(","),l=n.length;--l>-1;)a=n[l],si[a]&&(h=1,a=a==="transformOrigin"?Ie:dt),Sr(s,a);h&&(Sr(s,dt),o&&(o.svg&&s.removeAttribute("transform"),Er(s,1),o.uncache=1,mf(r)))}},On={clearProps:function(t,e,s,r,n){if(n.data!=="isFromStart"){var o=t._pt=new Wt(t._pt,e,s,0,0,bw);return o.u=r,o.pr=-10,o.tween=n,t._props.push(s),1}}},Ar=[1,0,0,1,0,0],vf={},wf=function(t){return t==="matrix(1, 0, 0, 1, 0, 0)"||t==="none"||!t},vc=function(t){var e=Ge(t,dt);return wf(e)?Ar:e.substr(7).match(Md).map(_t)},Ah=function(t,e){var s=t._gsap||Di(t),r=t.style,n=vc(t),o,a,h,l;return s.svg&&t.getAttribute("transform")?(h=t.transform.baseVal.consolidate().matrix,n=[h.a,h.b,h.c,h.d,h.e,h.f],n.join(",")==="1,0,0,1,0,0"?Ar:n):(n===Ar&&!t.offsetParent&&t!==Ts&&!s.svg&&(h=r.display,r.display="block",o=t.parentNode,(!o||!t.offsetParent)&&(l=1,a=t.nextElementSibling,Ts.appendChild(t)),n=vc(t),h?r.display=h:Sr(t,"display"),l&&(a?o.insertBefore(t,a):o?o.appendChild(t):Ts.removeChild(t))),e&&n.length>6?[n[0],n[1],n[4],n[5],n[12],n[13]]:n)},Ya=function(t,e,s,r,n,o){var a=t._gsap,h=n||Ah(t,!0),l=a.xOrigin||0,c=a.yOrigin||0,u=a.xOffset||0,d=a.yOffset||0,f=h[0],_=h[1],m=h[2],p=h[3],x=h[4],y=h[5],b=e.split(" "),v=parseFloat(b[0])||0,w=parseFloat(b[1])||0,C,A,T,S;s?h!==Ar&&(A=f*p-_*m)&&(T=v*(p/A)+w*(-m/A)+(m*y-p*x)/A,S=v*(-_/A)+w*(f/A)-(f*y-_*x)/A,v=T,w=S):(C=bf(t),v=C.x+(~b[0].indexOf("%")?v/100*C.width:v),w=C.y+(~(b[1]||b[0]).indexOf("%")?w/100*C.height:w)),r||r!==!1&&a.smooth?(x=v-l,y=w-c,a.xOffset=u+(x*f+y*m)-x,a.yOffset=d+(x*_+y*p)-y):a.xOffset=a.yOffset=0,a.xOrigin=v,a.yOrigin=w,a.smooth=!!r,a.origin=e,a.originIsAbsolute=!!s,t.style[Ie]="0px 0px",o&&(ui(o,a,"xOrigin",l,v),ui(o,a,"yOrigin",c,w),ui(o,a,"xOffset",u,a.xOffset),ui(o,a,"yOffset",d,a.yOffset)),t.setAttribute("data-svg-origin",v+" "+w)},Er=function(t,e){var s=t._gsap||new nf(t);if("x"in s&&!e&&!s.uncache)return s;var r=t.style,n=s.scaleX<0,o="px",a="deg",h=getComputedStyle(t),l=Ge(t,Ie)||"0",c,u,d,f,_,m,p,x,y,b,v,w,C,A,T,S,M,L,Q,K,Z,W,et,nt,Et,He,I,F,$,rt,q,at;return c=u=d=m=p=x=y=b=v=0,f=_=1,s.svg=!!(t.getCTM&&xf(t)),h.translate&&((h.translate!=="none"||h.scale!=="none"||h.rotate!=="none")&&(r[dt]=(h.translate!=="none"?"translate3d("+(h.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(h.rotate!=="none"?"rotate("+h.rotate+") ":"")+(h.scale!=="none"?"scale("+h.scale.split(" ").join(",")+") ":"")+(h[dt]!=="none"?h[dt]:"")),r.scale=r.rotate=r.translate="none"),A=Ah(t,s.svg),s.svg&&(s.uncache?(Et=t.getBBox(),l=s.xOrigin-Et.x+"px "+(s.yOrigin-Et.y)+"px",nt=""):nt=!e&&t.getAttribute("data-svg-origin"),Ya(t,nt||l,!!nt||s.originIsAbsolute,s.smooth!==!1,A)),w=s.xOrigin||0,C=s.yOrigin||0,A!==Ar&&(L=A[0],Q=A[1],K=A[2],Z=A[3],c=W=A[4],u=et=A[5],A.length===6?(f=Math.sqrt(L*L+Q*Q),_=Math.sqrt(Z*Z+K*K),m=L||Q?ns(Q,L)*Fi:0,y=K||Z?ns(K,Z)*Fi+m:0,y&&(_*=Math.abs(Math.cos(y*Cs))),s.svg&&(c-=w-(w*L+C*K),u-=C-(w*Q+C*Z))):(at=A[6],rt=A[7],I=A[8],F=A[9],$=A[10],q=A[11],c=A[12],u=A[13],d=A[14],T=ns(at,$),p=T*Fi,T&&(S=Math.cos(-T),M=Math.sin(-T),nt=W*S+I*M,Et=et*S+F*M,He=at*S+$*M,I=W*-M+I*S,F=et*-M+F*S,$=at*-M+$*S,q=rt*-M+q*S,W=nt,et=Et,at=He),T=ns(-K,$),x=T*Fi,T&&(S=Math.cos(-T),M=Math.sin(-T),nt=L*S-I*M,Et=Q*S-F*M,He=K*S-$*M,q=Z*M+q*S,L=nt,Q=Et,K=He),T=ns(Q,L),m=T*Fi,T&&(S=Math.cos(T),M=Math.sin(T),nt=L*S+Q*M,Et=W*S+et*M,Q=Q*S-L*M,et=et*S-W*M,L=nt,W=Et),p&&Math.abs(p)+Math.abs(m)>359.9&&(p=m=0,x=180-x),f=_t(Math.sqrt(L*L+Q*Q+K*K)),_=_t(Math.sqrt(et*et+at*at)),T=ns(W,et),y=Math.abs(T)>2e-4?T*Fi:0,v=q?1/(q<0?-q:q):0),s.svg&&(nt=t.getAttribute("transform"),s.forceCSS=t.setAttribute("transform","")||!wf(Ge(t,dt)),nt&&t.setAttribute("transform",nt))),Math.abs(y)>90&&Math.abs(y)<270&&(n?(f*=-1,y+=m<=0?180:-180,m+=m<=0?180:-180):(_*=-1,y+=y<=0?180:-180)),e=e||s.uncache,s.x=c-((s.xPercent=c&&(!e&&s.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-c)?-50:0)))?t.offsetWidth*s.xPercent/100:0)+o,s.y=u-((s.yPercent=u&&(!e&&s.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-u)?-50:0)))?t.offsetHeight*s.yPercent/100:0)+o,s.z=d+o,s.scaleX=_t(f),s.scaleY=_t(_),s.rotation=_t(m)+a,s.rotationX=_t(p)+a,s.rotationY=_t(x)+a,s.skewX=y+a,s.skewY=b+a,s.transformPerspective=v+o,(s.zOrigin=parseFloat(l.split(" ")[2])||0)&&(r[Ie]=Fn(l)),s.xOffset=s.yOffset=0,s.force3D=ee.force3D,s.renderTransform=s.svg?vw:yf?Tf:xw,s.uncache=0,s},Fn=function(t){return(t=t.split(" "))[0]+" "+t[1]},Qo=function(t,e,s){var r=Bt(e);return _t(parseFloat(e)+parseFloat(mi(t,"x",s+"px",r)))+r},xw=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,Tf(t,e)},Ci="0deg",js="0px",Si=") ",Tf=function(t,e){var s=e||this,r=s.xPercent,n=s.yPercent,o=s.x,a=s.y,h=s.z,l=s.rotation,c=s.rotationY,u=s.rotationX,d=s.skewX,f=s.skewY,_=s.scaleX,m=s.scaleY,p=s.transformPerspective,x=s.force3D,y=s.target,b=s.zOrigin,v="",w=x==="auto"&&t&&t!==1||x===!0;if(b&&(u!==Ci||c!==Ci)){var C=parseFloat(c)*Cs,A=Math.sin(C),T=Math.cos(C),S;C=parseFloat(u)*Cs,S=Math.cos(C),o=Qo(y,o,A*S*-b),a=Qo(y,a,-Math.sin(C)*-b),h=Qo(y,h,T*S*-b+b)}p!==js&&(v+="perspective("+p+Si),(r||n)&&(v+="translate("+r+"%, "+n+"%) "),(w||o!==js||a!==js||h!==js)&&(v+=h!==js||w?"translate3d("+o+", "+a+", "+h+") ":"translate("+o+", "+a+Si),l!==Ci&&(v+="rotate("+l+Si),c!==Ci&&(v+="rotateY("+c+Si),u!==Ci&&(v+="rotateX("+u+Si),(d!==Ci||f!==Ci)&&(v+="skew("+d+", "+f+Si),(_!==1||m!==1)&&(v+="scale("+_+", "+m+Si),y.style[dt]=v||"translate(0, 0)"},vw=function(t,e){var s=e||this,r=s.xPercent,n=s.yPercent,o=s.x,a=s.y,h=s.rotation,l=s.skewX,c=s.skewY,u=s.scaleX,d=s.scaleY,f=s.target,_=s.xOrigin,m=s.yOrigin,p=s.xOffset,x=s.yOffset,y=s.forceCSS,b=parseFloat(o),v=parseFloat(a),w,C,A,T,S;h=parseFloat(h),l=parseFloat(l),c=parseFloat(c),c&&(c=parseFloat(c),l+=c,h+=c),h||l?(h*=Cs,l*=Cs,w=Math.cos(h)*u,C=Math.sin(h)*u,A=Math.sin(h-l)*-d,T=Math.cos(h-l)*d,l&&(c*=Cs,S=Math.tan(l-c),S=Math.sqrt(1+S*S),A*=S,T*=S,c&&(S=Math.tan(c),S=Math.sqrt(1+S*S),w*=S,C*=S)),w=_t(w),C=_t(C),A=_t(A),T=_t(T)):(w=u,T=d,C=A=0),(b&&!~(o+"").indexOf("px")||v&&!~(a+"").indexOf("px"))&&(b=mi(f,"x",o,"px"),v=mi(f,"y",a,"px")),(_||m||p||x)&&(b=_t(b+_-(_*w+m*A)+p),v=_t(v+m-(_*C+m*T)+x)),(r||n)&&(S=f.getBBox(),b=_t(b+r/100*S.width),v=_t(v+n/100*S.height)),S="matrix("+w+","+C+","+A+","+T+","+b+","+v+")",f.setAttribute("transform",S),y&&(f.style[dt]=S)},ww=function(t,e,s,r,n){var o=360,a=At(n),h=parseFloat(n)*(a&&~n.indexOf("rad")?Fi:1),l=h-r,c=r+l+"deg",u,d;return a&&(u=n.split("_")[1],u==="short"&&(l%=o,l!==l%(o/2)&&(l+=l<0?o:-o)),u==="cw"&&l<0?l=(l+o*mc)%o-~~(l/o)*o:u==="ccw"&&l>0&&(l=(l-o*mc)%o-~~(l/o)*o)),t._pt=d=new Wt(t._pt,e,s,r,l,nw),d.e=c,d.u="deg",t._props.push(s),d},wc=function(t,e){for(var s in e)t[s]=e[s];return t},Tw=function(t,e,s){var r=wc({},s._gsap),n="perspective,force3D,transformOrigin,svgOrigin",o=s.style,a,h,l,c,u,d,f,_;r.svg?(l=s.getAttribute("transform"),s.setAttribute("transform",""),o[dt]=e,a=Er(s,1),Sr(s,dt),s.setAttribute("transform",l)):(l=getComputedStyle(s)[dt],o[dt]=e,a=Er(s,1),o[dt]=l);for(h in si)l=r[h],c=a[h],l!==c&&n.indexOf(h)<0&&(f=Bt(l),_=Bt(c),u=f!==_?mi(s,h,l,_):parseFloat(l),d=parseFloat(c),t._pt=new Wt(t._pt,a,h,u,d-u,Wa),t._pt.u=_||0,t._props.push(h));wc(a,r)};zt("padding,margin,Width,Radius",function(i,t){var e="Top",s="Right",r="Bottom",n="Left",o=(t<3?[e,s,r,n]:[e+n,e+s,r+s,r+n]).map(function(a){return t<2?i+a:"border"+a+i});On[t>1?"border"+i:i]=function(a,h,l,c,u){var d,f;if(arguments.length<4)return d=o.map(function(_){return Ke(a,_,l)}),f=d.join(" "),f.split(d[0]).length===5?d[0]:f;d=(c+"").split(" "),f={},o.forEach(function(_,m){return f[_]=d[m]=d[m]||d[(m-1)/2|0]}),a.init(h,f,u)}});var Cf={name:"css",register:Xa,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,s,r,n){var o=this._props,a=t.style,h=s.vars.startAt,l,c,u,d,f,_,m,p,x,y,b,v,w,C,A,T;Th||Xa(),this.styles=this.styles||gf(t),T=this.styles.props,this.tween=s;for(m in e)if(m!=="autoRound"&&(c=e[m],!(Zt[m]&&of(m,e,s,r,t,n)))){if(f=typeof c,_=On[m],f==="function"&&(c=c.call(s,r,t,n),f=typeof c),f==="string"&&~c.indexOf("random(")&&(c=Tr(c)),_)_(this,t,m,c,s)&&(A=1);else if(m.substr(0,2)==="--")l=(getComputedStyle(t).getPropertyValue(m)+"").trim(),c+="",fi.lastIndex=0,fi.test(l)||(p=Bt(l),x=Bt(c)),x?p!==x&&(l=mi(t,m,l,x)+x):p&&(c+=p),this.add(a,"setProperty",l,c,r,n,0,0,m),o.push(m),T.push(m,0,a[m]);else if(f!=="undefined"){if(h&&m in h?(l=typeof h[m]=="function"?h[m].call(s,r,t,n):h[m],At(l)&&~l.indexOf("random(")&&(l=Tr(l)),Bt(l+"")||(l+=ee.units[m]||Bt(Ke(t,m))||""),(l+"").charAt(1)==="="&&(l=Ke(t,m))):l=Ke(t,m),d=parseFloat(l),y=f==="string"&&c.charAt(1)==="="&&c.substr(0,2),y&&(c=c.substr(2)),u=parseFloat(c),m in ti&&(m==="autoAlpha"&&(d===1&&Ke(t,"visibility")==="hidden"&&u&&(d=0),T.push("visibility",0,a.visibility),ui(this,a,"visibility",d?"inherit":"hidden",u?"inherit":"hidden",!u)),m!=="scale"&&m!=="transform"&&(m=ti[m],~m.indexOf(",")&&(m=m.split(",")[0]))),b=m in si,b){if(this.styles.save(m),v||(w=t._gsap,w.renderTransform&&!e.parseTransform||Er(t,e.parseTransform),C=e.smoothOrigin!==!1&&w.smooth,v=this._pt=new Wt(this._pt,a,dt,0,1,w.renderTransform,w,0,-1),v.dep=1),m==="scale")this._pt=new Wt(this._pt,w,"scaleY",w.scaleY,(y?ws(w.scaleY,y+u):u)-w.scaleY||0,Wa),this._pt.u=0,o.push("scaleY",m),m+="X";else if(m==="transformOrigin"){T.push(Ie,0,a[Ie]),c=yw(c),w.svg?Ya(t,c,0,C,0,this):(x=parseFloat(c.split(" ")[2])||0,x!==w.zOrigin&&ui(this,w,"zOrigin",w.zOrigin,x),ui(this,a,m,Fn(l),Fn(c)));continue}else if(m==="svgOrigin"){Ya(t,c,1,C,0,this);continue}else if(m in vf){ww(this,w,m,d,y?ws(d,y+c):c);continue}else if(m==="smoothOrigin"){ui(this,w,"smooth",w.smooth,c);continue}else if(m==="force3D"){w[m]=c;continue}else if(m==="transform"){Tw(this,c,t);continue}}else m in a||(m=Os(m)||m);if(b||(u||u===0)&&(d||d===0)&&!rw.test(c)&&m in a)p=(l+"").substr((d+"").length),u||(u=0),x=Bt(c)||(m in ee.units?ee.units[m]:p),p!==x&&(d=mi(t,m,l,x)),this._pt=new Wt(this._pt,b?w:a,m,d,(y?ws(d,y+u):u)-d,!b&&(x==="px"||m==="zIndex")&&e.autoRound!==!1?aw:Wa),this._pt.u=x||0,p!==x&&x!=="%"&&(this._pt.b=l,this._pt.r=ow);else if(m in a)gw.call(this,t,m,l,y?y+c:c);else if(m in t)this.add(t,m,l||t[m],y?y+c:c,r,n);else if(m!=="parseTransform"){ph(m,c);continue}b||(m in a?T.push(m,0,a[m]):T.push(m,1,l||t[m])),o.push(m)}}A&&df(this)},render:function(t,e){if(e.tween._time||!Ch())for(var s=e._pt;s;)s.r(t,s.d),s=s._next;else e.styles.revert()},get:Ke,aliases:ti,getSetter:function(t,e,s){var r=ti[e];return r&&r.indexOf(",")<0&&(e=r),e in si&&e!==Ie&&(t._gsap.x||Ke(t,"x"))?s&&_c===s?e==="scale"?uw:cw:(_c=s||{})&&(e==="scale"?dw:fw):t.style&&!dh(t.style[e])?hw:~e.indexOf("-")?lw:vh(t,e)},core:{_removeProperty:Sr,_getMatrix:Ah}};oe.utils.checkPrefix=Os;oe.core.getStyleSaver=gf;(function(i,t,e,s){var r=zt(i+","+t+","+e,function(n){si[n]=1});zt(t,function(n){ee.units[n]="deg",vf[n]=1}),ti[r[13]]=i+","+t,zt(s,function(n){var o=n.split(":");ti[o[1]]=r[o[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");zt("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(i){ee.units[i]="px"});oe.registerPlugin(Cf);var O=oe.registerPlugin(Cf)||oe;O.core.Tween;class Cw{constructor(){g(this,"currentAlias");g(this,"current");g(this,"_globalVolume",.15);g(this,"_instanceVolume",.15)}async play(t,e){}setVolume(t){this._globalVolume=t,this.current&&(this.current.volume=this._globalVolume*this._instanceVolume)}getVolume(){return this._globalVolume}}class Sw{constructor(){g(this,"_volume",.5)}play(t,e){}setVolume(t){this._volume=t}getVolume(){return this._volume}}const or={muted(i){i?rs.muteAll():rs.unmuteAll()},getMasterVolume(){return rs.volumeAll},setMasterVolume(i){rs.volumeAll=i,i?rs.unmuteAll():rs.muteAll()}},Aw=new Cw,ie=new Sw,Xe=100,Ye=50;class Tc{constructor(){g(this,"canvas");g(this,"context");const t=document.createElement("canvas");t.width=Xe,t.height=Ye;const e=t.getContext("2d");this.context=e,e.fillStyle="#141414",e.fillRect(0,0,Xe,Ye),e.fillStyle="#141414",e.fillRect(0,0,Xe-1,Ye),e.fillStyle="#E72264",e.fillRect(Xe-1,0,1,Ye),this.canvas=t}update(t){const e=this.context;e.drawImage(this.canvas,0,0,Xe,Ye,-1,0,Xe,Ye),e.fillStyle="#141414",e.fillRect(Xe-1,0,Xe-1,Ye);const s=(1-t)*Ye;e.fillStyle="#E72264",e.fillRect(Xe-1,s,1,Ye-s)}}const Cc=100;class Ew{constructor(){g(this,"measureHash",{})}measureFunction(t,e,s=e){const r=t[e];this.measureHash[s]||(this.measureHash[s]={start:0,count:0,totalTime:0}),t[e]=(...n)=>{this.measureBegin(s);const o=r.call(t,...n);return this.measureEnd(s),o}}measureBegin(t){this.measureHash[t].start=performance.now()}measureEnd(t){const e=this.measureHash[t];e.count>Cc&&(e.totalTime=0,e.count=0),e.lastTime=performance.now()-e.start,e.totalTime+=e.lastTime,e.count++}measureGetAverage(t){const e=this.measureHash[t];return Math.round(e.totalTime/e.count*1e3)/1e3}measureShouldSample(t){return this.measureHash[t].count>=Cc}measureGetLast(t){const e=this.measureHash[t];return Math.round(e.lastTime*1e3)/1e3}}const rn=new Ew;class Pw{constructor(){g(this,"canvas",document.createElement("canvas"));g(this,"domElement",document.createElement("div"));g(this,"measureHash",{});g(this,"active",!1);document.body.appendChild(this.domElement),this.domElement.style.position="absolute",this.domElement.style.top=`${50}px`,this.domElement.style.right=`${10}px`,this.domElement.style.padding="10px",this.domElement.style.width="100px",this.domElement.style.backgroundColor="rgba(255,255,255,0.5)"}measureNumber(t,e,s=e){if(!this.measureHash[s]){const r={label:document.createElement("p"),graph:new Tc,data:{owner:t,value:e}};this.measureHash[s]=r,r.label.style.font=`bold ${9}px Helvetica,Arial,sans-serif`,this.domElement.appendChild(this.measureHash[s].label),this.domElement.appendChild(this.measureHash[s].graph.canvas)}this.active||(this.active=!0,this.update())}measureFunction(t,e,s=e){if(rn.measureFunction(t,e,s),!this.measureHash[s]){const r={label:document.createElement("p"),graph:new Tc};this.measureHash[s]=r,r.label.style.font=`bold ${9}px Helvetica,Arial,sans-serif`,this.domElement.appendChild(this.measureHash[s].label),this.domElement.appendChild(this.measureHash[s].graph.canvas)}this.active||(this.active=!0,this.update())}update(){for(const t in this.measureHash){const e=this.measureHash[t];e.data?(e.label.innerHTML=`${t}: ${e.data.owner[e.data.value]}`,e.graph.update(e.data.owner[e.data.value]?1:0)):rn.measureShouldSample(t)&&(e.label.innerHTML=`${t}: ${rn.measureGetAverage(t)}`,e.graph.update(rn.measureGetAverage(t)*.8))}requestAnimationFrame(()=>{this.update()})}}const Iw=new Pw,ar=function(){let i=0;const t=document.createElement("div");t.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",t.addEventListener("click",function(c){c.preventDefault(),s(++i%t.children.length)},!1);function e(c){return t.appendChild(c.dom),c}function s(c){for(let u=0;u<t.children.length;u++)t.children[u].style.display=u===c?"block":"none";i=c}let r=(performance||Date).now(),n=r,o=0;const a=e(new ar.Panel("FPS","#0ff","#002")),h=e(new ar.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var l=e(new ar.Panel("MB","#f08","#201"));return s(0),{REVISION:16,dom:t,addPanel:e,showPanel:s,begin(){r=(performance||Date).now()},end(){o++;const c=(performance||Date).now();if(h.update(c-r,200),c>=n+1e3&&(a.update(o*1e3/(c-n),100),n=c,o=0,l)){const u=performance.memory;l.update(u.usedJSHeapSize/1048576,u.jsHeapSizeLimit/1048576)}return c},update(){r=this.end()},domElement:t,setMode:s}};ar.Panel=function(i,t,e){let s=1/0,r=0;const n=Math.round,o=n(window.devicePixelRatio||1),a=80*o,h=48*o,l=3*o,c=2*o,u=3*o,d=15*o,f=74*o,_=30*o,m=document.createElement("canvas");m.width=a,m.height=h,m.style.cssText="width:80px;height:48px";const p=m.getContext("2d");return p.font=`bold ${9*o}px Helvetica,Arial,sans-serif`,p.textBaseline="top",p.fillStyle=e,p.fillRect(0,0,a,h),p.fillStyle=t,p.fillText(i,l,c),p.fillRect(u,d,f,_),p.fillStyle=e,p.globalAlpha=.9,p.fillRect(u,d,f,_),{dom:m,update(x,y){s=Math.min(s,x),r=Math.max(r,x),p.fillStyle=e,p.globalAlpha=1,p.fillRect(0,0,a,d),p.fillStyle=t,p.fillText(`${n(x)} ${i} (${n(s)}-${n(r)})`,l,c),p.drawImage(m,u+o,d,f-o,_,u,d,f-o,_),p.fillRect(u+f-o,d,o,_),p.fillStyle=e,p.globalAlpha=.9,p.fillRect(u+f-o,d,o,n((1-x/y)*_))}}};function Mw(i){Iw.measureFunction(i,"render"),Rw(i),kw()}function Rw(i){const t=document.createElement("div");t.style.font=`bold ${9}px Helvetica,Arial,sans-serif`,t.style.position="absolute",t.style.padding="10px",t.style.backgroundColor="#FFFFFF",t.innerHTML=i.type,t.style.top=`${10}px`,t.style.right=`${10}px`,document.body.appendChild(t)}function kw(){const i=new ar;i.dom.style.top=`${10}px`,i.dom.style.left=`${10}px`,document.body.appendChild(i.dom);function t(){i.update(),requestAnimationFrame(t)}t()}const Bw=428,Lw=925,U={content:{width:Bw,height:Lw},debugBody:!1,backgroundTileScale:2,decorEdgePadding:100,decorMinDistance:150,decorCountDesktop:6,decorCountMobile:3,forkMeURL:"https://github.com/pixijs/open-games"};class Ow{constructor(){g(this,"screenView",new R);g(this,"overlayView",new R);g(this,"currentScreen");g(this,"currentScreenResize");g(this,"loadScreen");g(this,"currentOverlay");g(this,"currentOverlayResize");g(this,"_w");g(this,"_h");g(this,"_screenMap",new Map)}init(){Ne.stage.addChild(this.screenView,this.overlayView)}setLoadScreen(t){this.loadScreen=this._getScreen(t)}async showOverlay(t,e){this._showScreen(t,!0,e)}async goToScreen(t,e){this._showScreen(t,!1,e)}async hideOverlay(){this.currentOverlay&&this._removeScreen(this.currentOverlay,!0)}_getScreen(t){let e=this._screenMap.get(t.SCREEN_ID);return e||(e=new t,this._screenMap.set(t.SCREEN_ID,e)),e}async _addScreen(t,e=!1){(e?this.overlayView:this.screenView).addChild(t),t.resize&&(e?this.currentOverlayResize=()=>t.resize:this.currentScreenResize=()=>t.resize,t.resize(this._w,this._h)),t.update&&Ne.ticker.add(t.update,t),t.show&&await t.show()}async _removeScreen(t,e=!1){t.hide&&await t.hide(),e?this.currentOverlayResize&&window.removeEventListener("resize",this.currentOverlayResize):this.currentScreenResize&&window.removeEventListener("resize",this.currentScreenResize),t.update&&Ne.ticker.remove(t.update,t),t.parent&&t.parent.removeChild(t)}async _showScreen(t,e,s){var n,o,a,h;const r=e?this.currentOverlay:this.currentScreen;r&&await this._removeScreen(r),t.assetBundles&&!Cm(t.assetBundles)&&(this.loadScreen&&this._addScreen(this.loadScreen,e),await Fe.loadBundle(t.assetBundles),this.loadScreen&&this._removeScreen(this.loadScreen,e)),e?(this.currentOverlay=this._getScreen(t),(o=(n=this.currentOverlay).prepare)==null||o.call(n,s),await this._addScreen(this.currentOverlay,e)):(this.currentScreen=this._getScreen(t),(h=(a=this.currentScreen).prepare)==null||h.call(a,s),await this._addScreen(this.currentScreen,e))}resize(t,e){var s,r,n,o;this._w=t,this._h=e,(r=(s=this.currentScreen)==null?void 0:s.resize)==null||r.call(s,t,e),(o=(n=this.currentOverlay)==null?void 0:n.resize)==null||o.call(n,t,e)}}const te=new Ow;function gt(i,t,e=!0){const s=Math.random()*(t-i)+i;return e?Math.floor(s):s}function ta(i,t=Math.random){return i[Math.floor(t()*i.length)]}const Fw=["yellow","green","red","blue"],Nw=["bomb","super","timer"],Uw=["red","green","blue"],Sf=13,Dw=.5,Gw=U.content.width/Sf,Vw={yellow:16763458,green:5832494,red:16736095,blue:6583295},P={screenTop:-U.content.height,minHeterogeneity:.5,heterogeneityIncrement:.01,startingLines:10,specialBubbleEvery:3,specialBubbleChance:.1,startingBubbleTypes:Uw,bubbleTypes:Fw,specialBubbleTypes:Nw,bubbleTypeToColor:Vw,bubblesPerLine:Sf,bubbleSize:Gw,bubbleOverflow:Dw,bounceLine:145,maxAimLinesLength:600,maxAimLines:2,newLine:{animInTime:3,urgentAnimInTime:.15,urgentMinLines:8,animInDecrement:.05,maxDecrement:1.5,decrementIn:5},scoreIncrement:10,power:{blastRadius:2,timerFreezeTime:5}};function ri(i){switch(i){case"all":return ta([...P.specialBubbleTypes,...P.bubbleTypes]);case"special":return ta(P.specialBubbleTypes);default:return ta(P.bubbleTypes)}}function _n(i){return P.specialBubbleTypes.includes(i)}var xt={},vi={};Object.defineProperty(vi,"__esModule",{value:!0});vi.Collector=void 0;class $w{constructor(t){this.emit=(...e)=>{t.emitCollecting(this,e)}}}vi.Collector=$w;var Kn={};Object.defineProperty(Kn,"__esModule",{value:!0});Kn.CollectorArray=void 0;const Hw=vi;class zw extends Hw.Collector{constructor(){super(...arguments),this.result=[]}handleResult(t){return this.result.push(t),!0}getResult(){return this.result}reset(){this.result.length=0}}Kn.CollectorArray=zw;var Zn={};Object.defineProperty(Zn,"__esModule",{value:!0});Zn.CollectorLast=void 0;const Ww=vi;class jw extends Ww.Collector{handleResult(t){return this.result=t,!0}getResult(){return this.result}reset(){delete this.result}}Zn.CollectorLast=jw;var Jn={};Object.defineProperty(Jn,"__esModule",{value:!0});Jn.CollectorUntil0=void 0;const Xw=vi;class Yw extends Xw.Collector{constructor(){super(...arguments),this.result=!1}handleResult(t){return this.result=t,this.result}getResult(){return this.result}reset(){this.result=!1}}Jn.CollectorUntil0=Yw;var Qn={};Object.defineProperty(Qn,"__esModule",{value:!0});Qn.CollectorWhile0=void 0;const qw=vi;class Kw extends qw.Collector{constructor(){super(...arguments),this.result=!1}handleResult(t){return this.result=t,!this.result}getResult(){return this.result}reset(){this.result=!1}}Qn.CollectorWhile0=Kw;var to={},eo={};Object.defineProperty(eo,"__esModule",{value:!0});eo.SignalConnectionImpl=void 0;class Zw{constructor(t,e){this.link=t,this.parentCleanup=e}disconnect(){return this.link!==null?(this.link.unlink(),this.link=null,this.parentCleanup(),this.parentCleanup=null,!0):!1}set enabled(t){this.link&&this.link.setEnabled(t)}get enabled(){return this.link!==null&&this.link.isEnabled()}}eo.SignalConnectionImpl=Zw;var io={};Object.defineProperty(io,"__esModule",{value:!0});io.SignalLink=void 0;class Eh{constructor(t=null,e=null,s=0){this.enabled=!0,this.newLink=!1,this.callback=null,this.prev=t??this,this.next=e??this,this.order=s}isEnabled(){return this.enabled&&!this.newLink}setEnabled(t){this.enabled=t}unlink(){this.callback=null,this.next.prev=this.prev,this.prev.next=this.next}insert(t,e){let s=this.prev;for(;s!==this&&!(s.order<=e);)s=s.prev;const r=new Eh(s,s.next,e);return r.callback=t,s.next=r,r.next.prev=r,r}}io.SignalLink=Eh;Object.defineProperty(to,"__esModule",{value:!0});to.Signal=void 0;const Jw=eo,Qw=io;class t1{constructor(){this.head=new Qw.SignalLink,this.hasNewLinks=!1,this.emitDepth=0,this.connectionsCount=0}getConnectionsCount(){return this.connectionsCount}hasConnections(){return this.connectionsCount>0}connect(t,e=0){this.connectionsCount++;const s=this.head.insert(t,e);return this.emitDepth>0&&(this.hasNewLinks=!0,s.newLink=!0),new Jw.SignalConnectionImpl(s,()=>this.decrementConnectionCount())}decrementConnectionCount(){this.connectionsCount--}disconnect(t){for(let e=this.head.next;e!==this.head;e=e.next)if(e.callback===t)return this.decrementConnectionCount(),e.unlink(),!0;return!1}disconnectAll(){for(;this.head.next!==this.head;)this.head.next.unlink();this.connectionsCount=0}emit(...t){this.emitDepth++;for(let e=this.head.next;e!==this.head;e=e.next)e.isEnabled()&&e.callback&&e.callback.apply(null,t);this.emitDepth--,this.unsetNewLink()}emitCollecting(t,e){this.emitDepth++;for(let s=this.head.next;s!==this.head;s=s.next)if(s.isEnabled()&&s.callback){const r=s.callback.apply(null,e);if(!t.handleResult(r))break}this.emitDepth--,this.unsetNewLink()}unsetNewLink(){if(this.hasNewLinks&&this.emitDepth===0){for(let t=this.head.next;t!==this.head;t=t.next)t.newLink=!1;this.hasNewLinks=!1}}}to.Signal=t1;var so={};Object.defineProperty(so,"__esModule",{value:!0});so.SignalConnections=void 0;class e1{constructor(){this.list=[]}add(t){this.list.push(t)}disconnectAll(){for(const t of this.list)t.disconnect();this.list=[]}getCount(){return this.list.length}isEmpty(){return this.list.length===0}}so.SignalConnections=e1;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.SignalConnections=i.Signal=i.CollectorWhile0=i.CollectorUntil0=i.CollectorLast=i.CollectorArray=i.Collector=void 0;var t=vi;Object.defineProperty(i,"Collector",{enumerable:!0,get:function(){return t.Collector}});var e=Kn;Object.defineProperty(i,"CollectorArray",{enumerable:!0,get:function(){return e.CollectorArray}});var s=Zn;Object.defineProperty(i,"CollectorLast",{enumerable:!0,get:function(){return s.CollectorLast}});var r=Jn;Object.defineProperty(i,"CollectorUntil0",{enumerable:!0,get:function(){return r.CollectorUntil0}});var n=Qn;Object.defineProperty(i,"CollectorWhile0",{enumerable:!0,get:function(){return n.CollectorWhile0}});var o=to;Object.defineProperty(i,"Signal",{enumerable:!0,get:function(){return o.Signal}});var a=so;Object.defineProperty(i,"SignalConnections",{enumerable:!0,get:function(){return a.SignalConnections}})})(xt);class i1{constructor(){g(this,"_isMouseIn");g(this,"_isDown");g(this,"onDown");g(this,"onUp");g(this,"onUpOut");g(this,"onOut");g(this,"onPress");g(this,"onHover");this.onPress=new xt.Signal,this.onDown=new xt.Signal,this.onUp=new xt.Signal,this.onHover=new xt.Signal,this.onOut=new xt.Signal,this.onUpOut=new xt.Signal}connectEvents(t){t.on("pointerdown",this.processDown,this),t.on("pointerup",this.processUp,this),t.on("pointerupoutside",this.processUpOut,this),t.on("pointerout",this.processOut,this),t.on("pointertap",this.processPress,this),t.on("pointerover",this.processOver,this)}disconnectEvents(t){t.off("pointerdown",this.processDown,this),t.off("pointerup",this.processUp,this),t.off("pointerupoutside",this.processUpOut,this),t.off("pointerout",this.processOut,this),t.off("pointertap",this.processPress,this),t.off("pointerover",this.processOver,this)}processDown(t){this._isDown=!0,console.log("processDown"),this.onDown.emit(this,t),this.down(t)}processUp(t){this._isDown&&(this.onUp.emit(this,t),this.up(t)),this._isDown=!1}processUpOut(t){this._isDown&&(this.onUp.emit(this,t),this.onUpOut.emit(this,t),this.up(t),this.upOut(t)),this._isDown=!1}processOut(t){this._isMouseIn&&(this._isMouseIn=!1,this.onOut.emit(this,t),this.out(t))}processPress(t){this._isDown=!1,this.onPress.emit(this,t),this.press(t)}processOver(t){hn.any||(this._isMouseIn=!0,this.onHover.emit(this,t),this.hover(t))}down(t){}up(t){}upOut(t){}out(t){}press(t){}hover(t){}get isDown(){return this._isDown}}const Af=(i,t,e=[])=>{const s=Object.getOwnPropertyDescriptors(t);for(let r of e)delete s[r];Object.defineProperties(i,s)},Pr=(i,t=[i])=>{const e=Object.getPrototypeOf(i);return e===null?t:Pr(e,[...t,e])},s1=(...i)=>{if(i.length===0)return;let t;const e=i.map(s=>Pr(s));for(;e.every(s=>s.length>0);){const s=e.map(n=>n.pop()),r=s[0];if(s.every(n=>n===r))t=r;else break}return t},Sc=(i,t,e=[])=>{var s;const r=(s=s1(...i))!==null&&s!==void 0?s:Object.prototype,n=Object.create(r),o=Pr(r);for(let a of i){let h=Pr(a);for(let l=h.length-1;l>=0;l--){let c=h[l];o.indexOf(c)===-1&&(Af(n,c,["constructor",...e]),o.push(c))}}return n.constructor=t,n},qa=i=>i.filter((t,e)=>i.indexOf(t)==e),Ef=new Map,r1=i=>Ef.get(i),n1=(i,t)=>Ef.set(i,t),Ac=(i,t)=>{var e,s;const r=qa([...Object.getOwnPropertyNames(i),...Object.getOwnPropertyNames(t)]),n={};for(let o of r)n[o]=qa([...(e=i==null?void 0:i[o])!==null&&e!==void 0?e:[],...(s=t==null?void 0:t[o])!==null&&s!==void 0?s:[]]);return n},Ec=(i,t)=>{var e,s,r,n;return{property:Ac((e=i==null?void 0:i.property)!==null&&e!==void 0?e:{},(s=t==null?void 0:t.property)!==null&&s!==void 0?s:{}),method:Ac((r=i==null?void 0:i.method)!==null&&r!==void 0?r:{},(n=t==null?void 0:t.method)!==null&&n!==void 0?n:{})}},o1=(i,t)=>{var e,s,r,n,o,a;return{class:qa([...(e=i==null?void 0:i.class)!==null&&e!==void 0?e:[],...(s=t==null?void 0:t.class)!==null&&s!==void 0?s:[]]),static:Ec((r=i==null?void 0:i.static)!==null&&r!==void 0?r:{},(n=t==null?void 0:t.static)!==null&&n!==void 0?n:{}),instance:Ec((o=i==null?void 0:i.instance)!==null&&o!==void 0?o:{},(a=t==null?void 0:t.instance)!==null&&a!==void 0?a:{})}},a1=new Map,h1=(...i)=>{var t;const e=new Set,s=new Set([...i]);for(;s.size>0;)for(let r of s){const n=Pr(r.prototype).map(l=>l.constructor),o=(t=r1(r))!==null&&t!==void 0?t:[],h=[...n,...o].filter(l=>!e.has(l));for(let l of h)s.add(l);e.add(r),s.delete(r)}return[...e]},l1=(...i)=>{const t=h1(...i).map(e=>a1.get(e)).filter(e=>!!e);return t.length==0?{}:t.length==1?t[0]:t.reduce((e,s)=>o1(e,s))};function c1(...i){var t,e,s;const r=i.map(a=>a.prototype);function n(...a){for(const h of i)Af(this,new h(...a))}n.prototype=Sc(r,n),Object.setPrototypeOf(n,Sc(i,null,["prototype"]));let o=n;{const a=l1(...i);for(let h of(t=a==null?void 0:a.class)!==null&&t!==void 0?t:[]){const l=h(o);l&&(o=l)}Pc((e=a==null?void 0:a.static)!==null&&e!==void 0?e:{},o),Pc((s=a==null?void 0:a.instance)!==null&&s!==void 0?s:{},o.prototype)}return n1(o,i),o}const Pc=(i,t)=>{const e=i.property,s=i.method;if(e)for(let r in e)for(let n of e[r])n(t,r);if(s)for(let r in s)for(let n of s[r])n(t,r,Object.getOwnPropertyDescriptor(t,r))};class Pf extends i1{constructor(e){super();g(this,"_view");e&&this.init(e)}init(e){this.view=e,this.enabled=!0}set view(e){const s=!!this._view;s&&this.disconnectEvents(e),this._view=e,this.connectEvents(e),s||(this.enabled=!0)}get view(){return this._view}set enabled(e){if(!this.view){console.error("Button view is not set. Please set it before enabling the button.");return}this.view.eventMode=e?"static":"auto",this.view.cursor=e?"pointer":"default",!e&&this.isDown&&this.processUp()}get enabled(){return this.view.eventMode==="static"}}class rT extends c1(R,Pf){constructor(t){super(),t&&this.init(t)}init(t){this.addChild(t),this.view=t,this.enabled=!0}}function cs(i){return typeof i=="string"?pt.from(i):i}class If extends R{constructor(e,s,r){super();g(this,"_triggerEvents",new Set(["onPress"]));g(this,"innerView");g(this,"_active");g(this,"onChange");this.innerView=new R,this.addChild(this.innerView),this.onChange=new xt.Signal,e&&(this.views=e),s&&(this.triggerEvents=s),r&&this.views.length>0&&(this.active=r),this.setInteractionEvents()}setInteractionEvents(){this.innerView.eventMode="static",this.innerView.on("pointerdown",()=>this.handleEvents("onDown")),this.innerView.on("pointerup",()=>this.handleEvents("onUp")),this.innerView.on("pointerupoutside",()=>this.handleEvents("onUpOut")),this.innerView.on("pointerout",()=>this.handleEvents("onOut")),this.innerView.on("pointertap",()=>this.handleEvents("onPress")),this.innerView.on("pointerover",()=>this.handleEvents("onHover"))}handleEvents(e){this._triggerEvents.has(e)&&this.switch()}get activeView(){if(this.views&&this.views[this.active])return this.views[this.active]}set views(e){this.innerView.removeChildren(),e.forEach(s=>this.add(s))}get views(){return this.innerView.children}add(e){const s=cs(e);this.innerView.addChild(s),s.visible=!1,this.views.length===1&&(this.active=0)}remove(e){this.views[e]&&this.innerView.removeChild(this.views[e])}set triggerEvents(e){this._triggerEvents=new Set(Array.isArray(e)?e:[e])}get triggerEvents(){return Array.from(this._triggerEvents)}switch(e){if(e!==void 0&&e===this.active)return;const s=this.active;if(this.forceSwitch(e),s!==this.active){const r=this.views.length>2?this.active:this.active===1;this.onChange.emit(r)}}forceSwitch(e){if(!(e!==void 0&&e===this.active)){if(this.activeView&&(this.activeView.visible=!1),e!==void 0&&!this.views[e])throw new Error(`View with id ${e} does not exist.`);this._active=e!==void 0?e:this.nextActive,this._active!==void 0&&(this.views[this.active].visible=!0)}}get nextActive(){if(this.views.length!==0)return this.active<this.views.length-1?this.active+1:0}set active(e){this.switch(e)}get active(){return this._active}}function u1(i){return i instanceof mt?i:new mt({text:String(i)})}function Ic(i,t,e=0){let s=t.scale.x,r=t.scale.y;const n=i.width-e*2,o=i.height-e*2,a=n-Math.round(t.width),h=o-Math.round(t.height);a<0&&(s=n/(t.width*s)),h<0&&(r=o/(t.height*r)),(s<=0||r<=0)&&(t.visible=!1),t.scale.set(Math.min(s,r))}/*!
 * tweedle.js - v2.0.1
 * Compiled Tue, 20 Dec 2022 14:21:53 UTC
 *
 * tweedle.js is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 * 
 * Copyright 2019-2021, Milton Candelero <miltoncandelero@gmail.com>, All Rights Reserved
 */let tr;typeof self>"u"&&typeof process<"u"&&process.hrtime?tr=function(){const i=process.hrtime();return i[0]*1e3+i[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?tr=self.performance.now.bind(self.performance):Date.now!==void 0?tr=Date.now:tr=function(){return new Date().getTime()};class we{constructor(){we.prototype.__init.call(this),we.prototype.__init2.call(this),we.prototype.__init3.call(this),we.prototype.__init4.call(this)}__init(){this._tweens={}}static get shared(){return we._shared||(we._shared=new we),we._shared}__init2(){this._paused=!1}isPaused(){return this._paused}pause(){this._paused=!0}resume(){this._paused=!1}__init3(){this._lastUpdateTime=void 0}__init4(){this.now=tr}getAll(){return Object.keys(this._tweens).map(t=>this._tweens[t])}removeAll(){this._tweens={}}add(t){this._tweens[t.getId()]=t}remove(t){delete this._tweens[t.getId()]}update(t,e=!1){if(t==null&&(this._lastUpdateTime==null?(this._lastUpdateTime=this.now(),t=0):t=this.now()-this._lastUpdateTime),this._lastUpdateTime=this.now(),this._paused)return!1;const s=Object.keys(this._tweens);if(s.length==0)return!1;for(let r=0;r<s.length;r++){const n=this._tweens[s[r]];n&&n.update(t,!0)==!1&&!e&&delete this._tweens[s[r]]}return!0}}const mn={Step:{None(i){return i<.5?0:1}},Linear:{None(i){return i}},Quadratic:{In(i){return i*i},Out(i){return i*(2-i)},InOut(i){return(i*=2)<1?.5*i*i:-.5*(--i*(i-2)-1)}},Cubic:{In(i){return i*i*i},Out(i){return--i*i*i+1},InOut(i){return(i*=2)<1?.5*i*i*i:.5*((i-=2)*i*i+2)}},Quartic:{In(i){return i*i*i*i},Out(i){return 1- --i*i*i*i},InOut(i){return(i*=2)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2)}},Quintic:{In(i){return i*i*i*i*i},Out(i){return--i*i*i*i*i+1},InOut(i){return(i*=2)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2)}},Sinusoidal:{In(i){return 1-Math.cos(i*Math.PI/2)},Out(i){return Math.sin(i*Math.PI/2)},InOut(i){return .5*(1-Math.cos(Math.PI*i))}},Exponential:{In(i){return i==0?0:Math.pow(1024,i-1)},Out(i){return i==1?1:1-Math.pow(2,-10*i)},InOut(i){return i==0?0:i==1?1:(i*=2)<1?.5*Math.pow(1024,i-1):.5*(-Math.pow(2,-10*(i-1))+2)}},Circular:{In(i){return 1-Math.sqrt(1-i*i)},Out(i){return Math.sqrt(1- --i*i)},InOut(i){return(i*=2)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1)}},Elastic:{In(i){return i==0?0:i==1?1:-Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI)},Out(i){return i==0?0:i==1?1:Math.pow(2,-10*i)*Math.sin((i-.1)*5*Math.PI)+1},InOut(i){return i==0?0:i==1?1:(i*=2,i<1?-.5*Math.pow(2,10*(i-1))*Math.sin((i-1.1)*5*Math.PI):.5*Math.pow(2,-10*(i-1))*Math.sin((i-1.1)*5*Math.PI)+1)}},Back:{In(i){return i*i*((1.70158+1)*i-1.70158)},Out(i){return--i*i*((1.70158+1)*i+1.70158)+1},InOut(i){const t=2.5949095;return(i*=2)<1?.5*(i*i*((t+1)*i-t)):.5*((i-=2)*i*((t+1)*i+t)+2)}},Bounce:{In(i){return 1-mn.Bounce.Out(1-i)},Out(i){return i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375},InOut(i){return i<.5?mn.Bounce.In(i*2)*.5:mn.Bounce.Out(i*2-1)*.5+.5}}},G={Geom:{Linear(i,t){const e=i.length-1,s=e*t,r=Math.floor(s),n=G.Utils.Linear;return t<0?n(i[0],i[1],s):t>1?n(i[e],i[e-1],e-s):n(i[r],i[r+1>e?e:r+1],s-r)},Bezier(i,t){let e=0;const s=i.length-1,r=Math.pow,n=G.Utils.Bernstein;for(let o=0;o<=s;o++)e+=n(s,o)*r(1-t,s-o)*r(t,o)*i[o];return e},QuadraticBezier(i,t){let e=0;const s=i.length-1;if(t==1)return i[s];const r=Math.pow,n=G.Utils.Bernstein,o=s*t,a=Math.floor(o),h=(o-a)*.5+.5*(a%2),l=a-a%2,c=l+1,u=l+2;return e+=n(2,0)*r(1-h,2-0)*r(h,0)*i[l],e+=n(2,1)*r(1-h,2-1)*r(h,1)*i[c],e+=n(2,2)*r(1-h,2-2)*r(h,2)*i[u],e},CubicBezier(i,t){let e=0;const s=i.length-1;if(t==1)return i[s];const r=Math.pow,n=G.Utils.Bernstein,o=s*t,a=Math.floor(o),h=(o-a)*(1/3)+1/3*(a%3),l=a-a%3,c=l+1,u=l+2,d=l+3;return e+=n(3,0)*r(1-h,3-0)*r(h,0)*i[l],e+=n(3,1)*r(1-h,3-1)*r(h,1)*i[c],e+=n(3,2)*r(1-h,3-2)*r(h,2)*i[u],e+=n(3,3)*r(1-h,3-3)*r(h,3)*i[d],e},CatmullRom(i,t){const e=i.length-1;let s=e*t,r=Math.floor(s);const n=G.Utils.CatmullRom;return i[0]==i[e]?(t<0&&(r=Math.floor(s=e*(1+t))),n(i[(r-1+e)%e],i[r],i[(r+1)%e],i[(r+2)%e],s-r)):t<0?i[0]-(n(i[0],i[0],i[1],i[1],-s)-i[0]):t>1?i[e]-(n(i[e],i[e],i[e-1],i[e-1],s-e)-i[e]):n(i[r?r-1:0],i[r],i[e<r+1?e:r+1],i[e<r+2?e:r+2],s-r)}},Angle:{Radians(i,t){const e=i.length-1,s=e*t,r=Math.floor(s),n=G.Utils.WrapLinear;return t<0?n(i[0],i[1],s,2*Math.PI):t>1?n(i[e],i[e-1],e-s,2*Math.PI):n(i[r],i[r+1>e?e:r+1],s-r,2*Math.PI)},Degrees(i,t){const e=i.length-1,s=e*t,r=Math.floor(s),n=G.Utils.WrapLinear;return t<0?n(i[0],i[1],s,360):t>1?n(i[e],i[e-1],e-s,360):n(i[r],i[r+1>e?e:r+1],s-r,360)}},Color:{RGB(i,t){const e=i.length-1,s=e*t,r=Math.floor(s),n=G.Utils.RGBLinear;return t<0?n(i[0],i[1],s):t>1?n(i[e],i[e-1],e-s):n(i[r],i[r+1>e?e:r+1],s-r)},HSV(i,t){const e=i.length-1,s=e*t,r=Math.floor(s),n=G.Utils.HSVLinear;return t<0?n(i[0],i[1],s):t>1?n(i[e],i[e-1],e-s):n(i[r],i[r+1>e?e:r+1],s-r)},HCL(i,t){const e=i.length-1,s=e*t,r=Math.floor(s),n=G.Utils.HCLLinear;return t<0?n(i[0],i[1],s):t>1?n(i[e],i[e-1],e-s):n(i[r],i[r+1>e?e:r+1],s-r)}},Utils:{RGBsplit(i){const t=i>>24&255,e=i>>16&255,s=i>>8&255,r=i&255;return{a:t,r:e,g:s,b:r}},HSVsplit(i){const t=G.Utils.RGBsplit(i);t.r/=255,t.g/=255,t.b/=255;const e=Math.max(t.r,t.g,t.b),s=Math.min(t.r,t.g,t.b);let r;const n=e,o=e-s,a=e==0?0:o/e;if(e==s)r=0;else{switch(e){case t.r:r=(t.g-t.b)/o+(t.g<t.b?6:0);break;case t.g:r=(t.b-t.r)/o+2;break;case t.b:r=(t.r-t.g)/o+4;break}r/=6}return{a:t.a,h:r,s:a,v:n}},HSVJoin(i){let t,e,s;const r=Math.floor(i.h*6),n=i.h*6-r,o=i.v*(1-i.s),a=i.v*(1-n*i.s),h=i.v*(1-(1-n)*i.s);switch(r%6){case 0:t=i.v,e=h,s=o;break;case 1:t=a,e=i.v,s=o;break;case 2:t=o,e=i.v,s=h;break;case 3:t=o,e=a,s=i.v;break;case 4:t=h,e=o,s=i.v;break;case 5:t=i.v,e=o,s=a;break}return i.a<<24|t<<16|e<<8|s},HCLSplit(i){const s=.530454533953517,r=G.Utils.RGBsplit(i),n={a:r.a,h:0,c:0,l:0};let o=0;const a=Math.min(r.r,Math.min(r.g,r.b)),h=Math.max(r.r,Math.max(r.g,r.b));let l=3/100;return n.c=h-a,n.c!=0&&(o=Math.atan2(r.g-r.b,r.r-r.g)/Math.PI,l*=a/h),l=Math.exp(l),n.h=(o/2-Math.min(o%1,-o%1)/6)%1,n.c*=l,n.l=G.Utils.Linear(-a,h,l)/(s*2),n},HCLJoin(i){const s=.530454533953517,r={a:i.a,r:0,g:0,b:0};if(i.l!=0){let n=i.h;const o=i.c,a=i.l*s,h=Math.exp((1-o/(2*a))*(3/100)),l=(2*a-o)/(2*h-1),c=o/h,u=(n+Math.min(2*n%1/4,-2*n%1/8))*Math.PI*2;let d;n*=6,n<=.999?(d=Math.tan(u),r.r=1,r.g=d/(1+d)):n<=1.001?(r.r=1,r.g=1):n<=2?(d=Math.tan(u),r.r=(1+d)/d,r.g=1):n<=3?(d=Math.tan(u),r.g=1,r.b=1+d):n<=3.999?(d=Math.tan(u),r.g=1/(1+d),r.b=1):n<=4.001?(r.g=0,r.b=1):n<=5?(d=Math.tan(u),r.r=-1/d,r.b=1):(d=Math.tan(u),r.r=1,r.b=-d),r.r=r.r*c+l,r.g=r.g*c+l,r.b=r.b*c+l}return r.a<<24|r.r<<16|r.g<<8|r.b},WrapLinear(i,t,e,s){let r;return i=(i+s*Math.trunc(Math.abs(i/s)))%s,t=(t+s*Math.trunc(Math.abs(t/s)))%s,Math.abs(i-t)<=.5*s?r=G.Utils.Linear(i,t,e):(i<t?r=G.Utils.Linear(i+s,t,e):r=G.Utils.Linear(i,t+s,e),r=r%s),r},RGBLinear(i,t,e){const s=G.Utils.RGBsplit(i),r=G.Utils.RGBsplit(t),n=G.Utils.Linear(s.a,r.a,e),o=G.Utils.Linear(s.r,r.r,e),a=G.Utils.Linear(s.g,r.g,e),h=G.Utils.Linear(s.b,r.b,e);return n<<24|o<<16|a<<8|h},HSVLinear(i,t,e){const s=G.Utils.HSVsplit(i),r=G.Utils.HSVsplit(t);let n;Math.abs(s.h-r.h)<=.5?n=G.Utils.Linear(s.h,r.h,e):(s.h<r.h?n=G.Utils.Linear(s.h+1,r.h,e):n=G.Utils.Linear(s.h,r.h+1,e),n=n%1);const o=G.Utils.Linear(s.s,r.s,e),a=G.Utils.Linear(s.v,r.v,e),h=G.Utils.Linear(s.a,r.a,e);return G.Utils.HSVJoin({a:h,h:n,s:o,v:a})},HCLLinear(i,t,e){const s=G.Utils.HCLSplit(i),r=G.Utils.HCLSplit(t);let n;Math.abs(s.h-r.h)<=.5?n=G.Utils.Linear(s.h,r.h,e):(s.h<r.h?n=G.Utils.Linear(s.h+1,r.h,e):n=G.Utils.Linear(s.h,r.h+1,e),n=n%1);const o=G.Utils.Linear(s.c,r.c,e),a=G.Utils.Linear(s.l,r.l,e),h=G.Utils.Linear(s.a,r.a,e);return G.Utils.HSVJoin({a:h,h:n,s:o,v:a})},Linear(i,t,e){return(t-i)*e+i},Bernstein(i,t){const e=G.Utils.Factorial;return e(i)/e(t)/e(i-t)},Factorial:function(){const i=[1];return function(t){let e=1;if(i[t])return i[t];for(let s=t;s>1;s--)e*=s;return i[t]=e,e}}(),CatmullRom(i,t,e,s,r){const n=(e-i)*.5,o=(s-t)*.5,a=r*r,h=r*a;return(2*t-2*e+n+o)*h+(-3*t+3*e-2*n-o)*a+n*r+t}}};class ro{static __initStatic(){this._nextId=0}static nextId(){return ro._nextId++}}ro.__initStatic();class ot{__init(){this._isPaused=!1}__init2(){this._valuesStart={}}__init3(){this._valuesEnd={}}__init4(){this._valuesStartRepeat={}}__init5(){this._duration=0}__init6(){this._repeatCount=0}__init7(){this._repeat=0}__init8(){this._yoyo=!1}__init9(){this._isPlaying=!1}get _reversed(){return this.yoyo&&this._repeatCount%2!==0}__init10(){this._delayTime=0}__init11(){this._startTime=0}__init12(){this._elapsedTime=0}__init13(){this._timescale=1}__init14(){this._safetyCheckFunction=t=>!0}__init15(){this._easingFunction=mn.Linear.None}__init16(){this._yoyoEasingFunction=void 0}__init17(){this._interpolationFunction=G.Geom.Linear}__init18(){this._chainedTweens=[]}__init19(){this._onStartCallbackFired=!1}__init20(){this._onAfterDelayCallbackFired=!1}__init21(){this._id=ro.nextId()}__init22(){this._isChainStopped=!1}get _group(){return this._groupRef?this._groupRef:we.shared}set _group(t){this._groupRef=t}constructor(t,e){ot.prototype.__init.call(this),ot.prototype.__init2.call(this),ot.prototype.__init3.call(this),ot.prototype.__init4.call(this),ot.prototype.__init5.call(this),ot.prototype.__init6.call(this),ot.prototype.__init7.call(this),ot.prototype.__init8.call(this),ot.prototype.__init9.call(this),ot.prototype.__init10.call(this),ot.prototype.__init11.call(this),ot.prototype.__init12.call(this),ot.prototype.__init13.call(this),ot.prototype.__init14.call(this),ot.prototype.__init15.call(this),ot.prototype.__init16.call(this),ot.prototype.__init17.call(this),ot.prototype.__init18.call(this),ot.prototype.__init19.call(this),ot.prototype.__init20.call(this),ot.prototype.__init21.call(this),ot.prototype.__init22.call(this),this._object=t,this._group=e}getId(){return this._id}getGroup(){return this._group}getTimescale(){return this._timescale}isPlaying(){return this._isPlaying}isPaused(){return this._isPaused}from(t){try{JSON.stringify(t)}catch{throw new Error("The object you provided to the from() method has a circular reference!")}return this._setupProperties(t,this._valuesStart,t,this._valuesStartRepeat,!0),this}to(t,e){try{this._valuesEnd=JSON.parse(JSON.stringify(t))}catch{return console.warn("The object you provided to the to() method has a circular reference!. It can't be cloned. Falling back to dynamic targeting"),this.dynamicTo(t,e)}return e!==void 0&&(this._duration=e),this}dynamicTo(t,e){return this._valuesEnd=t,e!==void 0&&(this._duration=e),this}duration(t){return this._duration=t,this}start(t){return this._isPlaying?this:(t!=null&&(this._delayTime=t),this._group.add(this),this._reversed&&(this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat))),this._repeatCount=0,this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onAfterDelayCallbackFired=!1,this._isChainStopped=!1,this._startTime=-this._delayTime,this._elapsedTime=0,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,!1),this)}restart(t){return this.reset(),this.start(t)}reset(){return this._isPlaying&&this.stop(),this._valuesStart={},this._valuesStartRepeat={},this}rewind(){this._isPlaying&&this.stop(),this._reversed&&this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd);const t=this._easingFunction(0);return this._updateProperties(this._object,this._valuesStart,this._valuesEnd,t),this}_setupProperties(t,e,s,r,n){for(const o in s){const a=t[o],h=Array.isArray(a),l=!Number.isNaN(Number(a)),c=h?"array":typeof a,u=c=="object",d=typeof s[o]=="object",f=!h&&Array.isArray(s[o]);c=="undefined"||c=="function"||s[o]==null||!h&&!l&&!u||((u||h||d)&&a&&!f?(typeof e[o]>"u"&&(e[o]=h?[]:{}),typeof r[o]>"u"&&(r[o]=h?[]:{}),this._setupProperties(a,e[o],s[o],r[o],n)):((typeof e[o]>"u"||n)&&(e[o]=a),(typeof r[o]>"u"||n)&&(f?r[o]=s[o].slice().reverse()[0]:r[o]=e[o]||0)))}}stop(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object,this),this):this}end(t=!1){let e=[];if(t||(e=this._chainedTweens,this._chainedTweens=[]),this.resume(),this.update(1/0),!t){this._chainedTweens=e;for(let s=0,r=this._chainedTweens.length;s<r;s++)this._chainedTweens[s].start()}return this}skip(t,e=!1){return this.resume(),this.update(t*this._duration-(e?this._elapsedTime:0)),this}pause(){return this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._group.remove(this),this)}resume(){return!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._group.add(this),this)}stopChainedTweens(){for(let t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this}startChainedTweens(t=!1){t&&this.stop();for(let e=0,s=this._chainedTweens.length;e<s;e++)this._chainedTweens[e].start();return this}group(t){return this._group=t,this}delay(t){return this._delayTime=t,this}timescale(t){return this._timescale=t,this}repeat(t=1/0){return this._repeat=t,this}repeatDelay(t){return this._repeatDelayTime=t,this}yoyo(t=!0){return this._yoyo=t,this}easing(t){return this._easingFunction=t,this}safetyCheck(t){return this._safetyCheckFunction=t,this}yoyoEasing(t){return this._yoyoEasingFunction=t,this}interpolation(t){return this._interpolationFunction=t,this}chain(...t){return this._chainedTweens=t,this}onStart(t){return this._onStartCallback=t,this}onAfterDelay(t){return this._onAfterDelayCallback=t,this}onUpdate(t){return this._onUpdateCallback=t,this}onRepeat(t){return this._onRepeatCallback=t,this}onComplete(t){return this._onCompleteCallback=t,this}onStop(t){return this._onStopCallback=t,this}update(t,e=!1){const s=this._internalUpdate(t);return!s&&!e&&this._group.remove(this),s}_internalUpdate(t){if(!this._safetyCheckFunction(this._object)||this._isPaused)return!1;t*=this._timescale;let e;this._elapsedTime+=t;const s=this._duration,r=this._startTime+this._elapsedTime;if(r>s&&!this._isPlaying)return!1;this.isPlaying||this.start(),this._onStartCallbackFired==!1&&(this._onStartCallback&&this._onStartCallback(this._object,this),this._onStartCallbackFired=!0),this._onAfterDelayCallbackFired==!1&&r>=0&&(this._onAfterDelayCallback&&this._onAfterDelayCallback(this._object,this),this._onAfterDelayCallbackFired=!0),e=r/this._duration,this._duration==0&&(r>=0?e=1:e=0),e=Math.min(1,e),e=Math.max(0,e);let n=Number.isFinite(r)?r%this._duration:r;Number.isNaN(n)&&(n=0);const o=Math.floor(r/this._duration);let a;if(this._reversed&&this._yoyoEasingFunction?a=this._yoyoEasingFunction(e):a=this._easingFunction(e),this._updateProperties(this._object,this._valuesStart,this._valuesEnd,a),this._onUpdateCallback&&(e!=1||this._repeat-this._repeatCount<=0)&&this._onUpdateCallback(this._object,e,this),e==1){if(this._repeat-this._repeatCount>0){const h=this._repeatCount;if(this._repeatCount=Math.min(this._repeat+1,this._repeatCount+o),this._onUpdateCallback&&(this._repeat-this._repeatCount<0||n<=0)&&this._onUpdateCallback(this._object,e,this),this._yoyo?this._swapEndStartRepeatValues(this._valuesStartRepeat,this._valuesEnd):this._moveForwardStartRepeatValues(this._valuesStartRepeat,this._valuesEnd),this._valuesStart=JSON.parse(JSON.stringify(this._valuesStartRepeat)),this._repeatDelayTime!==void 0?this._startTime=-this._repeatDelayTime:this._startTime=0,this._onRepeatCallback){let l=1;Number.isFinite(o)?l=this._repeatCount-h:Number.isFinite(this._repeat)&&(l=this._repeat-h);for(let c=0;c<l;c++)this._onRepeatCallback(this._object,h+1+c,this)}if(this._elapsedTime=0,this._repeat-this._repeatCount>=0)return n>0&&Number.isFinite(this._repeat)&&this._internalUpdate(n),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object,this);for(let h=0,l=this._chainedTweens.length;h<l;h++)this._chainedTweens[h].start(),n>0&&this._chainedTweens[h].update(n);return this._isPlaying=!1,!1}return!0}_updateProperties(t,e,s,r){for(const n in s){if(e[n]==null)continue;const o=e[n];let a=s[n];const h=Array.isArray(t[n]),l=Array.isArray(a);!h&&l?this._reversed?t[n]=this._interpolationFunction(a.concat([o]),r):t[n]=this._interpolationFunction([o].concat(a),r):typeof a=="object"&&a?this._updateProperties(t[n],o,a,r):(a=this._handleRelativeValue(o,a),typeof a=="number"&&(typeof o=="number"||typeof o=="string")&&(t[n]=Number(o)+(a-Number(o))*r,typeof o=="string"&&(t[n]=String(t[n]))))}}_handleRelativeValue(t,e){return typeof e!="string"?e:e.charAt(0)=="+"||e.charAt(0)=="-"?t+Number(e):Number(e)}_swapEndStartRepeatValues(t,e){for(const s in t){const r=!Array.isArray(t[s])&&Array.isArray(e[s]);if(typeof t[s]=="object")this._swapEndStartRepeatValues(t[s],e[s]);else{const n=t[s];if(typeof e[s]=="string")t[s]=Number(t[s])+Number(e[s]),e[s]=n;else if(r){const o=e[s].slice().reverse();t[s]=o[0],e[s]=o}else t[s]=e[s],e[s]=n}}}_moveForwardStartRepeatValues(t,e){for(const s in t)typeof e[s]=="object"?this._moveForwardStartRepeatValues(t[s],e[s]):typeof e[s]=="string"&&(t[s]=Number(t[s])+Number(e[s]))}}class Fr extends R{constructor({defaultView:e,hoverView:s,pressedView:r,disabledView:n,text:o,padding:a,offset:h,textOffset:l,iconOffset:c,scale:u,anchor:d,anchorX:f,anchorY:_,icon:m,animations:p}){super();g(this,"events");g(this,"animations");g(this,"originalInnerViewState");g(this,"defaultDuration",100);g(this,"padding");g(this,"offset");g(this,"textOffset");g(this,"iconOffset");g(this,"innerView");g(this,"_views",{});g(this,"state");g(this,"anchor");g(this,"onDown");g(this,"onUp");g(this,"onUpOut");g(this,"onOut");g(this,"onPress");g(this,"onHover");this.innerView=new R,this.addChild(this.innerView),this.anchor=new Dt({onUpdate:()=>{this.updateAnchor()}}),this.anchor.set(f??d??0,_??d??0),this.padding=a??0,this.offset=h,this.textOffset=l,this.iconOffset=c,this.scale.set(u??1),p&&(this.animations=p,$c.shared.add(()=>we.shared.update())),this.views={defaultView:e,hoverView:s,pressedView:r,disabledView:n,text:o,icon:m},this.setState("default"),this.addEvents()}set text(e){if(!e||e===0){this.innerView.removeChild(this._views.text),this._views.text=null;return}if(!this._views.text){this.createTextView(e);return}this._views.text.text=e.toString()}get text(){var e;return(e=this._views.text)==null?void 0:e.text}set enabled(e){this.events.enabled=e,this.setState(e?"default":"disabled")}get enabled(){return this.events.enabled}setState(e){if(this.state===e)return;const s=this.getStateView(this.state),r=this.getStateView(e);s&&(s.visible=!1),this.state=e,r&&(this.setOffset(r,e,this.offset),r.visible=!0),this.updateAnchor(),this.playAnimations(e)}createTextView(e){this._views.text||(this._views.text=u1(e),this._views.text.anchor.set(0),this.innerView.addChild(this._views.text)),this.adjustTextView(this.state)}setOffset(e,s,r){const n=r?r[s]:{x:0,y:0},o=r==null?void 0:r.default;n?(e.x+=n.x??0,e.y+=n.y??0):o?(e.x+=o.x??0,e.y+=o.y??0):(r.x||r.y)&&(e.x+=r.x??0,e.y+=r.y??0)}getStateView(e){const{default:s,hover:r,pressed:n,disabled:o}=this._views;switch(e){case"hover":return r??s;case"pressed":return n??r??s;case"disabled":return o??s;case"default":return s;default:return}}adjustTextView(e){if(!this.text)return;const s=this.getStateView(this.state);s&&(Ic(s,this._views.text,this.padding),this._views.text.x=s.x+s.width/2,this._views.text.y=s.y+s.height/2),this._views.text.anchor.set(.5),this.setOffset(this._views.text,e,this.textOffset)}adjustIconView(e){var r;if(!this._views.icon)return;const s=this.getStateView(e);Ic(s,this._views.icon,this.padding),(r=this._views.icon.anchor)==null||r.set(0),this._views.icon.x=s.x+s.width/2-this._views.icon.width/2,this._views.icon.y=s.y+s.height/2-this._views.icon.height/2,this.setOffset(this._views.icon,e,this.iconOffset)}updateAnchor(){const e=this.anchor.x??0,s=this.anchor.y??0;if([this._views.default,this._views.hover,this._views.pressed,this._views.disabled].forEach(n=>{var o;n&&((o=n.anchor)==null||o.set(0),n.x=-n.width*e,n.y=-n.height*s)}),this._views.default){const{x:n,y:o,width:a,height:h}=this._views.default;this.hitArea=new me(n,o,a,h)}this.adjustIconView(this.state),this.adjustTextView(this.state)}set views(e){console.log("_________________________",e);const{defaultView:s,hoverView:r,pressedView:n,disabledView:o,text:a,icon:h}=e;if(s){if(console.log("defaultView",s),this._views.default=cs(s),console.log("this._views.default",this._views.default),this._views.default===void 0)throw new Error(`View ${s} not found`);this.setOffset(this._views.default,"default",this.offset),this._views.default.parent||this.innerView.addChild(this._views.default)}else s===null&&this._views.default&&(this.innerView.removeChild(this._views.default),this._views.default=null);r?(this._views.hover=cs(r),this._views.hover.parent||this.innerView.addChild(this._views.hover),this._views.hover.visible=!1):r===null&&this._views.hover&&(this.innerView.removeChild(this._views.hover),this._views.hover=null),n?(this._views.pressed=cs(n),this._views.pressed.parent||this.innerView.addChild(this._views.pressed),this._views.pressed.visible=!1):n===null&&this._views.pressed&&(this.innerView.removeChild(this._views.pressed),this._views.pressed=null),o?(this._views.disabled=cs(o),this._views.disabled.parent||this.innerView.addChild(this._views.disabled),this._views.disabled.visible=!1):o===null&&this._views.disabled&&(this.innerView.removeChild(this._views.disabled),this._views.disabled=null),h?(this._views.icon=cs(h),this._views.icon.parent||this.innerView.addChild(this._views.icon)):h===null&&this._views.icon&&(this.innerView.removeChild(this._views.icon),this._views.icon=null),a?this.createTextView(a):a===null&&this._views.text&&(this.innerView.removeChild(this._views.text),this._views.text=null)}addEvents(){this.events=new Pf(this),this.onDown=new xt.Signal,this.onUp=new xt.Signal,this.onUpOut=new xt.Signal,this.onOut=new xt.Signal,this.onPress=new xt.Signal,this.onHover=new xt.Signal,this.events.onDown.connect((e,s)=>{this.onDown.emit(this,s),this.down(),this.setState("pressed")}),this.events.onUp.connect((e,s)=>{this.onUp.emit(this,s),this.up(),hn.any?this.setState("default"):this.setState("hover")}),this.events.onUpOut.connect((e,s)=>{this.onUpOut.emit(this,s),this.upOut(),this.setState("default")}),this.events.onOut.connect((e,s)=>{this.onOut.emit(this,s),this.out(),this.events.isDown||this.setState("default")}),this.events.onPress.connect((e,s)=>{this.onPress.emit(this,s),this.press(),hn.any?this.setState("default"):this.setState("hover")}),this.events.onHover.connect((e,s)=>{this.onHover.emit(this,s),this.hover(),this.events.isDown||(hn.any?this.setState("default"):this.setState("hover"))})}playAnimations(e){var r;if(!this.animations)return;if(e==="default"&&!this.originalInnerViewState){this.originalInnerViewState={x:this.innerView.x,y:this.innerView.y,width:this.innerView.width,height:this.innerView.height,scale:{x:this.innerView.scale.x,y:this.innerView.scale.y}};const n=(r=this.animations)==null?void 0:r.default;if(n){this.innerView.x=n.props.x??this.originalInnerViewState.x,this.innerView.y=n.props.y??this.originalInnerViewState.y,this.innerView.width=n.props.width??this.originalInnerViewState.width,this.innerView.height=n.props.height??this.originalInnerViewState.height,this.innerView.scale.x=n.props.scale.x??this.originalInnerViewState.scale.x,this.innerView.scale.y=n.props.scale.y??this.originalInnerViewState.scale.y;return}}const s=this.animations[e]??this.animations.default;if(s){const n=s;this.defaultDuration=n.duration,new ot(this.innerView).to(n.props,n.duration).start();return}new ot(this.innerView).to(this.originalInnerViewState,this.defaultDuration).start()}down(e){}up(e){}upOut(e){}out(e){}press(e){}hover(e){}}const no=i=>({default:{props:{scale:{x:i,y:i}},duration:100},hover:{props:{scale:{x:i*1.1,y:i*1.1}},duration:100},pressed:{props:{scale:{x:i*.9,y:i*.9}},duration:100}}),d1=.75;class Mf extends Fr{constructor(t,e=d1){super({defaultView:"button-flat-small",icon:t,iconOffset:{y:-4},anchor:.5,animations:no(e),scale:e})}press(){ie.play("audio/secondary-button-press.wav",{speed:1.1})}}const f1=.6;class Ka extends Fr{constructor(t){const e=new mt({text:(t==null?void 0:t.text)??"",style:{fill:4835583,fontFamily:"Bungee Regular",fontWeight:"bold",align:"center",fontSize:40,...t==null?void 0:t.textStyle}});super({defaultView:"play-btn-up",pressedView:"play-btn-down",text:e,textOffset:{default:{y:-30},pressed:{y:-15}},anchorX:.5,anchorY:1,scale:f1,...t.buttonOptions})}press(){ie.play("audio/primary-button-press.wav")}}class gi{constructor(t){g(this,"view",new R);g(this,"_shadow");g(this,"_sprite");g(this,"_shine");g(this,"_type");g(this,"_shimmerTimeline");this._sprite=pt.from(t?`bubble-${t}`:H.WHITE),this._sprite.anchor.set(.5),this._sprite.width=P.bubbleSize,this._sprite.height=P.bubbleSize,this._shadow=pt.from("bubble-shadow"),this._shadow.anchor.set(.5),this._shadow.tint=16777215,this._shadow.visible=!!t,this._shadow.width=this._sprite.width*1.1,this._shadow.height=this._sprite.height*1.1,this._shadow.y=(this._shadow.height-this._sprite.height)*1.5,this._sprite.visible=!!t,this._shadow.visible=!!t,this._shine=pt.from("bubble-shine"),this._shine.anchor.set(.5),this._shine.alpha=0,this._shine.visible=!1,this._sprite.addChild(this._shine),this.view.addChild(this._shadow,this._sprite);const e=.1;this._shimmerTimeline=O.timeline({paused:!0}).set(this._shine,{rotation:0,alpha:0}).to(this._shine,{rotation:Math.PI,ease:"power3.out",duration:e}).to(this._shine,{alpha:1,yoyo:!0,repeat:1,onComplete:()=>{this._shine.visible=!1},duration:e*.6},"<"),t&&(this.type=t)}get type(){return this._type}set type(t){this._type=t,this._sprite.texture=H.from(`bubble-${this._type}`),this._sprite.width=P.bubbleSize,this._sprite.height=P.bubbleSize,this._shadow.tint=P.bubbleTypeToColor[t]??6316128,this._sprite.visible=!0,this._shadow.visible=t!=="glow"}shimmer(){return this._shine.rotation=0,this._shine.alpha=0,this._shine.visible=!0,this._shimmerTimeline.play(0)}}const kh=class{constructor(t){g(this,"view",new R);g(this,"_frame");g(this,"_background");g(this,"_mask");g(this,"_bubble");g(this,"_radius");g(this,"_isBubbleSet",!1);t={...kh.DEFAULT_OPTIONS,...t},this._frame=new Es,this._frame.context.circle(0,0,t.size+t.frameWidth).fill(t.frameColor),this.view.addChild(this._frame),this._background=new Br({texture:H.from("background-tile-space"),width:64,height:64}),this._background.anchor.set(.5),this._background.width=this._background.height=t.size*2,this._frame.addChild(this._background),this._mask=new Es(new Wi().circle(0,0,t.size).fill(t.frameColor)),this._background.mask=this._mask,this.view.addChild(this._mask),this._bubble=new gi,this._background.addChild(this._bubble.view),this._radius=this._frame.width*.5}start(){this._setBubble()}stop(){this._setBubble(),O.killTweensOf(this._bubble.view)}_setBubble(){this._isBubbleSet=!0,this._bubble.view.scale.set(gt(.5,1,!1)),this._bubble.type=ri();const t=Math.random()*Math.PI*2,e=this._radius+this._bubble.view.width*.5;this._bubble.view.x=Math.cos(t)*e,this._bubble.view.y=Math.sin(t)*e,O.delayedCall(gt(3,6),this._moveBubble.bind(this))}_moveBubble(){if(!this._isBubbleSet)return;this._isBubbleSet=!1;const t=gt(-Math.PI*.33,Math.PI*.33,!1),e=Math.atan2(this._bubble.view.y,this._bubble.view.x)+t,s=this._radius+this._bubble.view.width*.5,r=-s*Math.cos(e),n=-s*Math.sin(e);O.to(this._bubble.view,{x:r,y:n,duration:gt(2,5),ease:"none",onComplete:this._setBubble.bind(this)})}};let Ss=kh;g(Ss,"DEFAULT_OPTIONS",{frameColor:7763574,frameWidth:10,size:60});const p1={pixiLogoHeader:"Made with",gameTitle:"BUBBO",gameSubtitle:"SPACE MACHINE",titlePlay:"SHOOT BUBBLES!",forkGithub:`Fork me
on Github`,helperMobile:`Hold to aim
Release to shoot!`,helperDesktop:`Move mouse to aim
Left click to shoot!`,paused:"GAME PAUSED",score:"CURRENT SCORE",sound:"Sound",resume:"Resume",quit:"Quit",resultsPlay:"BUB AGAIN",resultsTitle:"YOUR SCORE!",resultsBreakdownTitle:"BUB BREAKDOWN",resultsBreakdownPopped:"Bubbles popped",resultsBreakdownPowerups:"Powerups used",resultsBreakdownCombo:"Best combo",resultsScoreTitle:"FINAL SCORE",resultsHighscoreTitle:"HIGHSCORE"};class _1{constructor(){g(this,"dict",p1)}t(t,e){let s=this.dict[t];if(e){if(typeof e.variation=="number"){const r=/\[(.*?)\]/.exec(s);if(r){const o=r[1].split("|")[e.variation];s=s.replace(r[0],o)}}for(const r in e){const n=new RegExp(`{${r}}`,"g");s=s.replace(n,String(e[r]))}}return s}}const Tt=new _1;class Ph{constructor(){g(this,"view",new R);g(this,"_bubbleView");g(this,"_defaultBubbleScale",2.5);g(this,"_parts",{});g(this,"_type");g(this,"_rotation",0);this._build(),this._bubbleView=new gi,this._bubbleView.view.scale.set(0),this.view.addChild(this._bubbleView.view)}get rotation(){return this._rotation}set rotation(t){this._rotation=t,this._parts["cannon-barrel"].rotation=this._parts["cannon-arrow"].rotation=t}set type(t){if(this._bubbleView.view.scale.set(0),this._type=t,t==="empty"){this._parts["cannon-arrow"].tint=this._parts["cannon-main"].tint=16777215;return}this._parts["cannon-arrow"].tint=this._parts["cannon-main"].tint=P.bubbleTypeToColor[t],this._bubbleView.type=t,O.to(this._bubbleView.view.scale,{x:this._defaultBubbleScale,y:this._defaultBubbleScale,duration:.4,ease:"back.out"})}get type(){return this._type}_build(){((...e)=>{e.forEach(s=>{const r=pt.from(s);r.anchor.set(.5),this._parts[s]=r,this.view.addChild(r)})})("cannon-barrel","cannon-main","cannon-arrow","cannon-top")}}const m1={muted:!1,highscore:0},ea="bubbo-bubbo",se={readyStorage(){localStorage.getItem(ea)||this.setStorage(m1)},getStorage(){const i=localStorage.getItem(ea);return i?JSON.parse(i):void 0},getStorageItem(i){return this.getStorage()[i]},setStorageItem(i,t){const e=this.getStorage();return e&&i in e&&(e[i]=t,this.setStorage(e)),e[i]},setStorage(i){return localStorage.setItem(ea,JSON.stringify(i,void 0,2))}},Mc=.75;class g1 extends Fr{constructor(){const e=se.getStorageItem("muted"),s=new If(["icon-sound-on","icon-sound-off"],[],e?1:0);super({defaultView:s,animations:no(Mc),anchor:.5,scale:Mc});g(this,"_switcher");this._switcher=s}press(){const e=se.getStorageItem("muted");this.forceSwitch(!e),se.setStorageItem("muted",!e),or.muted(!e)}forceSwitch(e){this._switcher.forceSwitch(e?1:0)}}class Rf{constructor(t){g(this,"view",new R);const e=pt.from("pixi-logo");if(e.anchor.set(.5),this.view.addChild(e),t){const s=new mt({text:t,style:{fontSize:20,align:"center"}});s.anchor.set(.5),s.y=-(e.height*.5)-15,this.view.addChild(s)}}}class kf{constructor(){g(this,"view",new R);const t=Tt.t("gameTitle"),e=new mt({text:t,style:{fontSize:90,fontWeight:"900",fontFamily:"Bungee Regular"}});e.anchor.set(.5),this.view.addChild(e);const s=new gi(ri());s.view.position.set(e.width*.5-33.5,7),s.view.scale.set(1.6),e.addChild(s.view);const r=new mt({text:t,style:{fontSize:90,fontWeight:"900",fontFamily:"Bungee Regular"}});r.y=e.height-20,r.anchor.set(.5),this.view.addChild(r);const n=new gi(ri());n.view.position.set(r.width*.5-33.5,7),n.view.scale.set(1.6),r.addChild(n.view);const o=new mt({text:Tt.t("gameSubtitle"),style:{fontSize:32,fontWeight:"900",fontFamily:"Bungee Regular"}});o.anchor.set(.5),o.y=r.y+r.height-30,this.view.addChild(o)}}const ia={};function Bf(i,t,e){ia[i]||(e(),ia[i]=setTimeout(()=>delete ia[i],t))}class Fs extends R{constructor(){super();g(this,"_hitContainer",new R);g(this,"_hitArea");g(this,"_background");g(this,"_title");g(this,"_pixiLogo");g(this,"_cannon");g(this,"_footer");g(this,"_forkBtn");g(this,"_playBtn");g(this,"_audioBtn");g(this,"_portholeOne");g(this,"_portholeTwo");g(this,"_aimAngle");g(this,"_topAnimContainer",new R);g(this,"_midAnimContainer",new R);g(this,"_bottomAnimContainer",new R);this._background=new Br({texture:H.from("background-tile"),width:64,height:64}),this._background.tileScale.set(U.backgroundTileScale),this._background.interactive=!0,this.addChild(this._background),this._hitArea=new me,this._hitContainer.interactive=!0,this._hitContainer.hitArea=this._hitArea,this.addChild(this._hitContainer),this._buildDetails(),this._buildButtons(),this.addChild(this._topAnimContainer,this._midAnimContainer,this._bottomAnimContainer)}prepare(){this._portholeOne.stop(),this._portholeTwo.stop(),O.set(this._topAnimContainer,{y:-350}),O.set(this._midAnimContainer,{x:200}),O.set(this._bottomAnimContainer,{y:350})}async show(){this._hitContainer.on("pointermove",this._calculateAngle.bind(this)),this._hitContainer.on("pointertap",this._calculateAngle.bind(this)),O.killTweensOf(this),this.alpha=0,this._portholeOne.start(),this._portholeTwo.start(),this._audioBtn.forceSwitch(se.getStorageItem("muted")),await O.to(this,{alpha:1,duration:.2,ease:"linear"});const e={x:0,y:0,duration:.75,ease:"elastic.out(1, 0.5)"};O.to(this._topAnimContainer,e),O.to(this._midAnimContainer,e),O.to(this._bottomAnimContainer,e)}async hide(){this._hitContainer.removeAllListeners(),O.killTweensOf(this),await O.to(this,{alpha:0,duration:.2,ease:"linear"}),this._portholeOne.stop(),this._portholeTwo.stop()}resize(e,s){this._background.width=e,this._background.height=s,this._title.view.x=e*.5,this._title.view.y=145,this._pixiLogo.view.x=55,this._pixiLogo.view.y=s-40,this._footer.width=e*1.2,this._footer.x=e*.5,this._footer.y=s,this._forkBtn.x=e-this._pixiLogo.view.x,this._forkBtn.y=this._pixiLogo.view.y+this._forkBtn.height*.5-5,this._audioBtn.x=e-40,this._audioBtn.y=40,this._cannon.view.x=e*.5,this._cannon.view.y=s-this._footer.height*.5,this._playBtn.x=e*.5,this._playBtn.y=this._cannon.view.y-this._cannon.view.height/2-this._playBtn.height/2+10,this._portholeOne.view.x=40,this._portholeOne.view.y=40,this._portholeTwo.view.x=e-40,this._portholeTwo.view.y=this._title.view.y+this._title.view.height+10,this._hitArea.width=e,this._hitArea.height=s-P.bounceLine*.75}_calculateAngle(e){const s=this._cannon.view.getGlobalPosition(),r=Math.atan2(e.global.y-s.y,e.global.x-s.x);Math.abs(this._aimAngle-r)>Math.PI*2e-4&&Bf("cannon-audio",150,()=>{ie.play("audio/cannon-move.wav",{volume:.2})}),this._aimAngle=r,this._cannon.rotation=r+Math.PI*.5}_buildDetails(){this._title=new kf,this._topAnimContainer.addChild(this._title.view);const e=ri();this._footer=new Es,this._footer.context.ellipse(0,0,300,125).fill(P.bubbleTypeToColor[e]),this._bottomAnimContainer.addChild(this._footer),this._cannon=new Ph,this._cannon.view.scale.set(.75),this._cannon.type=e,this._bottomAnimContainer.addChild(this._cannon.view),this._pixiLogo=new Rf,this._pixiLogo.view.scale.set(.35),this._bottomAnimContainer.addChild(this._pixiLogo.view),this._portholeOne=new Ss,this._topAnimContainer.addChild(this._portholeOne.view),this._portholeTwo=new Ss,this._midAnimContainer.addChild(this._portholeTwo.view)}_buildButtons(){this._forkBtn=new Ka({text:Tt.t("forkGithub"),textStyle:{fill:15277667,fontFamily:"Opensans Semibold",fontWeight:"bold",align:"center",fontSize:16},buttonOptions:{defaultView:"pixi-btn-up",pressedView:"pixi-btn-down",textOffset:{default:{y:-13},pressed:{y:-8}}}}),this._forkBtn.onPress.connect(()=>{var e;(e=window.open(U.forkMeURL,"_blank"))==null||e.focus()}),this._bottomAnimContainer.addChild(this._forkBtn),this._audioBtn=new g1,this._topAnimContainer.addChild(this._audioBtn),this._playBtn=new Ka({text:Tt.t("titlePlay")}),this._playBtn.onPress.connect(()=>{te.goToScreen(Mr)}),this._bottomAnimContainer.addChild(this._playBtn)}}g(Fs,"SCREEN_ID","title"),g(Fs,"assetBundles",["images/title-screen"]);class sa{constructor(t,e){g(this,"view",new R);g(this,"_statNameText");g(this,"_statValueText");this._statNameText=new mt({text:t,style:{fontSize:18,fontWeight:"100",fontFamily:"Opensans Semibold",fill:0,align:"left"}}),this._statNameText.anchor.set(0,.5),this._statNameText.x=-e*.5,this._statValueText=new mt({text:"1000",style:{fontSize:18,fontWeight:"100",fontFamily:"Opensans Semibold",fill:0,align:"right"}}),this._statValueText.x=e*.5,this._statValueText.anchor.set(1,.5),this.view.addChild(this._statNameText,this._statValueText)}updateValue(t){if(t>99999999999){this._statValueText.text="9999999999+";return}this._statValueText.text=t}}class y1{constructor(){g(this,"view",new R);g(this,"_base");g(this,"_bubblesPoppedStat");g(this,"_powerupsUsedStat");g(this,"_comboStat");g(this,"_scoreText");g(this,"_highscoreText");g(this,"_maxScoreWidth",0);this._base=pt.from("panel-end-screen-base"),this._base.anchor.set(.5);const t=new mt({text:Tt.t("resultsTitle"),style:{fontSize:30,fontWeight:"900",fontFamily:"Bungee Regular",fill:0,align:"center"}});t.anchor.set(.5),t.y=-(this._base.height*.5)+27,this._base.addChild(t),this._buildBreakdownPanel(),this._highscoreText=this._buildSubPanel({yOffset:-175,title:Tt.t("resultsHighscoreTitle"),alpha:.4}),this._scoreText=this._buildSubPanel({yOffset:200,title:Tt.t("resultsScoreTitle")}),this.view.addChild(this._base)}updateData(t){for(this._bubblesPoppedStat.updateValue(t.popped),this._comboStat.updateValue(t.combo),this._powerupsUsedStat.updateValue(t.powerups),this._scoreText.text=t.score,this._scoreText.style.fontSize=60;this._scoreText.width>this._maxScoreWidth;)this._scoreText.style.fontSize--;for(this._highscoreText.text=t.highscore,this._highscoreText.style.fontSize=60;this._highscoreText.width>this._maxScoreWidth;)this._highscoreText.style.fontSize--}_buildBreakdownPanel(){const t=pt.from("panel-end-screen-points-breakdown");t.anchor.set(.5),t.y=15;const e=new mt({text:Tt.t("resultsBreakdownTitle"),style:{fontSize:16,fontWeight:"900",fontFamily:"Bungee Regular",fill:0,align:"center"}});t.alpha=.4,e.anchor.set(.5),e.y=-(t.height*.5)+e.height*.5+2;const s=new R;s.y=t.y;const r=10,n=30;this._bubblesPoppedStat=new sa(Tt.t("resultsBreakdownPopped"),t.width*.9),this._bubblesPoppedStat.view.y=r-n,this._comboStat=new sa(Tt.t("resultsBreakdownCombo"),t.width*.9),this._comboStat.view.y=r,this._powerupsUsedStat=new sa(Tt.t("resultsBreakdownPowerups"),t.width*.9),this._powerupsUsedStat.view.y=r+n,s.addChild(e,this._bubblesPoppedStat.view,this._powerupsUsedStat.view,this._comboStat.view),this._base.addChild(t,s)}_buildSubPanel(t){const e=pt.from("panel-end-screen-points-total");e.anchor.set(.5),t.alpha&&(e.alpha=t.alpha),e.y=t.yOffset,this._maxScoreWidth=e.width*.8;const s=new R;s.y=t.yOffset;const r=new mt({text:t.title,style:{fontSize:22,fontWeight:"900",fontFamily:"Bungee Regular",fill:0,align:"center"}});r.anchor.set(.5),r.y=-(e.height*.5)+r.height*.5+3;const n=new mt({text:"",style:{fontSize:50,fontWeight:"900",fontFamily:"Bungee Regular",fill:0,align:"center"}});return n.anchor.set(.5),n.y=10,s.addChild(r,n),this._base.addChild(e,s),n}}class Za extends R{constructor(){super();g(this,"_background");g(this,"_porthole");g(this,"_resultsPanel");g(this,"_footer");g(this,"_playBtn");g(this,"_backBtn");this._background=new Br({texture:H.from("background-tile"),width:64,height:64}),this._background.tileScale.set(U.backgroundTileScale),this.addChild(this._background),this._buildDetails(),this._buildButtons(),this._resultsPanel=new y1,this._resultsPanel.view.scale.set(.95),this.addChild(this._resultsPanel.view)}prepare(e){this._resultsPanel.updateData(e)}async show(){O.killTweensOf(this),this.alpha=0,this._porthole.start(),await O.to(this,{alpha:1,duration:.2,ease:"linear"})}async hide(){O.killTweensOf(this),await O.to(this,{alpha:0,duration:.2,ease:"linear"}),this._porthole.stop()}resize(e,s){this._background.width=e,this._background.height=s,this._footer.width=e*1.2,this._footer.x=e*.5,this._footer.y=s+25,this._porthole.view.x=40,this._porthole.view.y=80,this._playBtn.x=e*.5,this._playBtn.y=s-this._playBtn.height+5,this._backBtn.x=50,this._backBtn.y=s-50,this._resultsPanel.view.x=e*.5,this._resultsPanel.view.y=s*.5-85}_buildDetails(){this._porthole=new Ss,this.addChild(this._porthole.view),this._footer=new Es,this._footer.context.ellipse(0,0,300,125).fill(P.bubbleTypeToColor[ri()]),this.addChild(this._footer)}_buildButtons(){this._playBtn=new Ka({text:Tt.t("resultsPlay")}),this._playBtn.onPress.connect(()=>{te.goToScreen(Mr)}),this._backBtn=new Mf("icon-back",1),this._backBtn.onPress.connect(()=>{te.goToScreen(Fs)}),this.addChild(this._playBtn,this._backBtn)}}g(Za,"SCREEN_ID","result"),g(Za,"assetBundles",["images/results-screen"]);const Rc={score:0,highscore:0,bubblesPopped:0,bestCombo:0,powerupsUsed:0};class b1{constructor(){g(this,"_stats",{...Rc});this.set("highscore",se.getStorageItem("highscore"))}set(t,e){return this._stats[t]=e,this.get(t)}get(t){return t?this._stats[t]:this._stats}increment(t,e=1){return typeof this._stats[t]=="number"?this._stats[t]+=e:console.warn(`Cannot increment non-number stat: ${t}`),this.get(t)}reset(){this._stats={...Rc}}}class x1{constructor(t){g(this,"_game");g(this,"allSystems",new Map);g(this,"_width");g(this,"_height");this._game=t}add(t){var r;const e=t.SYSTEM_ID;if(!e)throw new Error("[SystemManager]: cannot add System without name");if(this.allSystems.has(e))return this.allSystems.get(e);const s=new t;return s.game=this._game,this._width&&this._height&&((r=s.resize)==null||r.call(s,this._width,this._height)),this.allSystems.set(t.SYSTEM_ID,s),s}get(t){return this.allSystems.get(t.SYSTEM_ID)}init(){this.allSystems.forEach(t=>{var e;return(e=t.init)==null?void 0:e.call(t)})}awake(){this.allSystems.forEach(t=>{var e;return(e=t.awake)==null?void 0:e.call(t)})}start(){this.allSystems.forEach(t=>{var e;return(e=t.start)==null?void 0:e.call(t)})}update(t){this.allSystems.forEach(e=>{var s;return(s=e.update)==null?void 0:s.call(e,t)})}end(){this.allSystems.forEach(t=>{var e;return(e=t.end)==null?void 0:e.call(t)})}reset(){this.allSystems.forEach(t=>{var e;return(e=t.reset)==null?void 0:e.call(t)})}resize(t,e){this.allSystems.forEach(s=>{var r;return(r=s.resize)==null?void 0:r.call(s,t,e)})}}class v1{constructor(t){g(this,"Ctor");g(this,"list",[]);this.Ctor=t}get(){return this.list.pop()??new this.Ctor}return(t){this.list.includes(t)||this.list.push(t)}}class w1{constructor(){g(this,"map",new Map)}get(t){let e=this.map.get(t);return e||(e=new v1(t),this.map.set(t,e)),e.get()}return(t){const e=this.map.get(t.constructor);e&&e.return(t)}}const Lt=new w1;class T1{constructor(){g(this,"view",new R);g(this,"_bubbleView");g(this,"_defaultBubbleScale",2);g(this,"_type");g(this,"_base");this._base=pt.from("bubble-reserve-base"),this._base.anchor.set(.5),this._base.scale.set(.9),this.view.addChild(this._base);const t=pt.from("bubble-reserve-ring");t.anchor.set(.5),t.scale.set(.85),t.y-=2,this._base.addChild(t),this._bubbleView=new gi,this._bubbleView.view.scale.set(0),t.addChild(this._bubbleView.view)}get type(){return this._type}set type(t){if(this._bubbleView.view.scale.set(0),this._type=t,t==="empty"){this._base.tint=16777215;return}this._bubbleView.type=t,this._base.tint=P.bubbleTypeToColor[t],O.to(this._bubbleView.view.scale,{x:this._defaultBubbleScale,y:this._defaultBubbleScale,duration:.4,ease:"back.out"})}}class $i{constructor(t,e){g(this,"x");g(this,"y");this.x=t||0,this.y=e||0}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}clone(){return new $i(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return kc.set(t,t),Bc.set(e,e),this.clamp(kc,Bc)}clampLength(t,e){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(t,Math.min(e,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){let t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,s=this.y-t.y;return e*e+s*s}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,s){return this.subVectors(e,t).multiplyScalar(s).add(t)}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e){return e===void 0&&(e=0),this.x=t[e],this.y=t[e+1],this}toArray(t,e){return t===void 0&&(t=[]),e===void 0&&(e=0),t[e]=this.x,t[e+1]=this.y,t}rotateAround(t,e){const s=Math.cos(e),r=Math.sin(e),n=this.x-t.x,o=this.y-t.y;return this.x=n*s-o*r+t.x,this.y=n*r+o*s+t.y,this}}const kc=new $i,Bc=new $i;var Hi=(i=>(i[i.STATIC=0]="STATIC",i[i.DYNAMIC=1]="DYNAMIC",i[i.KINEMATIC=2]="KINEMATIC",i))(Hi||{});class Ih{constructor(){g(this,"UID",0);g(this,"radius",P.bubbleSize/2);g(this,"mass",20);g(this,"position",new $i);g(this,"velocity",new $i);g(this,"damping",.6);g(this,"bounces",0);g(this,"maxBounces",1);g(this,"_force",new $i);g(this,"_state",0)}applyForce(t,e){this.state!==0&&(this._force.set(t,e),this.velocity.add(this._force.divideScalar(this.mass)))}zeroVelocity(){this._force.setScalar(0),this.velocity.setScalar(0)}reset(){this._force.set(0,0),this.position.set(0,0),this.velocity.set(0,0),this.state=0,this.bounces=0}get state(){return this._state}set state(t){t===0&&this.zeroVelocity(),this._state=t}get x(){return this.position.x}set x(t){this.position.x=t}get y(){return this.position.y}set y(t){this.position.y=t}}g(Ih,"GRAVITY",9.8*(1/60));const Lf={isMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Windows Phone|Opera Mini/i.test(navigator.userAgent)}};class C1{constructor(){g(this,"view",new R);const t=pt.from("panel-small-instructions");t.anchor.set(.5),t.scale.set(.75);const e=Tt.t(Lf.isMobileDevice()?"helperMobile":"helperDesktop"),s=new mt({text:e,style:{fontSize:19,fontWeight:"900",fontFamily:"Opensans Semibold",fill:0,align:"center"}});s.anchor.set(.5),s.x=-75,t.addChild(s),this.view.addChild(t)}prepare(){this.view.x=this._offScreenPos}show(){return O.to(this.view,{x:0,duration:1,delay:.5,ease:"back.out(1)"})}hide(){return O.to(this.view,{x:this._offScreenPos})}get _offScreenPos(){return-(U.content.width*.5)-this.view.width*.5}}class S1{constructor(){g(this,"view",new R);g(this,"_line");g(this,"_glow");g(this,"_targetAlpha",1);g(this,"_alphaDirection",1);g(this,"_alphaSpeed",.2);g(this,"_minAlpha",.2);g(this,"_maxAlpha",.5);g(this,"_pulseAlpha",1);g(this,"_isPulsing",!1);this._line=new us(H.from("laser-line")),this._line.height-=12,this._line.pivot.y=this._line.height*.5-6,this._line.width=U.content.width,this._glow=pt.from("laser-line-glow"),this._glow.anchor.set(.5),this._glow.x=this._line.width*.5,this.view.addChild(this._glow,this._line),this._glow.alpha=.25}update(t){this._isPulsing||(this._targetAlpha+=t/60*(this._alphaDirection*this._alphaSpeed),this._targetAlpha<=this._minAlpha?(this._targetAlpha=this._minAlpha,this._alphaDirection=1):this._targetAlpha>=this._maxAlpha&&(this._targetAlpha=this._maxAlpha,this._alphaDirection=-1),this._glow.alpha=this._targetAlpha)}pulse(){this._isPulsing=!0,this._glow.alpha=this._pulseAlpha,O.killTweensOf(this._glow),O.to(this._glow,{alpha:this._targetAlpha,delay:.2,onComplete:()=>{this._isPulsing=!1}})}}class Lc{constructor(){g(this,"view",new R);g(this,"_pointText");g(this,"_tint");this._tint=16777215,this._pointText=new mt({text:"",style:{fontSize:40,fontWeight:"900",fontFamily:"Bungee Regular",fill:this._tint,stroke:{color:0,width:3},align:"center"}}),this._pointText.anchor.set(.5),this.view.addChild(this._pointText)}popScore(t,e){this.view.alpha=0,this._pointText.text=t;const s=U.content.width*.5-this._pointText.width*.5;return this.view.x=Math.min(Math.max(this.view.x,-s),s),O.to(this.view,{y:this.view.y-gt(15,120),alpha:1,duration:.25,onComplete:()=>{O.to(this.view,{alpha:0,onComplete:()=>e==null?void 0:e(this)})}})}get tint(){return this._tint}set tint(t){this._tint=t,this._pointText.style.fill=t??16777215}}class A1{constructor(){g(this,"view",new R);g(this,"_base");g(this,"_scoreText");this._base=pt.from("info-bg"),this._base.anchor.y=.5,this._base.scale.set(.75),this.view.addChild(this._base),this._scoreText=new mt({text:"",style:{fontSize:40,fontWeight:"900",fontFamily:"Bungee Regular",fill:0,stroke:{color:16777215,width:5},align:"left"}}),this._scoreText.x=20,this._scoreText.anchor.y=.5,this._base.addChild(this._scoreText),this.setScore(0)}async setScore(t){this._scoreText.text=t.toLocaleString(),this._scoreText.style.fontSize=30,this._scoreText.style.update()}}function Oc(i){const t=window.location.search;return new URLSearchParams(t).get(i)}function Mh(i,t){return~i.indexOf(t)&&i.splice(i.indexOf(t),1),i}function E1(i,t){for(let e=i.length-1;e>=0;--e){const s=i[e];t==null||t(s),Mh(i,s)}return i}const Fc=.75;class P1 extends Fr{constructor(){const e=se.getStorageItem("muted"),s=new If(["icon-sound-on","icon-sound-off"],[],e?1:0);s.scale.set(.95);const r=new mt({text:Tt.t("sound"),style:{fill:"black",fontFamily:"Bungee Regular",fontWeight:"bold",align:"center",fontSize:40}});super({defaultView:"button-flat",icon:s,iconOffset:{x:90},anchor:.5,text:r,textOffset:{default:{x:-30}},animations:no(Fc),scale:Fc});g(this,"_switcher");this._switcher=s}press(){const e=se.setStorageItem("muted",!se.getStorageItem("muted"));this.forceSwitch(e),or.muted(e),e||ie.play("audio/secondary-button-press.wav")}forceSwitch(e){this._switcher.forceSwitch(e?1:0)}}const Nc=.75;class Uc extends Fr{constructor(t){const e=new mt({text:(t==null?void 0:t.text)??"",style:{fill:0,fontFamily:"Bungee Regular",fontWeight:"bold",align:"center",fontSize:40,...t==null?void 0:t.textStyle}});super({defaultView:"button-flat",anchor:.5,text:e,animations:no(Nc),scale:Nc,...t==null?void 0:t.buttonOptions}),t!=null&&t.tint&&(this.children[0].tint=t.tint)}press(){ie.play("audio/secondary-button-press.wav")}}class I1{constructor(){g(this,"view",new R);g(this,"_base");g(this,"_titleText");g(this,"_scoreTitleText");g(this,"_scoreText");this._base=pt.from("images/pause-overlay/pause-panel.png"),this._base.anchor.set(.5),this.view.addChild(this._base),this._titleText=new mt({text:Tt.t("paused"),style:{fontSize:30,fontWeight:"900",fontFamily:"Bungee Regular",fill:16777215,align:"center"}}),this._titleText.anchor.set(.5),this._titleText.y=-(this._base.height*.5)+50,this._base.addChild(this._titleText),this._scoreTitleText=new mt({text:Tt.t("score"),style:{fontSize:20,fontWeight:"900",fontFamily:"Bungee Regular",fill:0,align:"center"}}),this._scoreTitleText.anchor.set(.5),this._scoreTitleText.y=-82,this._base.addChild(this._scoreTitleText),this._scoreText=new mt({text:"",style:{fontSize:60,fontWeight:"900",fontFamily:"Bungee Regular",fill:0,align:"center"}}),this._scoreText.anchor.set(.5),this._scoreText.y=-37,this._base.addChild(this._scoreText)}setScore(t){for(this._scoreText.text=t.toLocaleString(),this._scoreText.style.fontSize=60;this._scoreText.width>this._base.width;)this._scoreText.style.fontSize--}}class Ja extends R{constructor(){super();g(this,"_background");g(this,"_panel");g(this,"_audioBtn");g(this,"_resumeBtn");g(this,"_quitBtn");g(this,"_callBack");this._background=new Es,this._background.context.rect(0,0,50,50).fill({color:0,alpha:.5}),this._background.interactive=!0,this.addChild(this._background),this._panel=new I1,this.addChild(this._panel.view),this._buildButtons()}prepare(e){this._panel.setScore((e==null?void 0:e.score)??0),this._callBack=e.callback,this._audioBtn.forceSwitch(se.getStorageItem("muted"))}async show(){O.killTweensOf(this),this.alpha=0,await O.to(this,{alpha:1,duration:.2,ease:"linear"})}async hide(){O.killTweensOf(this),await O.to(this,{alpha:0,duration:.2,ease:"linear"})}resize(e,s){this._background.width=e,this._background.height=s,this._panel.view.x=e*.5,this._panel.view.y=s*.5}_buildButtons(){this._audioBtn=new P1,this._panel.view.addChild(this._audioBtn),this._audioBtn.y=50,this._resumeBtn=new Uc({text:Tt.t("resume"),tint:16761900}),this._resumeBtn.onPress.connect(()=>{var e;(e=this._callBack)==null||e.call(this,"resume")}),this._resumeBtn.y=this._audioBtn.y+60,this._panel.view.addChild(this._resumeBtn),this._quitBtn=new Uc({text:Tt.t("quit"),tint:4835583}),this._quitBtn.onPress.connect(()=>{var e;(e=this._callBack)==null||e.call(this,"quit")}),this._panel.view.addChild(this._quitBtn),this._quitBtn.y=this._resumeBtn.y+60}}g(Ja,"SCREEN_ID","pause"),g(Ja,"assetBundles",["images/pause-overlay"]);class ce{constructor(){g(this,"game");g(this,"isPaused",!1);g(this,"_tweenList",[]);g(this,"_visibilityPauseBound")}start(){this._visibilityPauseBound=this._visibilityPause.bind(this),document.addEventListener("visibilitychange",this._visibilityPauseBound)}update(){this.isPaused&&this._tweenList.forEach(t=>{t.totalProgress()>=1&&this.removeTween(t)})}end(){document.removeEventListener("visibilitychange",this._visibilityPauseBound)}reset(){this.isPaused=!1,this._tweenList.forEach(t=>{t.kill()}),this._tweenList.length=0}addTween(t){return this._tweenList.push(t),t}removeTween(t){return Mh(this._tweenList,t),t}pause(){this.isPaused=!0,te.showOverlay(Ja,{score:this.game.stats.get("score"),callback:this._pauseCallback.bind(this)}),this._tweenList.forEach(t=>{t.pause()})}resume(){this.isPaused=!1,this._tweenList.forEach(t=>{t.resume()})}_visibilityPause(){document.visibilityState!=="visible"&&(this.isPaused||this.pause())}async _pauseCallback(t){await te.hideOverlay(),t==="resume"?this.resume():te.goToScreen(Fs)}}g(ce,"SYSTEM_ID","pause");class qi{constructor(){g(this,"game");g(this,"view",new R);g(this,"cannonContainer",new R);g(this,"_decorContainer",new R);g(this,"_gameHudContainer",new R);g(this,"_laserLine");g(this,"_topTray");g(this,"_roundedTray");g(this,"_hiddenTitle");g(this,"_bottomTray");g(this,"_leftBorder");g(this,"_rightBorder");g(this,"_pauseButton");g(this,"_scoreCounter");g(this,"_helperPanel");g(this,"_mask");g(this,"_hasShownHelper",!1);g(this,"_toasterList",[]);g(this,"_height");g(this,"_topTrayOffsetRatio",0)}init(){this.view.addChild(this._gameHudContainer,this._decorContainer),this.game.stage.addChild(this.view),this._laserLine=new S1,this._laserLine.view.y=-P.bounceLine,this._laserLine.view.x=-U.content.width*.5,this._topTray=new us(H.from("top-tray")),this._topTray.x=-U.content.width*.5,this._topTray.width=U.content.width,this._topTray.interactive=!0,this._roundedTray=pt.from("rounded-tray"),this._roundedTray.anchor.set(.5),this._hiddenTitle=new kf,this._hiddenTitle.view.scale.set(.85),this._hiddenTitle.view.y-=55,this._roundedTray.addChild(this._hiddenTitle.view),this._bottomTray=new us(H.from("bottom-tray")),this._bottomTray.height=P.bounceLine-30,this._bottomTray.pivot.y=this._bottomTray.height,this._bottomTray.x-=U.content.width*.5,this._bottomTray.width=U.content.width,this._scoreCounter=new A1,this._leftBorder=new us(H.from("game-side-border")),this._leftBorder.x=-(U.content.width*.5)-this._leftBorder.width,this._rightBorder=new us(H.from("game-side-border")),this._rightBorder.x=U.content.width*.5;const t=this.game.systems.get(ce);this._pauseButton=new Mf("icon-pause"),this._pauseButton.onPress.connect(()=>{t.pause()}),this._pauseButton.x=U.content.width*.5-40,this._pauseButton.y=-U.content.height+37,this._mask=new Es,this._mask.context.rect(-U.content.width*.5,-U.content.height,U.content.width,U.content.height).fill(197408),this._helperPanel=new C1,this._helperPanel.view.y=-U.content.height+200,this._decorContainer.addChild(this._mask,this._leftBorder,this._rightBorder,this._topTray,this._roundedTray),this._gameHudContainer.addChild(this._bottomTray,this._scoreCounter.view,this._laserLine.view,this._helperPanel.view,this.cannonContainer,this._pauseButton),this._gameHudContainer.mask=this._mask,this.game.systems.get(Ns).signals.onCannonFire.connect(e=>{e&&this.game.systems.get(ce).addTween(this._helperPanel.hide())})}awake(){this._helperPanel.prepare(),this._topTrayOffsetRatio=0,this._updateTopTrayHeight(),this._gameHudContainer.visible=!0}start(){this._hasShownHelper||(this.game.systems.get(ce).addTween(this._helperPanel.show()),this._hasShownHelper=!0)}closeHud(){return this.game.systems.get(ce).addTween(O.to(this,{_topTrayOffsetRatio:1,duration:2,ease:"bounce.out",onUpdate:()=>{this._updateTopTrayHeight()},onComplete:()=>{this._gameHudContainer.visible=!1}}))}updateScore(t,e,s){const r=Lt.get(Lc);r.view.x=s.x,r.view.y=this._laserLine.view.y,r.tint=P.bubbleTypeToColor[s.type],this._toasterList.push(r),this.game.systems.get(ce).addTween(r.popScore(t,this._killToaster.bind(this))),this.view.addChild(r.view),this._scoreCounter.setScore(e)}lineImpact(){this._laserLine.pulse()}update(t){this._laserLine.update(t)}reset(){this._scoreCounter.setScore(0),E1(this._toasterList,t=>{t.view.removeFromParent()})}resize(t,e){this.view.x=t*.5,this.view.y=e,this._height=e,this._updateTopTrayHeight(),this._leftBorder.y=-e,this._leftBorder.height=e,this._rightBorder.y=-e,this._rightBorder.height=e,this._scoreCounter.view.x=U.content.width*.5-this._scoreCounter.view.width-30,this._scoreCounter.view.y=-70}_updateTopTrayHeight(){const t=this._height-U.content.height;this._topTray.height=t+this._topTrayOffsetRatio*U.content.height,this._topTray.y=-this._height,this._roundedTray.scale.set(1);const e=this._topTray.height/this._roundedTray.height;this._roundedTray.visible=e>.9,this._roundedTray.scale.set(Math.min(e,1)),this._roundedTray.y=this._topTray.y+this._topTray.height-this._topTray.height*.5}_killToaster(t){Mh(this._toasterList,t),t.view.removeFromParent(),Lt.return(Lc)}}g(qi,"SYSTEM_ID","hud");function Of(i){return Math.sqrt(i.x*i.x+i.y*i.y)}function M1(i,t){return Of({x:i.x-t.x,y:i.y-t.y})}function Ff(i,t){return{x:i.x*t,y:i.y*t}}function R1(i){const t=Of(i);return Ff(i,1/t)}function k1(i,t){return{x:i.x-t.x,y:i.y-t.y}}class Nf{constructor(){g(this,"i");g(this,"j")}get defaultX(){return(this.i+1)*(P.bubbleSize/2)}get defaultY(){return-this.j*P.bubbleSize}}let B1=0;class L1 extends Nf{constructor(){super();g(this,"UID");g(this,"view",new R);g(this,"bubbleView");g(this,"body",new Ih);g(this,"dropGroupId");g(this,"_type");this.bubbleView=new gi,this.view.addChild(this.bubbleView.view)}reset(){this.UID=this.body.UID=B1++,this.body.reset(),this.i=this.j=-1,this.dropGroupId=0}connect(e,s){this.i=e,this.j=s,this.body.state=Hi.STATIC}drop(){O.killTweensOf(this),this.body.state=Hi.DYNAMIC,this.body.applyForce(gt(-30,30),gt(-20,0))}bounce(){ie.play("audio/bubble-land-sfx.wav",{speed:gt(.8,1.1,!1)}),this.bubbleView.type="glow",this.body.bounces++,this.body.y-=this.body.velocity.y,this.body.velocity.y=-Math.abs(this.body.velocity.y*this.body.damping)}impact(e){return O.to(this.bubbleView.view,{x:e.x,y:e.y,duration:.075,yoyo:!0,repeat:1})}update(){this.view.x=this.body.x,this.view.y=this.body.y}get x(){return this.body.x}set x(e){this.body.x=e}get y(){return this.body.y}set y(e){this.body.y=e}get type(){return this._type}set type(e){this._type=e,this.bubbleView.type=this.type}}class yi{constructor(){g(this,"game");g(this,"signals",{onShotConnect:new xt.Signal,onBubbleBounce:new xt.Signal,onBubbleCrossLine:new xt.Signal});g(this,"_bodyMap",new Map)}update(){this._bodyMap.forEach(t=>{t.state===Hi.DYNAMIC&&t.applyForce(0,Ih.GRAVITY*t.mass),t.position.add(t.velocity),this._checkOutOfBounds(t),this._checkShotConnect()})}addBody(t){this._bodyMap.get(t.UID)||this._bodyMap.set(t.UID,t)}removeBody(t){this._bodyMap.delete(t.UID)}_checkOutOfBounds(t){var a;const e=this.game.systems.get(Ns),s=this.game.systems.get(Me),r=this.game.systems.get(qi),n=s.getBubbleFromBody(t);if(t.state===Hi.STATIC){t.y+t.radius>-P.bounceLine&&this.signals.onBubbleCrossLine.emit(n);return}if(t.x-t.radius<-U.content.width/2?(t.x+=t.velocity.x,t.velocity.x=Math.abs(t.velocity.x)):t.x+t.radius>U.content.width/2&&(t.x-=t.velocity.x,t.velocity.x=-Math.abs(t.velocity.x)),t===((a=e.projectile)==null?void 0:a.body)){t.y<-U.content.height-P.bubbleSize*2&&e.projectile&&n&&s.killBubble(n);return}t.bounces<t.maxBounces&&t.y>-P.bounceLine?n&&(n.bounce(),r.lineImpact(),this.signals.onBubbleBounce.emit(n)):t.bounces>=t.maxBounces&&t.y+t.radius>P.bubbleSize&&n&&s.killBubble(n)}_checkShotConnect(){const t=this.game.systems.get(Me),{projectile:e}=this.game.systems.get(Ns);if(!e)return;const s=e.body;this._bodyMap.forEach(r=>{if(r===e.body||r.state!==Hi.STATIC)return;const n=s.x-r.x,o=s.y-r.y,a=Math.sqrt(n*n+o*o),h=s.radius+r.radius;if(a<h*.9){this.signals.onShotConnect.emit();const l=t.getBubbleFromBody(r);l&&t.handleConnect(e,{i:l.i,j:l.j})}})}reset(){this._bodyMap.clear()}}g(yi,"SYSTEM_ID","physics");const Qa=2*P.bubblesPerLine-2;class Dc{constructor(){g(this,"j");g(this,"isEven");g(this,"bubbles",new Array(Qa+1));g(this,"bubbleCount");g(this,"game");g(this,"_y")}init(t,e,s){this.j=t,this.isEven=s,this.bubbleCount=0,this.game=e,this.bubbles.length=Qa+1}get y(){return this._y}set y(t){this._y=t,this.bubbles.forEach(e=>{e&&(e.y=this.y)})}addBubble(t,e){t.x=e,t.y=this.y,this.bubbles[t.i]===void 0&&(this.bubbleCount+=1),this.bubbles[t.i]=t,this.game.systems.get(yi).addBody(t.body),this.bubbleCount>P.bubblesPerLine&&console.error("Number of bubble is too high!")}updatePosRatio(t=1){const e=P.screenTop+(this.j-1)*P.bubbleSize,r=(P.screenTop+this.j*P.bubbleSize-e)*t+e;this.y=r}hasBubbleAt(t){return this.bubbles[t]!==void 0}getBubbleAt(t){return this.bubbles[t]}removeBubble(t,e=!0){this.bubbles[t.i]=void 0,this.bubbleCount-=1,this.bubbleCount<0&&console.error("Number of bubble is too low!"),e&&t.drop()}}class Rh{constructor(){g(this,"game");g(this,"shockwaveFilter",new fu);g(this,"_activeShockwave",!1);g(this,"_shockwaveSpeedMod",1);g(this,"_lastContainerPos",new Ut);g(this,"_shockIntensity")}shockwave(t,e,s=!1){this._lastContainerPos.set(this.game.gameContainer.x,this.game.gameContainer.y);const{shockwaveFilter:r}=this;if(this._activeShockwave=!0,this.game.gameContainer.filters=[r],r.center.x=U.content.width*.5+t,r.center.y=U.content.height+e,this.shockwaveFilter.time=0,this._shockIntensity=s?10:5,ie.play("audio/bubbles-falling.wav",{speed:s?.7:gt(1,1.25,!1)}),!s){r.radius=100,r.wavelength=55,this._shockwaveSpeedMod=.75;return}r.radius=300,r.wavelength=140,this._shockwaveSpeedMod=1}stopShockwave(){var t;this._activeShockwave=!1,(t=this.game.gameContainer.filters)!=null&&t.length&&(this.game.gameContainer.filters.length=0),this.game.gameContainer.x=this._lastContainerPos.x,this.game.gameContainer.y=this._lastContainerPos.y}update(t){this._activeShockwave&&(this.game.gameContainer.x=this._lastContainerPos.x+Math.random()*this._shockIntensity,this.game.gameContainer.y=this._lastContainerPos.y+Math.random()*this._shockIntensity,this.shockwaveFilter.time>.4?this.stopShockwave():this.shockwaveFilter.time+=t/60*this._shockwaveSpeedMod)}reset(){this.stopShockwave()}}g(Rh,"SYSTEM_ID","effects");class Nn{constructor(){g(this,"game");g(this,"signals",{onPowerUsed:new xt.Signal})}usePower(t,e,s){switch(t){case"super":this._super(s);break;case"bomb":this._bomb(e,s);break;case"timer":this._timer();break}this.signals.onPowerUsed.emit(t,!1),this.game.stats.increment("powerupsUsed")}_super(t){const e=this.game.systems.get(Me),s=e.lines[t];ie.play("audio/powerup-super.wav"),s.bubbles.forEach(async r=>{r&&await e.removeBubble(r,!_n(r.type))})}_bomb(t,e){var r;const s=this.game.systems.get(Me);ie.play("audio/powerup-bomb.wav"),(r=s.getNeighbours(t,e,P.power.blastRadius))==null||r.forEach(async n=>{await s.removeBubble(n,!0)})}_timer(){ie.play("audio/powerup-time"),this.game.systems.get(ce).addTween(O.delayedCall(P.power.timerFreezeTime,()=>{this.signals.onPowerUsed.emit("timer",!0)}))}}g(Nn,"SYSTEM_ID","power");class Me{constructor(){g(this,"game");g(this,"countPerType",new Map);g(this,"lines",[]);g(this,"signals",{onGameReady:new xt.Signal});g(this,"_heterogeneity",P.minHeterogeneity);g(this,"startingLines",P.startingLines);g(this,"_gridContainer",new R);g(this,"_bubbleMap",new Map);g(this,"_spoofBubble",new Nf);g(this,"_spawnBubbleCount",0);g(this,"_animOffsetRatio",0);g(this,"_dropGroupIndex",0);g(this,"_allowNewLine",!1);g(this,"_newLineTween");g(this,"_newLineSpeedDecrement",0);g(this,"_newLineCount",0)}init(){this.game.addToGame(this._gridContainer),this.game.systems.get(yi).signals.onBubbleCrossLine.connect(()=>{this._allowNewLine=!1,this.game.isGameOver||this.game.gameOver()}),this.game.systems.get(Nn).signals.onPowerUsed.connect((t,e)=>{t==="timer"&&(e?this._newLineTween.resume():this._newLineTween.pause())})}start(){this.createLevel(),this.game.systems.get(Ir).updateRoof(),this._gridContainer.alpha=1,this.game.systems.get(ce).addTween(O.to(this._gridContainer,{y:0,duration:2,ease:"back.out(1)",delay:1,onComplete:()=>{this.signals.onGameReady.emit()}}))}reset(){this._newLineSpeedDecrement=0,this._dropGroupIndex=0,this._newLineCount=0,this._allowNewLine=!1,this.clearLevel()}getAttachedBubbles(){const t=[];return this.lines.forEach(e=>{t.push(...e.bubbles.filter(s=>s!==void 0))}),t}update(){this._bubbleMap.forEach(t=>{t.update()})}clearLevel(){this._bubbleMap.forEach(t=>{this.killBubble(t)}),this._bubbleMap.clear(),this.countPerType.clear();for(let t=0;t<P.startingBubbleTypes.length;t++)this.countPerType.set(P.startingBubbleTypes[t],0);this.lines.length=0,this._spawnBubbleCount=0}createLevel(){const t=this.startingLines;for(let e=0;e<t;e++)this.addLine();this._gridContainer.alpha=0,this._gridContainer.y=-t*P.bubbleSize,this.lines.forEach(e=>{e.updatePosRatio(1)})}getBubbleAt(t,e){const s=this.lines[e];return s==null?void 0:s.getBubbleAt(t)}calculateBubbleX(t){return-U.content.width/2+t.defaultX}calculateBubbleY(t){return P.screenTop+P.bubbleSize*t.j}addLineToGridTop(){this._newLineCount++;const{urgentMinLines:t,animInTime:e,urgentAnimInTime:s,maxDecrement:r,decrementIn:n,animInDecrement:o}=P.newLine,h=this.lines.length<t?s:e-this._newLineSpeedDecrement;this.addLine(!0,h,()=>{this._heterogeneity+=P.heterogeneityIncrement,this._allowNewLine&&this.addLineToGridTop()}),this._newLineCount%n===0&&(this._newLineSpeedDecrement=Math.min(this._newLineSpeedDecrement+o,r))}addLine(t=!0,e=0,s){let r;if(t){this.lines.forEach(h=>{h.j++,h.bubbles.forEach(l=>{l&&(l.j=h.j)})});const o=this.lines.length>0?!this.lines[0].isEven:!0;r=Lt.get(Dc),r.init(0,this.game,o),this.lines.unshift(r);const a=o?0:1;for(let h=a;h<=Qa;h+=2){this._spawnBubbleCount++;const l=this._selectBubbleType(h,0),c=this._createGridBubble(l,h,0);r.addBubble(c,this.calculateBubbleX(c)),this._gridContainer.addChild(c.view)}r.y=P.screenTop-P.bubbleSize,this.pushLevelDown(e,s)}else{const n=this.getLine("bottom"),o=this.lines.length>0?!n.isEven:!0,a=n.j+1;r=Lt.get(Dc),r.init(a,this.game,o),r.y=P.screenTop+P.bubbleSize*r.j,this.lines.push(r)}return r}getLine(t){return t==="top"?this.lines[0]:t==="bottom"?this.lines[this.lines.length-1]:this.lines[t]}pushLevelDown(t,e){const s=this.game.systems.get(ce);this._animOffsetRatio=0,this._newLineTween=s.addTween(O.to(this,{_animOffsetRatio:1,ease:"none",duration:t,onUpdate:()=>{this.lines.forEach(r=>{r.updatePosRatio(this._animOffsetRatio)})},onComplete:e}))}createBubble(){const t=Lt.get(L1);return t.reset(),this._bubbleMap.set(t.UID,t),t}getChanceSelection(t,e){let s=0,r=Math.random()*t-e.get(P.bubbleTypes[0]);for(;s<P.bubbleTypes.length&&r>0;){s+=1;const n=P.bubbleTypes[s];e.has(n)&&(r-=e.get(n))}return s>=P.bubbleTypes.length&&(s=P.bubbleTypes.length-1),s}setBubble(t,e,s){ie.play("audio/bubble-land-sfx.wav",{speed:gt(.8,1.1,!1)}),t.view.removeFromParent(),this._gridContainer.addChild(t.view);const r=s===this.getLine("bottom").j+1?this.addLine(!1):this.lines[s];t.connect(e,r.j);const n=e%2===0;n!==r.isEven&&console.error(`Trying to set even = ${n} where line is even = ${r.isEven}`),r.addBubble(t,this.calculateBubbleX(t));const o=this._getClusterAt(e,s===-1?0:s,!0),a=o.filter(d=>_n(d.type)),h=(a==null?void 0:a.length)>0,l=t.bubbleView.shimmer(),c=o.length>2,u=this.game.systems.get(ce);c?this._dropGroupIndex++:this.getNeighbours(e,r.j).forEach(d=>{const f=Ff(R1(k1(d,t.body.position)),P.bubbleSize*.1);u.addTween(d.impact(f))}),l.then(()=>{o.forEach(p=>{h&&p===t||!c&&!h||this.removeBubble(p,!_n(p.type))}),a.forEach(p=>this.game.systems.get(Nn).usePower(p.type,p.i,p.j));const d=this.removeFloatingBubbles(),{x:f,y:_}=t.view,m=o.length+d;m>this.game.stats.get("bestCombo")&&this.game.stats.set("bestCombo",m),(c||h)&&this.game.systems.get(Rh).shockwave(f,_,h)}),u.addTween(l),this._allowNewLine||(this._allowNewLine=!0,this.addLineToGridTop()),r.updatePosRatio(this._animOffsetRatio)}async removeBubble(t,e=!0){this.game.stats.increment("bubblesPopped"),this.removeBubbleAt(t.i,t.j,e),t.dropGroupId=this._dropGroupIndex}removeBubbleAt(t,e,s=!0){const r=this.lines[e],n=r==null?void 0:r.getBubbleAt(t);if(!n){console.error("Trying to remove a bubble that doesnt exist at ",t,e);return}const o=n.view.parent;s?o.addChild(o.removeChild(n.view)):this.killBubble(n),r.removeBubble(n,s)}removeFloatingBubbles(){const t=new Set,e=new Map;this.getAttachedBubbles().forEach(r=>{if(e.has(r))return;const n=this._getClusterAt(r.i,r.j,!1);n.forEach(o=>{e.set(o,!0)}),n.some(o=>o.j===0)||n.forEach(o=>{t.add(o)})});const s=Array.from(t.values());return s.map(async r=>{this.removeBubble(r)}),this.garbageCollectLines(),s.length}garbageCollectLines(){for(;this.lines.length>0&&this.getLine("bottom").bubbleCount===0;)Lt.return(this.lines.pop());this.game.systems.get(Ir).updateRoof()}killBubble(t){Lt.return(t),t.view.removeFromParent(),this._bubbleMap.delete(t.UID),this.game.systems.get(yi).removeBody(t.body)}handleConnect(t,e,s){const r=this.lines[e.j],n=this._getNeighboursCoord(e.i,r.j);let o=[];const a=t.x-t.body.velocity.x,h=t.y-t.body.velocity.y,l=this._spoofBubble;l.i=e.i;const c=a<this.calculateBubbleX(l)?"left":"right";n.forEach(d=>{l.i=d.i,l.j=d.j;const f=this.calculateBubbleX(l),_=this.calculateBubbleY(l),m=a<f?"left":"right";if(s&&s!==m)return;const p=Math.sqrt(Math.pow(a-f,2)+Math.pow(h-_,2));o.push({i:d.i,j:d.j,distance:p})}),o.sort((d,f)=>d.distance-f.distance);const u=o[0];o=o.splice(0,3).filter(d=>this.isValidGrid(d.i,d.j,!0)&&!this.getBubbleAt(d.i,d.j)),o.length===0&&u?this.handleConnect(t,u,s??c):this.setBubble(t,o[0].i,o[0].j)}getBubbleFromBody(t){return this._bubbleMap.get(t.UID)}getNeighbours(t,e,s=1){const r=[];for(let n=e-s;n<=e+s;n++){const o=n;if(o<0||o>this.lines.length-1)continue;const a=Math.abs(n-e);for(let h=t-s*2+a;h<=t+s*2-a;h++)if(!(h<0||h>this.lines[o].bubbles.length-1)&&(h!==t||n!==e)){const l=this.lines[o].bubbles[h];l&&r.push(l)}}return r}_getNeighboursCoord(t,e){const s=[],r=e,n=(h,l)=>{s.push({i:h,j:l})};n(t-2,r),n(t+2,r);const o=r+1;n(t-1,o),n(t+1,o);const a=r-1;return n(t-1,a),n(t+1,a),s}_getClusterAt(t,e,s){const r=this.getBubbleAt(t,e);if(!r)return[];const n=r.type,o=[],a=[],h=[r],l=c=>_n(c);for(;h.length;){const c=h.pop();if(a.includes(c)||!this.isValidGrid(c.i,c.j))continue;a.push(c);const u=l(c.type);if(!s||c.type===n||u){if(o.push(c),s&&u)continue;const f=this.getNeighbours(c.i,c.j,1).filter(_=>_&&!a.includes(_)&&(!s||!l(_.type)||r===c));h.push(...f)}}return o}isValidGrid(t,e,s){const r=this.getLine("bottom").j,n=e===r+1;if(n&&!s)return!1;const o=this.lines[n?r:e],a=n?!o.isEven:o.isEven,h=a&&t>-1||!a&&t>0,l=a&&t<P.bubblesPerLine*2-1||!a&&t<P.bubblesPerLine*2-2;return o&&h&&l}_createGridBubble(t,e,s){const r=this.countPerType.get(t)??0;this.countPerType.set(t,1+r);const n=this.createBubble();return n.type=t,n.connect(e,s),n}_selectBubbleType(t,e){const s=this._getSpecialType();if(s)return s;const r=this.getNeighbours(t,e);let n=P.bubbleTypes.length*this._heterogeneity;const o=P.bubbleTypes.reduce((h,l)=>h.set(l,this._heterogeneity),new Map);for(let h=0;h<r.length;h+=1){const c=r[h].type;let u=1;o.has(c)?u+=o.get(c):u+=this._heterogeneity,o.set(c,u),n+=1}const a=this.getChanceSelection(n,o);return P.bubbleTypes[a]}_getSpecialType(){const t=P.specialBubbleEvery,e=P.specialBubbleChance;return this._spawnBubbleCount%t===0&&Math.random()<e?ri("special"):null}}g(Me,"SYSTEM_ID","level");class Ns{constructor(){g(this,"game");g(this,"view",new R);g(this,"cannon");g(this,"bubbleReserves",[]);g(this,"reserveBubbleTypes",[]);g(this,"currentBubbleType");g(this,"signals",{onCannonFire:new xt.Signal});g(this,"_aimAngle",0);g(this,"_projectile");g(this,"_cannonForward",new Ut);g(this,"_shotProjectiles",0)}init(){this.game.systems.get(qi).cannonContainer.addChild(this.view);const t=()=>{const e=new T1;return this.view.addChild(e.view),e};this.bubbleReserves.push(t()),this.bubbleReserves.push(t()),this.cannon=new Ph,this.cannon.view.scale.set(.5),this.view.addChild(this.cannon.view),this.reserveBubbleTypes.length=this.bubbleReserves.length,this.game.systems.get(Me).signals.onGameReady.connect(()=>{this.game.hitContainer.on("pointermove",this._calculateAngle.bind(this)),this.game.hitContainer.on("pointertap",this._fire.bind(this)),this._loadNextShot()}),this.game.systems.get(yi).signals.onShotConnect.connect(()=>{this._projectile=null}),this.cannon.view.y=-P.bounceLine+75,this.bubbleReserves.forEach((e,s)=>{var r,n;e.view.x=(((n=(r=this.bubbleReserves[s-1])==null?void 0:r.view)==null?void 0:n.x)??-5)-75,e.view.y=this.cannon.view.y})}awake(){this._emptyShots()}reset(){this.cannon.rotation=0,this._shotProjectiles=0}get cannonX(){return this.cannon.view.x}get cannonY(){return this.cannon.view.y}get projectile(){return this._projectile}get forward(){return this._cannonForward}get angle(){return this._aimAngle}_fire(t){if(this._projectile)return;ie.play("audio/bubble-land-sfx.wav",{speed:.25}),this._calculateAngle(t),this.signals.onCannonFire.emit(this._shotProjectiles===0),this._shotProjectiles++;const e=this.game.systems.get(Me).createBubble();e.type=this.currentBubbleType,this.game.addToGame(e.view);const{x:s,y:r}=this.forward;e.x=s,e.y=r,e.body.state=Hi.KINEMATIC;const n=3;e.body.applyForce((s-this.cannonX)*n,(r-this.cannonY)*n),this.game.systems.get(yi).addBody(e.body),this._projectile=e,this._loadNextShot()}_emptyShots(){for(let t=0;t<this.reserveBubbleTypes.length;t++)this.bubbleReserves[t].type="empty";this.currentBubbleType="empty",this.cannon.type=this.currentBubbleType}_loadNextShot(){this.currentBubbleType=this.reserveBubbleTypes[0]??this._newBubble();const t=this.reserveBubbleTypes;for(let e=0;e<t.length;e++)t[e]=t[e+1]??this._newBubble(),this.bubbleReserves[e].type=t[e];this.cannon.type=this.currentBubbleType}_calculateAngle(t){const e=this.cannon.view.getGlobalPosition(),s=Math.atan2(t.global.y-e.y,t.global.x-e.x);Math.abs(this._aimAngle-s)>Math.PI*2e-4&&Bf("cannon-audio",150,()=>{ie.play("audio/cannon-move.wav",{volume:.2})}),this._aimAngle=s,this.cannon.rotation=s+Math.PI*.5,this._cannonForward.set(80*Math.cos(this._aimAngle)+this.cannonX,80*Math.sin(this._aimAngle)+this.cannonY)}_newBubble(){const t=this.game.systems.get(Me),e=new Map(t.countPerType);this.currentBubbleType!==void 0&&e.set(this.currentBubbleType,0);let s=0;e.forEach(o=>{s+=o});const r=t.getChanceSelection(s,e);return P.bubbleTypes[r]}}g(Ns,"SYSTEM_ID","cannon");class nn{constructor(){g(this,"startNode",new Ut);g(this,"endNode",new Ut)}}class O1{constructor(){g(this,"view");g(this,"type");this.view=pt.from("shot-visualiser"),this.view.anchor.set(.5),this.view.scale.set(.25)}}class Ir{constructor(){g(this,"game");g(this,"view",new R);g(this,"nodeContainer",new R({layer:!0}));g(this,"_aimLines",[]);g(this,"_leftWall");g(this,"_rightWall");g(this,"_roof");g(this,"_activeNodes",[])}init(){this.game.systems.get(qi).view.addChild(this.view),this.view.addChild(this.nodeContainer);const t=U.content.width*.5-P.bubbleSize*.5,e=U.content.height;this._leftWall=new nn,this._leftWall.startNode.set(-t,0),this._leftWall.endNode.set(-t,-e),this._rightWall=new nn,this._rightWall.startNode.set(t,0),this._rightWall.endNode.set(t,-e),this._roof=new nn,this._roof.startNode.set(t,0),this._roof.endNode.set(t,-e),this.enabled(!1),this.game.systems.get(Me).signals.onGameReady.connect(()=>{this.game.hitContainer.on("pointermove",this.updateAim.bind(this)),this.game.hitContainer.on("pointertap",this.updateAim.bind(this)),this.game.hitContainer.on("pointerout",this.enabled.bind(this,!1)),this.game.hitContainer.on("pointerover",this.enabled.bind(this,!0)),this.enabled(!0)})}reset(){this._clear()}updateRoof(){const t=U.content.width*.5,e=this.game.systems.get(Me).getLine("bottom").y;this._roof.startNode.set(-t,e+P.bubbleSize),this._roof.endNode.set(t,e+P.bubbleSize)}updateAim(){this._clear();const t=this.game.systems.get(Ns);this._calculateEdgeNodes(t.cannonX,t.cannonY,t.angle)}enabled(t){O.killTweensOf(this.nodeContainer),O.to(this.nodeContainer,{alpha:t?1:0,duration:.2})}_calculateEdgeNodes(t,e,s,r){const n=Lt.get(nn);this._aimLines.push(n),n.startNode.set(t,e);const o=P.maxAimLinesLength,a=t+o*Math.cos(s),h=e+o*Math.sin(s);n.endNode.set(a,h);const l=this._intersection(n,this._roof);if(l){n.endNode.set(l.x,l.y),this._visualiseNodes();return}const c=this._intersection(n,this._leftWall);let u=null;if(c&&(!r||r!==this._leftWall)&&(n.endNode.set(c.x,c.y),u=this._leftWall),!u){const d=this._intersection(n,this._rightWall);d&&(n.endNode.set(d.x,d.y),u=this._rightWall)}if(!u||this._aimLines.length>P.maxAimLines)this._visualiseNodes();else{const d=-(s-2*(Math.PI/2));this._calculateEdgeNodes(n.endNode.x,n.endNode.y,d,u)}}_intersection(t,e){const{startNode:s,endNode:r}=t,{startNode:n,endNode:o}=e,a=(o.y-n.y)*(r.x-s.x)-(o.x-n.x)*(r.y-s.y);if(a===0)return null;const h=((o.x-n.x)*(s.y-n.y)-(o.y-n.y)*(s.x-n.x))/a,l=((r.x-s.x)*(s.y-n.y)-(r.y-s.y)*(s.x-n.x))/a;if(h<0||h>1||l<0||l>1)return null;const c=s.x+h*(r.x-s.x),u=s.y+h*(r.y-s.y);return{x:c,y:u}}_clear(){this._activeNodes.forEach(t=>{Lt.return(t)}),this._activeNodes.length=0,this.nodeContainer.removeChildren(),this._aimLines.forEach(t=>{Lt.return(t)}),this._aimLines.length=0}_visualiseNodes(){const t=(e,s,r)=>{const n=Math.sqrt(Math.pow(s.x-e.x,2)+Math.pow(s.y-e.y,2)),o=Math.ceil(n/r),a=[],h=(s.x-e.x)/o,l=(s.y-e.y)/o;for(let c=1;c<o;c++)a.push({x:e.x+h*c,y:e.y+l*c});return a};this._aimLines.forEach((e,s)=>{const r=s===this._aimLines.length-1;if(!r){const o=this.getVisualNode("joint");o.view.position.copyFrom(e.endNode),this.nodeContainer.addChild(o.view)}const n=t(e.startNode,e.endNode,50);n.forEach((o,a)=>{const h=this.getVisualNode("line");if(h.view.position.copyFrom(o),this.nodeContainer.addChild(h.view),r&&a>n.length*.2){const l=1-a/n.length;h.view.alpha=l*.75}})})}getVisualNode(t){const e=Lt.get(O1);return e.type=t,e.view.alpha=1,this._activeNodes.push(e),e}}g(Ir,"SYSTEM_ID","aim");class th{constructor(){g(this,"game");g(this,"_pointMap",new Map)}init(){const t=this.game.systems.get(qi),e=this.game.systems.get(yi);let s=null;e.signals.onBubbleBounce.connect(r=>{const n=this._pointMap.get(r.dropGroupId)??this._pointMap.set(r.dropGroupId,1).get(r.dropGroupId),o=P.scoreIncrement*n;t.updateScore(o,this.game.stats.increment("score",o),r),s&&clearTimeout(s),s=setTimeout(()=>{this.updateHighscore()},60),this._pointMap.set(r.dropGroupId,n+1)})}updateHighscore(){const t=this.game.stats;if(t.get("score")>t.get("highscore")){const e=t.get("score");t.set("highscore",e),se.setStorageItem("highscore",e)}}reset(){this._pointMap.clear()}}g(th,"SYSTEM_ID","score");class F1{constructor(){g(this,"view",new R);g(this,"_tick",0);g(this,"_frequency",0);g(this,"_range",.5);const t=pt.from("satellite");t.anchor.set(.5),this.view.addChild(t)}changeView(){this.view.scale.set(gt(.3,.9,!1)),this._tick=gt(-Math.PI*.01,Math.PI*.01,!1),this._frequency=gt(1,2,!1),this._range=gt(-Math.PI*.05,Math.PI*.05,!1)}update(t){this._tick+=t/60;const e=this._tick/this._frequency,s=this._range*Math.sin(e);this.view.rotation=s}}class N1{constructor(){g(this,"view",new R);g(this,"_mainBubble");g(this,"_subBubbles",[]);g(this,"_orbitAngles",[]);g(this,"_orbitDirections",[]);g(this,"_orbitRadii",[]);g(this,"_orbitSpeeds",[])}changeView(){this._mainBubble&&this.reset(),this._mainBubble=Lt.get(gi),this._mainBubble.type=ri(),this._mainBubble.view.x=0,this._mainBubble.view.y=0,this._mainBubble.view.scale.set(gt(.7,2.5,!1)),this.view.addChild(this._mainBubble.view);const t=gt(1,5);for(let e=0;e<t;e++)this._subBubbles[e]=Lt.get(gi),this._subBubbles[e].type=ri(),this._subBubbles[e].view.scale.set(this._mainBubble.view.scale.x*gt(.3,.7,!1)),this._orbitAngles[e]=Math.random()*Math.PI,this._orbitDirections[e]=Math.sign(gt(-1,1,!1)),this._orbitRadii[e]=this._mainBubble.view.width*.5+this._subBubbles[e].view.width*.5+10,this._orbitSpeeds[e]=this._subBubbles[e].view.scale.x/this._mainBubble.view.scale.x*.5,this.view.addChild(this._subBubbles[e].view)}reset(){this._mainBubble.view.removeFromParent();for(let t=0;t<this._subBubbles.length;t++)this._subBubbles[t].view.removeFromParent(),Lt.return(this._subBubbles[t]);this._subBubbles.length=0,this._orbitAngles.length=0,this._orbitDirections.length=0,this._orbitRadii.length=0,this._orbitSpeeds.length=0}update(t){for(let e=0;e<this._subBubbles.length;e++)this._subBubbles[e].view.x=Math.cos(this._orbitAngles[e])*this._orbitRadii[e],this._subBubbles[e].view.y=Math.sin(this._orbitAngles[e])*this._orbitRadii[e],this._orbitAngles[e]+=t/60*this._orbitSpeeds[e]*this._orbitDirections[e]}}class Uf{constructor(){g(this,"game");g(this,"view",new R);g(this,"_decor",[]);g(this,"_width");g(this,"_height")}init(){this.game.stage.addChildAt(this.view,0)}generateRandomPoints(t){const e=[],s=U.decorEdgePadding,r=U.decorMinDistance,n=U.content.width*.8;let o=!1,a=1e3;for(;e.length<t&&!o;){const h=gt(s,this._width-s,!1),l=gt(s,this._height-s,!1);if(a<=0&&(o=!0),a--,Math.abs(h-this._width/2)<n&&Math.abs(l-this._height/2)<n)continue;let c=!1;for(const u of e)if(M1(u,{x:h,y:l})<r){c=!0;break}c||e.push({x:h,y:l})}return e}update(t){this._decor.forEach(e=>{e.update(t)})}resize(t,e){if(this._width=t,this._height=e,this._clear(),t>U.content.width*2){const s=Lf.isMobileDevice()?U.decorCountMobile:U.decorCountDesktop;this._createDecor(this.generateRandomPoints(s))}}_createDecor(t){t.forEach(e=>{const s=Math.random()<.4?F1:N1,r=Lt.get(s);r.view.position.copyFrom(e),this._decor.push(r),this.view.addChild(r.view),r.changeView()})}_clear(){this._decor.forEach(t=>{t.view.removeFromParent(),Lt.return(t)}),this._decor.length=0}}g(Uf,"SYSTEM_ID","spaceDecor");class U1{constructor(){g(this,"stage",new R);g(this,"gameContainer",new R);g(this,"hitContainer",new R);g(this,"systems");g(this,"stats");g(this,"isGameOver",!1);g(this,"_hitArea");this.stage.addChild(this.gameContainer),this._hitArea=new me,this.hitContainer.interactive=!0,this.hitContainer.hitArea=this._hitArea,this.gameContainer.addChild(this.hitContainer),this.systems=new x1(this),this.stats=new b1}addToGame(...t){t.forEach(e=>{this.gameContainer.addChild(e)})}removeFromGame(...t){t.forEach(e=>{e.removeFromParent()})}init(){this.systems.add(Uf),this.systems.add(ce),this.systems.add(yi),this.systems.add(qi),this.systems.add(Nn),this.systems.add(Me),this.systems.add(Ir),this.systems.add(Ns),this.systems.add(Rh),this.systems.add(th),this.systems.init()}async awake(){this.systems.awake(),this.gameContainer.visible=!0}async start(){this.systems.start()}async gameOver(){this.isGameOver=!0,this.systems.get(Ir).enabled(!1),this.systems.get(th).updateHighscore(),await this.systems.get(qi).closeHud(),this.gameContainer.visible=!1,O.delayedCall(1,()=>{te.goToScreen(Za,{score:this.stats.get("score"),popped:this.stats.get("bubblesPopped"),powerups:this.stats.get("powerupsUsed"),combo:this.stats.get("bestCombo"),highscore:this.stats.get("highscore")})})}async end(){this.hitContainer.removeAllListeners(),this.systems.end()}update(t){this.systems.get(ce).isPaused||this.isGameOver||this.systems.update(t)}reset(){this.isGameOver=!1,this.stats.reset(),this.systems.reset()}resize(t,e){this.gameContainer.x=t*.5,this.gameContainer.y=e,this._hitArea.x=-t/2,this._hitArea.y=-e,this._hitArea.width=t,this._hitArea.height=e-P.bounceLine*.75,this.systems.resize(t,e)}}class Mr extends R{constructor(){super();g(this,"_background");g(this,"_game");this._background=new Br({texture:H.from("background-tile-space"),width:64,height:64}),this._background.tileScale.set(U.backgroundTileScale),this.addChild(this._background),this._game=new U1,this._game.init(),this.addChild(this._game.stage)}async show(){O.killTweensOf(this),this.alpha=0,this._game.awake(),await O.to(this,{alpha:1,duration:.2,ease:"linear"}),this._game.start()}async hide(){O.killTweensOf(this),this._game.end(),await O.to(this,{alpha:0,duration:.2,ease:"linear"}),this._game.reset()}update(e){this._game.update(e.deltaTime)}resize(e,s){this._background.width=e,this._background.height=s,this._game.resize(e,s)}}g(Mr,"SCREEN_ID","game"),g(Mr,"assetBundles",["images/game-screen"]);function D1(i,t,e){return(1-e)*i+e*t}class Un extends R{constructor(){super();g(this,"_background");g(this,"_spinner");g(this,"_cannon");g(this,"_pixiLogo");g(this,"_bottomContainer",new R);g(this,"_targetOffset",0);g(this,"_tick",0);this._background=new Br({texture:H.from("background-tile"),width:64,height:64}),this._background.tileScale.set(U.backgroundTileScale),this.addChild(this._background),this._spinner=pt.from("loading-circle"),this._spinner.anchor.set(.5),this.addChild(this._spinner),this._cannon=new Ph,this._cannon.view.scale.set(.5),this._cannon.type=ri(),this.addChild(this._cannon.view),this._pixiLogo=new Rf(Tt.t("pixiLogoHeader")),this._pixiLogo.view.scale.set(.75),this._bottomContainer.addChild(this._pixiLogo.view),this.addChild(this._bottomContainer)}async show(){O.killTweensOf(this),this.alpha=0,this._bottomContainer.y=0,await O.to(this,{alpha:1,duration:.2,ease:"linear"})}async hide(){O.killTweensOf(this),await O.to(this._bottomContainer,{y:100,duration:.25}),await O.to(this,{alpha:0,delay:.1,duration:.2,ease:"linear"})}update(e){const s=e.deltaTime;this._spinner.rotation-=s/60,this._cannon.rotation=D1(this._cannon.rotation,this._spinner.rotation-this._targetOffset,.1),this._tick<=0?(this._targetOffset=gt(Math.PI*.2,Math.PI*.5),this._tick=1):this._tick-=s/60}resize(e,s){this._background.width=e,this._background.height=s,this._spinner.x=this._cannon.view.x=e*.5,this._spinner.y=this._cannon.view.y=s*.5,this._pixiLogo.view.x=e*.5,this._pixiLogo.view.y=s-55}}g(Un,"SCREEN_ID","loader"),g(Un,"assetBundles",["images/preload"]);const Ne=new nh;let Gc=!1;function Vc(){const i=window.innerWidth,t=window.innerHeight,e=U.content.width,s=U.content.height,r=i<e?e/i:1,n=t<s?s/t:1,o=r>n?r:n,a=i*o,h=t*o;Ne.renderer.view.element.style.width=`${i}px`,Ne.renderer.view.element.style.height=`${t}px`,window.scrollTo(0,0),Ne.renderer.resize(a,h),te.init(),te.resize(a,h)}async function G1(){await Ne.init({resolution:Math.max(window.devicePixelRatio,2),backgroundColor:16777215}),Ne.stage.layer=!0,document.body.appendChild(Ne.canvas),Mw(Ne.renderer),window.addEventListener("resize",Vc),Vc(),await wm(),se.readyStorage(),te.setLoadScreen(Un),or.muted(se.getStorageItem("muted")),document.addEventListener("pointerdown",()=>{Gc||Aw.play("audio/bubbo-bubbo-bg-music.wav"),Gc=!0}),document.addEventListener("visibilitychange",()=>{document.visibilityState!=="visible"?or.muted(!0):or.muted(se.getStorageItem("muted"))}),Oc("play")!==null?(await Fe.loadBundle(Fs.assetBundles),await te.goToScreen(Mr)):Oc("loading")!==null?await te.goToScreen(Un):await te.goToScreen(Fs)}G1();export{ga as $,fa as A,Rr as B,R as C,$p as D,Oe as E,au as F,Wi as G,da as H,r_ as I,_u as J,N_ as K,Hc as L,J as M,jh as N,n_ as O,Ut as P,Xh as Q,me as R,pt as S,$c as T,na as U,em as V,fm as W,hm as X,Ae as Y,re as Z,il as _,jt as a,Ze as a0,im as a1,sl as a2,iT as a3,H as b,np as c,op as d,Dn as e,Gs as f,Kp as g,y_ as h,uu as i,Kh as j,Jt as k,Up as l,ir as m,$h as n,Xf as o,hr as p,jc as q,Dp as r,Gt as s,x_ as t,ur as u,hu as v,L_ as w,lu as x,sp as y,Jh as z};
